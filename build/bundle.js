var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function h(){return p(" ")}function g(){return p("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function k(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function x(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function _(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function C(t,e){return new t(e)}let y;function S(t){y=t}function q(){if(!y)throw new Error("Function called outside component initialization");return y}function T(t){q().$$.on_mount.push(t)}function L(t){q().$$.after_update.push(t)}function V(){const t=q();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,o,e),s}(e,n,{cancelable:o});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const E=[],j=[],U=[],H=[],M=Promise.resolve();let A=!1;function B(t){U.push(t)}const P=new Set;let N=0;function I(){const t=y;do{for(;N<E.length;){const t=E[N];N++,S(t),G(t.$$)}for(S(null),E.length=0,N=0;j.length;)j.pop()();for(let t=0;t<U.length;t+=1){const e=U[t];P.has(e)||(P.add(e),e())}U.length=0}while(E.length);for(;H.length;)H.pop()();A=!1,P.clear(),S(t)}function G(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const O=new Set;let R;function D(){R={r:0,c:[],p:R}}function z(){R.r||s(R.c),R=R.p}function F(t,e){t&&t.i&&(O.delete(t),t.i(e))}function Q(t,e,n,o){if(t&&t.o){if(O.has(t))return;O.add(t),R.c.push((()=>{O.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function J(t){t&&t.c()}function W(t,e,o,i){const{fragment:c,after_update:l}=t.$$;c&&c.m(e,o),i||B((()=>{const e=t.$$.on_mount.map(n).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...e):s(e),t.$$.on_mount=[]})),l.forEach(B)}function K(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(E.push(t),A||(A=!0,M.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,n,r,i,c,l,a,d=[-1]){const f=y;S(e);const p=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:d,skip_bound:!1,root:n.target||f.$$.root};a&&a(p.root);let h=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),h&&Y(e,t)),n})):[],p.update(),h=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();n.intro&&F(e.$$.fragment),W(e,n.target,n.anchor,n.customElement),I()}S(f)}class Z{$destroy(){K(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const tt=[];function et(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!tt.length;for(const t of s)t[1](),tt.push(t,e);if(t){for(let t=0;t<tt.length;t+=2)tt[t][0](tt[t+1]);tt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const nt=(()=>{const{subscribe:t,set:e}=et({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=nt.views[t];o.props=n,e(o)}}})(),ot=(()=>{const{subscribe:t,set:e,update:n}=et([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})();function st(t,e,n){const o=t.slice();return o[2]=e[n],o}function rt(t){let e,n,o=t[2]+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&w(n,o)},d(t){t&&u(e)}}}function it(e){let n,o,s,r,i,c,p,g,$,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=rt(st(e,w,t));return{c(){n=f("div"),o=f("h4"),o.textContent="Errors",s=h(),r=f("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=h(),c=f("div"),p=f("button"),p.textContent="Ok",b(o,"class","is-text-danger"),b(p,"class","button"),b(c,"class","is-floating"),b(n,"class","card card-shadow block content")},m(t,u){a(t,n,u),l(n,o),l(n,s),l(n,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);l(n,i),l(n,c),l(c,p),g||($=m(p,"click",e[1]),g=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=st(t,w,n);v[n]?v[n].p(o,e):(v[n]=rt(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&u(n),d(v,t),g=!1,$()}}}function ct(t,e,n){let o;c(t,ot,(t=>n(0,o=t)));return[o,()=>{ot.resetErrors()}]}class lt extends Z{constructor(t){super(),X(this,t,ct,it,i,{})}}const at=t=>{ot.addError(t.type)},ut=new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=e=>{const o=n.result;e.oldVersion<4&&(t=>{if(t.objectStoreNames.contains("topics")||t.createObjectStore("topics",{keyPath:"file"}),!t.objectStoreNames.contains("questions")){const e=t.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});e.indexNames.contains("file")||e.createIndex("file","file",{unique:!1})}t.objectStoreNames.contains("hash")||(t.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}),t.objectStoreNames.contains("admin")||t.createObjectStore("admin",{keyPath:"config"}),t.objectStoreNames.contains("config")&&t.deleteObjectStore("config")})(o),t(o)},n.onerror=t=>{ot.addError(t.type),e()},n.onsuccess=()=>{const e=n.result;e.onerror=at,console.log("db init success!"),t(e)}})),dt=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=()=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),ft=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=()=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),pt=t=>new Promise(((e,n)=>{ut.then((o=>{const s=o.transaction(["hash"],"readonly").objectStore("hash"),r=s.get(t);r.onsuccess=()=>{const n=r.result?r.result:{file:t};console.log("Store:",s.name,"get:",n),e(n)},r.onerror=e=>{console.log("Store:",s.name,"get:",t,"error",e),n()}}))})),ht=(t,e)=>{const n=t.objectStore("hash");return dt(n,e)},gt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},mt=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},$t=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},bt=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),wt=t=>{for(let e=0;e<t.length;e++){const n=bt(0,t.length-1);if(e===n)continue;const o=t[e];t[e]=t[n],t[n]=o}};function vt(t){return t instanceof Error?t.message:String(t)}const kt=()=>new Promise((t=>{ut.then((e=>{const n=e.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=()=>{let e=n.result;e||(e={config:"admin",langUrl:"https://api.github.com/repos/dead-end/cards-russian/contents/",backupUrl:"",file:"",token:""}),t(e)}}))})),xt=t=>{try{return JSON.parse((e=t,decodeURIComponent(escape(window.atob(e)))))}catch(t){ot.addError(`githubParseContent - unable to parse json content: ${t}`)}var e},_t=t=>{const e={Accept:"application/vnd.github.v3+json"};return t&&t.token&&(e.authorization=`token ${t.token}`),e},Ct=async()=>{const t=await kt();return{backupUrl:t.backupUrl+t.file+".json",headers:_t(t)}},yt=async(t,e)=>{const n=await fetch(t,{method:"HEAD",headers:e}).catch((e=>{ot.addError(`githubGetEtag - url: ${t} error: ${e}`)}));if(!n||404===n.status)return;if(!n.ok)return void ot.addError(`githubGetEtag - url: ${t} error: ${n.statusText}`);const o=n.headers.get("ETag");if(!o)return;const s=o.startsWith("W/")?3:1;return o.substring(s,o.length-1)},St=async(t,e)=>{const n=await fetch(t,e).catch((e=>{ot.addError(`githubGetJsonContent - url: ${t} error: ${e}`)}));if(n){if(n.ok)return n.json();ot.addError(`githubGetJsonContent - url: ${t} error: ${n.statusText}`)}},qt=async t=>{const{fileUrl:e,headers:n}=await(async t=>{const e=await kt();return{fileUrl:e.langUrl+t,headers:_t(e)}})(t);let o=await pt(t);if(o.value){const t=await(async(t,e,n)=>{const o=await yt(t,e);if(!o)return!1;const s=o===n;return console.log("url :",t,"ETag",o,"hash",n,"matches",s),s})(e,n,o.value);if(t)return}const s=await St(e,n);if(!s)return;const r=xt(s.content);return r?(o.value=s.sha,o.lastLoaded=new Date,await(t=>new Promise(((e,n)=>{ut.then((o=>{const s=o.transaction(["hash"],"readwrite").objectStore("hash"),r=s.put(t);r.onsuccess=()=>{console.log("Store:",s.name,"put:",t),e()},r.onerror=e=>{console.log("Store:",s.name,"put:",t,"error",e),n()}}))})))(o),console.log("githubGetJson",r),r):void 0};class Tt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&ot.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class Lt{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new Tt(t,e)}_pattern(){let t="";for(const e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return t in this.map||ot.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(const e in this.map)this.map[e].check(t)}_substitute(t){return t.replaceAll(this.regex,(t=>this.tag(t)))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(const o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}static remove(t){return t.replace(/[_*~]/g,"")}}const Vt=(t,e)=>((t,e,n,o)=>new Promise((s=>{const r=t.objectStore(e),i=r.index(n).getAllKeys(o);i.onsuccess=()=>{i.result.forEach((t=>{dt(r,t)})),s()}})))(t,"questions","file",e),Et=async t=>{const e=(await ut).transaction(["questions"],"readonly").objectStore("questions");return jt(e,t)},jt=(t,e)=>new Promise((n=>{const o=t.index("file").getAll(e.file);o.onsuccess=()=>{n(o.result)}})),Ut=async(t,e)=>{const n=(await ut).transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,new Promise((e=>{n.put(t).onsuccess=()=>{e()}})))));await Promise.all(o)},Ht=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=()=>{const t=Bt(n),r=Bt(s.result);r.forEach((e=>{t.has(e.id)||dt(o,e.id)})),t.forEach((t=>{const n=r.get(t.id);n?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(n,t),ft(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=()=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},Mt=async t=>{const e=(await ut).transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];((t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=()=>{n(s.result)},s.onerror=e=>{console.log("Store:",t.name,"questGet:",e),o()}})))(e,n).then((t=>{t&&t.total<s&&(t.failed=o,t.total=s,t.ratio=$t(t.failed,t.total),ft(e,t))}))}))},At=async t=>{const e=await qt(t);if(e){const n=(await ut).transaction(["questions"],"readwrite");Ht(n,t,e)}},Bt=t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e},Pt=(t,e)=>{for(let n of t)if(Lt.remove(n).toLowerCase().includes(e))return!0;return!1},Nt=()=>new Promise(((t,e)=>{ut.then((n=>{const o=n.transaction(["topics"],"readonly").objectStore("topics"),s=o.getAll();s.onsuccess=()=>{console.log("Store:",o.name,"topicGetAll:"),t(s.result)},s.onerror=t=>{console.log("Store:",o.name,"topicGetAll error:",t),e()}}))})),It=(t,e)=>{const n=t.objectStore("topics");dt(n,e)},Gt=async t=>{const e=(await ut).transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=()=>{const s=Ot(o.result),r=t.map((t=>t.file));for(const t of s.keys())r.includes(t)||(It(e,t),ht(e,t),Vt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!mt(t.tags,e.tags)||!mt(t.details,e.details)))(t,s.get(t.file))&&ft(n,t)}))}},Ot=t=>{const e=new Map;return t.forEach((t=>{e.set(t.file,t)})),e};function Rt(t){let e,n,o,s,r,i,c,d,m,$,b,v,k,x,_=t[4]&&Dt(t);return{c(){e=f("tr"),n=f("td"),n.textContent="Questions",o=h(),s=f("td"),r=p(t[2]),i=h(),c=f("tr"),d=f("td"),d.textContent="Status",m=h(),$=f("td"),b=p(t[1]),v=p("%"),k=h(),_&&_.c(),x=g()},m(t,u){a(t,e,u),l(e,n),l(e,o),l(e,s),l(s,r),a(t,i,u),a(t,c,u),l(c,d),l(c,m),l(c,$),l($,b),l($,v),a(t,k,u),_&&_.m(t,u),a(t,x,u)},p(t,e){4&e&&w(r,t[2]),2&e&&w(b,t[1]),t[4]?_?_.p(t,e):(_=Dt(t),_.c(),_.m(x.parentNode,x)):_&&(_.d(1),_=null)},d(t){t&&u(e),t&&u(i),t&&u(c),t&&u(k),_&&_.d(t),t&&u(x)}}}function Dt(t){let e,n,o,s,r,i,c,d,g,m,$,b=gt(t[4].lastLoaded)+"",v=(t[4].value?t[4].value:"")+"";return{c(){e=f("tr"),n=f("td"),n.textContent="Last loaded",o=h(),s=f("td"),r=p(b),i=h(),c=f("tr"),d=f("td"),d.textContent="Hash",g=h(),m=f("td"),$=p(v)},m(t,u){a(t,e,u),l(e,n),l(e,o),l(e,s),l(s,r),a(t,i,u),a(t,c,u),l(c,d),l(c,g),l(c,m),l(m,$)},p(t,e){16&e&&b!==(b=gt(t[4].lastLoaded)+"")&&w(r,b),16&e&&v!==(v=(t[4].value?t[4].value:"")+"")&&w($,v)},d(t){t&&u(e),t&&u(i),t&&u(c)}}}function zt(t){let e,n,o=t[0].desc+"";return{c(){e=f("p"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&w(n,o)},d(t){t&&u(e)}}}function Ft(e){let n,o,s,r,i,c,d,m,$,b,v,k,x,_,C,y,S,q,T=e[0].title+"",L=gt(e[0].lastLearned)+"",V=e[0].tags.join(", ")+"",E=e[3]&&Rt(e),j=e[0].desc&&zt(e);return{c(){n=f("h4"),o=p(T),s=h(),r=f("table"),i=f("tr"),c=f("td"),c.textContent="Last learned",d=h(),m=f("td"),$=p(L),b=h(),v=f("tr"),k=f("td"),k.textContent="Tags",x=h(),_=f("td"),C=p(V),y=h(),E&&E.c(),S=h(),j&&j.c(),q=g()},m(t,e){a(t,n,e),l(n,o),a(t,s,e),a(t,r,e),l(r,i),l(i,c),l(i,d),l(i,m),l(m,$),l(r,b),l(r,v),l(v,k),l(v,x),l(v,_),l(_,C),l(r,y),E&&E.m(r,null),a(t,S,e),j&&j.m(t,e),a(t,q,e)},p(t,[e]){1&e&&T!==(T=t[0].title+"")&&w(o,T),1&e&&L!==(L=gt(t[0].lastLearned)+"")&&w($,L),1&e&&V!==(V=t[0].tags.join(", ")+"")&&w(C,V),t[3]?E?E.p(t,e):(E=Rt(t),E.c(),E.m(r,null)):E&&(E.d(1),E=null),t[0].desc?j?j.p(t,e):(j=zt(t),j.c(),j.m(q.parentNode,q)):j&&(j.d(1),j=null)},i:t,o:t,d(t){t&&u(n),t&&u(s),t&&u(r),E&&E.d(),t&&u(S),j&&j.d(t),t&&u(q)}}}function Qt(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return T((async()=>{c&&n(4,o=await pt(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}(async()=>{const t=await qt("data/topics.json");t&&Gt(t)})();class Jt extends Z{constructor(t){super(),X(this,t,Qt,Ft,i,{topic:0,status:1,size:2,details:3})}}function Wt(t){let e,n,o,s,r,i,c,d,p;return n=new Jt({props:{topic:t[0],details:!1}}),{c(){e=f("div"),J(n.$$.fragment),o=h(),s=f("div"),r=f("button"),r.textContent="Show",b(r,"class","button"),b(s,"class","is-floating"),b(e,"class","card card-shadow content"),b(e,"id",i=t[0].file)},m(i,u){a(i,e,u),W(n,e,null),l(e,o),l(e,s),l(s,r),c=!0,d||(p=m(r,"click",t[2]),d=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&b(e,"id",i)},i(t){c||(F(n.$$.fragment,t),c=!0)},o(t){Q(n.$$.fragment,t),c=!1},d(t){t&&u(e),K(n),d=!1,p()}}}function Kt(t,e,n){let{topic:o}=e;const s=t=>{nt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Yt extends Z{constructor(t){super(),X(this,t,Kt,Wt,i,{topic:0})}}function Xt(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){a(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function Zt(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class te extends Z{constructor(t){super(),X(this,t,Zt,Xt,i,{onClick:0})}}function ee(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){a(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function ne(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class oe extends Z{constructor(t){super(),X(this,t,ne,ee,i,{onClick:0})}}function se(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5l-3.9 19.5m-2.1-19.5l-3.9 19.5"></path></svg>',b(n,"class","icon reset-button")},m(t,i){a(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function re(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class ie extends Z{constructor(t){super(),X(this,t,re,se,i,{onClick:0})}}function ce(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"></path></svg>',b(n,"class","icon reset-button")},m(t,i){a(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function le(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class ae extends Z{constructor(t){super(),X(this,t,le,ce,i,{onClick:0})}}function ue(t,e,n){const o=t.slice();return o[14]=e[n],o}function de(t,e,n){const o=t.slice();return o[17]=e[n],o}function fe(t){let e,n,o,r,i,c,p,g,$,w,v,k,_,C,y,S,q,T,L,V,E,j,U,H=t[1],M=[];for(let e=0;e<H.length;e+=1)M[e]=pe(de(t,H,e));let A=t[2]&&he(t);return C=new ae({props:{onClick:t[9]}}),S=new ie({props:{onClick:t[10]}}),T=new oe({props:{onClick:t[11]}}),V=new te({props:{onClick:t[12]}}),{c(){e=f("div"),n=f("label"),n.textContent="Sort",o=h(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Last learned",p=h(),g=f("label"),g.textContent="Tag Filter",$=h(),w=f("select"),v=f("option"),v.textContent="-- Select --";for(let t=0;t<M.length;t+=1)M[t].c();k=h(),A&&A.c(),_=h(),J(C.$$.fragment),y=h(),J(S.$$.fragment),q=h(),J(T.$$.fragment),L=h(),J(V.$$.fragment),b(n,"class","is-valign-center"),b(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,b(r,"id","sort-select"),void 0===t[3]&&B((()=>t[6].call(r))),b(g,"for","tag-select"),v.__value="",v.value=v.__value,b(w,"id","tag-select"),void 0===t[2]&&B((()=>t[7].call(w))),b(e,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),x(r,t[3]),l(e,p),l(e,g),l(e,$),l(e,w),l(w,v);for(let t=0;t<M.length;t+=1)M[t].m(w,null);x(w,t[2]),l(e,k),A&&A.m(e,null),l(e,_),W(C,e,null),l(e,y),W(S,e,null),l(e,q),W(T,e,null),l(e,L),W(V,e,null),E=!0,j||(U=[m(r,"change",t[6]),m(r,"change",t[4]),m(w,"change",t[7]),m(w,"change",t[4])],j=!0)},p(t,n){if(8&n&&x(r,t[3]),2&n){let e;for(H=t[1],e=0;e<H.length;e+=1){const o=de(t,H,e);M[e]?M[e].p(o,n):(M[e]=pe(o),M[e].c(),M[e].m(w,null))}for(;e<M.length;e+=1)M[e].d(1);M.length=H.length}6&n&&x(w,t[2]),t[2]?A?A.p(t,n):(A=he(t),A.c(),A.m(e,_)):A&&(A.d(1),A=null)},i(t){E||(F(C.$$.fragment,t),F(S.$$.fragment,t),F(T.$$.fragment,t),F(V.$$.fragment,t),E=!0)},o(t){Q(C.$$.fragment,t),Q(S.$$.fragment,t),Q(T.$$.fragment,t),Q(V.$$.fragment,t),E=!1},d(t){t&&u(e),d(M,t),A&&A.d(),K(C),K(S),K(T),K(V),j=!1,s(U)}}}function pe(t){let e,n,o,s=t[17]+"";return{c(){e=f("option"),n=p(s),e.__value=o=t[17],e.value=e.__value},m(t,o){a(t,e,o),l(e,n)},p(t,r){2&r&&s!==(s=t[17]+"")&&w(n,s),2&r&&o!==(o=t[17])&&(e.__value=o,e.value=e.__value)},d(t){t&&u(e)}}}function he(e){let n,o,s;return{c(){n=f("button"),n.textContent="Show",b(n,"class","button")},m(t,r){a(t,n,r),o||(s=m(n,"click",e[8]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function ge(t){let e,n;return e=new Yt({props:{topic:t[14]}}),{c(){J(e.$$.fragment)},m(t,o){W(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[14]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function me(t){let e,n,o,s=t[1]&&fe(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=ge(ue(t,r,e));const c=t=>Q(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=h(),n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();b(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),a(t,e,r),a(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?(s.p(t,o),2&o&&F(s,1)):(s=fe(t),s.c(),F(s,1),s.m(e.parentNode,e)):s&&(D(),Q(s,1,1,(()=>{s=null})),z()),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=ue(t,r,e);i[e]?(i[e].p(s,o),F(i[e],1)):(i[e]=ge(s),i[e].c(),F(i[e],1),i[e].m(n,null))}for(D(),e=r.length;e<i.length;e+=1)c(e);z()}},i(t){if(!o){F(s);for(let t=0;t<r.length;t+=1)F(i[t]);o=!0}},o(t){Q(s),i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)Q(i[t]);o=!1},d(t){s&&s.d(t),t&&u(e),t&&u(n),d(i,t)}}}function $e(t,e,n){let o,s,r,{id:i}=e,c=[],l=[];T((()=>{Nt().then((t=>(t.sort(((t,e)=>+(t.title>e.title)||-(t.title<e.title))),t))).then((t=>{c=t,n(0,l=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(c))}))})),L((()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}}));return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[l,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,l=t)},i,function(){r=_(this),n(3,r)},function(){s=_(this),n(2,s),n(1,o)},()=>nt.setView("ViewTagInfo",{tag:s,topics:l}),()=>nt.setView("ViewTranslate"),()=>nt.setView("ViewHashes"),()=>nt.setView("ViewAdmin"),()=>nt.setView("ViewSearch")]}class be extends Z{constructor(t){super(),X(this,t,$e,me,i,{id:5})}}function we(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=f("div"),n=f("h5"),n.textContent="Details",o=h(),s=f("div"),r=f("p"),b(s,"class","card content is-info"),b(e,"class","block")},m(t,c){a(t,e,c),l(e,n),l(e,o),l(e,s),l(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&u(e)}}}function ve(t){let e,n,o,r,i,c,d,g,$,w,v,k,x,_,C,y,S,q,T,L,V,E,j,U,H,M;r=new Jt({props:{topic:t[0],status:t[1],size:t[3]}});let A=t[0].details&&we(t);return{c(){e=f("div"),n=f("div"),o=f("div"),J(r.$$.fragment),i=h(),c=f("div"),d=f("label"),d.textContent="Number of correct answers",g=h(),$=f("select"),w=f("option"),w.textContent="-- Select --",v=f("option"),v.textContent="Set 0",k=f("option"),k.textContent="Set 1",x=f("option"),x.textContent="Set 2",_=f("option"),_.textContent="Set 3",C=h(),A&&A.c(),y=h(),S=f("div"),q=f("button"),q.textContent="Back",T=h(),L=f("button"),L.textContent="Listing",V=h(),E=f("button"),j=p("Start"),b(o,"class","is-text-left"),b(d,"for","sf-set"),w.__value="",w.value=w.__value,v.__value="0",v.value=v.__value,k.__value="1",k.value=k.__value,x.__value="2",x.value=x.__value,_.__value="3",_.value=_.__value,b($,"id","sf-set"),b(c,"class","is-floating"),b(q,"class","button"),b(L,"class","button"),b(E,"class","button"),E.disabled=t[2],b(S,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,u){a(s,e,u),l(e,n),l(n,o),W(r,o,null),l(n,i),l(n,c),l(c,d),l(c,g),l(c,$),l($,w),l($,v),l($,k),l($,x),l($,_),l(n,C),A&&A.m(n,null),l(e,y),l(e,S),l(S,q),l(S,T),l(S,L),l(S,V),l(S,E),l(E,j),U=!0,H||(M=[m($,"change",t[8]),m(q,"click",t[5]),m(L,"click",t[6]),m(E,"click",t[7])],H=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?A?A.p(t,e):(A=we(t),A.c(),A.m(n,null)):A&&(A.d(1),A=null),(!U||4&e)&&(E.disabled=t[2])},i(t){U||(F(r.$$.fragment,t),U=!0)},o(t){Q(r.$$.fragment,t),U=!1},d(t){t&&u(e),K(r),A&&A.d(),H=!1,s(M)}}}function ke(t,e,n){let{topic:o}=e,{questions:s}=e;const r=new Lt;let i=0,c=!0,l=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return $t(n,t.length*e)})(t,3)),n(2,c=((t,e)=>{for(const n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,l=t.length)};T((async()=>{try{s||(await At(o.file),console.log("Loading questions for topics"),n(9,s=await Et(o)),a())}catch(t){ot.addError("ViewTopicInfo: "+vt(t))}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,l,r,()=>{nt.setView("ViewTopicList",{id:o.file})},()=>{nt.setView("ViewTopicQuests",{topic:o})},()=>{nt.setView("ViewQuestAnswer",{topics:[o],questions:s})},async t=>{if(!s)return;const e=t.target;await Ut(s,e.selectedIndex-1),e.selectedIndex=0,a()},s]}class xe extends Z{constructor(t){super(),X(this,t,ke,ve,i,{topic:0,questions:9})}}function _e(e){let n,o,s,r,i,c,d,g,m,$,v,k,x,_,C,y=e[0].progress+"",S=e[0].total+"",q=e[0].ratio+"";return{c(){n=f("div"),o=p("Progress: "),s=f("span"),r=p(y),i=p(" /\n  "),c=f("span"),c.textContent="3",d=h(),g=f("span"),m=p("Total: "),$=f("span"),v=p(S),k=p(" Wrong:\n    "),x=f("span"),_=p(q),C=p("%"),b(s,"class","is-text-success"),b(c,"class","is-text-success"),b($,"class","is-text-success"),b(x,"class","is-text-danger"),b(g,"class","hide-sm"),b(n,"class","h6")},m(t,e){a(t,n,e),l(n,o),l(n,s),l(s,r),l(n,i),l(n,c),l(n,d),l(n,g),l(g,m),l(g,$),l($,v),l(g,k),l(g,x),l(x,_),l(x,C)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&w(r,y),1&e&&S!==(S=t[0].total+"")&&w(v,S),1&e&&q!==(q=t[0].ratio+"")&&w(_,q)},i:t,o:t,d(t){t&&u(n)}}}function Ce(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class ye extends Z{constructor(t){super(),X(this,t,Ce,_e,i,{question:0})}}function Se(t,e,n){const o=t.slice();return o[9]=e[n],o}function qe(t){let e,n,o,s,r,i,c,d,g,m,$,v=t[9].id+"",k=t[9].file+"";return m=new ye({props:{question:t[9]}}),{c(){e=f("div"),n=f("div"),o=f("span"),s=p("Id: "),r=p(v),i=h(),c=f("span"),d=p(k),g=h(),J(m.$$.fragment),b(o,"class","h6"),b(c,"class","hide-sm"),b(e,"class","is-flex-spread grid-full")},m(t,u){a(t,e,u),l(e,n),l(n,o),l(o,s),l(o,r),l(n,i),l(n,c),l(c,d),l(e,g),W(m,e,null),$=!0},p(t,e){(!$||2&e)&&v!==(v=t[9].id+"")&&w(r,v),(!$||2&e)&&k!==(k=t[9].file+"")&&w(d,k);const n={};2&e&&(n.question=t[9]),m.$set(n)},i(t){$||(F(m.$$.fragment,t),$=!0)},o(t){Q(m.$$.fragment,t),$=!1},d(t){t&&u(e),K(m)}}}function Te(t){let e,n,o,s,r,i,c,d,p,g,m=t[3].toHtml(t[9].quest)+"",$=t[3].toHtml(t[9].answer)+"",w=t[0]&&qe(t);return{c(){w&&w.c(),e=h(),n=f("div"),o=f("div"),s=f("p"),r=h(),i=f("div"),c=f("div"),d=f("p"),p=h(),b(o,"class","content"),b(n,"class","card "+t[5]()),b(c,"class","content"),b(i,"class","card "+t[5]())},m(t,u){w&&w.m(t,u),a(t,e,u),a(t,n,u),l(n,o),l(o,s),s.innerHTML=m,a(t,r,u),a(t,i,u),l(i,c),l(c,d),d.innerHTML=$,l(i,p),g=!0},p(t,n){t[0]?w?(w.p(t,n),1&n&&F(w,1)):(w=qe(t),w.c(),F(w,1),w.m(e.parentNode,e)):w&&(D(),Q(w,1,1,(()=>{w=null})),z()),(!g||2&n)&&m!==(m=t[3].toHtml(t[9].quest)+"")&&(s.innerHTML=m),(!g||2&n)&&$!==($=t[3].toHtml(t[9].answer)+"")&&(d.innerHTML=$)},i(t){g||(F(w),g=!0)},o(t){Q(w),g=!1},d(t){w&&w.d(t),t&&u(e),t&&u(n),t&&u(r),t&&u(i)}}}function Le(t){let e,n,o,r,i,c,p,g,$,w,v,k,_,C,y,S,q=t[1],T=[];for(let e=0;e<q.length;e+=1)T[e]=Te(Se(t,q,e));const L=t=>Q(T[t],1,1,(()=>{T[t]=null}));return{c(){e=f("div"),n=f("label"),n.textContent="Details",o=h(),r=f("input"),i=h(),c=f("label"),c.textContent="Tag Filter",p=h(),g=f("select"),$=f("option"),$.textContent="-- Select --",w=f("option"),w.textContent="Total",v=f("option"),v.textContent="Ratio",k=h(),_=f("div");for(let t=0;t<T.length;t+=1)T[t].c();b(n,"for","details-checkbox"),b(r,"type","checkbox"),b(r,"id","details-checkbox"),b(c,"for","quest-sort"),$.__value="",$.value=$.__value,w.__value="total",w.value=w.__value,v.__value="ratio",v.value=v.__value,b(g,"id","quest-sort"),void 0===t[2]&&B((()=>t[8].call(g))),b(e,"class","is-floating"),b(_,"class","grid grid-2")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),r.checked=t[0],l(e,i),l(e,c),l(e,p),l(e,g),l(g,$),l(g,w),l(g,v),x(g,t[2]),a(s,k,u),a(s,_,u);for(let t=0;t<T.length;t+=1)T[t].m(_,null);C=!0,y||(S=[m(r,"change",t[7]),m(g,"change",t[8]),m(g,"change",t[4])],y=!0)},p(t,[e]){if(1&e&&(r.checked=t[0]),4&e&&x(g,t[2]),43&e){let n;for(q=t[1],n=0;n<q.length;n+=1){const o=Se(t,q,n);T[n]?(T[n].p(o,e),F(T[n],1)):(T[n]=Te(o),T[n].c(),F(T[n],1),T[n].m(_,null))}for(D(),n=q.length;n<T.length;n+=1)L(n);z()}},i(t){if(!C){for(let t=0;t<q.length;t+=1)F(T[t]);C=!0}},o(t){T=T.filter(Boolean);for(let t=0;t<T.length;t+=1)Q(T[t]);C=!1},d(t){t&&u(e),t&&u(k),t&&u(_),d(T,t),y=!1,s(S)}}}function Ve(t,e,n){let{questions:o}=e,s=!1,r=[],i="";const c=new Lt;L((()=>{console.log("afterUpdate questions:",o),n(1,r=o)}));const l=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(6,o=t.questions)},[s,r,i,c,()=>{if(!i)return void n(1,r=o);let t=[...o];"ratio"===i?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===i&&t.sort(((t,e)=>e.total-t.total)),n(1,r=t)},l,o,function(){s=this.checked,n(0,s)},function(){i=_(this),n(2,i)}]}class Ee extends Z{constructor(t){super(),X(this,t,Ve,Le,i,{questions:6})}}function je(t){let e,n;return e=new Ee({props:{questions:t[1]}}),{c(){J(e.$$.fragment)},m(t,o){W(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Ue(t){let e,n,o,s,r,i,c,d,g,$,v=t[0].title+"",k=0!==t[1].length&&je(t);return{c(){e=f("div"),n=f("h4"),o=p(v),s=h(),k&&k.c(),r=h(),i=f("div"),c=f("button"),c.textContent="Back",b(c,"class","button"),b(i,"class","is-floating"),b(e,"class","card card-shadow content")},m(u,f){a(u,e,f),l(e,n),l(n,o),l(e,s),k&&k.m(e,null),l(e,r),l(e,i),l(i,c),d=!0,g||($=m(c,"click",t[3]),g=!0)},p(t,[n]){(!d||1&n)&&v!==(v=t[0].title+"")&&w(o,v),0!==t[1].length?k?(k.p(t,n),2&n&&F(k,1)):(k=je(t),k.c(),F(k,1),k.m(e,r)):k&&(D(),Q(k,1,1,(()=>{k=null})),z())},i(t){d||(F(k),d=!0)},o(t){Q(k),d=!1},d(t){t&&u(e),k&&k.d(),g=!1,$()}}}function He(t,e,n){let{topic:o}=e,s=[];T((()=>{Et(o).then((t=>{n(1,s=t)}))}));const r=t=>{nt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class Me extends Z{constructor(t){super(),X(this,t,He,Ue,i,{topic:0})}}function Ae(t,e,n){const o=t.slice();return o[15]=e[n],o}function Be(t){let e,n,o=t[15].title+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[15].title+"")&&w(n,o)},d(t){t&&u(e)}}}function Pe(t){let e,n,o,r,i,c,d,p,g,$;return{c(){e=f("div"),n=f("label"),n.textContent="Number of correct answers",o=h(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Set 0",d=f("option"),d.textContent="Set 1",p=f("option"),p.textContent="Set 2",b(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,d.__value="1",d.value=d.__value,p.__value="2",p.value=p.__value,b(r,"id","sf-set"),void 0===t[5]&&B((()=>t[14].call(r))),b(e,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),l(r,d),l(r,p),x(r,t[5]),g||($=[m(r,"change",t[14]),m(r,"change",t[9])],g=!0)},p(t,e){32&e&&x(r,t[5])},d(t){t&&u(e),g=!1,s($)}}}function Ne(t){let e,n,o,r,i,c,d,p,g,$,w,v,k,_,C,y,S,q;return{c(){e=f("div"),n=f("label"),n.textContent="Load Questions",o=h(),r=f("select"),i=f("option"),i.textContent="30",c=f("option"),c.textContent="All",d=h(),p=f("div"),g=f("label"),g.textContent="Used fraction (sorted by ratio)",$=h(),w=f("select"),v=f("option"),v.textContent="40 %",k=f("option"),k.textContent="50 %",_=f("option"),_.textContent="60 %",C=f("option"),C.textContent="70 %",y=f("option"),y.textContent="80 %",b(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,b(r,"id","load-quests"),void 0===t[2]&&B((()=>t[12].call(r))),b(e,"class","is-floating"),b(g,"for","relevant"),v.__value="0.4",v.value=v.__value,k.__value="0.5",k.value=k.__value,_.__value="0.6",_.value=_.__value,C.__value="0.7",C.value=C.__value,y.__value="0.8",y.value=y.__value,b(w,"id","relevant"),void 0===t[3]&&B((()=>t[13].call(w))),b(p,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),x(r,t[2]),a(s,d,u),a(s,p,u),l(p,g),l(p,$),l(p,w),l(w,v),l(w,k),l(w,_),l(w,C),l(w,y),x(w,t[3]),S||(q=[m(r,"change",t[12]),m(w,"change",t[13])],S=!0)},p(t,e){4&e&&x(r,t[2]),8&e&&x(w,t[3])},d(t){t&&u(e),t&&u(d),t&&u(p),S=!1,s(q)}}}function Ie(e){let n,o,s;return{c(){n=f("button"),n.textContent="Load",b(n,"class","button")},m(t,r){a(t,n,r),o||(s=m(n,"click",e[10]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function Ge(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Listing",o=h(),r=f("button"),r.textContent="Start",b(n,"class","button"),b(r,"class","button")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),i||(c=[m(n,"click",e[6]),m(r,"click",e[8])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function Oe(e){let n,o,s,r,i,c,g,$,v,k,x,_,C,y,S,q,T,L=e[1],V=[];for(let t=0;t<L.length;t+=1)V[t]=Be(Ae(e,L,t));function E(t,e){return t[4]?Pe:Ne}let j=E(e),U=j(e);function H(t,e){return t[4]?Ge:Ie}let M=H(e),A=M(e);return{c(){n=f("div"),o=f("div"),s=f("div"),r=f("h4"),i=p("Tag: "),c=p(e[0]),g=h(),$=f("p"),$.textContent="Files incluging the tag:",v=h(),k=f("ul");for(let t=0;t<V.length;t+=1)V[t].c();x=h(),U.c(),_=h(),C=f("div"),y=f("button"),y.textContent="Back",S=h(),A.c(),b(s,"class","is-text-left"),b(y,"class","button"),b(C,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,u){a(t,n,u),l(n,o),l(o,s),l(s,r),l(r,i),l(r,c),l(s,g),l(s,$),l(s,v),l(s,k);for(let t=0;t<V.length;t+=1)V[t].m(k,null);l(n,x),U.m(n,null),l(n,_),l(n,C),l(C,y),l(C,S),A.m(C,null),q||(T=m(y,"click",e[7]),q=!0)},p(t,[e]){if(1&e&&w(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=Ae(t,L,n);V[n]?V[n].p(o,e):(V[n]=Be(o),V[n].c(),V[n].m(k,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=L.length}j===(j=E(t))&&U?U.p(t,e):(U.d(1),U=j(t),U&&(U.c(),U.m(n,_))),M===(M=H(t))&&A?A.p(t,e):(A.d(1),A=M(t),A&&(A.c(),A.m(C,null)))},i:t,o:t,d(t){t&&u(n),d(V,t),U.d(),A.d(),q=!1,T()}}}function Re(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i}=e,c="30",l="0.5",a=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(11,i=t.questions)},[s,r,c,l,a,o,()=>{nt.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{nt.setView("ViewTopicList")},()=>{nt.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;Ut(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(11,i=await(async(t,e,n)=>{const o=(await ut).transaction(["questions"],"readonly").objectStore("questions"),s=[];return t.forEach((t=>{s.push(jt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if(wt(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),wt(o)),o.splice(0,e)}))})(r,t,parseFloat(l))),n(4,a=!0)}catch(t){ot.addError("ViewTagInfo: "+vt(t))}},i,function(){c=_(this),n(2,c)},function(){l=_(this),n(3,l)},function(){o=_(this),n(5,o)}]}class De extends Z{constructor(t){super(),X(this,t,Re,Oe,i,{tag:0,topics:1,questions:11})}}function ze(t){let e,n,o,s,r,i,c,d,g,$,v,k;return i=new Ee({props:{questions:t[1]}}),{c(){e=f("div"),n=f("h4"),o=p("Tag: "),s=p(t[0]),r=h(),J(i.$$.fragment),c=h(),d=f("div"),g=f("button"),g.textContent="Back",b(g,"class","button"),b(d,"class","is-floating"),b(e,"class","card card-shadow content")},m(u,f){a(u,e,f),l(e,n),l(n,o),l(n,s),l(e,r),W(i,e,null),l(e,c),l(e,d),l(d,g),$=!0,v||(k=m(g,"click",t[4]),v=!0)},p(t,[e]){(!$||1&e)&&w(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){$||(F(i.$$.fragment,t),$=!0)},o(t){Q(i.$$.fragment,t),$=!1},d(t){t&&u(e),K(i),v=!1,k()}}}function Fe(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{nt.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class Qe extends Z{constructor(t){super(),X(this,t,Fe,ze,i,{tag:0,topics:3,questions:1})}}function Je(e){let n,o,s,r,i,c,d,g,m,$,v,k,x,_,C,y,S,q,T,L,V,E,j,U,H=e[0][0]+"",M=e[0][1]+"",A=e[0][2]+"",B=e[0][3]+"";return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="No correct Answers",r=h(),i=f("td"),c=p(H),d=h(),g=f("tr"),m=f("td"),m.textContent="One correct Answer",$=h(),v=f("td"),k=p(M),x=h(),_=f("tr"),C=f("td"),C.textContent="Two correct Answers",y=h(),S=f("td"),q=p(A),T=h(),L=f("tr"),V=f("td"),V.textContent="Learned",E=h(),j=f("td"),U=p(B),b(n,"class","table hide-md")},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,d),l(n,g),l(g,m),l(g,$),l(g,v),l(v,k),l(n,x),l(n,_),l(_,C),l(_,y),l(_,S),l(S,q),l(n,T),l(n,L),l(L,V),l(L,E),l(L,j),l(j,U)},p(t,[e]){1&e&&H!==(H=t[0][0]+"")&&w(c,H),1&e&&M!==(M=t[0][1]+"")&&w(k,M),1&e&&A!==(A=t[0][2]+"")&&w(q,A),1&e&&B!==(B=t[0][3]+"")&&w(U,B)},i:t,o:t,d(t){t&&u(n)}}}function We(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Ke extends Z{constructor(t){super(),X(this,t,We,Je,i,{statistic:0})}}function Ye(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=f("p")},m(t,o){a(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&u(e)}}}function Xe(t){let e,n,o,s,r,i,c,d,g,m,$,v,k,x,_,C,y,S,q,T=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",V=t[3].toHtml(t[0].answer)+"";d=new ye({props:{question:t[0]}});let E=t[1].details&&Ye(t);return{c(){e=f("div"),n=f("div"),o=f("div"),s=f("div"),r=p("Question: "),i=p(T),c=h(),J(d.$$.fragment),g=h(),m=f("div"),$=f("p"),v=h(),k=f("div"),x=f("h5"),x.textContent="Answer",_=h(),C=f("div"),y=f("p"),S=h(),E&&E.c(),b(s,"class","h5"),b(o,"class","is-flex-spread block"),b(m,"class","card content is-primary"),b(C,"class","card content is-info"),k.hidden=t[2],b(e,"class","grid grid-2")},m(t,u){a(t,e,u),l(e,n),l(n,o),l(o,s),l(s,r),l(s,i),l(o,c),W(d,o,null),l(n,g),l(n,m),l(m,$),$.innerHTML=L,l(e,v),l(e,k),l(k,x),l(k,_),l(k,C),l(C,y),y.innerHTML=V,l(C,S),E&&E.m(C,null),q=!0},p(t,[e]){(!q||1&e)&&T!==(T=t[0].id+"")&&w(i,T);const n={};1&e&&(n.question=t[0]),d.$set(n),(!q||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&($.innerHTML=L),(!q||1&e)&&V!==(V=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=V),t[1].details?E?E.p(t,e):(E=Ye(t),E.c(),E.m(C,null)):E&&(E.d(1),E=null),(!q||4&e)&&(k.hidden=t[2])},i(t){q||(F(d.$$.fragment,t),q=!0)},o(t){Q(d.$$.fragment,t),q=!1},d(t){t&&u(e),K(d),E&&E.d()}}}function Ze(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Lt;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class tn extends Z{constructor(t){super(),X(this,t,Ze,Xe,i,{question:0,topic:1,hideAnswer:2})}}function en(t){let e,n,o,r,i,c,d,g,$,w,v,k,x,_,C,y,S,q,T,L,V,E,j,U;function H(t,e){return t[0]?on:nn}let M=H(t),A=M(t);return o=new Ke({props:{statistic:t[3]}}),i=new tn({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=f("div"),A.c(),n=h(),J(o.$$.fragment),r=h(),J(i.$$.fragment),c=h(),d=f("div"),g=f("button"),$=p("Show"),v=h(),k=f("button"),x=p("Correct"),_=h(),C=f("button"),y=p("Wrong"),S=h(),q=f("button"),T=p("Skip"),L=h(),V=f("button"),V.textContent="Stop",b(g,"class","button"),g.hidden=w=!t[4],b(k,"class","button is-success"),k.hidden=t[4],b(C,"class","button is-danger"),C.hidden=t[4],b(q,"class","button is-warning"),q.hidden=t[4],b(V,"class","button"),b(d,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,u){a(s,e,u),A.m(e,null),l(e,n),W(o,e,null),l(e,r),W(i,e,null),l(e,c),l(e,d),l(d,g),l(g,$),l(d,v),l(d,k),l(k,x),l(d,_),l(d,C),l(C,y),l(d,S),l(d,q),l(q,T),l(d,L),l(d,V),E=!0,j||(U=[m(g,"click",t[9]),m(k,"click",t[10]),m(C,"click",t[11]),m(q,"click",t[12]),m(V,"click",t[6])],j=!0)},p(t,s){M===(M=H(t))&&A?A.p(t,s):(A.d(1),A=M(t),A&&(A.c(),A.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!E||16&s&&w!==(w=!t[4]))&&(g.hidden=w),(!E||16&s)&&(k.hidden=t[4]),(!E||16&s)&&(C.hidden=t[4]),(!E||16&s)&&(q.hidden=t[4])},i(t){E||(F(o.$$.fragment,t),F(i.$$.fragment,t),E=!0)},o(t){Q(o.$$.fragment,t),Q(i.$$.fragment,t),E=!1},d(t){t&&u(e),A.d(),K(o),K(i),j=!1,s(U)}}}function nn(t){let e,n,o=t[1].title+"";return{c(){e=f("h4"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&w(n,o)},d(t){t&&u(e)}}}function on(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=f("h4"),n=p("Tag: "),o=p(t[0]),s=h(),r=f("h6"),i=p(c)},m(t,c){a(t,e,c),l(e,n),l(e,o),a(t,s,c),a(t,r,c),l(r,i)},p(t,e){1&e&&w(o,t[0]),2&e&&c!==(c=t[1].title+"")&&w(i,c)},d(t){t&&u(e),t&&u(s),t&&u(r)}}}function sn(t){let e,n,o=t[2]&&en(t);return{c(){o&&o.c(),e=g()},m(t,s){o&&o.m(t,s),a(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&F(o,1)):(o=en(t),o.c(),F(o,1),o.m(e.parentNode,e)):o&&(D(),Q(o,1,1,(()=>{o=null})),z())},i(t){n||(F(o),n=!0)},o(t){Q(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function rn(t,e,n){let o,s,r,i,{tag:c}=e,{topics:l}=e,{questions:a}=e,u=!0;const d=t=>{if(void 0===t)return i.push(s),void f();var e;((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=$t(t.failed,t.total)})(s,t),(e=s,new Promise((t=>{ut.then((n=>{const o=n.transaction(["questions"],"readwrite").objectStore("questions");o.put(e).onsuccess=()=>{console.log("Store:",o.name," update:",e),t()}}))}))).then((()=>{s.progress<3&&i.push(s),0===i.length&&p(),f()}))},f=()=>{const t=i.shift();if(!t)return;n(2,s=t);const e=l.find((t=>t.file===s.file));e&&(n(1,o=e),n(3,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(a)),n(4,u=!0),console.log("next",s))};T((()=>{i=a.filter((t=>t.progress<3)),wt(i),f()}));const p=async()=>{c?nt.setView("ViewTopicList"):(n(1,o.lastLearned=new Date,o),await(async t=>{const e=(await ut).transaction(["topics"],"readwrite").objectStore("topics");ft(e,t)})(o),nt.setView("ViewTopicList",{id:o.file}))};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(7,l=t.topics),"questions"in t&&n(8,a=t.questions)},[c,o,s,r,u,d,p,l,a,()=>n(4,u=!1),()=>d(!0),()=>d(!1),()=>d()]}class cn extends Z{constructor(t){super(),X(this,t,rn,sn,i,{tag:0,topics:7,questions:8})}}function ln(e){let n,o,r,i,c,d,g,$,k,x,_,C,y,S,q,T,L,V,E,j,U,H,M,A,B;return{c(){n=f("h4"),n.textContent="Translate",o=h(),r=f("div"),i=f("label"),c=p(e[0]),d=h(),g=f("textarea"),$=h(),k=f("label"),x=p(e[1]),_=h(),C=f("textarea"),y=h(),S=f("div"),q=f("button"),q.textContent="Back",T=h(),L=f("button"),L.textContent="Translate",V=h(),E=f("button"),E.textContent="Reset",j=h(),U=f("button"),U.textContent="Switch",H=h(),M=f("p"),M.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',b(i,"for","src"),b(g,"id","src"),b(g,"class","input"),b(k,"for","dst"),b(C,"id","dst"),C.readOnly=!0,C.value=e[3],b(C,"class","input"),b(r,"class","block"),b(q,"class","button"),b(L,"class","button"),b(E,"class","button"),b(U,"class","button"),b(S,"class","is-floating")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),l(r,i),l(i,c),l(r,d),l(r,g),v(g,e[2]),l(r,$),l(r,k),l(k,x),l(r,_),l(r,C),a(t,y,s),a(t,S,s),l(S,q),l(S,T),l(S,L),l(S,V),l(S,E),l(S,j),l(S,U),a(t,H,s),a(t,M,s),A||(B=[m(g,"input",e[8]),m(q,"click",e[9]),m(L,"click",e[10]),m(E,"click",e[11]),m(U,"click",e[12])],A=!0)},p(t,[e]){1&e&&w(c,t[0]),4&e&&v(g,t[2]),2&e&&w(x,t[1]),8&e&&(C.value=t[3])},i:t,o:t,d(t){t&&u(n),t&&u(o),t&&u(r),t&&u(y),t&&u(S),t&&u(H),t&&u(M),A=!1,s(B)}}}function an(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",l="";const a=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||ot.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,l=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=l),a()},d=()=>{n(2,c=""),n(3,l="")},f=()=>{nt.setView("ViewTopicList")};return[o,s,c,l,a,u,d,f,function(){c=this.value,n(2,c)},()=>f(),()=>a(),()=>d(),()=>u()]}class un extends Z{constructor(t){super(),X(this,t,an,ln,i,{})}}function dn(t,e,n){const o=t.slice();return o[10]=e[n],o}function fn(t){let e,n,o,s,r,i,c,d,g,$,v,k,x,_,C,y=t[10].file+"",S=t[10].value+"",q=gt(t[10].lastLoaded)+"";function T(){return t[7](t[10])}return{c(){e=f("tr"),n=f("td"),o=p(y),s=h(),r=f("td"),i=p(S),c=h(),d=f("td"),g=p(q),$=h(),v=f("td"),k=f("button"),k.textContent="Delete",x=h(),b(k,"class","button")},m(t,u){a(t,e,u),l(e,n),l(n,o),l(e,s),l(e,r),l(r,i),l(e,c),l(e,d),l(d,g),l(e,$),l(e,v),l(v,k),l(e,x),_||(C=m(k,"click",T),_=!0)},p(e,n){t=e,1&n&&y!==(y=t[10].file+"")&&w(o,y),1&n&&S!==(S=t[10].value+"")&&w(i,S),1&n&&q!==(q=gt(t[10].lastLoaded)+"")&&w(g,q)},d(t){t&&u(e),_=!1,C()}}}function pn(e){let n,o,r,i,c,p,g,$,w,v,k,_,C,y,S,q,T,L=e[0],V=[];for(let t=0;t<L.length;t+=1)V[t]=fn(dn(e,L,t));return{c(){n=f("div"),o=f("label"),o.textContent="Tag Filter",r=h(),i=f("select"),c=f("option"),c.textContent="By Name",p=f("option"),p.textContent="By Date",g=h(),$=f("button"),$.textContent="Load All",w=h(),v=f("table"),k=f("tr"),k.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",_=h();for(let t=0;t<V.length;t+=1)V[t].c();C=h(),y=f("div"),S=f("button"),S.textContent="Back",b(o,"for","sort-select"),c.__value="file",c.value=c.__value,p.__value="lastLoaded",p.value=p.__value,b(i,"id","sort-select"),void 0===e[1]&&B((()=>e[6].call(i))),b($,"class","button"),b(n,"class","is-floating"),b(S,"class","button"),b(y,"class","is-floating")},m(t,s){a(t,n,s),l(n,o),l(n,r),l(n,i),l(i,c),l(i,p),x(i,e[1]),l(n,g),l(n,$),a(t,w,s),a(t,v,s),l(v,k),l(v,_);for(let t=0;t<V.length;t+=1)V[t].m(v,null);a(t,C,s),a(t,y,s),l(y,S),q||(T=[m(i,"change",e[6]),m(i,"change",e[2]),m($,"click",e[5]),m(S,"click",e[8])],q=!0)},p(t,[e]){if(2&e&&x(i,t[1]),9&e){let n;for(L=t[0],n=0;n<L.length;n+=1){const o=dn(t,L,n);V[n]?V[n].p(o,e):(V[n]=fn(o),V[n].c(),V[n].m(v,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=L.length}},i:t,o:t,d(t){t&&u(n),t&&u(w),t&&u(v),d(V,t),t&&u(C),t&&u(y),q=!1,s(T)}}}function hn(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),"file"===s?o.sort(((t,e)=>+(e.file>t.file)||-(e.file<t.file))):o.sort(((t,e)=>+(e.lastLoaded>t.lastLoaded)||-(e.lastLoaded<t.lastLoaded))),n(0,o)},i=async()=>{n(0,o=await new Promise(((t,e)=>{ut.then((n=>{const o=n.transaction(["hash"],"readonly").objectStore("hash"),s=o.getAll();s.onsuccess=()=>{const e=s.result;console.log("Store:",o.name,"get all:",e.length),t(e)},s.onerror=t=>{console.log("Store:",o.name,"get all error:",t),e()}}))}))),r()},c=async t=>{await(async t=>{const e=(await ut).transaction(["hash"],"readwrite").objectStore("hash");return dt(e,t)})(t),i()},l=()=>{nt.setView("ViewTopicList")};T((()=>{i()}));return[o,s,r,c,l,async()=>{const t=(await Nt()).map((t=>t.file));await(async t=>{const e=[];return t.forEach((t=>{e.push(At(t))})),Promise.all(e)})(t),i()},function(){s=_(this),n(1,s)},t=>c(t.file),()=>l()]}class gn extends Z{constructor(t){super(),X(this,t,hn,pn,i,{})}}function mn(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=p("..."),n=p(o)},m(t,o){a(t,e,o),a(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&w(n,o)},d(t){t&&u(e),t&&u(n)}}}function $n(e){let n,o,s,r,i,c,d,g,m,$,b,v,k,x,_,C,y,S,q,T,L,V,E,j=e[0].langUrl+"",U=(e[0].backupUrl?e[0].backupUrl:"")+"",H=(e[0].file?e[0].file:"")+"",M=e[0].token&&mn(e);return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="Github URL Language",r=h(),i=f("td"),c=p(j),d=h(),g=f("tr"),m=f("td"),m.textContent="Github URL Backup",$=h(),b=f("td"),v=p(U),k=h(),x=f("tr"),_=f("td"),_.textContent="Github File",C=h(),y=f("td"),S=p(H),q=h(),T=f("tr"),L=f("td"),L.textContent="Token",V=h(),E=f("td"),M&&M.c()},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,d),l(n,g),l(g,m),l(g,$),l(g,b),l(b,v),l(n,k),l(n,x),l(x,_),l(x,C),l(x,y),l(y,S),l(n,q),l(n,T),l(T,L),l(T,V),l(T,E),M&&M.m(E,null)},p(t,[e]){1&e&&j!==(j=t[0].langUrl+"")&&w(c,j),1&e&&U!==(U=(t[0].backupUrl?t[0].backupUrl:"")+"")&&w(v,U),1&e&&H!==(H=(t[0].file?t[0].file:"")+"")&&w(S,H),t[0].token?M?M.p(t,e):(M=mn(t),M.c(),M.m(E,null)):M&&(M.d(1),M=null)},i:t,o:t,d(t){t&&u(n),M&&M.d()}}}function bn(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class wn extends Z{constructor(t){super(),X(this,t,bn,$n,i,{admin:0})}}function vn(e){let n,o,r,i,c,d,g,$,v,x,_,C,y,S;return{c(){n=f("div"),o=f("div"),r=f("h5"),i=p(e[0]),c=h(),d=f("p"),g=p(e[1]),$=h(),v=f("div"),x=f("button"),x.textContent="OK",_=h(),C=f("button"),C.textContent="Cancel",b(x,"class","button"),b(C,"class","button"),b(v,"class","is-floating"),b(o,"class","popup-content"),b(n,"class","popup"),k(n,"display",e[2]?"block":"none")},m(t,s){a(t,n,s),l(n,o),l(o,r),l(r,i),l(o,c),l(o,d),l(d,g),l(o,$),l(o,v),l(v,x),l(v,_),l(v,C),y||(S=[m(x,"click",e[4]),m(C,"click",e[5])],y=!0)},p(t,[e]){1&e&&w(i,t[0]),2&e&&w(g,t[1]),4&e&&k(n,"display",t[2]?"block":"none")},i:t,o:t,d(t){t&&u(n),y=!1,s(S)}}}function kn(t,e,n){let{title:o=""}=e,{msg:s=""}=e,{doShow:r=!1}=e;const i=V();return t.$$set=t=>{"title"in t&&n(0,o=t.title),"msg"in t&&n(1,s=t.msg),"doShow"in t&&n(2,r=t.doShow)},[o,s,r,i,()=>i("popup","ok"),()=>i("popup","cancel")]}class xn extends Z{constructor(t){super(),X(this,t,kn,vn,i,{title:0,msg:1,doShow:2})}}function _n(t){let e,n;return{c(){e=f("div"),n=p(t[2]),b(e,"class","block is-text-success")},m(t,o){a(t,e,o),l(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&u(e)}}}function Cn(t){let e,n,o,s;const r=[Sn,yn],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=g()},m(t,n){i[e].m(t,n),a(t,o,n),s=!0},p(t,s){let l=e;e=c(t),e===l?i[e].p(t,s):(D(),Q(i[l],1,1,(()=>{i[l]=null})),z(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),F(n,1),n.m(o.parentNode,o))},i(t){s||(F(n),s=!0)},o(t){Q(n),s=!1},d(t){i[e].d(t),t&&u(o)}}}function yn(t){let e,n,o,r,i,c,d,p,g,$,w;n=new wn({props:{admin:t[0]}});let v=t[0].file&&t[0].backupUrl&&t[0].token&&qn(t);return{c(){e=f("div"),J(n.$$.fragment),o=h(),r=f("div"),i=f("button"),i.textContent="Back",c=h(),d=f("button"),d.textContent="Update",p=h(),v&&v.c(),b(i,"class","button"),b(d,"class","button"),b(r,"class","is-floating"),b(e,"class","block")},m(s,u){a(s,e,u),W(n,e,null),l(e,o),l(e,r),l(r,i),l(r,c),l(r,d),l(r,p),v&&v.m(r,null),g=!0,$||(w=[m(i,"click",t[8]),m(d,"click",t[16])],$=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?v?v.p(t,e):(v=qn(t),v.c(),v.m(r,null)):v&&(v.d(1),v=null)},i(t){g||(F(n.$$.fragment,t),g=!0)},o(t){Q(n.$$.fragment,t),g=!1},d(t){t&&u(e),K(n),v&&v.d(),$=!1,s(w)}}}function Sn(e){let n,o,r,i,c,d,p,g,w,k,x,_,C,y,S,q,T,L,V,E,j,U,H,M,A,B;return{c(){n=f("form"),o=f("div"),r=f("label"),r.textContent="Github URL Language",i=h(),c=f("input"),d=h(),p=f("label"),p.textContent="Github URL Backup",g=h(),w=f("input"),k=h(),x=f("label"),x.textContent="Github File",_=h(),C=f("input"),y=h(),S=f("label"),S.textContent="Token",q=h(),T=f("input"),L=h(),V=f("div"),E=f("button"),E.textContent="Save",j=h(),U=f("button"),U.textContent="Cancel",H=h(),M=f("button"),M.textContent="Back",b(r,"for","langUrl"),b(c,"id","langUrl"),b(c,"type","url"),b(c,"class","input"),b(p,"for","backupUrl"),b(w,"id","backupUrl"),b(w,"type","url"),b(w,"class","input"),b(x,"for","file"),b(C,"id","file"),b(C,"type","text"),b(C,"class","input"),b(S,"for","token"),b(T,"id","token"),b(T,"type","password"),b(T,"class","input"),b(o,"class","block"),b(E,"class","button"),b(U,"class","button"),b(M,"class","button"),b(V,"class","is-floating")},m(t,s){a(t,n,s),l(n,o),l(o,r),l(o,i),l(o,c),v(c,e[0].langUrl),l(o,d),l(o,p),l(o,g),l(o,w),v(w,e[0].backupUrl),l(o,k),l(o,x),l(o,_),l(o,C),v(C,e[0].file),l(o,y),l(o,S),l(o,q),l(o,T),v(T,e[0].token),l(n,L),l(n,V),l(V,E),l(V,j),l(V,U),l(V,H),l(V,M),A||(B=[m(c,"input",e[11]),m(w,"input",e[12]),m(C,"input",e[13]),m(T,"input",e[14]),m(U,"click",e[15]),m(M,"click",e[8]),m(n,"submit",$(e[7]))],A=!0)},p(t,e){1&e&&v(c,t[0].langUrl),1&e&&v(w,t[0].backupUrl),1&e&&C.value!==t[0].file&&v(C,t[0].file),1&e&&T.value!==t[0].token&&v(T,t[0].token)},i:t,o:t,d(t){t&&u(n),A=!1,s(B)}}}function qn(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Backup",o=h(),r=f("button"),r.textContent="Restore",b(n,"class","button"),b(r,"class","button")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),i||(c=[m(n,"click",e[17]),m(r,"click",e[18])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function Tn(t){let e,n,o,s,r,i,c=t[2]&&_n(t),l=t[0]&&Cn(t);return r=new xn({props:{title:t[4],msg:t[5],doShow:t[6]}}),r.$on("popup",t[10]),{c(){e=f("h4"),e.textContent="Configuration",n=h(),c&&c.c(),o=h(),l&&l.c(),s=h(),J(r.$$.fragment)},m(t,u){a(t,e,u),a(t,n,u),c&&c.m(t,u),a(t,o,u),l&&l.m(t,u),a(t,s,u),W(r,t,u),i=!0},p(t,[e]){t[2]?c?c.p(t,e):(c=_n(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[0]?l?(l.p(t,e),1&e&&F(l,1)):(l=Cn(t),l.c(),F(l,1),l.m(s.parentNode,s)):l&&(D(),Q(l,1,1,(()=>{l=null})),z());const n={};16&e&&(n.title=t[4]),32&e&&(n.msg=t[5]),64&e&&(n.doShow=t[6]),r.$set(n)},i(t){i||(F(l),F(r.$$.fragment,t),i=!0)},o(t){Q(l),Q(r.$$.fragment,t),i=!1},d(t){t&&u(e),t&&u(n),c&&c.d(t),t&&u(o),l&&l.d(t),t&&u(s),K(r,t)}}}function Ln(t,e,n){let o,s=!1,r="";T((async()=>{n(0,o=await kt())}));const i=async()=>{(async t=>{const{backupUrl:e,headers:n}=await Ct(),o=await yt(e,n);console.log("sha",o);const s={method:"PUT",headers:n,body:JSON.stringify({sha:o,content:(r=JSON.stringify(t),window.btoa(unescape(encodeURIComponent(r)))),message:"backup"})};var r;const i=await fetch(e,s).catch((t=>{ot.addError(`githubBackup - url: ${e} error: ${t}`)}));i&&(i.ok||ot.addError(`githubBackup - url: ${e} error: ${i.statusText}`))})(await new Promise(((t,e)=>{const n=[];ut.then((o=>{const s=o.transaction(["questions"],"readonly").objectStore("questions"),r=s.openCursor();r.onsuccess=()=>{const e=r.result;if(e){const t=e.value;n.push([t.id,t.failed,t.total]),e.continue()}else console.log("Store:",s.name,"questGetBackup finished:",n.length),t(n)},r.onerror=t=>{console.log("Store:",s.name,"questGetBackup:",t),e()}}))}))),n(2,r="Backup done!")},c=async()=>{const t=await(async()=>{const{backupUrl:t,headers:e}=await Ct(),n=await St(t,e);if(n)return xt(n.content)})();t&&(Mt(t),n(2,r="Restore done!"))};var l;let a,u;!function(t){t[t.Backup=0]="Backup",t[t.Restore=1]="Restore"}(l||(l={}));let d,f=!1;const p=t=>{switch(t){case l.Backup:n(4,a="Information"),n(5,u="Do you realy want to create a backup?"),d=i;break;case l.Restore:n(4,a="Warning"),n(5,u="Do you realy want to restore the backup?"),d=c;break;default:console.log("Unkown type",t)}n(6,f=!0)};return[o,s,r,l,a,u,f,()=>{o.langUrl&&(async t=>{const e=(await ut).transaction(["admin"],"readwrite").objectStore("admin");ft(e,t)})(o),n(1,s=!1)},()=>{nt.setView("ViewTopicList")},p,t=>{n(6,f=!1),"ok"===t.detail&&d()},function(){o.langUrl=this.value,n(0,o)},function(){o.backupUrl=this.value,n(0,o)},function(){o.file=this.value,n(0,o)},function(){o.token=this.value,n(0,o)},()=>n(1,s=!1),()=>n(1,s=!0),()=>p(l.Backup),()=>p(l.Restore)]}class Vn extends Z{constructor(t){super(),X(this,t,Ln,Tn,i,{})}}function En(t){let e,n;return{c(){e=f("div"),n=p(t[2]),b(e,"class","is-text-danger")},m(t,o){a(t,e,o),l(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&u(e)}}}function jn(t){let e,n,o,s,r,i,c,d;return c=new Ee({props:{questions:t[1]}}),{c(){e=f("div"),n=p("Total: "),o=p(t[3]),s=p(" found: "),r=p(t[4]),i=h(),J(c.$$.fragment)},m(t,u){a(t,e,u),l(e,n),l(e,o),l(e,s),l(e,r),a(t,i,u),W(c,t,u),d=!0},p(t,e){(!d||8&e)&&w(o,t[3]),(!d||16&e)&&w(r,t[4]);const n={};2&e&&(n.questions=t[1]),c.$set(n)},i(t){d||(F(c.$$.fragment,t),d=!0)},o(t){Q(c.$$.fragment,t),d=!1},d(t){t&&u(e),t&&u(i),K(c,t)}}}function Un(t){let e,n,o,r,i,c,d,p,g,w,k,x,_,C,y,S,q,T;w=new te({props:{onClick:t[5]}});let L=t[2]&&En(t),V=0!==t[1].length&&jn(t);return{c(){e=f("h4"),e.textContent="Search",n=h(),o=f("form"),r=f("div"),i=f("label"),i.textContent="Search String",c=h(),d=f("div"),p=f("input"),g=h(),J(w.$$.fragment),k=h(),L&&L.c(),x=h(),V&&V.c(),_=h(),C=f("div"),y=f("button"),y.textContent="Back",b(i,"for","searchStr"),b(p,"id","searchStr"),b(p,"class","input"),b(d,"class","is-floating"),b(r,"class",""),b(y,"class","button"),b(C,"class","is-floating")},m(s,u){a(s,e,u),a(s,n,u),a(s,o,u),l(o,r),l(r,i),l(r,c),l(r,d),l(d,p),v(p,t[0]),l(d,g),W(w,d,null),l(r,k),L&&L.m(r,null),a(s,x,u),V&&V.m(s,u),a(s,_,u),a(s,C,u),l(C,y),S=!0,q||(T=[m(p,"input",t[7]),m(o,"submit",$(t[5])),m(y,"click",t[6])],q=!0)},p(t,[e]){1&e&&p.value!==t[0]&&v(p,t[0]),t[2]?L?L.p(t,e):(L=En(t),L.c(),L.m(r,null)):L&&(L.d(1),L=null),0!==t[1].length?V?(V.p(t,e),2&e&&F(V,1)):(V=jn(t),V.c(),F(V,1),V.m(_.parentNode,_)):V&&(D(),Q(V,1,1,(()=>{V=null})),z())},i(t){S||(F(w.$$.fragment,t),F(V),S=!0)},o(t){Q(w.$$.fragment,t),Q(V),S=!1},d(t){t&&u(e),t&&u(n),t&&u(o),K(w),L&&L.d(),t&&u(x),V&&V.d(t),t&&u(_),t&&u(C),q=!1,s(T)}}}function Hn(t,e,n){let o="",s=[],r="",i=0,c=0;return[o,s,r,i,c,async()=>{console.log("Searching:",o);const t=o.trim();!t||t.length<3?n(2,r="Please enter search string with at least 3 chars!"):(r&&n(2,r=""),n(1,s=[]),n(1,[s,i,c]=await((t,e)=>{const n=t.toLowerCase();return new Promise(((t,o)=>{const s=[];let r=0,i=0;ut.then((c=>{const l=c.transaction(["questions"],"readonly").objectStore("questions"),a=l.openCursor();a.onsuccess=()=>{const o=a.result;if(o){const t=o.value;(Pt(t.quest,n)||Pt(t.answer,n))&&(s.length<e&&s.push(t),i++),r++,o.continue()}else console.log("Store:",l.name,"questSearch finished:",s.length),t([s,r,i])},a.onerror=t=>{console.log("Store:",l.name,"questSearch:",t),o()}}))}))})(t,30),s,n(3,i),n(4,c)),0===s.length?n(2,r="Nothing found!"):s.length<c&&n(2,r="More than: 30 questions found"))},()=>{nt.setView("ViewTopicList",{id:""})},function(){o=this.value,n(0,o)}]}class Mn extends Z{constructor(t){super(),X(this,t,Hn,Un,i,{})}}function An(t){let e,n;return e=new lt({}),{c(){J(e.$$.fragment)},m(t,o){W(e,t,o),n=!0},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Bn(t){let n,o,s,r,i,c,d,p,g,m=0!==t[0].length&&An();const $=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<$.length;t+=1)n=e(n,$[t]);return{props:n}}return w&&(c=C(w,v())),{c(){n=f("div"),o=f("h2"),o.textContent="Cards",s=h(),m&&m.c(),r=h(),i=f("div"),c&&J(c.$$.fragment),d=h(),p=f("div"),p.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',b(i,"id","main"),b(i,"class","block"),b(p,"class","block"),b(n,"class","container")},m(t,e){a(t,n,e),l(n,o),l(n,s),m&&m.m(n,null),l(n,r),l(n,i),c&&W(c,i,null),l(n,d),l(n,p),g=!0},p(t,[e]){0!==t[0].length?m?1&e&&F(m,1):(m=An(),m.c(),F(m,1),m.m(n,r)):m&&(D(),Q(m,1,1,(()=>{m=null})),z());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}($,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(w!==(w=t[1].component)){if(c){D();const t=c;Q(t.$$.fragment,1,0,(()=>{K(t,1)})),z()}w?(c=C(w,v()),J(c.$$.fragment),F(c.$$.fragment,1),W(c,i,null)):c=null}else w&&c.$set(o)},i(t){g||(F(m),c&&F(c.$$.fragment,t),g=!0)},o(t){Q(m),c&&Q(c.$$.fragment,t),g=!1},d(t){t&&u(n),m&&m.d(),c&&K(c)}}}function Pn(t,e,n){let o,s;return c(t,ot,(t=>n(0,o=t))),c(t,nt,(t=>n(1,s=t))),T((()=>{nt.views={ViewTopicList:{component:be},ViewTopicInfo:{component:xe},ViewTopicQuests:{component:Me},ViewTagInfo:{component:De},ViewTagQuests:{component:Qe},ViewQuestAnswer:{component:cn},ViewTranslate:{component:un},ViewHashes:{component:gn},ViewAdmin:{component:Vn},ViewSearch:{component:Mn}},nt.setView("ViewTopicList")})),[o,s]}return new class extends Z{constructor(t){super(),X(this,t,Pn,Bn,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

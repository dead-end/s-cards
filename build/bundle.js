var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function a(t,e,n){t.$$.on_destroy.push(c(e,n))}function l(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function g(){return h(" ")}function m(){return h("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function w(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function x(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function C(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function y(t){const e=t.querySelector(":checked")||function(t){for(const e of t.options)if(!e.disabled)return e}(t);return e&&e.__value}function _(t,e){return new t(e)}let E;function S(t){E=t}function q(){if(!E)throw new Error("Function called outside component initialization");return E}function L(t){q().$$.on_mount.push(t)}function T(t){q().$$.after_update.push(t)}function V(){const t=q();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,o,e),s}(e,n,{cancelable:o});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const U=[],M=[];let j=[];const O=[],R=Promise.resolve();let B=!1;function A(t){j.push(t)}const N=new Set;let H=0;function F(){if(0!==H)return;const t=E;do{try{for(;H<U.length;){const t=U[H];H++,S(t),G(t.$$)}}catch(t){throw U.length=0,H=0,t}for(S(null),U.length=0,H=0;M.length;)M.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];N.has(e)||(N.add(e),e())}j.length=0}while(U.length);for(;O.length;)O.pop()();B=!1,N.clear(),S(t)}function G(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const P=new Set;let I;function D(){I={r:0,c:[],p:I}}function z(){I.r||s(I.c),I=I.p}function J(t,e){t&&t.i&&(P.delete(t),t.i(e))}function W(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),I.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function Q(t){t&&t.c()}function K(t,e,o,i){const{fragment:c,after_update:a}=t.$$;c&&c.m(e,o),i||A((()=>{const e=t.$$.on_mount.map(n).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...e):s(e),t.$$.on_mount=[]})),a.forEach(A)}function Y(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];j.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),j=e}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function X(t,e){-1===t.$$.dirty[0]&&(U.push(t),B||(B=!0,R.then(F)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(e,n,r,i,c,a,l,u=[-1]){const p=E;S(e);const f=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(p?p.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||p.$$.root};l&&l(f.root);let h=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&c(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),h&&X(e,t)),n})):[],f.update(),h=!0,s(f.before_update),f.fragment=!!i&&i(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(d)}else f.fragment&&f.fragment.c();n.intro&&J(e.$$.fragment),K(e,n.target,n.anchor,n.customElement),F()}S(p)}class tt{$destroy(){Y(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!et.length;for(const t of s)t[1](),et.push(t,e);if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const a=[i,c];return s.add(a),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(a),0===s.size&&o&&(o(),o=null)}}}}const ot=(()=>{const{subscribe:t,set:e}=nt({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=ot.views[t];o.props=n,e(o)}}})(),st=(()=>{const{subscribe:t,set:e,update:n}=nt([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})(),rt=t=>{st.addError(t.type)},it=new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{const e=n.result;t.oldVersion<4&&(t=>{if(t.objectStoreNames.contains("topics")||t.createObjectStore("topics",{keyPath:"file"}),!t.objectStoreNames.contains("questions")){const e=t.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});e.indexNames.contains("file")||e.createIndex("file","file",{unique:!1})}t.objectStoreNames.contains("hash")||(t.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}),t.objectStoreNames.contains("admin")||t.createObjectStore("admin",{keyPath:"config"}),t.objectStoreNames.contains("config")&&t.deleteObjectStore("config")})(e),console.log("db upgrade success!")},n.onerror=t=>{st.addError(t.type),e()},n.onsuccess=()=>{const e=n.result;e.onerror=rt,console.log("db init success!"),t(e)}})),ct=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=()=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),at=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=()=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),lt=(t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=()=>{console.log("Store:",t.name,"id:",e,"get:",s.result?s.result:"NOT-FOUND"),n(s.result)},s.onerror=n=>{st.addError(`Store: ${t.name} id: ${e} storeGet error: ${n}`),o()}})),ut=t=>new Promise(((e,n)=>{const o=t.getAll();o.onsuccess=()=>{console.log("Store:",t.name,"getAll num:",o.result.length),e(o.result)},o.onerror=e=>{st.addError(`Store: ${t.name} storeGetAll error: ${e}`),n()}})),dt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},pt=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},ft=(t,e)=>{for(const n in t)if(t[n]!==e)return!1;return!0},ht=(t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return gt(n,t.length*e)},gt=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},mt=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),$t=t=>{for(let e=0;e<t.length;e++){const n=mt(0,t.length-1);if(e===n)continue;const o=t[e];t[e]=t[n],t[n]=o}},wt=(t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n};function bt(t){return t instanceof Error?t.message:String(t)}const kt=(t,e)=>t.endsWith(e)?t:t+e,vt=t=>{const e=[];return t.split("\n").forEach((t=>{(t=t.trim())&&e.push(t)})),e},xt=t=>t.join("\n");var Ct;!function(t){t[t.OK=0]="OK",t[t.ERROR=1]="ERROR",t[t.UNDEF=2]="UNDEF"}(Ct||(Ct={}));class yt{constructor(){this.status=Ct.UNDEF}isOk(){if(this.status===Ct.UNDEF)throw new Error("Status not set!");return this.status===Ct.OK}hasError(){if(this.status===Ct.UNDEF)throw new Error("Status not set!");return this.status===Ct.ERROR}getMessage(){if(this.status!==Ct.ERROR)throw new Error("Status is not ERROR!");if(!this.message)throw new Error("Status is ERROR but no message is set!");return this.message}getValue(){if(this.status!==Ct.OK)throw new Error("Status is not OK!");if(!this.wrapper)throw new Error("Value not set!");return this.wrapper.value}setOk(t){return this.status=Ct.OK,this.wrapper={value:t},this}setError(t){return this.status=Ct.ERROR,this.message=t,this}}const _t="https://api.github.com/repos/dead-end/cards-russian/contents/",Et=(()=>{const t=nt();return{subscribe:t.subscribe,init:async()=>{const e=await new Promise((t=>{it.then((e=>{const n=e.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=()=>{let e=n.result;e||(e={config:"admin",langUrl:_t,linkUrl:"https://github.com/dead-end/cards-russian/blob/master/",backupUrl:"",file:"",token:""}),t(e)}}))}));t.set(e),console.log("init admin",e)},get:()=>function(t){let e;return c(t,(t=>e=t))(),e}(t),put:async e=>{const n=new yt;try{return await(async t=>{t.langUrl=kt(t.langUrl,"/"),t.linkUrl?t.linkUrl=kt(t.linkUrl,"/"):t.linkUrl=_t;const e=(await it).transaction(["admin"],"readwrite").objectStore("admin");at(e,t)})(e),t.set(e),n.setOk()}catch(t){return n.setError(`Unable to store admin config - ${t}`)}}}})();function St(t,e,n){const o=t.slice();return o[2]=e[n],o}function qt(t){let e,n,o=t[2]+"";return{c(){e=f("li"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&k(n,o)},d(t){t&&d(e)}}}function Lt(e){let n,o,s,r,i,c,a,h,m,w=e[0],k=[];for(let t=0;t<w.length;t+=1)k[t]=qt(St(e,w,t));return{c(){n=f("div"),o=f("h4"),o.textContent="Errors",s=g(),r=f("ul");for(let t=0;t<k.length;t+=1)k[t].c();i=g(),c=f("div"),a=f("button"),a.textContent="Ok",b(o,"class","is-text-danger"),b(a,"class","button"),b(c,"class","is-floating"),b(n,"class","card card-shadow block content")},m(t,d){u(t,n,d),l(n,o),l(n,s),l(n,r);for(let t=0;t<k.length;t+=1)k[t]&&k[t].m(r,null);l(n,i),l(n,c),l(c,a),h||(m=$(a,"click",e[1]),h=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=St(t,w,n);k[n]?k[n].p(o,e):(k[n]=qt(o),k[n].c(),k[n].m(r,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=w.length}},i:t,o:t,d(t){t&&d(n),p(k,t),h=!1,m()}}}function Tt(t,e,n){let o;a(t,st,(t=>n(0,o=t)));return[o,()=>{st.resetErrors()}]}class Vt extends tt{constructor(t){super(),Z(this,t,Tt,Lt,i,{})}}const Ut=async t=>{const e=(await it).transaction(["hash"],"readonly").objectStore("hash");return lt(e,t)},Mt=async()=>{const t=(await it).transaction(["hash"],"readonly").objectStore("hash");return ut(t)},jt=async t=>{const e=(await it).transaction(["hash"],"readwrite").objectStore("hash");return ct(e,t)},Ot=(t,e)=>{const n=t.objectStore("hash");return ct(n,e)},Rt=async(t,e,n,o,s)=>{const r=new yt;try{const c={content:(i=e,window.btoa(unescape(encodeURIComponent(i)))),message:o};n&&(c.sha=n);const a={method:"PUT",headers:{Accept:"application/vnd.github.v3+json",authorization:`token ${s}`},body:JSON.stringify(c)},l=await fetch(t,a);if(!l.ok)return r.setError(`githubWriteContent - Url: ${t} Error: ${l.statusText}`)}catch(e){return r.setError(`githubWriteContent - Url: ${t} Error: ${e}`)}var i;return r.setOk()},Bt=async(t,e)=>{const n=new yt;try{const s={Accept:"application/vnd.github.v3+json"};e&&(s.authorization=`token ${e}`);const r=await fetch(t,s);if(!r.ok)return n.setError(`githubReadContent - Url: ${t} Read error: ${r.statusText}`);const i=await r.json(),c=(o=i.content,decodeURIComponent(escape(window.atob(o))));return n.setOk({content:c,hash:i.sha})}catch(e){return n.setError(`githubReadContent - Url: ${t} Error: ${e}`)}var o},At=async(t,e)=>{const n=new yt;try{const o={Accept:"application/vnd.github.v3+json"};e&&(o.authorization=`token ${e}`);const s=await fetch(t,{method:"HEAD",headers:o});if(404===s.status)return n.setOk();if(!s.ok)return n.setError(`githubGetHash - Url: ${t} Error: ${s.statusText}`);const r=s.headers.get("ETag");if(!r)return console.log("githubGetHash - no ETag found",t),n.setOk();const i=r.startsWith("W/")?3:1,c=r.substring(i,r.length-1);return console.log("githubGetHash:",c),n.setOk(c)}catch(e){return n.setError(`githubGetHash - Url: ${t} Error: ${e}`)}},Nt=async()=>{const t=new yt;try{const e=Et.get(),n=e.backupUrl+e.file,o=await Bt(n,e.token);if(o.hasError())return t.setError(`repoReadBackup - unable to read data: ${o.getMessage()}`);const s=JSON.parse(o.getValue().content);return t.setOk(s)}catch(e){return t.setError(`repoReadBackup - unable to restore data: ${e}`)}},Ht=async t=>{const e=Et.get();if(!e.token)return(new yt).setError(`repoWriteBackup - file: ${e.backupUrl} Token required`);const n=await At(e.backupUrl,e.token),o=JSON.stringify(t),s=e.backupUrl+e.file;return Rt(s,o,n.getValue(),"backup",e.token)},Ft=async(t,e,n,o)=>{const s=new yt,r=Et.get();if(!r.token)return s.setError(`repoWriteContent - file: ${t} Token required`);const i=r.langUrl+t,c=JSON.stringify(e,null,2),a=await Rt(i,c,n,o,r.token);return a.hasError()?s.setError(`repoWriteJson - unable to write: ${a.getMessage()}`):(await jt(t),s.setOk())},Gt=async t=>{const e=new yt;try{const n=Et.get(),o=n.langUrl+t,s=await Bt(o,n.token);return s.hasError()?e.setError(`repoGetJson - unable to read data: ${s.getMessage()}`):e.setOk({json:JSON.parse(s.getValue().content),hash:s.getValue().hash})}catch(t){return e.setError(`repoGetJson - unable get json: ${t}`)}},Pt=async t=>{const e=new yt;try{const n=Et.get(),o=n.langUrl+t;let s=await Ut(t);if(s&&s.value){const r=await At(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);if(r.getValue()&&r.getValue()===s.value)return console.log("repoGetJsonCache - cache ok",t),e.setOk()}const r=await Bt(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);const i=JSON.parse(r.getValue().content);return await(async t=>{const e=(await it).transaction(["hash"],"readwrite").objectStore("hash");return at(e,t)})({file:t,value:r.getValue().hash,lastLoaded:new Date}),console.log("repoGetJsonCache",t,i),e.setOk(i)}catch(n){return e.setError(`repoGetJsonCache - file: ${t} - ${n}`)}},It=[{pattern:new RegExp(/_([^_]+)_/,"g"),replace:"<u>$1</u>"},{pattern:new RegExp(/\*([^*]+)\*/,"g"),replace:"<b>$1</b>"},{pattern:new RegExp(/~([^~]+)~/,"g"),replace:"<i>$1</i>"}],Dt=new RegExp(/[_*~]/,"g"),zt=t=>(It.forEach((e=>{t=t.replaceAll(e.pattern,e.replace)})),t),Jt=t=>t.replace(Dt,""),Wt=t=>{Array.isArray(t)||(t=[t]);let e=!1,n="";for(const o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+zt(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=zt(o.trim()));return e&&(n+="</ul>"),n},Qt=t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e},Kt=(t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=gt(t.failed,t.total)},Yt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=()=>{c.result.forEach((t=>{ct(i,t)})),s()},c.onerror=t=>{st.addError(`Store: ${i.name} delete index error: ${t}`),r()}})))(t,"questions","file",e),Xt=async t=>{const e=(await it).transaction(["questions"],"readwrite").objectStore("questions");return at(e,t)},Zt=async t=>{const e=(await it).transaction(["questions"],"readonly").objectStore("questions");return te(e,t)},te=(t,e)=>new Promise((n=>{const o=t.index("file").getAll(e.file);o.onsuccess=()=>{n(o.result)}})),ee=async(t,e)=>{const n=(await it).transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,at(n,t))));await Promise.all(o)},ne=async(t,e,n)=>{const o=(await it).transaction(["questions"],"readonly").objectStore("questions"),s=[];return t.forEach((t=>{s.push(te(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if($t(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),$t(o)),o.splice(0,e)}))},oe=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=()=>{const t=ae(n),r=ae(s.result);r.forEach((e=>{t.has(e.id)||ct(o,e.id)})),t.forEach((t=>{const n=r.get(t.id);n?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(n,t),at(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=()=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},se=()=>new Promise(((t,e)=>{const n=[];it.then((o=>{const s=o.transaction(["questions"],"readonly").objectStore("questions"),r=s.openCursor();r.onsuccess=()=>{const e=r.result;if(e){const t=e.value;n.push([t.id,t.failed,t.total]),e.continue()}else console.log("Store:",s.name,"questGetBackup finished:",n.length),t(n)},r.onerror=t=>{console.log("Store:",s.name,"questGetBackup:",t),e()}}))})),re=async t=>{const e=(await it).transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];lt(e,n).then((t=>{t?t.total>=s?console.log(`question: ${n} total db: ${t.total} total backup: ${s} => ignore`):(t.failed=o,t.total=s,t.ratio=gt(t.failed,t.total),at(e,t)):console.log("question to restore not found in db",n)}))}))},ie=async t=>{const e=await Pt(t);if(e.hasError())return void st.addError(`Unable to get file: ${t} - ${e.getMessage()}`);const n=e.getValue();if(n){const e=(await it).transaction(["questions"],"readwrite");oe(e,t,n)}},ce=async t=>{const e=[];return t.forEach((t=>{e.push(ie(t))})),Promise.all(e)},ae=t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e},le=(t,e)=>{for(let n of t)if(Jt(n).toLowerCase().includes(e))return!0;return!1},ue=(t,e)=>{const n=t.toLowerCase();return new Promise(((t,o)=>{const s=[];let r=0,i=0;it.then((c=>{const a=c.transaction(["questions"],"readonly").objectStore("questions"),l=a.openCursor();l.onsuccess=()=>{const o=l.result;if(o){const t=o.value;(le(t.quest,n)||le(t.answer,n))&&(s.length<e&&s.push(t),i++),r++,o.continue()}else console.log("Store:",a.name,"questSearch finished:",s.length),t([s,r,i])},l.onerror=t=>{console.log("Store:",a.name,"questSearch:",t),o()}}))}))},de=t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()},pe=async t=>{const e=(await it).transaction(["topics"],"readonly").objectStore("topics");return lt(e,t)},fe=async()=>{const t=(await it).transaction(["topics"],"readonly").objectStore("topics");return ut(t)},he=async t=>{const e=(await it).transaction(["topics"],"readwrite").objectStore("topics");at(e,t)},ge=(t,e)=>{const n=t.objectStore("topics");ct(n,e)},me=async t=>{const e=(await it).transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=()=>{const s=$e(o.result),r=t.map((t=>t.file));for(const t of s.keys())r.includes(t)||(ge(e,t),Ot(e,t),Yt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!pt(t.tags,e.tags)||!pt(t.details,e.details)))(t,s.get(t.file))&&at(n,t)}))}},$e=t=>{const e=new Map;return t.forEach((t=>{e.set(t.file,t)})),e},we=async()=>{const t=await Pt("data/topics.json");if(t.hasError())return void st.addError(`Unable to load topics - ${t.getMessage()}`);const e=t.getValue();e&&await me(e)};function be(t){let e,n,o,s,r,i,c,a,p,$,w,b,v,x,C=t[4]&&ke(t);return{c(){e=f("tr"),n=f("td"),n.textContent="Questions",o=g(),s=f("td"),r=h(t[2]),i=g(),c=f("tr"),a=f("td"),a.textContent="Status",p=g(),$=f("td"),w=h(t[1]),b=h("%"),v=g(),C&&C.c(),x=m()},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(s,r),u(t,i,d),u(t,c,d),l(c,a),l(c,p),l(c,$),l($,w),l($,b),u(t,v,d),C&&C.m(t,d),u(t,x,d)},p(t,e){4&e&&k(r,t[2]),2&e&&k(w,t[1]),t[4]?C?C.p(t,e):(C=ke(t),C.c(),C.m(x.parentNode,x)):C&&(C.d(1),C=null)},d(t){t&&d(e),t&&d(i),t&&d(c),t&&d(v),C&&C.d(t),t&&d(x)}}}function ke(t){let e,n,o,s,r,i,c,a,p,m,$,w=dt(t[4].lastLoaded)+"",b=t[4].value+"";return{c(){e=f("tr"),n=f("td"),n.textContent="Last loaded",o=g(),s=f("td"),r=h(w),i=g(),c=f("tr"),a=f("td"),a.textContent="Hash",p=g(),m=f("td"),$=h(b)},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(s,r),u(t,i,d),u(t,c,d),l(c,a),l(c,p),l(c,m),l(m,$)},p(t,e){16&e&&w!==(w=dt(t[4].lastLoaded)+"")&&k(r,w),16&e&&b!==(b=t[4].value+"")&&k($,b)},d(t){t&&d(e),t&&d(i),t&&d(c)}}}function ve(t){let e,n,o=t[0].desc+"";return{c(){e=f("p"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&k(n,o)},d(t){t&&d(e)}}}function xe(e){let n,o,s,r,i,c,a,p,$,w,b,v,x,C,y,_,E,S,q,L,T,V,U,M,j=e[0].title+"",O=e[0].file+"",R=e[0].tags.join(", ")+"",B=dt(e[0].lastLearned)+"",A=e[3]&&be(e),N=e[0].desc&&ve(e);return{c(){n=f("h4"),o=h(j),s=g(),r=f("table"),i=f("tr"),c=f("td"),c.textContent="File",a=g(),p=f("td"),$=h(O),w=g(),b=f("tr"),v=f("td"),v.textContent="Tags",x=g(),C=f("td"),y=h(R),_=g(),E=f("tr"),S=f("td"),S.textContent="Last learned",q=g(),L=f("td"),T=h(B),V=g(),A&&A.c(),U=g(),N&&N.c(),M=m()},m(t,e){u(t,n,e),l(n,o),u(t,s,e),u(t,r,e),l(r,i),l(i,c),l(i,a),l(i,p),l(p,$),l(r,w),l(r,b),l(b,v),l(b,x),l(b,C),l(C,y),l(r,_),l(r,E),l(E,S),l(E,q),l(E,L),l(L,T),l(r,V),A&&A.m(r,null),u(t,U,e),N&&N.m(t,e),u(t,M,e)},p(t,[e]){1&e&&j!==(j=t[0].title+"")&&k(o,j),1&e&&O!==(O=t[0].file+"")&&k($,O),1&e&&R!==(R=t[0].tags.join(", ")+"")&&k(y,R),1&e&&B!==(B=dt(t[0].lastLearned)+"")&&k(T,B),t[3]?A?A.p(t,e):(A=be(t),A.c(),A.m(r,null)):A&&(A.d(1),A=null),t[0].desc?N?N.p(t,e):(N=ve(t),N.c(),N.m(M.parentNode,M)):N&&(N.d(1),N=null)},i:t,o:t,d(t){t&&d(n),t&&d(s),t&&d(r),A&&A.d(),t&&d(U),N&&N.d(t),t&&d(M)}}}function Ce(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return L((async()=>{c&&n(4,o=await Ut(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class ye extends tt{constructor(t){super(),Z(this,t,Ce,xe,i,{topic:0,status:1,size:2,details:3})}}function _e(t){let e,n,o,s,r,i,c,a,p;return n=new ye({props:{topic:t[0],details:!1}}),{c(){e=f("div"),Q(n.$$.fragment),o=g(),s=f("div"),r=f("button"),r.textContent="Show",b(r,"class","button"),b(s,"class","is-floating"),b(e,"class","card card-shadow content"),b(e,"id",i=t[0].file)},m(i,d){u(i,e,d),K(n,e,null),l(e,o),l(e,s),l(s,r),c=!0,a||(p=$(r,"click",t[2]),a=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&b(e,"id",i)},i(t){c||(J(n.$$.fragment,t),c=!0)},o(t){W(n.$$.fragment,t),c=!1},d(t){t&&d(e),Y(n),a=!1,p()}}}function Ee(t,e,n){let{topic:o}=e;const s=t=>{ot.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Se extends tt{constructor(t){super(),Z(this,t,Ee,_e,i,{topic:0})}}function qe(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Le(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Te extends tt{constructor(t){super(),Z(this,t,Le,qe,i,{onClick:0})}}function Ve(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Ue(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Me extends tt{constructor(t){super(),Z(this,t,Ue,Ve,i,{onClick:0})}}function je(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5l-3.9 19.5m-2.1-19.5l-3.9 19.5"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Oe(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Re extends tt{constructor(t){super(),Z(this,t,Oe,je,i,{onClick:0})}}function Be(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Ae(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Ne extends tt{constructor(t){super(),Z(this,t,Ae,Be,i,{onClick:0})}}function He(t,e,n){const o=t.slice();return o[14]=e[n],o}function Fe(t,e,n){const o=t.slice();return o[17]=e[n],o}function Ge(t){let e,n,o,r,i,c,a,h,m,w,k,v,x,y,_,E,S,q,L,T,V,U,M,j=t[1],O=[];for(let e=0;e<j.length;e+=1)O[e]=Pe(Fe(t,j,e));let R=t[2]&&Ie(t);return y=new Ne({props:{onClick:t[9]}}),E=new Re({props:{onClick:t[10]}}),q=new Me({props:{onClick:t[11]}}),T=new Te({props:{onClick:t[12]}}),{c(){e=f("div"),n=f("label"),n.textContent="Sort",o=g(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Last learned",a=g(),h=f("label"),h.textContent="Tag Filter",m=g(),w=f("select"),k=f("option"),k.textContent="-- Select --";for(let t=0;t<O.length;t+=1)O[t].c();v=g(),R&&R.c(),x=g(),Q(y.$$.fragment),_=g(),Q(E.$$.fragment),S=g(),Q(q.$$.fragment),L=g(),Q(T.$$.fragment),b(n,"class","is-valign-center"),b(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,b(r,"id","sort-select"),void 0===t[3]&&A((()=>t[6].call(r))),b(h,"for","tag-select"),k.__value="",k.value=k.__value,b(w,"id","tag-select"),void 0===t[2]&&A((()=>t[7].call(w))),b(e,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),C(r,t[3]),l(e,a),l(e,h),l(e,m),l(e,w),l(w,k);for(let t=0;t<O.length;t+=1)O[t]&&O[t].m(w,null);C(w,t[2]),l(e,v),R&&R.m(e,null),l(e,x),K(y,e,null),l(e,_),K(E,e,null),l(e,S),K(q,e,null),l(e,L),K(T,e,null),V=!0,U||(M=[$(r,"change",t[6]),$(r,"change",t[4]),$(w,"change",t[7]),$(w,"change",t[4])],U=!0)},p(t,n){if(8&n&&C(r,t[3]),2&n){let e;for(j=t[1],e=0;e<j.length;e+=1){const o=Fe(t,j,e);O[e]?O[e].p(o,n):(O[e]=Pe(o),O[e].c(),O[e].m(w,null))}for(;e<O.length;e+=1)O[e].d(1);O.length=j.length}6&n&&C(w,t[2]),t[2]?R?R.p(t,n):(R=Ie(t),R.c(),R.m(e,x)):R&&(R.d(1),R=null)},i(t){V||(J(y.$$.fragment,t),J(E.$$.fragment,t),J(q.$$.fragment,t),J(T.$$.fragment,t),V=!0)},o(t){W(y.$$.fragment,t),W(E.$$.fragment,t),W(q.$$.fragment,t),W(T.$$.fragment,t),V=!1},d(t){t&&d(e),p(O,t),R&&R.d(),Y(y),Y(E),Y(q),Y(T),U=!1,s(M)}}}function Pe(t){let e,n,o,s=t[17]+"";return{c(){e=f("option"),n=h(s),e.__value=o=t[17],e.value=e.__value},m(t,o){u(t,e,o),l(e,n)},p(t,r){2&r&&s!==(s=t[17]+"")&&k(n,s),2&r&&o!==(o=t[17])&&(e.__value=o,e.value=e.__value)},d(t){t&&d(e)}}}function Ie(e){let n,o,s;return{c(){n=f("button"),n.textContent="Show",b(n,"class","button")},m(t,r){u(t,n,r),o||(s=$(n,"click",e[8]),o=!0)},p:t,d(t){t&&d(n),o=!1,s()}}}function De(t){let e,n;return e=new Se({props:{topic:t[14]}}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[14]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function ze(t){let e,n,o,s=t[1]&&Ge(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=De(He(t,r,e));const c=t=>W(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=g(),n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();b(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),u(t,e,r),u(t,n,r);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?(s.p(t,o),2&o&&J(s,1)):(s=Ge(t),s.c(),J(s,1),s.m(e.parentNode,e)):s&&(D(),W(s,1,1,(()=>{s=null})),z()),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=He(t,r,e);i[e]?(i[e].p(s,o),J(i[e],1)):(i[e]=De(s),i[e].c(),J(i[e],1),i[e].m(n,null))}for(D(),e=r.length;e<i.length;e+=1)c(e);z()}},i(t){if(!o){J(s);for(let t=0;t<r.length;t+=1)J(i[t]);o=!0}},o(t){W(s),i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)W(i[t]);o=!1},d(t){s&&s.d(t),t&&d(e),t&&d(n),p(i,t)}}}function Je(t,e,n){let o,s,r,{id:i}=e,c=[],a=[];L((()=>{fe().then((t=>(t.sort(((t,e)=>+(t.title>e.title)||-(t.title<e.title))),t))).then((t=>{c=t,n(0,a=t),n(1,o=de(c))}))})),T((()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}}));return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[a,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,a=t)},i,function(){r=y(this),n(3,r)},function(){s=y(this),n(2,s),n(1,o)},()=>ot.setView("ViewTagInfo",{tag:s,topics:a}),()=>ot.setView("ViewTranslate"),()=>ot.setView("ViewHashes"),()=>ot.setView("ViewAdmin"),()=>ot.setView("ViewSearch")]}class We extends tt{constructor(t){super(),Z(this,t,Je,ze,i,{id:5})}}function Qe(t){let e,n,o,s,r,i=Wt(t[0].details)+"";return{c(){e=f("div"),n=f("h5"),n.textContent="Details",o=g(),s=f("div"),r=f("p"),b(s,"class","card content is-info"),b(e,"class","block")},m(t,c){u(t,e,c),l(e,n),l(e,o),l(e,s),l(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=Wt(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&d(e)}}}function Ke(t){let e,n,o,r,i,c,a,p,m,w,k,v,x,C,y,_,E,S,q,L,T,V,U,M,j,O;r=new ye({props:{topic:t[0],status:t[1],size:t[3]}});let R=t[0].details&&Qe(t);return{c(){e=f("div"),n=f("div"),o=f("div"),Q(r.$$.fragment),i=g(),c=f("div"),a=f("label"),a.textContent="Number of correct answers",p=g(),m=f("select"),w=f("option"),w.textContent="-- Select --",k=f("option"),k.textContent="Set 0",v=f("option"),v.textContent="Set 1",x=f("option"),x.textContent="Set 2",C=f("option"),C.textContent="Set 3",y=g(),R&&R.c(),_=g(),E=f("div"),S=f("button"),S.textContent="Back",q=g(),L=f("button"),L.textContent="Listing",T=g(),V=f("button"),U=h("Start"),b(o,"class","is-text-left"),b(a,"for","sf-set"),w.__value="",w.value=w.__value,k.__value="0",k.value=k.__value,v.__value="1",v.value=v.__value,x.__value="2",x.value=x.__value,C.__value="3",C.value=C.__value,b(m,"id","sf-set"),b(c,"class","is-floating"),b(S,"class","button"),b(L,"class","button"),b(V,"class","button"),V.disabled=t[2],b(E,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,d){u(s,e,d),l(e,n),l(n,o),K(r,o,null),l(n,i),l(n,c),l(c,a),l(c,p),l(c,m),l(m,w),l(m,k),l(m,v),l(m,x),l(m,C),l(n,y),R&&R.m(n,null),l(e,_),l(e,E),l(E,S),l(E,q),l(E,L),l(E,T),l(E,V),l(V,U),M=!0,j||(O=[$(m,"change",t[7]),$(S,"click",t[4]),$(L,"click",t[5]),$(V,"click",t[6])],j=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?R?R.p(t,e):(R=Qe(t),R.c(),R.m(n,null)):R&&(R.d(1),R=null),(!M||4&e)&&(V.disabled=t[2])},i(t){M||(J(r.$$.fragment,t),M=!0)},o(t){W(r.$$.fragment,t),M=!1},d(t){t&&d(e),Y(r),R&&R.d(),j=!1,s(O)}}}function Ye(t,e,n){let{topic:o}=e,{questions:s}=e,r=0,i=!0,c=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,r=ht(t,3)),n(2,i=ft(t,3)),n(3,c=t.length)};L((async()=>{try{s||(await ie(o.file),console.log("Loading questions for topics"),n(8,s=await Zt(o)),a())}catch(t){st.addError("ViewTopicInfo: "+bt(t))}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(8,s=t.questions)},[o,r,i,c,()=>{ot.setView("ViewTopicList",{id:o.file})},()=>{ot.setView("ViewTopicQuests",{topic:o})},()=>{ot.setView("ViewQuestAnswer",{topics:[o],questions:s})},async t=>{if(!s)return;const e=t.target;await ee(s,e.selectedIndex-1),e.selectedIndex=0,a()},s]}class Xe extends tt{constructor(t){super(),Z(this,t,Ye,Ke,i,{topic:0,questions:8})}}function Ze(e){let n,o,s,r,i,c,a,p,m,$,w,v,x,C,y,_=e[0].progress+"",E=e[0].total+"",S=e[0].ratio+"";return{c(){n=f("div"),o=h("Progress: "),s=f("span"),r=h(_),i=h(" /\n  "),c=f("span"),c.textContent="3",a=g(),p=f("span"),m=h("Total: "),$=f("span"),w=h(E),v=h(" Wrong:\n    "),x=f("span"),C=h(S),y=h("%"),b(s,"class","is-text-success"),b(c,"class","is-text-success"),b($,"class","is-text-success"),b(x,"class","is-text-danger"),b(p,"class","hide-sm"),b(n,"class","h6")},m(t,e){u(t,n,e),l(n,o),l(n,s),l(s,r),l(n,i),l(n,c),l(n,a),l(n,p),l(p,m),l(p,$),l($,w),l(p,v),l(p,x),l(x,C),l(x,y)},p(t,[e]){1&e&&_!==(_=t[0].progress+"")&&k(r,_),1&e&&E!==(E=t[0].total+"")&&k(w,E),1&e&&S!==(S=t[0].ratio+"")&&k(C,S)},i:t,o:t,d(t){t&&d(n)}}}function tn(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class en extends tt{constructor(t){super(),Z(this,t,tn,Ze,i,{question:0})}}function nn(e){let n,o,s;return{c(){n=f("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function on(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class sn extends tt{constructor(t){super(),Z(this,t,on,nn,i,{onClick:0})}}function rn(t,e,n){const o=t.slice();return o[11]=e[n],o}function cn(t){let e,n,o,s,r,i,c,a,p,m,$,w,v,x,C=t[11].id+"",y=t[11].file+"",_=t[1]&&an(t);return v=new en({props:{question:t[11]}}),{c(){e=f("div"),n=f("div"),o=f("span"),s=h("Id: "),r=h(C),i=g(),c=f("span"),a=f("a"),p=h(y),$=g(),_&&_.c(),w=g(),Q(v.$$.fragment),b(o,"class","h6"),b(a,"href",m=t[4].linkUrl+t[11].file),b(a,"target","_blank"),b(c,"class","hide-sm"),b(e,"class","is-flex-spread grid-full")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(o,s),l(o,r),l(n,i),l(n,c),l(c,a),l(a,p),l(n,$),_&&_.m(n,null),l(e,w),K(v,e,null),x=!0},p(t,e){(!x||4&e)&&C!==(C=t[11].id+"")&&k(r,C),(!x||4&e)&&y!==(y=t[11].file+"")&&k(p,y),(!x||20&e&&m!==(m=t[4].linkUrl+t[11].file))&&b(a,"href",m),t[1]?_?(_.p(t,e),2&e&&J(_,1)):(_=an(t),_.c(),J(_,1),_.m(n,null)):_&&(D(),W(_,1,1,(()=>{_=null})),z());const o={};4&e&&(o.question=t[11]),v.$set(o)},i(t){x||(J(_),J(v.$$.fragment,t),x=!0)},o(t){W(_),W(v.$$.fragment,t),x=!1},d(t){t&&d(e),_&&_.d(),Y(v)}}}function an(t){let e,n;function o(){return t[10](t[11])}return e=new sn({props:{onClick:o}}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(n,s){t=n;const r={};6&s&&(r.onClick=o),e.$set(r)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function ln(t){let e,n,o,s,r,i,c,a,p,h,m=Wt(t[11].quest)+"",$=Wt(t[11].answer)+"",w=t[0]&&cn(t);return{c(){w&&w.c(),e=g(),n=f("div"),o=f("div"),s=f("p"),r=g(),i=f("div"),c=f("div"),a=f("p"),p=g(),b(o,"class","content"),b(n,"class","card "+t[6]()),b(c,"class","content"),b(i,"class","card "+t[6]())},m(t,d){w&&w.m(t,d),u(t,e,d),u(t,n,d),l(n,o),l(o,s),s.innerHTML=m,u(t,r,d),u(t,i,d),l(i,c),l(c,a),a.innerHTML=$,l(i,p),h=!0},p(t,n){t[0]?w?(w.p(t,n),1&n&&J(w,1)):(w=cn(t),w.c(),J(w,1),w.m(e.parentNode,e)):w&&(D(),W(w,1,1,(()=>{w=null})),z()),(!h||4&n)&&m!==(m=Wt(t[11].quest)+"")&&(s.innerHTML=m),(!h||4&n)&&$!==($=Wt(t[11].answer)+"")&&(a.innerHTML=$)},i(t){h||(J(w),h=!0)},o(t){W(w),h=!1},d(t){w&&w.d(t),t&&d(e),t&&d(n),t&&d(r),t&&d(i)}}}function un(t){let e,n,o,r,i,c,a,h,m,w,k,v,x,y,_,E,S=t[2],q=[];for(let e=0;e<S.length;e+=1)q[e]=ln(rn(t,S,e));const L=t=>W(q[t],1,1,(()=>{q[t]=null}));return{c(){e=f("div"),n=f("label"),n.textContent="Details",o=g(),r=f("input"),i=g(),c=f("label"),c.textContent="Sort",a=g(),h=f("select"),m=f("option"),m.textContent="-- Select --",w=f("option"),w.textContent="Total",k=f("option"),k.textContent="Ratio",v=g(),x=f("div");for(let t=0;t<q.length;t+=1)q[t].c();b(n,"for","details-checkbox"),b(r,"type","checkbox"),b(r,"id","details-checkbox"),b(c,"for","quest-sort"),m.__value="",m.value=m.__value,w.__value="total",w.value=w.__value,k.__value="ratio",k.value=k.__value,b(h,"id","quest-sort"),void 0===t[3]&&A((()=>t[9].call(h))),b(e,"class","is-floating"),b(x,"class","grid grid-2")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),r.checked=t[0],l(e,i),l(e,c),l(e,a),l(e,h),l(h,m),l(h,w),l(h,k),C(h,t[3]),u(s,v,d),u(s,x,d);for(let t=0;t<q.length;t+=1)q[t]&&q[t].m(x,null);y=!0,_||(E=[$(r,"change",t[8]),$(h,"change",t[9]),$(h,"change",t[5])],_=!0)},p(t,[e]){if(1&e&&(r.checked=t[0]),8&e&&C(h,t[3]),87&e){let n;for(S=t[2],n=0;n<S.length;n+=1){const o=rn(t,S,n);q[n]?(q[n].p(o,e),J(q[n],1)):(q[n]=ln(o),q[n].c(),J(q[n],1),q[n].m(x,null))}for(D(),n=S.length;n<q.length;n+=1)L(n);z()}},i(t){if(!y){for(let t=0;t<S.length;t+=1)J(q[t]);y=!0}},o(t){q=q.filter(Boolean);for(let t=0;t<q.length;t+=1)W(q[t]);y=!1},d(t){t&&d(e),t&&d(v),t&&d(x),p(q,t),_=!1,s(E)}}}function dn(t,e,n){let o;a(t,Et,(t=>n(4,o=t)));let{questions:s}=e,{goBackFct:r}=e,{details:i=!1}=e,c=[],l="";T((()=>{console.log("afterUpdate questions:",s),n(2,c=s)}));const u=wt(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(7,s=t.questions),"goBackFct"in t&&n(1,r=t.goBackFct),"details"in t&&n(0,i=t.details)},[i,r,c,l,o,()=>{if(!l)return void n(2,c=s);let t=[...s];"ratio"===l?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===l&&t.sort(((t,e)=>e.total-t.total)),n(2,c=t)},u,s,function(){i=this.checked,n(0,i)},function(){l=y(this),n(3,l)},t=>ot.setView("ViewQuestEdit",{question:t,goBackFct:r})]}class pn extends tt{constructor(t){super(),Z(this,t,dn,un,i,{questions:7,goBackFct:1,details:0})}}function fn(t){let e,n;return e=new pn({props:{questions:t[2],details:t[1],goBackFct:t[4]}}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.questions=t[2]),2&n&&(o.details=t[1]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function hn(t){let e,n,o,s,r,i,c,a,p,m,w=t[0].title+"",v=0!==t[2].length&&fn(t);return{c(){e=f("div"),n=f("h4"),o=h(w),s=g(),v&&v.c(),r=g(),i=f("div"),c=f("button"),c.textContent="Back",b(c,"class","button"),b(i,"class","is-floating"),b(e,"class","card card-shadow content")},m(d,f){u(d,e,f),l(e,n),l(n,o),l(e,s),v&&v.m(e,null),l(e,r),l(e,i),l(i,c),a=!0,p||(m=$(c,"click",t[5]),p=!0)},p(t,[n]){(!a||1&n)&&w!==(w=t[0].title+"")&&k(o,w),0!==t[2].length?v?(v.p(t,n),4&n&&J(v,1)):(v=fn(t),v.c(),J(v,1),v.m(e,r)):v&&(D(),W(v,1,1,(()=>{v=null})),z())},i(t){a||(J(v),a=!0)},o(t){W(v),a=!1},d(t){t&&d(e),v&&v.d(),p=!1,m()}}}function gn(t,e,n){let{topic:o}=e,{details:s=!1}=e,r=[];L((()=>{Zt(o).then((t=>{n(2,r=t)}))}));const i=t=>{ot.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"details"in t&&n(1,s=t.details)},[o,s,r,i,()=>{ot.setView("ViewTopicQuests",{topic:o,details:!0})},()=>i(o)]}class mn extends tt{constructor(t){super(),Z(this,t,gn,hn,i,{topic:0,details:1})}}function $n(t,e,n){const o=t.slice();return o[15]=e[n],o}function wn(t){let e,n,o=t[15].title+"";return{c(){e=f("li"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[15].title+"")&&k(n,o)},d(t){t&&d(e)}}}function bn(t){let e,n,o,r,i,c,a,p,h,m;return{c(){e=f("div"),n=f("label"),n.textContent="Number of correct answers",o=g(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Set 0",a=f("option"),a.textContent="Set 1",p=f("option"),p.textContent="Set 2",b(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,a.__value="1",a.value=a.__value,p.__value="2",p.value=p.__value,b(r,"id","sf-set"),void 0===t[5]&&A((()=>t[14].call(r))),b(e,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),l(r,a),l(r,p),C(r,t[5]),h||(m=[$(r,"change",t[14]),$(r,"change",t[9])],h=!0)},p(t,e){32&e&&C(r,t[5])},d(t){t&&d(e),h=!1,s(m)}}}function kn(t){let e,n,o,r,i,c,a,p,h,m,w,k,v,x,y,_,E,S;return{c(){e=f("div"),n=f("label"),n.textContent="Load Questions",o=g(),r=f("select"),i=f("option"),i.textContent="30",c=f("option"),c.textContent="All",a=g(),p=f("div"),h=f("label"),h.textContent="Used fraction (sorted by ratio)",m=g(),w=f("select"),k=f("option"),k.textContent="40 %",v=f("option"),v.textContent="50 %",x=f("option"),x.textContent="60 %",y=f("option"),y.textContent="70 %",_=f("option"),_.textContent="80 %",b(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,b(r,"id","load-quests"),void 0===t[2]&&A((()=>t[12].call(r))),b(e,"class","is-floating"),b(h,"for","relevant"),k.__value="0.4",k.value=k.__value,v.__value="0.5",v.value=v.__value,x.__value="0.6",x.value=x.__value,y.__value="0.7",y.value=y.__value,_.__value="0.8",_.value=_.__value,b(w,"id","relevant"),void 0===t[3]&&A((()=>t[13].call(w))),b(p,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),C(r,t[2]),u(s,a,d),u(s,p,d),l(p,h),l(p,m),l(p,w),l(w,k),l(w,v),l(w,x),l(w,y),l(w,_),C(w,t[3]),E||(S=[$(r,"change",t[12]),$(w,"change",t[13])],E=!0)},p(t,e){4&e&&C(r,t[2]),8&e&&C(w,t[3])},d(t){t&&d(e),t&&d(a),t&&d(p),E=!1,s(S)}}}function vn(e){let n,o,s;return{c(){n=f("button"),n.textContent="Load",b(n,"class","button")},m(t,r){u(t,n,r),o||(s=$(n,"click",e[10]),o=!0)},p:t,d(t){t&&d(n),o=!1,s()}}}function xn(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Listing",o=g(),r=f("button"),r.textContent="Start",b(n,"class","button"),b(r,"class","button")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),i||(c=[$(n,"click",e[6]),$(r,"click",e[8])],i=!0)},p:t,d(t){t&&d(n),t&&d(o),t&&d(r),i=!1,s(c)}}}function Cn(e){let n,o,s,r,i,c,a,m,w,v,x,C,y,_,E,S,q,L=e[1],T=[];for(let t=0;t<L.length;t+=1)T[t]=wn($n(e,L,t));function V(t,e){return t[4]?bn:kn}let U=V(e),M=U(e);function j(t,e){return t[4]?xn:vn}let O=j(e),R=O(e);return{c(){n=f("div"),o=f("div"),s=f("div"),r=f("h4"),i=h("Tag: "),c=h(e[0]),a=g(),m=f("p"),m.textContent="Files incluging the tag:",w=g(),v=f("ul");for(let t=0;t<T.length;t+=1)T[t].c();x=g(),M.c(),C=g(),y=f("div"),_=f("button"),_.textContent="Back",E=g(),R.c(),b(s,"class","is-text-left"),b(_,"class","button"),b(y,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,d){u(t,n,d),l(n,o),l(o,s),l(s,r),l(r,i),l(r,c),l(s,a),l(s,m),l(s,w),l(s,v);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(v,null);l(n,x),M.m(n,null),l(n,C),l(n,y),l(y,_),l(y,E),R.m(y,null),S||(q=$(_,"click",e[7]),S=!0)},p(t,[e]){if(1&e&&k(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=$n(t,L,n);T[n]?T[n].p(o,e):(T[n]=wn(o),T[n].c(),T[n].m(v,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}U===(U=V(t))&&M?M.p(t,e):(M.d(1),M=U(t),M&&(M.c(),M.m(n,C))),O===(O=j(t))&&R?R.p(t,e):(R.d(1),R=O(t),R&&(R.c(),R.m(y,null)))},i:t,o:t,d(t){t&&d(n),p(T,t),M.d(),R.d(),S=!1,q()}}}function yn(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i}=e,c="30",a="0.5",l=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(11,i=t.questions)},[s,r,c,a,l,o,()=>{ot.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{ot.setView("ViewTopicList",{id:""})},()=>{ot.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;ee(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(11,i=await ne(r,t,parseFloat(a))),n(4,l=!0)}catch(t){st.addError("ViewTagInfo: "+bt(t))}},i,function(){c=y(this),n(2,c)},function(){a=y(this),n(3,a)},function(){o=y(this),n(5,o)}]}class _n extends tt{constructor(t){super(),Z(this,t,yn,Cn,i,{tag:0,topics:1,questions:11})}}function En(t){let e,n,o,s,r,i,c,a,p,m,w,v;return i=new pn({props:{questions:t[1]}}),{c(){e=f("div"),n=f("h4"),o=h("Tag: "),s=h(t[0]),r=g(),Q(i.$$.fragment),c=g(),a=f("div"),p=f("button"),p.textContent="Back",b(p,"class","button"),b(a,"class","is-floating"),b(e,"class","card card-shadow content")},m(d,f){u(d,e,f),l(e,n),l(n,o),l(n,s),l(e,r),K(i,e,null),l(e,c),l(e,a),l(a,p),m=!0,w||(v=$(p,"click",t[4]),w=!0)},p(t,[e]){(!m||1&e)&&k(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){m||(J(i.$$.fragment,t),m=!0)},o(t){W(i.$$.fragment,t),m=!1},d(t){t&&d(e),Y(i),w=!1,v()}}}function Sn(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{ot.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class qn extends tt{constructor(t){super(),Z(this,t,Sn,En,i,{tag:0,topics:3,questions:1})}}function Ln(e){let n,o,s,r,i,c,a,p,m,$,w,v,x,C,y,_,E,S,q,L,T,V,U,M,j=e[0][0]+"",O=e[0][1]+"",R=e[0][2]+"",B=e[0][3]+"";return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="No correct Answers",r=g(),i=f("td"),c=h(j),a=g(),p=f("tr"),m=f("td"),m.textContent="One correct Answer",$=g(),w=f("td"),v=h(O),x=g(),C=f("tr"),y=f("td"),y.textContent="Two correct Answers",_=g(),E=f("td"),S=h(R),q=g(),L=f("tr"),T=f("td"),T.textContent="Learned",V=g(),U=f("td"),M=h(B),b(n,"class","table hide-md")},m(t,e){u(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,a),l(n,p),l(p,m),l(p,$),l(p,w),l(w,v),l(n,x),l(n,C),l(C,y),l(C,_),l(C,E),l(E,S),l(n,q),l(n,L),l(L,T),l(L,V),l(L,U),l(U,M)},p(t,[e]){1&e&&j!==(j=t[0][0]+"")&&k(c,j),1&e&&O!==(O=t[0][1]+"")&&k(v,O),1&e&&R!==(R=t[0][2]+"")&&k(S,R),1&e&&B!==(B=t[0][3]+"")&&k(M,B)},i:t,o:t,d(t){t&&d(n)}}}function Tn(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Vn extends tt{constructor(t){super(),Z(this,t,Tn,Ln,i,{statistic:0})}}function Un(t){let e,n=Wt(t[1].details)+"";return{c(){e=f("p")},m(t,o){u(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=Wt(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&d(e)}}}function Mn(t){let e,n,o,s,r,i,c,a,p,m,$,w,v,x,C,y,_,E,S,q=t[0].id+"",L=Wt(t[0].quest)+"",T=Wt(t[0].answer)+"";a=new en({props:{question:t[0]}});let V=t[1].details&&Un(t);return{c(){e=f("div"),n=f("div"),o=f("div"),s=f("div"),r=h("Question: "),i=h(q),c=g(),Q(a.$$.fragment),p=g(),m=f("div"),$=f("p"),w=g(),v=f("div"),x=f("h5"),x.textContent="Answer",C=g(),y=f("div"),_=f("p"),E=g(),V&&V.c(),b(s,"class","h5"),b(o,"class","is-flex-spread block"),b(m,"class","card content is-primary"),b(y,"class","card content is-info"),v.hidden=t[2],b(e,"class","grid grid-2")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(o,s),l(s,r),l(s,i),l(o,c),K(a,o,null),l(n,p),l(n,m),l(m,$),$.innerHTML=L,l(e,w),l(e,v),l(v,x),l(v,C),l(v,y),l(y,_),_.innerHTML=T,l(y,E),V&&V.m(y,null),S=!0},p(t,[e]){(!S||1&e)&&q!==(q=t[0].id+"")&&k(i,q);const n={};1&e&&(n.question=t[0]),a.$set(n),(!S||1&e)&&L!==(L=Wt(t[0].quest)+"")&&($.innerHTML=L),(!S||1&e)&&T!==(T=Wt(t[0].answer)+"")&&(_.innerHTML=T),t[1].details?V?V.p(t,e):(V=Un(t),V.c(),V.m(y,null)):V&&(V.d(1),V=null),(!S||4&e)&&(v.hidden=t[2])},i(t){S||(J(a.$$.fragment,t),S=!0)},o(t){W(a.$$.fragment,t),S=!1},d(t){t&&d(e),Y(a),V&&V.d()}}}function jn(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r]}class On extends tt{constructor(t){super(),Z(this,t,jn,Mn,i,{question:0,topic:1,hideAnswer:2})}}function Rn(t){let e,n,o,r,i,c,a,p,m,w,k,v,x,C,y,_,E,S,q,L,T,V,U,M;function j(t,e){return t[0]?An:Bn}let O=j(t),R=O(t);return o=new Vn({props:{statistic:t[3]}}),i=new On({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=f("div"),R.c(),n=g(),Q(o.$$.fragment),r=g(),Q(i.$$.fragment),c=g(),a=f("div"),p=f("button"),m=h("Show"),k=g(),v=f("button"),x=h("Correct"),C=g(),y=f("button"),_=h("Wrong"),E=g(),S=f("button"),q=h("Skip"),L=g(),T=f("button"),T.textContent="Stop",b(p,"class","button"),p.hidden=w=!t[4],b(v,"class","button is-success"),v.hidden=t[4],b(y,"class","button is-danger"),y.hidden=t[4],b(S,"class","button is-warning"),S.hidden=t[4],b(T,"class","button"),b(a,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,d){u(s,e,d),R.m(e,null),l(e,n),K(o,e,null),l(e,r),K(i,e,null),l(e,c),l(e,a),l(a,p),l(p,m),l(a,k),l(a,v),l(v,x),l(a,C),l(a,y),l(y,_),l(a,E),l(a,S),l(S,q),l(a,L),l(a,T),V=!0,U||(M=[$(p,"click",t[10]),$(v,"click",t[11]),$(y,"click",t[12]),$(S,"click",t[13]),$(T,"click",t[7])],U=!0)},p(t,s){O===(O=j(t))&&R?R.p(t,s):(R.d(1),R=O(t),R&&(R.c(),R.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!V||16&s&&w!==(w=!t[4]))&&(p.hidden=w),(!V||16&s)&&(v.hidden=t[4]),(!V||16&s)&&(y.hidden=t[4]),(!V||16&s)&&(S.hidden=t[4])},i(t){V||(J(o.$$.fragment,t),J(i.$$.fragment,t),V=!0)},o(t){W(o.$$.fragment,t),W(i.$$.fragment,t),V=!1},d(t){t&&d(e),R.d(),Y(o),Y(i),U=!1,s(M)}}}function Bn(t){let e,n,o=t[1].title+"";return{c(){e=f("h4"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&k(n,o)},d(t){t&&d(e)}}}function An(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=f("h4"),n=h("Tag: "),o=h(t[0]),s=g(),r=f("h6"),i=h(c)},m(t,c){u(t,e,c),l(e,n),l(e,o),u(t,s,c),u(t,r,c),l(r,i)},p(t,e){1&e&&k(o,t[0]),2&e&&c!==(c=t[1].title+"")&&k(i,c)},d(t){t&&d(e),t&&d(s),t&&d(r)}}}function Nn(t){let e,n,o=t[2]&&Rn(t);return{c(){o&&o.c(),e=m()},m(t,s){o&&o.m(t,s),u(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&J(o,1)):(o=Rn(t),o.c(),J(o,1),o.m(e.parentNode,e)):o&&(D(),W(o,1,1,(()=>{o=null})),z())},i(t){n||(J(o),n=!0)},o(t){W(o),n=!1},d(t){o&&o.d(t),t&&d(e)}}}function Hn(t,e,n){let o,s,r,i,{tag:c}=e,{topics:a}=e,{questions:l}=e,u=!0;var d;!function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong",t[t.Skip=2]="Skip"}(d||(d={}));const p=t=>{if(t===d.Skip)return i.push(s),void f();Kt(s,t===d.Correct),Xt(s).then((()=>{s.progress<3&&i.push(s),0===i.length&&h(),f()}))},f=()=>{const t=i.shift();if(!t)return;n(2,s=t);const e=a.find((t=>t.file===s.file));e&&(n(1,o=e),n(3,r=Qt(l)),n(4,u=!0),console.log("next",s))};L((()=>{i=l.filter((t=>t.progress<3)),$t(i),f()}));const h=async()=>{c?ot.setView("ViewTopicList",{id:""}):(n(1,o.lastLearned=new Date,o),await he(o),ot.setView("ViewTopicList",{id:o.file}))};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(8,a=t.topics),"questions"in t&&n(9,l=t.questions)},[c,o,s,r,u,d,p,h,a,l,()=>n(4,u=!1),()=>p(d.Correct),()=>p(d.Wrong),()=>p(d.Skip)]}class Fn extends tt{constructor(t){super(),Z(this,t,Hn,Nn,i,{tag:0,topics:8,questions:9})}}function Gn(e){let n,o,r,i,c,a,p,m,w,x,C,y,_,E,S,q,L,T,V,U,M,j,O,R,B;return{c(){n=f("h4"),n.textContent="Translate",o=g(),r=f("div"),i=f("label"),c=h(e[0]),a=g(),p=f("textarea"),m=g(),w=f("label"),x=h(e[1]),C=g(),y=f("textarea"),_=g(),E=f("div"),S=f("button"),S.textContent="Back",q=g(),L=f("button"),L.textContent="Translate",T=g(),V=f("button"),V.textContent="Reset",U=g(),M=f("button"),M.textContent="Switch",j=g(),O=f("p"),O.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',b(i,"for","src"),b(p,"id","src"),b(p,"class","input"),b(w,"for","dst"),b(y,"id","dst"),y.readOnly=!0,y.value=e[3],b(y,"class","input"),b(r,"class","block"),b(S,"class","button"),b(L,"class","button"),b(V,"class","button"),b(M,"class","button"),b(E,"class","is-floating")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),l(r,i),l(i,c),l(r,a),l(r,p),v(p,e[2]),l(r,m),l(r,w),l(w,x),l(r,C),l(r,y),u(t,_,s),u(t,E,s),l(E,S),l(E,q),l(E,L),l(E,T),l(E,V),l(E,U),l(E,M),u(t,j,s),u(t,O,s),R||(B=[$(p,"input",e[8]),$(S,"click",e[9]),$(L,"click",e[10]),$(V,"click",e[11]),$(M,"click",e[12])],R=!0)},p(t,[e]){1&e&&k(c,t[0]),4&e&&v(p,t[2]),2&e&&k(x,t[1]),8&e&&(y.value=t[3])},i:t,o:t,d(t){t&&d(n),t&&d(o),t&&d(r),t&&d(_),t&&d(E),t&&d(j),t&&d(O),R=!1,s(B)}}}function Pn(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",a="";const l=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||st.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,a=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=a),l()},d=()=>{n(2,c=""),n(3,a="")},p=()=>{ot.setView("ViewTopicList",{id:""})};return[o,s,c,a,l,u,d,p,function(){c=this.value,n(2,c)},()=>p(),()=>l(),()=>d(),()=>u()]}class In extends tt{constructor(t){super(),Z(this,t,Pn,Gn,i,{})}}function Dn(t,e,n){const o=t.slice();return o[10]=e[n],o}function zn(t){let e,n,o,s,r,i,c,a,p,m,w,v,x,C,y,_=t[10].file+"",E=t[10].value+"",S=dt(t[10].lastLoaded)+"";function q(){return t[7](t[10])}return{c(){e=f("tr"),n=f("td"),o=h(_),s=g(),r=f("td"),i=h(E),c=g(),a=f("td"),p=h(S),m=g(),w=f("td"),v=f("button"),v.textContent="Delete",x=g(),b(v,"class","button")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(e,s),l(e,r),l(r,i),l(e,c),l(e,a),l(a,p),l(e,m),l(e,w),l(w,v),l(e,x),C||(y=$(v,"click",q),C=!0)},p(e,n){t=e,1&n&&_!==(_=t[10].file+"")&&k(o,_),1&n&&E!==(E=t[10].value+"")&&k(i,E),1&n&&S!==(S=dt(t[10].lastLoaded)+"")&&k(p,S)},d(t){t&&d(e),C=!1,y()}}}function Jn(e){let n,o,r,i,c,a,h,m,w,k,v,x,y,_,E,S,q,L=e[0],T=[];for(let t=0;t<L.length;t+=1)T[t]=zn(Dn(e,L,t));return{c(){n=f("div"),o=f("label"),o.textContent="Tag Filter",r=g(),i=f("select"),c=f("option"),c.textContent="By Name",a=f("option"),a.textContent="By Date",h=g(),m=f("button"),m.textContent="Load All",w=g(),k=f("table"),v=f("tr"),v.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",x=g();for(let t=0;t<T.length;t+=1)T[t].c();y=g(),_=f("div"),E=f("button"),E.textContent="Back",b(o,"for","sort-select"),c.__value="file",c.value=c.__value,a.__value="lastLoaded",a.value=a.__value,b(i,"id","sort-select"),void 0===e[1]&&A((()=>e[6].call(i))),b(m,"class","button"),b(n,"class","is-floating"),b(E,"class","button"),b(_,"class","is-floating")},m(t,s){u(t,n,s),l(n,o),l(n,r),l(n,i),l(i,c),l(i,a),C(i,e[1]),l(n,h),l(n,m),u(t,w,s),u(t,k,s),l(k,v),l(k,x);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(k,null);u(t,y,s),u(t,_,s),l(_,E),S||(q=[$(i,"change",e[6]),$(i,"change",e[2]),$(m,"click",e[5]),$(E,"click",e[8])],S=!0)},p(t,[e]){if(2&e&&C(i,t[1]),9&e){let n;for(L=t[0],n=0;n<L.length;n+=1){const o=Dn(t,L,n);T[n]?T[n].p(o,e):(T[n]=zn(o),T[n].c(),T[n].m(k,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}},i:t,o:t,d(t){t&&d(n),t&&d(w),t&&d(k),p(T,t),t&&d(y),t&&d(_),S=!1,s(q)}}}function Wn(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),"file"===s?o.sort(((t,e)=>+(e.file>t.file)||-(e.file<t.file))):o.sort(((t,e)=>+(e.lastLoaded>t.lastLoaded)||-(e.lastLoaded<t.lastLoaded))),n(0,o)},i=async()=>{n(0,o=await Mt()),r()},c=async t=>{await jt(t),i()},a=()=>{ot.setView("ViewTopicList",{id:""})};L((()=>{i()}));return[o,s,r,c,a,async()=>{const t=(await fe()).map((t=>t.file));await ce(t),i()},function(){s=y(this),n(1,s)},t=>c(t.file),()=>a()]}class Qn extends tt{constructor(t){super(),Z(this,t,Wn,Jn,i,{})}}function Kn(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=h("..."),n=h(o)},m(t,o){u(t,e,o),u(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&k(n,o)},d(t){t&&d(e),t&&d(n)}}}function Yn(e){let n,o,s,r,i,c,a,p,m,$,w,b,v,x,C,y,_,E,S,q,L,T,V,U,M,j,O,R,B,A=e[0].langUrl+"",N=e[0].linkUrl+"",H=(e[0].backupUrl?e[0].backupUrl:"")+"",F=(e[0].file?e[0].file:"")+"",G=e[0].token&&Kn(e);return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="Github URL Language",r=g(),i=f("td"),c=h(A),a=g(),p=f("tr"),m=f("td"),m.textContent="Github Link URL",$=g(),w=f("td"),b=h(N),v=g(),x=f("tr"),C=f("td"),C.textContent="Github URL Backup",y=g(),_=f("td"),E=h(H),S=g(),q=f("tr"),L=f("td"),L.textContent="Github File",T=g(),V=f("td"),U=h(F),M=g(),j=f("tr"),O=f("td"),O.textContent="Token",R=g(),B=f("td"),G&&G.c()},m(t,e){u(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,a),l(n,p),l(p,m),l(p,$),l(p,w),l(w,b),l(n,v),l(n,x),l(x,C),l(x,y),l(x,_),l(_,E),l(n,S),l(n,q),l(q,L),l(q,T),l(q,V),l(V,U),l(n,M),l(n,j),l(j,O),l(j,R),l(j,B),G&&G.m(B,null)},p(t,[e]){1&e&&A!==(A=t[0].langUrl+"")&&k(c,A),1&e&&N!==(N=t[0].linkUrl+"")&&k(b,N),1&e&&H!==(H=(t[0].backupUrl?t[0].backupUrl:"")+"")&&k(E,H),1&e&&F!==(F=(t[0].file?t[0].file:"")+"")&&k(U,F),t[0].token?G?G.p(t,e):(G=Kn(t),G.c(),G.m(B,null)):G&&(G.d(1),G=null)},i:t,o:t,d(t){t&&d(n),G&&G.d()}}}function Xn(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class Zn extends tt{constructor(t){super(),Z(this,t,Xn,Yn,i,{admin:0})}}function to(e){let n,o,r,i,c,a,p,m,w,v,C,y,_,E;return{c(){n=f("div"),o=f("div"),r=f("h5"),i=h(e[0]),c=g(),a=f("p"),p=h(e[1]),m=g(),w=f("div"),v=f("button"),v.textContent="OK",C=g(),y=f("button"),y.textContent="Cancel",b(v,"class","button"),b(y,"class","button"),b(w,"class","is-floating"),b(o,"class","popup-content"),b(n,"class","popup"),x(n,"display",e[2]?"block":"none")},m(t,s){u(t,n,s),l(n,o),l(o,r),l(r,i),l(o,c),l(o,a),l(a,p),l(o,m),l(o,w),l(w,v),l(w,C),l(w,y),_||(E=[$(v,"click",e[4]),$(y,"click",e[5])],_=!0)},p(t,[e]){1&e&&k(i,t[0]),2&e&&k(p,t[1]),4&e&&x(n,"display",t[2]?"block":"none")},i:t,o:t,d(t){t&&d(n),_=!1,s(E)}}}function eo(t,e,n){let{title:o=""}=e,{msg:s=""}=e,{doShow:r=!1}=e;const i=V();return t.$$set=t=>{"title"in t&&n(0,o=t.title),"msg"in t&&n(1,s=t.msg),"doShow"in t&&n(2,r=t.doShow)},[o,s,r,i,()=>i("popup","ok"),()=>i("popup","cancel")]}class no extends tt{constructor(t){super(),Z(this,t,eo,to,i,{title:0,msg:1,doShow:2})}}function oo(t){let e,n;return{c(){e=f("div"),n=h(t[2]),b(e,"class","block is-text-success")},m(t,o){u(t,e,o),l(e,n)},p(t,e){4&e&&k(n,t[2])},d(t){t&&d(e)}}}function so(t){let e,n,o,s;const r=[io,ro],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=m()},m(t,n){i[e].m(t,n),u(t,o,n),s=!0},p(t,s){let a=e;e=c(t),e===a?i[e].p(t,s):(D(),W(i[a],1,1,(()=>{i[a]=null})),z(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),J(n,1),n.m(o.parentNode,o))},i(t){s||(J(n),s=!0)},o(t){W(n),s=!1},d(t){i[e].d(t),t&&d(o)}}}function ro(t){let e,n,o,r,i,c,a,p,h,m,w;n=new Zn({props:{admin:t[0]}});let k=t[0].file&&t[0].backupUrl&&t[0].token&&co(t);return{c(){e=f("div"),Q(n.$$.fragment),o=g(),r=f("div"),i=f("button"),i.textContent="Back",c=g(),a=f("button"),a.textContent="Update",p=g(),k&&k.c(),b(i,"class","button"),b(a,"class","button"),b(r,"class","is-floating"),b(e,"class","block")},m(s,d){u(s,e,d),K(n,e,null),l(e,o),l(e,r),l(r,i),l(r,c),l(r,a),l(r,p),k&&k.m(r,null),h=!0,m||(w=[$(i,"click",t[8]),$(a,"click",t[17])],m=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?k?k.p(t,e):(k=co(t),k.c(),k.m(r,null)):k&&(k.d(1),k=null)},i(t){h||(J(n.$$.fragment,t),h=!0)},o(t){W(n.$$.fragment,t),h=!1},d(t){t&&d(e),Y(n),k&&k.d(),m=!1,s(w)}}}function io(e){let n,o,r,i,c,a,p,h,m,k,x,C,y,_,E,S,q,L,T,V,U,M,j,O,R,B,A,N,H,F;return{c(){n=f("form"),o=f("div"),r=f("label"),r.textContent="Github URL Language",i=g(),c=f("input"),a=g(),p=f("label"),p.textContent="Github Link URL",h=g(),m=f("input"),k=g(),x=f("label"),x.textContent="Github URL Backup",C=g(),y=f("input"),_=g(),E=f("label"),E.textContent="Github File",S=g(),q=f("input"),L=g(),T=f("label"),T.textContent="Token",V=g(),U=f("input"),M=g(),j=f("div"),O=f("button"),O.textContent="Save",R=g(),B=f("button"),B.textContent="Cancel",A=g(),N=f("button"),N.textContent="Back",b(r,"for","langUrl"),b(c,"id","langUrl"),b(c,"type","url"),b(c,"class","input"),b(p,"for","linkUrl"),b(m,"id","linkUrl"),b(m,"type","url"),b(m,"class","input"),b(x,"for","backupUrl"),b(y,"id","backupUrl"),b(y,"type","url"),b(y,"class","input"),b(E,"for","file"),b(q,"id","file"),b(q,"type","text"),b(q,"class","input"),b(T,"for","token"),b(U,"id","token"),b(U,"type","password"),b(U,"class","input"),b(o,"class","block"),b(O,"class","button"),b(B,"class","button"),b(N,"class","button"),b(j,"class","is-floating")},m(t,s){u(t,n,s),l(n,o),l(o,r),l(o,i),l(o,c),v(c,e[0].langUrl),l(o,a),l(o,p),l(o,h),l(o,m),v(m,e[0].linkUrl),l(o,k),l(o,x),l(o,C),l(o,y),v(y,e[0].backupUrl),l(o,_),l(o,E),l(o,S),l(o,q),v(q,e[0].file),l(o,L),l(o,T),l(o,V),l(o,U),v(U,e[0].token),l(n,M),l(n,j),l(j,O),l(j,R),l(j,B),l(j,A),l(j,N),H||(F=[$(c,"input",e[11]),$(m,"input",e[12]),$(y,"input",e[13]),$(q,"input",e[14]),$(U,"input",e[15]),$(B,"click",e[16]),$(N,"click",e[8]),$(n,"submit",w(e[7]))],H=!0)},p(t,e){1&e&&c.value!==t[0].langUrl&&v(c,t[0].langUrl),1&e&&m.value!==t[0].linkUrl&&v(m,t[0].linkUrl),1&e&&y.value!==t[0].backupUrl&&v(y,t[0].backupUrl),1&e&&q.value!==t[0].file&&v(q,t[0].file),1&e&&U.value!==t[0].token&&v(U,t[0].token)},i:t,o:t,d(t){t&&d(n),H=!1,s(F)}}}function co(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Backup",o=g(),r=f("button"),r.textContent="Restore",b(n,"class","button"),b(r,"class","button")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),i||(c=[$(n,"click",e[18]),$(r,"click",e[19])],i=!0)},p:t,d(t){t&&d(n),t&&d(o),t&&d(r),i=!1,s(c)}}}function ao(t){let e,n,o,s,r,i,c=t[2]&&oo(t),a=t[0]&&so(t);return r=new no({props:{title:t[4],msg:t[5],doShow:t[6]}}),r.$on("popup",t[10]),{c(){e=f("h4"),e.textContent="Configuration",n=g(),c&&c.c(),o=g(),a&&a.c(),s=g(),Q(r.$$.fragment)},m(t,l){u(t,e,l),u(t,n,l),c&&c.m(t,l),u(t,o,l),a&&a.m(t,l),u(t,s,l),K(r,t,l),i=!0},p(t,[e]){t[2]?c?c.p(t,e):(c=oo(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[0]?a?(a.p(t,e),1&e&&J(a,1)):(a=so(t),a.c(),J(a,1),a.m(s.parentNode,s)):a&&(D(),W(a,1,1,(()=>{a=null})),z());const n={};16&e&&(n.title=t[4]),32&e&&(n.msg=t[5]),64&e&&(n.doShow=t[6]),r.$set(n)},i(t){i||(J(a),J(r.$$.fragment,t),i=!0)},o(t){W(a),W(r.$$.fragment,t),i=!1},d(t){t&&d(e),t&&d(n),c&&c.d(t),t&&d(o),a&&a.d(t),t&&d(s),Y(r,t)}}}function lo(t,e,n){let o=Et.get(),s=!1,r="";const i=async()=>{try{const t=await se(),e=await Ht(t);e.hasError()?(st.addError(`Unable to write backup - ${e.getMessage()}`),n(2,r="Backup FAILED!")):n(2,r="Backup done!")}catch(t){st.addError(`Error on backup - ${t}`)}},c=async()=>{const t=await Nt();t.hasError()?(st.addError(t.getMessage()),n(2,r="Restore FAILED!")):(re(t.getValue()),n(2,r="Restore done!"))};var a;let l,u;!function(t){t[t.Backup=0]="Backup",t[t.Restore=1]="Restore"}(a||(a={}));let d,p=!1;const f=t=>{switch(t){case a.Backup:n(4,l="Information"),n(5,u="Do you realy want to create a backup?"),d=i;break;case a.Restore:n(4,l="Warning"),n(5,u="Do you realy want to restore the backup?"),d=c;break;default:console.log("Unkown type",t)}n(6,p=!0)};return[o,s,r,a,l,u,p,async()=>{if(o.langUrl){const t=await Et.put(o);t.hasError()&&st.addError(`Error on save - ${t.getMessage()}`)}n(1,s=!1)},()=>{ot.setView("ViewTopicList",{id:""})},f,t=>{n(6,p=!1),"ok"===t.detail&&d()},function(){o.langUrl=this.value,n(0,o)},function(){o.linkUrl=this.value,n(0,o)},function(){o.backupUrl=this.value,n(0,o)},function(){o.file=this.value,n(0,o)},function(){o.token=this.value,n(0,o)},()=>n(1,s=!1),()=>n(1,s=!0),()=>f(a.Backup),()=>f(a.Restore)]}class uo extends tt{constructor(t){super(),Z(this,t,lo,ao,i,{})}}function po(t){let e,n;return{c(){e=f("div"),n=h(t[3]),b(e,"class","is-text-danger")},m(t,o){u(t,e,o),l(e,n)},p(t,e){8&e&&k(n,t[3])},d(t){t&&d(e)}}}function fo(t){let e,n,o,s,r,i,c,a;return c=new pn({props:{questions:t[2],details:t[1],goBackFct:t[8]}}),{c(){e=f("div"),n=h("Total: "),o=h(t[4]),s=h(" found: "),r=h(t[5]),i=g(),Q(c.$$.fragment)},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(e,r),u(t,i,d),K(c,t,d),a=!0},p(t,e){(!a||16&e)&&k(o,t[4]),(!a||32&e)&&k(r,t[5]);const n={};4&e&&(n.questions=t[2]),2&e&&(n.details=t[1]),c.$set(n)},i(t){a||(J(c.$$.fragment,t),a=!0)},o(t){W(c.$$.fragment,t),a=!1},d(t){t&&d(e),t&&d(i),Y(c,t)}}}function ho(t){let e,n,o,r,i,c,a,p,h,m,k,x,C,y,_,E,S,q;m=new Te({props:{onClick:t[6]}});let L=t[3]&&po(t),T=0!==t[2].length&&fo(t);return{c(){e=f("h4"),e.textContent="Search",n=g(),o=f("form"),r=f("div"),i=f("label"),i.textContent="Search String",c=g(),a=f("div"),p=f("input"),h=g(),Q(m.$$.fragment),k=g(),L&&L.c(),x=g(),T&&T.c(),C=g(),y=f("div"),_=f("button"),_.textContent="Back",b(i,"for","searchStr"),b(p,"id","searchStr"),b(p,"class","input"),b(a,"class","is-floating"),b(r,"class",""),b(_,"class","button"),b(y,"class","is-floating")},m(s,d){u(s,e,d),u(s,n,d),u(s,o,d),l(o,r),l(r,i),l(r,c),l(r,a),l(a,p),v(p,t[0]),l(a,h),K(m,a,null),l(r,k),L&&L.m(r,null),u(s,x,d),T&&T.m(s,d),u(s,C,d),u(s,y,d),l(y,_),E=!0,S||(q=[$(p,"input",t[9]),$(o,"submit",w(t[6])),$(_,"click",t[7])],S=!0)},p(t,[e]){1&e&&p.value!==t[0]&&v(p,t[0]),t[3]?L?L.p(t,e):(L=po(t),L.c(),L.m(r,null)):L&&(L.d(1),L=null),0!==t[2].length?T?(T.p(t,e),4&e&&J(T,1)):(T=fo(t),T.c(),J(T,1),T.m(C.parentNode,C)):T&&(D(),W(T,1,1,(()=>{T=null})),z())},i(t){E||(J(m.$$.fragment,t),J(T),E=!0)},o(t){W(m.$$.fragment,t),W(T),E=!1},d(t){t&&d(e),t&&d(n),t&&d(o),Y(m),L&&L.d(),t&&d(x),T&&T.d(t),t&&d(C),t&&d(y),S=!1,s(q)}}}const go=30;function mo(t,e,n){let{searchStr:o=""}=e,{details:s=!1}=e,r=[],i="",c=0,a=0;const l=async()=>{console.log("Searching:",o);const t=o.trim();!t||t.length<3?n(3,i="Please enter search string with at least 3 chars!"):(i&&n(3,i=""),n(2,r=[]),n(2,[r,c,a]=await ue(t,go),r,n(4,c),n(5,a)),0===r.length?n(3,i="Nothing found!"):r.length<a&&n(3,i=`More than: ${go} questions found! (Total: ${a})`))};L((()=>{o&&l()}));return t.$$set=t=>{"searchStr"in t&&n(0,o=t.searchStr),"details"in t&&n(1,s=t.details)},[o,s,r,i,c,a,l,()=>{ot.setView("ViewTopicList",{id:""})},()=>{ot.setView("ViewSearch",{searchStr:o,details:!0})},function(){o=this.value,n(0,o)}]}class $o extends tt{constructor(t){super(),Z(this,t,mo,ho,i,{searchStr:0,details:1})}}function wo(e){let n,o,i,c,a,p,m,x,C,y,_,E,S,q,L,T,V,U,M,j,O,R,B,A,N,H,F,G,P,I,D,z=e[0].id+"";return{c(){n=f("div"),o=f("form"),i=f("div"),c=f("h5"),a=h("Question: "),p=h(z),m=g(),x=f("div"),C=f("textarea"),y=g(),_=f("div"),E=f("p"),S=g(),q=f("h5"),q.textContent="Answer",L=g(),T=f("div"),V=f("textarea"),U=g(),M=f("div"),j=f("p"),O=g(),R=f("h5"),R.textContent="Comment",B=g(),A=f("input"),N=g(),H=f("div"),F=f("button"),F.textContent="Back",G=g(),P=f("button"),P.textContent="Save",b(C,"rows","10"),b(C,"id","quest"),b(C,"class","input"),b(_,"class","card content is-primary"),b(x,"class","grid grid-2"),b(V,"rows","10"),b(V,"id","answer"),b(V,"class","input"),b(M,"class","card content is-primary"),b(T,"class","grid grid-2"),b(A,"type","input"),b(A,"class","input"),b(i,"class","block"),b(F,"class","button"),b(P,"class","button"),b(H,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,s){u(t,n,s),l(n,o),l(o,i),l(i,c),l(c,a),l(c,p),l(i,m),l(i,x),l(x,C),v(C,e[2]),l(x,y),l(x,_),l(_,E),E.innerHTML=e[4],l(i,S),l(i,q),l(i,L),l(i,T),l(T,V),v(V,e[3]),l(T,U),l(T,M),l(M,j),j.innerHTML=e[5],l(i,O),l(i,R),l(i,B),l(i,A),v(A,e[6]),l(o,N),l(o,H),l(H,F),l(H,G),l(H,P),I||(D=[$(C,"input",e[8]),$(V,"input",e[9]),$(A,"input",e[10]),$(F,"click",(function(){r(e[1])&&e[1].apply(this,arguments)})),$(o,"submit",w(e[7]))],I=!0)},p(t,[n]){e=t,1&n&&z!==(z=e[0].id+"")&&k(p,z),4&n&&v(C,e[2]),16&n&&(E.innerHTML=e[4]),8&n&&v(V,e[3]),32&n&&(j.innerHTML=e[5]),64&n&&v(A,e[6])},i:t,o:t,d(t){t&&d(n),I=!1,s(D)}}}function bo(t,e,n){let{question:o}=e,{goBackFct:s}=e,r="",i="",c=xt(o.quest),a=xt(o.answer),l=`Update question: '${o.id}' in: '${o.file}'`;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"goBackFct"in t&&n(1,s=t.goBackFct)},t.$$.update=()=>{4&t.$$.dirty&&n(4,r=Wt(vt(c))),8&t.$$.dirty&&n(5,i=Wt(vt(a)))},[o,s,c,a,r,i,l,async()=>{const t=await Gt(o.file);if(t.hasError())return void st.addError(t.getMessage());const e=t.getValue();for(let t=0;t<e.json.length;t++){const n=e.json[t];if(n.id===o.id){n.quest=vt(c),n.answer=vt(a);break}}const n=await Ft(o.file,e.json,e.hash,l);n.hasError()?st.addError(n.getMessage()):(await ie(o.file),await pe(o.file),s())},function(){c=this.value,n(2,c)},function(){a=this.value,n(3,a)},function(){l=this.value,n(6,l)}]}class ko extends tt{constructor(t){super(),Z(this,t,bo,wo,i,{question:0,goBackFct:1})}}function vo(t){let e,n;return e=new Vt({}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function xo(t){let n,o,s,r,i,c,a,p,h,m=0!==t[0].length&&vo();const $=[t[1].props];var w=t[1].component;function k(t){let n={};for(let t=0;t<$.length;t+=1)n=e(n,$[t]);return{props:n}}return w&&(c=_(w,k())),{c(){n=f("div"),o=f("h2"),o.textContent="Cards",s=g(),m&&m.c(),r=g(),i=f("div"),c&&Q(c.$$.fragment),a=g(),p=f("div"),p.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',b(i,"id","main"),b(i,"class","block"),b(p,"class","block"),b(n,"class","container")},m(t,e){u(t,n,e),l(n,o),l(n,s),m&&m.m(n,null),l(n,r),l(n,i),c&&K(c,i,null),l(n,a),l(n,p),h=!0},p(t,[e]){0!==t[0].length?m?1&e&&J(m,1):(m=vo(),m.c(),J(m,1),m.m(n,r)):m&&(D(),W(m,1,1,(()=>{m=null})),z());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}($,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(2&e&&w!==(w=t[1].component)){if(c){D();const t=c;W(t.$$.fragment,1,0,(()=>{Y(t,1)})),z()}w?(c=_(w,k()),Q(c.$$.fragment),J(c.$$.fragment,1),K(c,i,null)):c=null}else w&&c.$set(o)},i(t){h||(J(m),c&&J(c.$$.fragment,t),h=!0)},o(t){W(m),c&&W(c.$$.fragment,t),h=!1},d(t){t&&d(n),m&&m.d(),c&&Y(c)}}}function Co(t,e,n){let o,s;return a(t,st,(t=>n(0,o=t))),a(t,ot,(t=>n(1,s=t))),L((async()=>{ot.views={ViewTopicList:{component:We},ViewTopicInfo:{component:Xe},ViewTopicQuests:{component:mn},ViewTagInfo:{component:_n},ViewTagQuests:{component:qn},ViewQuestAnswer:{component:Fn},ViewTranslate:{component:In},ViewHashes:{component:Qn},ViewAdmin:{component:uo},ViewSearch:{component:$o},ViewQuestEdit:{component:ko}},await Et.init(),await we(),ot.setView("ViewTopicList",{id:""})})),[o,s]}return new class extends tt{constructor(t){super(),Z(this,t,Co,xo,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

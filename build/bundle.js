var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function h(){return p(" ")}function g(){return p("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t){return""===t?null:+t}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function x(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function k(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function _(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let C;function y(t){C=t}function S(){if(!C)throw new Error("Function called outside component initialization");return C}function q(t){S().$$.on_mount.push(t)}function T(){const t=S();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,o,e),s}(e,n,{cancelable:o});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const L=[],E=[],V=[],j=[],U=Promise.resolve();let H=!1;function A(t){V.push(t)}const P=new Set;let B=0;function M(){const t=C;do{for(;B<L.length;){const t=L[B];B++,y(t),N(t.$$)}for(y(null),L.length=0,B=0;E.length;)E.pop()();for(let t=0;t<V.length;t+=1){const e=V[t];P.has(e)||(P.add(e),e())}V.length=0}while(L.length);for(;j.length;)j.pop()();H=!1,P.clear(),y(t)}function N(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;let G;function O(){G={r:0,c:[],p:G}}function R(){G.r||s(G.c),G=G.p}function D(t,e){t&&t.i&&(I.delete(t),t.i(e))}function z(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),G.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function F(t){t&&t.c()}function Q(t,e,o,i){const{fragment:c,on_mount:l,on_destroy:a,after_update:u}=t.$$;c&&c.m(e,o),i||A((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(A)}function J(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(L.push(t),H||(H=!0,U.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,n,r,i,c,l,a,d=[-1]){const f=C;y(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:d,skip_bound:!1,root:n.target||f.$$.root};a&&a(p.root);let h=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),h&&W(e,t)),n})):[],p.update(),h=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();n.intro&&D(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),M()}y(f)}class Y{$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const X=[];function Z(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!X.length;for(const t of s)t[1](),X.push(t,e);if(t){for(let t=0;t<X.length;t+=2)X[t][0](X[t+1]);X.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const tt=(()=>{const{subscribe:t,set:e}=Z({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=tt.views[t];o.props=n,e(o)}}})(),et=(()=>{const{subscribe:t,set:e,update:n}=Z([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})();function nt(t,e,n){const o=t.slice();return o[2]=e[n],o}function ot(t){let e,n,o=t[2]+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&w(n,o)},d(t){t&&u(e)}}}function st(e){let n,o,s,r,i,c,p,g,$,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=ot(nt(e,w,t));return{c(){n=f("div"),o=f("h4"),o.textContent="Errors",s=h(),r=f("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=h(),c=f("div"),p=f("button"),p.textContent="Ok",b(o,"class","is-text-danger"),b(p,"class","button"),b(c,"class","is-floating"),b(n,"class","card card-shadow block content")},m(t,u){a(t,n,u),l(n,o),l(n,s),l(n,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);l(n,i),l(n,c),l(c,p),g||($=m(p,"click",e[1]),g=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=nt(t,w,n);v[n]?v[n].p(o,e):(v[n]=ot(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&u(n),d(v,t),g=!1,$()}}}function rt(t,e,n){let o;c(t,et,(t=>n(0,o=t)));return[o,()=>{et.resetErrors()}]}class it extends Y{constructor(t){super(),K(this,t,rt,st,i,{})}}const ct=t=>{et.addError(t.type)},lt=new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=e=>{const o=n.result;e.oldVersion<4&&(t=>{if(t.objectStoreNames.contains("topics")||t.createObjectStore("topics",{keyPath:"file"}),!t.objectStoreNames.contains("questions")){const e=t.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});e.indexNames.contains("file")||e.createIndex("file","file",{unique:!1})}t.objectStoreNames.contains("hash")||(t.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}),t.objectStoreNames.contains("admin")||t.createObjectStore("admin",{keyPath:"config"}),t.objectStoreNames.contains("config")&&t.deleteObjectStore("config")})(o),t(o)},n.onerror=t=>{et.addError(t.type),e()},n.onsuccess=()=>{const e=n.result;e.onerror=ct,console.log("db init success!"),t(e)}})),at=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=()=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),ut=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=()=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),dt=t=>new Promise(((e,n)=>{lt.then((o=>{const s=o.transaction(["hash"],"readonly").objectStore("hash"),r=s.get(t);r.onsuccess=()=>{const n=r.result?r.result:{file:t};console.log("Store:",s.name,"get:",n),e(n)},r.onerror=e=>{console.log("Store:",s.name,"get:",t,"error",e),n()}}))})),ft=(t,e)=>{const n=t.objectStore("hash");return at(n,e)},pt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},ht=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},gt=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},mt=t=>{for(let o=0;o<t.length;o++){const s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;const r=t[o];t[o]=t[s],t[s]=r}var e,n};function bt(t){return t instanceof Error?t.message:String(t)}const $t=()=>new Promise((t=>{lt.then((e=>{const n=e.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=()=>{let e=n.result;e||(e={config:"admin",langUrl:"https://api.github.com/repos/dead-end/cards-russian/contents/",backupUrl:"",file:"",token:""}),t(e)}}))})),wt=t=>{try{return JSON.parse((e=t,decodeURIComponent(escape(window.atob(e)))))}catch(t){et.addError(`githubParseContent - unable to parse json content: ${t}`)}var e},vt=t=>{const e={Accept:"application/vnd.github.v3+json"};return t&&t.token&&(e.authorization=`token ${t.token}`),e},xt=async()=>{const t=await $t();return{backupUrl:t.backupUrl+t.file+".json",headers:vt(t)}},kt=async(t,e)=>{const n=await fetch(t,{method:"HEAD",headers:e}).catch((e=>{et.addError(`githubGetEtag - url: ${t} error: ${e}`)}));if(!n||404===n.status)return;if(!n.ok)return void et.addError(`githubGetEtag - url: ${t} error: ${n.statusText}`);const o=n.headers.get("ETag");if(!o)return;const s=o.startsWith("W/")?3:1;return o.substring(s,o.length-1)},_t=async(t,e)=>{const n=await fetch(t,e).catch((e=>{et.addError(`githubGetJsonContent - url: ${t} error: ${e}`)}));if(n){if(n.ok)return n.json();et.addError(`githubGetJsonContent - url: ${t} error: ${n.statusText}`)}},Ct=async t=>{const{fileUrl:e,headers:n}=await(async t=>{const e=await $t();return{fileUrl:e.langUrl+t,headers:vt(e)}})(t);let o=await dt(t);if(o.value){const t=await(async(t,e,n)=>{const o=await kt(t,e);if(!o)return!1;const s=o===n;return console.log("url :",t,"ETag",o,"hash",n,"matches",s),s})(e,n,o.value);if(t)return}const s=await _t(e,n);if(!s)return;const r=wt(s.content);return r?(o.value=s.sha,o.lastLoaded=new Date,await(t=>new Promise(((e,n)=>{lt.then((o=>{const s=o.transaction(["hash"],"readwrite").objectStore("hash"),r=s.put(t);r.onsuccess=()=>{console.log("Store:",s.name,"put:",t),e()},r.onerror=e=>{console.log("Store:",s.name,"put:",t,"error",e),n()}}))})))(o),console.log("githubGetJson",r),r):void 0},yt=(t,e)=>((t,e,n,o)=>new Promise((s=>{const r=t.objectStore(e),i=r.index(n).getAllKeys(o);i.onsuccess=()=>{i.result.forEach((t=>{at(r,t)})),s()}})))(t,"questions","file",e),St=async t=>{const e=(await lt).transaction(["questions"],"readonly").objectStore("questions");return qt(e,t)},qt=(t,e)=>new Promise((n=>{const o=t.index("file").getAll(e.file);o.onsuccess=()=>{n(o.result)}})),Tt=async(t,e)=>{const n=(await lt).transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,new Promise((e=>{n.put(t).onsuccess=()=>{e()}})))));await Promise.all(o)},Lt=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=()=>{const t=jt(n),r=jt(s.result);r.forEach((e=>{t.has(e.id)||at(o,e.id)})),t.forEach((t=>{const n=r.get(t.id);n?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(n,t),ut(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=()=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},Et=async t=>{const e=(await lt).transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];((t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=()=>{n(s.result)},s.onerror=e=>{console.log("Store:",t.name,"questGet:",e),o()}})))(e,n).then((t=>{t&&t.total<s&&(t.failed=o,t.total=s,t.ratio=gt(t.failed,t.total),ut(e,t))}))}))},Vt=async t=>{const e=await Ct(t);if(e){const n=(await lt).transaction(["questions"],"readwrite");Lt(n,t,e)}},jt=t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e},Ut=()=>new Promise(((t,e)=>{lt.then((n=>{const o=n.transaction(["topics"],"readonly").objectStore("topics"),s=o.getAll();s.onsuccess=()=>{console.log("Store:",o.name,"topicGetAll:"),t(s.result)},s.onerror=t=>{console.log("Store:",o.name,"topicGetAll error:",t),e()}}))})),Ht=(t,e)=>{const n=t.objectStore("topics");at(n,e)},At=async t=>{const e=(await lt).transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=()=>{const s=Pt(o.result),r=t.map((t=>t.file));for(const t of s.keys())r.includes(t)||(Ht(e,t),ft(e,t),yt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!ht(t.tags,e.tags)||!ht(t.details,e.details)))(t,s.get(t.file))&&ut(n,t)}))}},Pt=t=>{const e=new Map;return t.forEach((t=>{e.set(t.file,t)})),e};function Bt(t){let e,n,o,s,r,i,c,d,m,b,$,v,x,k,_=t[4]&&Mt(t);return{c(){e=f("tr"),n=f("td"),n.textContent="Questions",o=h(),s=f("td"),r=p(t[2]),i=h(),c=f("tr"),d=f("td"),d.textContent="Status",m=h(),b=f("td"),$=p(t[1]),v=p("%"),x=h(),_&&_.c(),k=g()},m(t,u){a(t,e,u),l(e,n),l(e,o),l(e,s),l(s,r),a(t,i,u),a(t,c,u),l(c,d),l(c,m),l(c,b),l(b,$),l(b,v),a(t,x,u),_&&_.m(t,u),a(t,k,u)},p(t,e){4&e&&w(r,t[2]),2&e&&w($,t[1]),t[4]?_?_.p(t,e):(_=Mt(t),_.c(),_.m(k.parentNode,k)):_&&(_.d(1),_=null)},d(t){t&&u(e),t&&u(i),t&&u(c),t&&u(x),_&&_.d(t),t&&u(k)}}}function Mt(t){let e,n,o,s,r,i,c,d,g,m,b,$=pt(t[4].lastLoaded)+"",v=(t[4].value?t[4].value:"")+"";return{c(){e=f("tr"),n=f("td"),n.textContent="Last loaded",o=h(),s=f("td"),r=p($),i=h(),c=f("tr"),d=f("td"),d.textContent="Hash",g=h(),m=f("td"),b=p(v)},m(t,u){a(t,e,u),l(e,n),l(e,o),l(e,s),l(s,r),a(t,i,u),a(t,c,u),l(c,d),l(c,g),l(c,m),l(m,b)},p(t,e){16&e&&$!==($=pt(t[4].lastLoaded)+"")&&w(r,$),16&e&&v!==(v=(t[4].value?t[4].value:"")+"")&&w(b,v)},d(t){t&&u(e),t&&u(i),t&&u(c)}}}function Nt(t){let e,n,o=t[0].desc+"";return{c(){e=f("p"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&w(n,o)},d(t){t&&u(e)}}}function It(e){let n,o,s,r,i,c,d,m,b,$,v,x,k,_,C,y,S,q,T=e[0].title+"",L=pt(e[0].lastLearned)+"",E=e[0].tags.join(", ")+"",V=e[3]&&Bt(e),j=e[0].desc&&Nt(e);return{c(){n=f("h4"),o=p(T),s=h(),r=f("table"),i=f("tr"),c=f("td"),c.textContent="Last learned",d=h(),m=f("td"),b=p(L),$=h(),v=f("tr"),x=f("td"),x.textContent="Tags",k=h(),_=f("td"),C=p(E),y=h(),V&&V.c(),S=h(),j&&j.c(),q=g()},m(t,e){a(t,n,e),l(n,o),a(t,s,e),a(t,r,e),l(r,i),l(i,c),l(i,d),l(i,m),l(m,b),l(r,$),l(r,v),l(v,x),l(v,k),l(v,_),l(_,C),l(r,y),V&&V.m(r,null),a(t,S,e),j&&j.m(t,e),a(t,q,e)},p(t,[e]){1&e&&T!==(T=t[0].title+"")&&w(o,T),1&e&&L!==(L=pt(t[0].lastLearned)+"")&&w(b,L),1&e&&E!==(E=t[0].tags.join(", ")+"")&&w(C,E),t[3]?V?V.p(t,e):(V=Bt(t),V.c(),V.m(r,null)):V&&(V.d(1),V=null),t[0].desc?j?j.p(t,e):(j=Nt(t),j.c(),j.m(q.parentNode,q)):j&&(j.d(1),j=null)},i:t,o:t,d(t){t&&u(n),t&&u(s),t&&u(r),V&&V.d(),t&&u(S),j&&j.d(t),t&&u(q)}}}function Gt(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return q((async()=>{c&&n(4,o=await dt(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}(async()=>{const t=await Ct("data/topics.json");t&&At(t)})();class Ot extends Y{constructor(t){super(),K(this,t,Gt,It,i,{topic:0,status:1,size:2,details:3})}}function Rt(t){let e,n,o,s,r,i,c,d,p;return n=new Ot({props:{topic:t[0],details:!1}}),{c(){e=f("div"),F(n.$$.fragment),o=h(),s=f("div"),r=f("button"),r.textContent="Show",b(r,"class","button"),b(s,"class","is-floating"),b(e,"class","card card-shadow content"),b(e,"id",i=t[0].file)},m(i,u){a(i,e,u),Q(n,e,null),l(e,o),l(e,s),l(s,r),c=!0,d||(p=m(r,"click",t[2]),d=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&b(e,"id",i)},i(t){c||(D(n.$$.fragment,t),c=!0)},o(t){z(n.$$.fragment,t),c=!1},d(t){t&&u(e),J(n),d=!1,p()}}}function Dt(t,e,n){let{topic:o}=e;const s=t=>{tt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class zt extends Y{constructor(t){super(),K(this,t,Dt,Rt,i,{topic:0})}}function Ft(t,e,n){const o=t.slice();return o[13]=e[n],o}function Qt(t,e,n){const o=t.slice();return o[16]=e[n],o}function Jt(t){let e,n,o,r,i,c,p,g,$,w,v,x,_,C,y,S,q,T,L,E,V=t[1],j=[];for(let e=0;e<V.length;e+=1)j[e]=Wt(Qt(t,V,e));let U=t[2]&&Kt(t);return{c(){e=f("div"),n=f("label"),n.textContent="Sort",o=h(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Last learned",p=h(),g=f("label"),g.textContent="Tag Filter",$=h(),w=f("select"),v=f("option"),v.textContent="-- Select --";for(let t=0;t<j.length;t+=1)j[t].c();x=h(),U&&U.c(),_=h(),C=f("button"),C.textContent="Translate",y=h(),S=f("button"),S.textContent="Hashes",q=h(),T=f("button"),T.textContent="Admin",b(n,"class","is-valign-center"),b(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,b(r,"id","sort-select"),void 0===t[3]&&A((()=>t[6].call(r))),b(g,"for","tag-select"),v.__value="",v.value=v.__value,b(w,"id","tag-select"),void 0===t[2]&&A((()=>t[7].call(w))),b(C,"class","button"),b(S,"class","button"),b(T,"class","button"),b(e,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),k(r,t[3]),l(e,p),l(e,g),l(e,$),l(e,w),l(w,v);for(let t=0;t<j.length;t+=1)j[t].m(w,null);k(w,t[2]),l(e,x),U&&U.m(e,null),l(e,_),l(e,C),l(e,y),l(e,S),l(e,q),l(e,T),L||(E=[m(r,"change",t[6]),m(r,"change",t[4]),m(w,"change",t[7]),m(w,"change",t[4]),m(C,"click",t[9]),m(S,"click",t[10]),m(T,"click",t[11])],L=!0)},p(t,n){if(8&n&&k(r,t[3]),2&n){let e;for(V=t[1],e=0;e<V.length;e+=1){const o=Qt(t,V,e);j[e]?j[e].p(o,n):(j[e]=Wt(o),j[e].c(),j[e].m(w,null))}for(;e<j.length;e+=1)j[e].d(1);j.length=V.length}6&n&&k(w,t[2]),t[2]?U?U.p(t,n):(U=Kt(t),U.c(),U.m(e,_)):U&&(U.d(1),U=null)},d(t){t&&u(e),d(j,t),U&&U.d(),L=!1,s(E)}}}function Wt(t){let e,n,o,s=t[16]+"";return{c(){e=f("option"),n=p(s),e.__value=o=t[16],e.value=e.__value},m(t,o){a(t,e,o),l(e,n)},p(t,r){2&r&&s!==(s=t[16]+"")&&w(n,s),2&r&&o!==(o=t[16])&&(e.__value=o,e.value=e.__value)},d(t){t&&u(e)}}}function Kt(e){let n,o,s;return{c(){n=f("button"),n.textContent="Show",b(n,"class","button")},m(t,r){a(t,n,r),o||(s=m(n,"click",e[8]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function Yt(t){let e,n;return e=new zt({props:{topic:t[13]}}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[13]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function Xt(t){let e,n,o,s=t[1]&&Jt(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Yt(Ft(t,r,e));const c=t=>z(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=h(),n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();b(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),a(t,e,r),a(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?s.p(t,o):(s=Jt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Ft(t,r,e);i[e]?(i[e].p(s,o),D(i[e],1)):(i[e]=Yt(s),i[e].c(),D(i[e],1),i[e].m(n,null))}for(O(),e=r.length;e<i.length;e+=1)c(e);R()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)D(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)z(i[t]);o=!1},d(t){s&&s.d(t),t&&u(e),t&&u(n),d(i,t)}}}function Zt(t,e,n){let o,s,r,{id:i}=e,c=[],l=[];var a;q((()=>{Ut().then((t=>{c=t,n(0,l=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(c))}))})),a=()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}},S().$$.after_update.push(a);return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[l,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,l=t)},i,function(){r=_(this),n(3,r)},function(){s=_(this),n(2,s),n(1,o)},()=>tt.setView("ViewTagInfo",{tag:s,topics:l}),()=>tt.setView("ViewTranslate"),()=>tt.setView("ViewHashes"),()=>tt.setView("ViewAdmin")]}class te extends Y{constructor(t){super(),K(this,t,Zt,Xt,i,{id:5})}}class ee{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&et.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class ne{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new ee(t,e)}_pattern(){let t="";for(const e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return t in this.map||et.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(const e in this.map)this.map[e].check(t)}_substitute(t){return t.replaceAll(this.regex,(t=>this.tag(t)))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(const o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}}function oe(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=f("div"),n=f("h5"),n.textContent="Details",o=h(),s=f("div"),r=f("p"),b(s,"class","card content is-info"),b(e,"class","block")},m(t,c){a(t,e,c),l(e,n),l(e,o),l(e,s),l(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&u(e)}}}function se(t){let e,n,o,r,i,c,d,g,$,w,v,x,k,_,C,y,S,q,T,L,E,V,j,U,H,A;r=new Ot({props:{topic:t[0],status:t[1],size:t[3]}});let P=t[0].details&&oe(t);return{c(){e=f("div"),n=f("div"),o=f("div"),F(r.$$.fragment),i=h(),c=f("div"),d=f("label"),d.textContent="Number of correct answers",g=h(),$=f("select"),w=f("option"),w.textContent="-- Select --",v=f("option"),v.textContent="Set 0",x=f("option"),x.textContent="Set 1",k=f("option"),k.textContent="Set 2",_=f("option"),_.textContent="Set 3",C=h(),P&&P.c(),y=h(),S=f("div"),q=f("button"),q.textContent="Back",T=h(),L=f("button"),L.textContent="Listing",E=h(),V=f("button"),j=p("Start"),b(o,"class","is-text-left"),b(d,"for","sf-set"),w.__value="",w.value=w.__value,v.__value="0",v.value=v.__value,x.__value="1",x.value=x.__value,k.__value="2",k.value=k.__value,_.__value="3",_.value=_.__value,b($,"id","sf-set"),b(c,"class","is-floating"),b(q,"class","button"),b(L,"class","button"),b(V,"class","button"),V.disabled=t[2],b(S,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,u){a(s,e,u),l(e,n),l(n,o),Q(r,o,null),l(n,i),l(n,c),l(c,d),l(c,g),l(c,$),l($,w),l($,v),l($,x),l($,k),l($,_),l(n,C),P&&P.m(n,null),l(e,y),l(e,S),l(S,q),l(S,T),l(S,L),l(S,E),l(S,V),l(V,j),U=!0,H||(A=[m($,"change",t[8]),m(q,"click",t[5]),m(L,"click",t[6]),m(V,"click",t[7])],H=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?P?P.p(t,e):(P=oe(t),P.c(),P.m(n,null)):P&&(P.d(1),P=null),(!U||4&e)&&(V.disabled=t[2])},i(t){U||(D(r.$$.fragment,t),U=!0)},o(t){z(r.$$.fragment,t),U=!1},d(t){t&&u(e),J(r),P&&P.d(),H=!1,s(A)}}}function re(t,e,n){let{topic:o}=e,{questions:s}=e;const r=new ne;let i=0,c=!0,l=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return gt(n,t.length*e)})(t,3)),n(2,c=((t,e)=>{for(const n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,l=t.length)};q((async()=>{try{s||(await Vt(o.file),console.log("Loading questions for topics"),n(9,s=await St(o)),a())}catch(t){et.addError("ViewTopicInfo: "+bt(t))}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,l,r,()=>{tt.setView("ViewTopicList",{id:o.file})},()=>{tt.setView("ViewTopicQuests",{topic:o})},()=>{tt.setView("ViewQuestAnswer",{topics:[o],questions:s})},async t=>{if(!s)return;const e=t.target;await Tt(s,e.selectedIndex-1),e.selectedIndex=0,a()},s]}class ie extends Y{constructor(t){super(),K(this,t,re,se,i,{topic:0,questions:9})}}function ce(e){let n,o,s,r,i,c,d,g,m,$,v,x,k,_,C,y=e[0].progress+"",S=e[0].total+"",q=e[0].ratio+"";return{c(){n=f("div"),o=p("Progress: "),s=f("span"),r=p(y),i=p(" /\n  "),c=f("span"),c.textContent="3",d=h(),g=f("span"),m=p("Total: "),$=f("span"),v=p(S),x=p(" Wrong:\n    "),k=f("span"),_=p(q),C=p("%"),b(s,"class","is-text-success"),b(c,"class","is-text-success"),b($,"class","is-text-success"),b(k,"class","is-text-danger"),b(g,"class","hide-sm"),b(n,"class","h6")},m(t,e){a(t,n,e),l(n,o),l(n,s),l(s,r),l(n,i),l(n,c),l(n,d),l(n,g),l(g,m),l(g,$),l($,v),l(g,x),l(g,k),l(k,_),l(k,C)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&w(r,y),1&e&&S!==(S=t[0].total+"")&&w(v,S),1&e&&q!==(q=t[0].ratio+"")&&w(_,q)},i:t,o:t,d(t){t&&u(n)}}}function le(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class ae extends Y{constructor(t){super(),K(this,t,le,ce,i,{question:0})}}function ue(t,e,n){const o=t.slice();return o[9]=e[n],o}function de(t){let e,n,o,s,r,i="2"===t[0]&&fe(t);return s=new ae({props:{question:t[9]}}),{c(){e=f("div"),n=f("div"),i&&i.c(),o=h(),F(s.$$.fragment),b(e,"class","is-flex-spread grid-full")},m(t,c){a(t,e,c),l(e,n),i&&i.m(n,null),l(e,o),Q(s,e,null),r=!0},p(t,e){"2"===t[0]?i?i.p(t,e):(i=fe(t),i.c(),i.m(n,null)):i&&(i.d(1),i=null);const o={};2&e&&(o.question=t[9]),s.$set(o)},i(t){r||(D(s.$$.fragment,t),r=!0)},o(t){z(s.$$.fragment,t),r=!1},d(t){t&&u(e),i&&i.d(),J(s)}}}function fe(t){let e,n,o,s,r,i,c=t[9].id+"",d=t[9].file+"";return{c(){e=f("span"),n=p("Id: "),o=p(c),s=h(),r=f("span"),i=p(d),b(e,"class","h6"),b(r,"class","hide-sm")},m(t,c){a(t,e,c),l(e,n),l(e,o),a(t,s,c),a(t,r,c),l(r,i)},p(t,e){2&e&&c!==(c=t[9].id+"")&&w(o,c),2&e&&d!==(d=t[9].file+"")&&w(i,d)},d(t){t&&u(e),t&&u(s),t&&u(r)}}}function pe(t){let e,n,o,s,r,i,c,d,p,g,m,$,w=t[3].toHtml(t[9].quest)+"",v=t[3].toHtml(t[9].answer)+"",x=("1"===t[0]||"2"===t[0])&&de(t);return{c(){x&&x.c(),e=h(),n=f("div"),o=f("div"),s=f("p"),i=h(),c=f("div"),d=f("div"),p=f("p"),g=h(),b(o,"class","content"),b(n,"class",r="card "+t[5]()),b(d,"class","content"),b(c,"class",m="card "+t[5]())},m(t,r){x&&x.m(t,r),a(t,e,r),a(t,n,r),l(n,o),l(o,s),s.innerHTML=w,a(t,i,r),a(t,c,r),l(c,d),l(d,p),p.innerHTML=v,l(c,g),$=!0},p(t,n){"1"===t[0]||"2"===t[0]?x?(x.p(t,n),1&n&&D(x,1)):(x=de(t),x.c(),D(x,1),x.m(e.parentNode,e)):x&&(O(),z(x,1,1,(()=>{x=null})),R()),(!$||2&n)&&w!==(w=t[3].toHtml(t[9].quest)+"")&&(s.innerHTML=w),(!$||2&n)&&v!==(v=t[3].toHtml(t[9].answer)+"")&&(p.innerHTML=v)},i(t){$||(D(x),$=!0)},o(t){z(x),$=!1},d(t){x&&x.d(t),t&&u(e),t&&u(n),t&&u(i),t&&u(c)}}}function he(t){let e,n,o,r,i,c,p,g,$,w,v,x,_,C,y,S,q,T,L,E=t[1],V=[];for(let e=0;e<E.length;e+=1)V[e]=pe(ue(t,E,e));const j=t=>z(V[t],1,1,(()=>{V[t]=null}));return{c(){e=f("div"),n=f("label"),n.textContent="Details",o=h(),r=f("select"),i=f("option"),i.textContent="Simple",c=f("option"),c.textContent="Progress",p=f("option"),p.textContent="ID's",g=h(),$=f("label"),$.textContent="Tag Filter",w=h(),v=f("select"),x=f("option"),x.textContent="-- Select --",_=f("option"),_.textContent="Total",C=f("option"),C.textContent="Ratio",y=h(),S=f("div");for(let t=0;t<V.length;t+=1)V[t].c();b(n,"for","details-select"),i.__value="0",i.value=i.__value,c.__value="1",c.value=c.__value,p.__value="2",p.value=p.__value,b(r,"id","details-select"),void 0===t[0]&&A((()=>t[7].call(r))),b($,"for","quest-sort"),x.__value="",x.value=x.__value,_.__value="total",_.value=_.__value,C.__value="ratio",C.value=C.__value,b(v,"id","quest-sort"),void 0===t[2]&&A((()=>t[8].call(v))),b(e,"class","is-floating"),b(S,"class","grid grid-2")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),l(r,p),k(r,t[0]),l(e,g),l(e,$),l(e,w),l(e,v),l(v,x),l(v,_),l(v,C),k(v,t[2]),a(s,y,u),a(s,S,u);for(let t=0;t<V.length;t+=1)V[t].m(S,null);q=!0,T||(L=[m(r,"change",t[7]),m(v,"change",t[8]),m(v,"change",t[4])],T=!0)},p(t,[e]){if(1&e&&k(r,t[0]),4&e&&k(v,t[2]),43&e){let n;for(E=t[1],n=0;n<E.length;n+=1){const o=ue(t,E,n);V[n]?(V[n].p(o,e),D(V[n],1)):(V[n]=pe(o),V[n].c(),D(V[n],1),V[n].m(S,null))}for(O(),n=E.length;n<V.length;n+=1)j(n);R()}},i(t){if(!q){for(let t=0;t<E.length;t+=1)D(V[t]);q=!0}},o(t){V=V.filter(Boolean);for(let t=0;t<V.length;t+=1)z(V[t]);q=!1},d(t){t&&u(e),t&&u(y),t&&u(S),d(V,t),T=!1,s(L)}}}function ge(t,e,n){let{questions:o}=e,s="0",r=[],i="";const c=new ne;q((()=>{console.log("questions",o),n(1,r=o)}));const l=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(6,o=t.questions)},[s,r,i,c,()=>{if(!i)return void n(1,r=o);let t=[...o];"ratio"===i?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===i&&t.sort(((t,e)=>e.total-t.total)),n(1,r=t)},l,o,function(){s=_(this),n(0,s)},function(){i=_(this),n(2,i)}]}class me extends Y{constructor(t){super(),K(this,t,ge,he,i,{questions:6})}}function be(t){let e,n;return e=new me({props:{questions:t[1]}}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function $e(t){let e,n,o,s,r,i,c,d,g,$,v=t[0].title+"",x=0!==t[1].length&&be(t);return{c(){e=f("div"),n=f("h4"),o=p(v),s=h(),x&&x.c(),r=h(),i=f("div"),c=f("button"),c.textContent="Back",b(c,"class","button"),b(i,"class","is-floating"),b(e,"class","card card-shadow content")},m(u,f){a(u,e,f),l(e,n),l(n,o),l(e,s),x&&x.m(e,null),l(e,r),l(e,i),l(i,c),d=!0,g||($=m(c,"click",t[3]),g=!0)},p(t,[n]){(!d||1&n)&&v!==(v=t[0].title+"")&&w(o,v),0!==t[1].length?x?(x.p(t,n),2&n&&D(x,1)):(x=be(t),x.c(),D(x,1),x.m(e,r)):x&&(O(),z(x,1,1,(()=>{x=null})),R())},i(t){d||(D(x),d=!0)},o(t){z(x),d=!1},d(t){t&&u(e),x&&x.d(),g=!1,$()}}}function we(t,e,n){let{topic:o}=e,s=[];q((()=>{St(o).then((t=>{n(1,s=t)}))}));const r=t=>{tt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class ve extends Y{constructor(t){super(),K(this,t,we,$e,i,{topic:0})}}function xe(t,e,n){const o=t.slice();return o[16]=e[n],o}function ke(t){let e,n,o=t[16].title+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[16].title+"")&&w(n,o)},d(t){t&&u(e)}}}function _e(t){let e,n,o,r,i,c,d,p,g,$;return{c(){e=f("div"),n=f("label"),n.textContent="Number of correct answers",o=h(),r=f("select"),i=f("option"),i.textContent="-- Select --",c=f("option"),c.textContent="Set 0",d=f("option"),d.textContent="Set 1",p=f("option"),p.textContent="Set 2",b(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,d.__value="1",d.value=d.__value,p.__value="2",p.value=p.__value,b(r,"id","sf-set"),void 0===t[5]&&A((()=>t[15].call(r))),b(e,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),l(r,d),l(r,p),k(r,t[5]),g||($=[m(r,"change",t[15]),m(r,"change",t[9])],g=!0)},p(t,e){32&e&&k(r,t[5])},d(t){t&&u(e),g=!1,s($)}}}function Ce(t){let e,n,o,r,i,c,d,p,g,w,x,_,C;return{c(){e=f("div"),n=f("label"),n.textContent="Load Questions",o=h(),r=f("select"),i=f("option"),i.textContent="30",c=f("option"),c.textContent="All",d=h(),p=f("div"),g=f("label"),g.textContent="Fraction",w=h(),x=f("input"),b(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,b(r,"id","load-quests"),void 0===t[2]&&A((()=>t[13].call(r))),b(e,"class","is-floating"),b(g,"for","relevant"),b(x,"id","relevant"),b(x,"type","number"),b(x,"min","0.2"),b(x,"max","1"),b(x,"step","0.2"),b(p,"class","is-floating")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),k(r,t[2]),a(s,d,u),a(s,p,u),l(p,g),l(p,w),l(p,x),v(x,t[3]),_||(C=[m(r,"change",t[13]),m(x,"input",t[14]),m(x,"input",t[11])],_=!0)},p(t,e){4&e&&k(r,t[2]),8&e&&$(x.value)!==t[3]&&v(x,t[3])},d(t){t&&u(e),t&&u(d),t&&u(p),_=!1,s(C)}}}function ye(e){let n,o,s;return{c(){n=f("button"),n.textContent="Load",b(n,"class","button")},m(t,r){a(t,n,r),o||(s=m(n,"click",e[10]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function Se(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Listing",o=h(),r=f("button"),r.textContent="Start",b(n,"class","button"),b(r,"class","button")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),i||(c=[m(n,"click",e[6]),m(r,"click",e[8])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function qe(e){let n,o,s,r,i,c,g,$,v,x,k,_,C,y,S,q,T,L=e[1],E=[];for(let t=0;t<L.length;t+=1)E[t]=ke(xe(e,L,t));function V(t,e){return t[4]?_e:Ce}let j=V(e),U=j(e);function H(t,e){return t[4]?Se:ye}let A=H(e),P=A(e);return{c(){n=f("div"),o=f("div"),s=f("div"),r=f("h4"),i=p("Tag: "),c=p(e[0]),g=h(),$=f("p"),$.textContent="Files incluging the tag:",v=h(),x=f("ul");for(let t=0;t<E.length;t+=1)E[t].c();k=h(),U.c(),_=h(),C=f("div"),y=f("button"),y.textContent="Back",S=h(),P.c(),b(s,"class","is-text-left"),b(y,"class","button"),b(C,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,u){a(t,n,u),l(n,o),l(o,s),l(s,r),l(r,i),l(r,c),l(s,g),l(s,$),l(s,v),l(s,x);for(let t=0;t<E.length;t+=1)E[t].m(x,null);l(n,k),U.m(n,null),l(n,_),l(n,C),l(C,y),l(C,S),P.m(C,null),q||(T=m(y,"click",e[7]),q=!0)},p(t,[e]){if(1&e&&w(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=xe(t,L,n);E[n]?E[n].p(o,e):(E[n]=ke(o),E[n].c(),E[n].m(x,null))}for(;n<E.length;n+=1)E[n].d(1);E.length=L.length}j===(j=V(t))&&U?U.p(t,e):(U.d(1),U=j(t),U&&(U.c(),U.m(n,_))),A===(A=H(t))&&P?P.p(t,e):(P.d(1),P=A(t),P&&(P.c(),P.m(C,null)))},i:t,o:t,d(t){t&&u(n),d(E,t),U.d(),P.d(),q=!1,T()}}}function Te(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i}=e,c="30",l=.8,a=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(12,i=t.questions)},[s,r,c,l,a,o,()=>{tt.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{tt.setView("ViewTopicList")},()=>{tt.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;Tt(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(12,i=await(async(t,e,n)=>{const o=(await lt).transaction(["questions"],"readonly").objectStore("questions"),s=[];return t.forEach((t=>{s.push(qt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if(mt(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),mt(o)),o.splice(0,e)}))})(r,t,l)),n(4,a=!0)}catch(t){et.addError("ViewTagInfo: "+bt(t))}},()=>{var t,e,o;n(3,(o=1,l=(t=l)<(e=.2)?e:t>o?o:t))},i,function(){c=_(this),n(2,c)},function(){l=$(this.value),n(3,l)},function(){o=_(this),n(5,o)}]}class Le extends Y{constructor(t){super(),K(this,t,Te,qe,i,{tag:0,topics:1,questions:12})}}function Ee(t){let e,n,o,s,r,i,c,d,g,$,v,x;return i=new me({props:{questions:t[1]}}),{c(){e=f("div"),n=f("h4"),o=p("Tag: "),s=p(t[0]),r=h(),F(i.$$.fragment),c=h(),d=f("div"),g=f("button"),g.textContent="Back",b(g,"class","button"),b(d,"class","is-floating"),b(e,"class","card card-shadow content")},m(u,f){a(u,e,f),l(e,n),l(n,o),l(n,s),l(e,r),Q(i,e,null),l(e,c),l(e,d),l(d,g),$=!0,v||(x=m(g,"click",t[4]),v=!0)},p(t,[e]){(!$||1&e)&&w(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){$||(D(i.$$.fragment,t),$=!0)},o(t){z(i.$$.fragment,t),$=!1},d(t){t&&u(e),J(i),v=!1,x()}}}function Ve(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{tt.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class je extends Y{constructor(t){super(),K(this,t,Ve,Ee,i,{tag:0,topics:3,questions:1})}}function Ue(e){let n,o,s,r,i,c,d,g,m,$,v,x,k,_,C,y,S,q,T,L,E,V,j,U,H=e[0][0]+"",A=e[0][1]+"",P=e[0][2]+"",B=e[0][3]+"";return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="No correct Answers",r=h(),i=f("td"),c=p(H),d=h(),g=f("tr"),m=f("td"),m.textContent="One correct Answer",$=h(),v=f("td"),x=p(A),k=h(),_=f("tr"),C=f("td"),C.textContent="Two correct Answers",y=h(),S=f("td"),q=p(P),T=h(),L=f("tr"),E=f("td"),E.textContent="Learned",V=h(),j=f("td"),U=p(B),b(n,"class","table hide-md")},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,d),l(n,g),l(g,m),l(g,$),l(g,v),l(v,x),l(n,k),l(n,_),l(_,C),l(_,y),l(_,S),l(S,q),l(n,T),l(n,L),l(L,E),l(L,V),l(L,j),l(j,U)},p(t,[e]){1&e&&H!==(H=t[0][0]+"")&&w(c,H),1&e&&A!==(A=t[0][1]+"")&&w(x,A),1&e&&P!==(P=t[0][2]+"")&&w(q,P),1&e&&B!==(B=t[0][3]+"")&&w(U,B)},i:t,o:t,d(t){t&&u(n)}}}function He(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Ae extends Y{constructor(t){super(),K(this,t,He,Ue,i,{statistic:0})}}function Pe(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=f("p")},m(t,o){a(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&u(e)}}}function Be(t){let e,n,o,s,r,i,c,d,g,m,$,v,x,k,_,C,y,S,q,T=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",E=t[3].toHtml(t[0].answer)+"";d=new ae({props:{question:t[0]}});let V=t[1].details&&Pe(t);return{c(){e=f("div"),n=f("div"),o=f("div"),s=f("div"),r=p("Question: "),i=p(T),c=h(),F(d.$$.fragment),g=h(),m=f("div"),$=f("p"),v=h(),x=f("div"),k=f("h5"),k.textContent="Answer",_=h(),C=f("div"),y=f("p"),S=h(),V&&V.c(),b(s,"class","h5"),b(o,"class","is-flex-spread block"),b(m,"class","card content is-primary"),b(C,"class","card content is-info"),x.hidden=t[2],b(e,"class","grid grid-2")},m(t,u){a(t,e,u),l(e,n),l(n,o),l(o,s),l(s,r),l(s,i),l(o,c),Q(d,o,null),l(n,g),l(n,m),l(m,$),$.innerHTML=L,l(e,v),l(e,x),l(x,k),l(x,_),l(x,C),l(C,y),y.innerHTML=E,l(C,S),V&&V.m(C,null),q=!0},p(t,[e]){(!q||1&e)&&T!==(T=t[0].id+"")&&w(i,T);const n={};1&e&&(n.question=t[0]),d.$set(n),(!q||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&($.innerHTML=L),(!q||1&e)&&E!==(E=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=E),t[1].details?V?V.p(t,e):(V=Pe(t),V.c(),V.m(C,null)):V&&(V.d(1),V=null),(!q||4&e)&&(x.hidden=t[2])},i(t){q||(D(d.$$.fragment,t),q=!0)},o(t){z(d.$$.fragment,t),q=!1},d(t){t&&u(e),J(d),V&&V.d()}}}function Me(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new ne;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class Ne extends Y{constructor(t){super(),K(this,t,Me,Be,i,{question:0,topic:1,hideAnswer:2})}}function Ie(t){let e,n,o,r,i,c,d,g,$,w,v,x,k,_,C,y,S,q,T,L,E,V,j,U;function H(t,e){return t[0]?Oe:Ge}let A=H(t),P=A(t);return o=new Ae({props:{statistic:t[3]}}),i=new Ne({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=f("div"),P.c(),n=h(),F(o.$$.fragment),r=h(),F(i.$$.fragment),c=h(),d=f("div"),g=f("button"),$=p("Show"),v=h(),x=f("button"),k=p("Correct"),_=h(),C=f("button"),y=p("Wrong"),S=h(),q=f("button"),T=p("Skip"),L=h(),E=f("button"),E.textContent="Stop",b(g,"class","button"),g.hidden=w=!t[4],b(x,"class","button is-success"),x.hidden=t[4],b(C,"class","button is-danger"),C.hidden=t[4],b(q,"class","button is-warning"),q.hidden=t[4],b(E,"class","button"),b(d,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,u){a(s,e,u),P.m(e,null),l(e,n),Q(o,e,null),l(e,r),Q(i,e,null),l(e,c),l(e,d),l(d,g),l(g,$),l(d,v),l(d,x),l(x,k),l(d,_),l(d,C),l(C,y),l(d,S),l(d,q),l(q,T),l(d,L),l(d,E),V=!0,j||(U=[m(g,"click",t[9]),m(x,"click",t[10]),m(C,"click",t[11]),m(q,"click",t[12]),m(E,"click",t[6])],j=!0)},p(t,s){A===(A=H(t))&&P?P.p(t,s):(P.d(1),P=A(t),P&&(P.c(),P.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!V||16&s&&w!==(w=!t[4]))&&(g.hidden=w),(!V||16&s)&&(x.hidden=t[4]),(!V||16&s)&&(C.hidden=t[4]),(!V||16&s)&&(q.hidden=t[4])},i(t){V||(D(o.$$.fragment,t),D(i.$$.fragment,t),V=!0)},o(t){z(o.$$.fragment,t),z(i.$$.fragment,t),V=!1},d(t){t&&u(e),P.d(),J(o),J(i),j=!1,s(U)}}}function Ge(t){let e,n,o=t[1].title+"";return{c(){e=f("h4"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&w(n,o)},d(t){t&&u(e)}}}function Oe(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=f("h4"),n=p("Tag: "),o=p(t[0]),s=h(),r=f("h6"),i=p(c)},m(t,c){a(t,e,c),l(e,n),l(e,o),a(t,s,c),a(t,r,c),l(r,i)},p(t,e){1&e&&w(o,t[0]),2&e&&c!==(c=t[1].title+"")&&w(i,c)},d(t){t&&u(e),t&&u(s),t&&u(r)}}}function Re(t){let e,n,o=t[2]&&Ie(t);return{c(){o&&o.c(),e=g()},m(t,s){o&&o.m(t,s),a(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&D(o,1)):(o=Ie(t),o.c(),D(o,1),o.m(e.parentNode,e)):o&&(O(),z(o,1,1,(()=>{o=null})),R())},i(t){n||(D(o),n=!0)},o(t){z(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function De(t,e,n){let o,s,r,i,{tag:c}=e,{topics:l}=e,{questions:a}=e,u=!0;const d=t=>{if(void 0===t)return i.push(s),void f();var e;((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=gt(t.failed,t.total)})(s,t),(e=s,new Promise((t=>{lt.then((n=>{const o=n.transaction(["questions"],"readwrite").objectStore("questions");o.put(e).onsuccess=()=>{console.log("Store:",o.name," update:",e),t()}}))}))).then((()=>{s.progress<3&&i.push(s),0===i.length&&p(),f()}))},f=()=>{const t=i.shift();if(!t)return;n(2,s=t);const e=l.find((t=>t.file===s.file));e&&(n(1,o=e),n(3,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(a)),n(4,u=!0),console.log("next",s))};q((()=>{i=a.filter((t=>t.progress<3)),mt(i),f()}));const p=async()=>{c?tt.setView("ViewTopicList"):(n(1,o.lastLearned=new Date,o),await(async t=>{const e=(await lt).transaction(["topics"],"readwrite").objectStore("topics");ut(e,t)})(o),tt.setView("ViewTopicList",{id:o.file}))};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(7,l=t.topics),"questions"in t&&n(8,a=t.questions)},[c,o,s,r,u,d,p,l,a,()=>n(4,u=!1),()=>d(!0),()=>d(!1),()=>d()]}class ze extends Y{constructor(t){super(),K(this,t,De,Re,i,{tag:0,topics:7,questions:8})}}function Fe(e){let n,o,r,i,c,d,g,$,x,k,_,C,y,S,q,T,L,E,V,j,U,H,A,P;return{c(){n=f("h4"),n.textContent="Translate",o=h(),r=f("label"),i=p(e[0]),c=h(),d=f("textarea"),g=h(),$=f("label"),x=p(e[1]),k=h(),_=f("textarea"),C=h(),y=f("div"),S=f("button"),S.textContent="Back",q=h(),T=f("button"),T.textContent="Translate",L=h(),E=f("button"),E.textContent="Reset",V=h(),j=f("button"),j.textContent="Switch",U=h(),H=f("p"),H.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',b(r,"for","src"),b(d,"id","src"),b(d,"class","input"),b($,"for","dst"),b(_,"id","dst"),_.readOnly=!0,_.value=e[3],b(_,"class","input"),b(S,"class","button"),b(T,"class","button"),b(E,"class","button"),b(j,"class","button"),b(y,"class","is-floating")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),l(r,i),a(t,c,s),a(t,d,s),v(d,e[2]),a(t,g,s),a(t,$,s),l($,x),a(t,k,s),a(t,_,s),a(t,C,s),a(t,y,s),l(y,S),l(y,q),l(y,T),l(y,L),l(y,E),l(y,V),l(y,j),a(t,U,s),a(t,H,s),A||(P=[m(d,"input",e[8]),m(S,"click",e[9]),m(T,"click",e[10]),m(E,"click",e[11]),m(j,"click",e[12])],A=!0)},p(t,[e]){1&e&&w(i,t[0]),4&e&&v(d,t[2]),2&e&&w(x,t[1]),8&e&&(_.value=t[3])},i:t,o:t,d(t){t&&u(n),t&&u(o),t&&u(r),t&&u(c),t&&u(d),t&&u(g),t&&u($),t&&u(k),t&&u(_),t&&u(C),t&&u(y),t&&u(U),t&&u(H),A=!1,s(P)}}}function Qe(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",l="";const a=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||et.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,l=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=l),a()},d=()=>{n(2,c=""),n(3,l="")},f=()=>{tt.setView("ViewTopicList")};return[o,s,c,l,a,u,d,f,function(){c=this.value,n(2,c)},()=>f(),()=>a(),()=>d(),()=>u()]}class Je extends Y{constructor(t){super(),K(this,t,Qe,Fe,i,{})}}function We(t,e,n){const o=t.slice();return o[10]=e[n],o}function Ke(t){let e,n,o,s,r,i,c,d,g,$,v,x,k,_,C,y=t[10].file+"",S=t[10].value+"",q=pt(t[10].lastLoaded)+"";function T(){return t[7](t[10])}return{c(){e=f("tr"),n=f("td"),o=p(y),s=h(),r=f("td"),i=p(S),c=h(),d=f("td"),g=p(q),$=h(),v=f("td"),x=f("button"),x.textContent="Delete",k=h(),b(x,"class","button")},m(t,u){a(t,e,u),l(e,n),l(n,o),l(e,s),l(e,r),l(r,i),l(e,c),l(e,d),l(d,g),l(e,$),l(e,v),l(v,x),l(e,k),_||(C=m(x,"click",T),_=!0)},p(e,n){t=e,1&n&&y!==(y=t[10].file+"")&&w(o,y),1&n&&S!==(S=t[10].value+"")&&w(i,S),1&n&&q!==(q=pt(t[10].lastLoaded)+"")&&w(g,q)},d(t){t&&u(e),_=!1,C()}}}function Ye(e){let n,o,r,i,c,p,g,$,w,v,x,_,C,y,S,q,T,L=e[0],E=[];for(let t=0;t<L.length;t+=1)E[t]=Ke(We(e,L,t));return{c(){n=f("div"),o=f("label"),o.textContent="Tag Filter",r=h(),i=f("select"),c=f("option"),c.textContent="By Name",p=f("option"),p.textContent="By Date",g=h(),$=f("button"),$.textContent="Load All",w=h(),v=f("table"),x=f("tr"),x.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",_=h();for(let t=0;t<E.length;t+=1)E[t].c();C=h(),y=f("div"),S=f("button"),S.textContent="Back",b(o,"for","sort-select"),c.__value="file",c.value=c.__value,p.__value="lastLoaded",p.value=p.__value,b(i,"id","sort-select"),void 0===e[1]&&A((()=>e[6].call(i))),b($,"class","button"),b(n,"class","is-floating"),b(S,"class","button"),b(y,"class","is-floating")},m(t,s){a(t,n,s),l(n,o),l(n,r),l(n,i),l(i,c),l(i,p),k(i,e[1]),l(n,g),l(n,$),a(t,w,s),a(t,v,s),l(v,x),l(v,_);for(let t=0;t<E.length;t+=1)E[t].m(v,null);a(t,C,s),a(t,y,s),l(y,S),q||(T=[m(i,"change",e[6]),m(i,"change",e[2]),m($,"click",e[5]),m(S,"click",e[8])],q=!0)},p(t,[e]){if(2&e&&k(i,t[1]),9&e){let n;for(L=t[0],n=0;n<L.length;n+=1){const o=We(t,L,n);E[n]?E[n].p(o,e):(E[n]=Ke(o),E[n].c(),E[n].m(v,null))}for(;n<E.length;n+=1)E[n].d(1);E.length=L.length}},i:t,o:t,d(t){t&&u(n),t&&u(w),t&&u(v),d(E,t),t&&u(C),t&&u(y),q=!1,s(T)}}}function Xe(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),"file"===s?o.sort(((t,e)=>+(e.file>t.file)||-(e.file<t.file))):o.sort(((t,e)=>+(e.lastLoaded>t.lastLoaded)||-(e.lastLoaded<t.lastLoaded))),n(0,o)},i=async()=>{n(0,o=await new Promise(((t,e)=>{lt.then((n=>{const o=n.transaction(["hash"],"readonly").objectStore("hash"),s=o.getAll();s.onsuccess=()=>{const e=s.result;console.log("Store:",o.name,"get all:",e.length),t(e)},s.onerror=t=>{console.log("Store:",o.name,"get all error:",t),e()}}))}))),r()},c=async t=>{await(async t=>{const e=(await lt).transaction(["hash"],"readwrite").objectStore("hash");return at(e,t)})(t),i()},l=()=>{tt.setView("ViewTopicList")};q((()=>{i()}));return[o,s,r,c,l,async()=>{const t=(await Ut()).map((t=>t.file));await(async t=>{const e=[];return t.forEach((t=>{e.push(Vt(t))})),Promise.all(e)})(t),i()},function(){s=_(this),n(1,s)},t=>c(t.file),()=>l()]}class Ze extends Y{constructor(t){super(),K(this,t,Xe,Ye,i,{})}}function tn(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=p("..."),n=p(o)},m(t,o){a(t,e,o),a(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&w(n,o)},d(t){t&&u(e),t&&u(n)}}}function en(e){let n,o,s,r,i,c,d,g,m,b,$,v,x,k,_,C,y,S,q,T,L,E,V,j=e[0].langUrl+"",U=(e[0].backupUrl?e[0].backupUrl:"")+"",H=(e[0].file?e[0].file:"")+"",A=e[0].token&&tn(e);return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="Github URL Language",r=h(),i=f("td"),c=p(j),d=h(),g=f("tr"),m=f("td"),m.textContent="Github URL Backup",b=h(),$=f("td"),v=p(U),x=h(),k=f("tr"),_=f("td"),_.textContent="Github File",C=h(),y=f("td"),S=p(H),q=h(),T=f("tr"),L=f("td"),L.textContent="Token",E=h(),V=f("td"),A&&A.c()},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,d),l(n,g),l(g,m),l(g,b),l(g,$),l($,v),l(n,x),l(n,k),l(k,_),l(k,C),l(k,y),l(y,S),l(n,q),l(n,T),l(T,L),l(T,E),l(T,V),A&&A.m(V,null)},p(t,[e]){1&e&&j!==(j=t[0].langUrl+"")&&w(c,j),1&e&&U!==(U=(t[0].backupUrl?t[0].backupUrl:"")+"")&&w(v,U),1&e&&H!==(H=(t[0].file?t[0].file:"")+"")&&w(S,H),t[0].token?A?A.p(t,e):(A=tn(t),A.c(),A.m(V,null)):A&&(A.d(1),A=null)},i:t,o:t,d(t){t&&u(n),A&&A.d()}}}function nn(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class on extends Y{constructor(t){super(),K(this,t,nn,en,i,{admin:0})}}function sn(e){let n,o,r,i,c,d,g,$,v,k,_,C,y,S;return{c(){n=f("div"),o=f("div"),r=f("h5"),i=p(e[0]),c=h(),d=f("p"),g=p(e[1]),$=h(),v=f("div"),k=f("button"),k.textContent="OK",_=h(),C=f("button"),C.textContent="Cancel",b(k,"class","button"),b(C,"class","button"),b(v,"class","is-floating"),b(o,"class","popup-content"),b(n,"class","popup"),x(n,"display",e[2]?"block":"none",!1)},m(t,s){a(t,n,s),l(n,o),l(o,r),l(r,i),l(o,c),l(o,d),l(d,g),l(o,$),l(o,v),l(v,k),l(v,_),l(v,C),y||(S=[m(k,"click",e[4]),m(C,"click",e[5])],y=!0)},p(t,[e]){1&e&&w(i,t[0]),2&e&&w(g,t[1]),4&e&&x(n,"display",t[2]?"block":"none",!1)},i:t,o:t,d(t){t&&u(n),y=!1,s(S)}}}function rn(t,e,n){let{title:o=""}=e,{msg:s=""}=e,{doShow:r=!1}=e;const i=T();return t.$$set=t=>{"title"in t&&n(0,o=t.title),"msg"in t&&n(1,s=t.msg),"doShow"in t&&n(2,r=t.doShow)},[o,s,r,i,()=>i("popup","ok"),()=>i("popup","cancel")]}class cn extends Y{constructor(t){super(),K(this,t,rn,sn,i,{title:0,msg:1,doShow:2})}}function ln(t){let e,n;return{c(){e=f("div"),n=p(t[2]),b(e,"class","block is-text-success")},m(t,o){a(t,e,o),l(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&u(e)}}}function an(t){let e,n,o,s;const r=[dn,un],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=g()},m(t,n){i[e].m(t,n),a(t,o,n),s=!0},p(t,s){let l=e;e=c(t),e===l?i[e].p(t,s):(O(),z(i[l],1,1,(()=>{i[l]=null})),R(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),D(n,1),n.m(o.parentNode,o))},i(t){s||(D(n),s=!0)},o(t){z(n),s=!1},d(t){i[e].d(t),t&&u(o)}}}function un(t){let e,n,o,r,i,c,d,p,g,$,w;n=new on({props:{admin:t[0]}});let v=t[0].file&&t[0].backupUrl&&t[0].token&&fn(t);return{c(){e=f("div"),F(n.$$.fragment),o=h(),r=f("div"),i=f("button"),i.textContent="Back",c=h(),d=f("button"),d.textContent="Update",p=h(),v&&v.c(),b(i,"class","button"),b(d,"class","button"),b(r,"class","is-floating"),b(e,"class","block")},m(s,u){a(s,e,u),Q(n,e,null),l(e,o),l(e,r),l(r,i),l(r,c),l(r,d),l(r,p),v&&v.m(r,null),g=!0,$||(w=[m(i,"click",t[8]),m(d,"click",t[16])],$=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?v?v.p(t,e):(v=fn(t),v.c(),v.m(r,null)):v&&(v.d(1),v=null)},i(t){g||(D(n.$$.fragment,t),g=!0)},o(t){z(n.$$.fragment,t),g=!1},d(t){t&&u(e),J(n),v&&v.d(),$=!1,s(w)}}}function dn(e){let n,o,r,i,c,d,p,g,$,w,x,k,_,C,y,S,q,T,L,E,V,j,U,H,A,P;return{c(){n=f("form"),o=f("div"),r=f("label"),r.textContent="Github URL Language",i=h(),c=f("input"),d=h(),p=f("label"),p.textContent="Github URL Backup",g=h(),$=f("input"),w=h(),x=f("label"),x.textContent="Github File",k=h(),_=f("input"),C=h(),y=f("label"),y.textContent="Token",S=h(),q=f("input"),T=h(),L=f("div"),E=f("button"),E.textContent="Save",V=h(),j=f("button"),j.textContent="Cancel",U=h(),H=f("button"),H.textContent="Back",b(r,"for","langUrl"),b(c,"id","langUrl"),b(c,"type","url"),b(c,"class","input"),b(p,"for","backupUrl"),b($,"id","backupUrl"),b($,"type","url"),b($,"class","input"),b(x,"for","file"),b(_,"id","file"),b(_,"type","text"),b(_,"class","input"),b(y,"for","token"),b(q,"id","token"),b(q,"type","password"),b(q,"class","input"),b(o,"class","block"),b(E,"class","button"),b(j,"class","button"),b(H,"class","button"),b(L,"class","is-floating")},m(t,s){var u;a(t,n,s),l(n,o),l(o,r),l(o,i),l(o,c),v(c,e[0].langUrl),l(o,d),l(o,p),l(o,g),l(o,$),v($,e[0].backupUrl),l(o,w),l(o,x),l(o,k),l(o,_),v(_,e[0].file),l(o,C),l(o,y),l(o,S),l(o,q),v(q,e[0].token),l(n,T),l(n,L),l(L,E),l(L,V),l(L,j),l(L,U),l(L,H),A||(P=[m(c,"input",e[11]),m($,"input",e[12]),m(_,"input",e[13]),m(q,"input",e[14]),m(j,"click",e[15]),m(H,"click",e[8]),m(n,"submit",(u=e[7],function(t){return t.preventDefault(),u.call(this,t)}))],A=!0)},p(t,e){1&e&&v(c,t[0].langUrl),1&e&&v($,t[0].backupUrl),1&e&&_.value!==t[0].file&&v(_,t[0].file),1&e&&q.value!==t[0].token&&v(q,t[0].token)},i:t,o:t,d(t){t&&u(n),A=!1,s(P)}}}function fn(e){let n,o,r,i,c;return{c(){n=f("button"),n.textContent="Backup",o=h(),r=f("button"),r.textContent="Restore",b(n,"class","button"),b(r,"class","button")},m(t,s){a(t,n,s),a(t,o,s),a(t,r,s),i||(c=[m(n,"click",e[17]),m(r,"click",e[18])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function pn(t){let e,n,o,s,r,i,c=t[2]&&ln(t),l=t[0]&&an(t);return r=new cn({props:{title:t[4],msg:t[5],doShow:t[6]}}),r.$on("popup",t[10]),{c(){e=f("h4"),e.textContent="Configuration",n=h(),c&&c.c(),o=h(),l&&l.c(),s=h(),F(r.$$.fragment)},m(t,u){a(t,e,u),a(t,n,u),c&&c.m(t,u),a(t,o,u),l&&l.m(t,u),a(t,s,u),Q(r,t,u),i=!0},p(t,[e]){t[2]?c?c.p(t,e):(c=ln(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[0]?l?(l.p(t,e),1&e&&D(l,1)):(l=an(t),l.c(),D(l,1),l.m(s.parentNode,s)):l&&(O(),z(l,1,1,(()=>{l=null})),R());const n={};16&e&&(n.title=t[4]),32&e&&(n.msg=t[5]),64&e&&(n.doShow=t[6]),r.$set(n)},i(t){i||(D(l),D(r.$$.fragment,t),i=!0)},o(t){z(l),z(r.$$.fragment,t),i=!1},d(t){t&&u(e),t&&u(n),c&&c.d(t),t&&u(o),l&&l.d(t),t&&u(s),J(r,t)}}}function hn(t,e,n){let o,s=!1,r="";q((async()=>{n(0,o=await $t())}));const i=async()=>{(async t=>{const{backupUrl:e,headers:n}=await xt(),o=await kt(e,n);console.log("sha",o);const s={method:"PUT",headers:n,body:JSON.stringify({sha:o,content:(r=JSON.stringify(t),window.btoa(unescape(encodeURIComponent(r)))),message:"backup"})};var r;const i=await fetch(e,s).catch((t=>{et.addError(`githubBackup - url: ${e} error: ${t}`)}));i&&(i.ok||et.addError(`githubBackup - url: ${e} error: ${i.statusText}`))})(await new Promise(((t,e)=>{const n=[];lt.then((o=>{const s=o.transaction(["questions"],"readonly").objectStore("questions"),r=s.openCursor();r.onsuccess=()=>{const e=r.result;if(e){const t=e.value;n.push([t.id,t.failed,t.total]),e.continue()}else console.log("Store:",s.name,"questGetBackup finished:",n.length),t(n)},r.onerror=t=>{console.log("Store:",s.name,"questGetBackup:",t),e()}}))}))),n(2,r="Backup done!")},c=async()=>{const t=await(async()=>{const{backupUrl:t,headers:e}=await xt(),n=await _t(t,e);if(n)return wt(n.content)})();t&&(Et(t),n(2,r="Restore done!"))};var l;let a,u;!function(t){t[t.Backup=0]="Backup",t[t.Restore=1]="Restore"}(l||(l={}));let d,f=!1;const p=t=>{switch(t){case l.Backup:n(4,a="Information"),n(5,u="Do you realy want to create a backup?"),d=i;break;case l.Restore:n(4,a="Warning"),n(5,u="Do you realy want to restore the backup?"),d=c;break;default:console.log("Unkown type",t)}n(6,f=!0)};return[o,s,r,l,a,u,f,()=>{o.langUrl&&(async t=>{const e=(await lt).transaction(["admin"],"readwrite").objectStore("admin");ut(e,t)})(o),n(1,s=!1)},()=>{tt.setView("ViewTopicList")},p,t=>{n(6,f=!1),"ok"===t.detail&&d()},function(){o.langUrl=this.value,n(0,o)},function(){o.backupUrl=this.value,n(0,o)},function(){o.file=this.value,n(0,o)},function(){o.token=this.value,n(0,o)},()=>n(1,s=!1),()=>n(1,s=!0),()=>p(l.Backup),()=>p(l.Restore)]}class gn extends Y{constructor(t){super(),K(this,t,hn,pn,i,{})}}function mn(t){let e,n;return e=new it({}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function bn(t){let n,o,s,r,i,c,d,p,g,m=0!==t[0].length&&mn();const $=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<$.length;t+=1)n=e(n,$[t]);return{props:n}}return w&&(c=new w(v())),{c(){n=f("div"),o=f("h2"),o.textContent="Cards",s=h(),m&&m.c(),r=h(),i=f("div"),c&&F(c.$$.fragment),d=h(),p=f("div"),p.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',b(i,"id","main"),b(i,"class","block"),b(p,"class","block"),b(n,"class","container")},m(t,e){a(t,n,e),l(n,o),l(n,s),m&&m.m(n,null),l(n,r),l(n,i),c&&Q(c,i,null),l(n,d),l(n,p),g=!0},p(t,[e]){0!==t[0].length?m?1&e&&D(m,1):(m=mn(),m.c(),D(m,1),m.m(n,r)):m&&(O(),z(m,1,1,(()=>{m=null})),R());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}($,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(w!==(w=t[1].component)){if(c){O();const t=c;z(t.$$.fragment,1,0,(()=>{J(t,1)})),R()}w?(c=new w(v()),F(c.$$.fragment),D(c.$$.fragment,1),Q(c,i,null)):c=null}else w&&c.$set(o)},i(t){g||(D(m),c&&D(c.$$.fragment,t),g=!0)},o(t){z(m),c&&z(c.$$.fragment,t),g=!1},d(t){t&&u(n),m&&m.d(),c&&J(c)}}}function $n(t,e,n){let o,s;return c(t,et,(t=>n(0,o=t))),c(t,tt,(t=>n(1,s=t))),q((()=>{tt.views={ViewTopicList:{component:te},ViewTopicInfo:{component:ie},ViewTopicQuests:{component:ve},ViewTagInfo:{component:Le},ViewTagQuests:{component:je},ViewQuestAnswer:{component:ze},ViewTranslate:{component:Je},ViewHashes:{component:Ze},ViewAdmin:{component:gn}},tt.setView("ViewTopicList")})),[o,s]}return new class extends Y{constructor(t){super(),K(this,t,$n,bn,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

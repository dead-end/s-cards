var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(t){let e;return c(t,(t=>e=t))(),e}function a(t,e,n){t.$$.on_destroy.push(c(e,n))}function u(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function b(){return g("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function _(t,e){t.value=null==e?"":e}function k(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function C(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let y;function S(t){y=t}function q(){if(!y)throw new Error("Function called outside component initialization");return y}function T(t){q().$$.on_mount.push(t)}const L=[],V=[],E=[],j=[],U=Promise.resolve();let A=!1;function H(t){E.push(t)}const P=new Set;let M=0;function N(){const t=y;do{for(;M<L.length;){const t=L[M];M++,S(t),B(t.$$)}for(S(null),L.length=0,M=0;V.length;)V.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];P.has(e)||(P.add(e),e())}E.length=0}while(L.length);for(;j.length;)j.pop()();A=!1,P.clear(),S(t)}function B(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(H)}}const I=new Set;let O;function G(){O={r:0,c:[],p:O}}function R(){O.r||s(O.c),O=O.p}function D(t,e){t&&t.i&&(I.delete(t),t.i(e))}function z(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),O.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function F(t){t&&t.c()}function Q(t,e,o,i){const{fragment:c,on_mount:l,on_destroy:a,after_update:u}=t.$$;c&&c.m(e,o),i||H((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(H)}function J(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(L.push(t),A||(A=!0,U.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,n,r,i,c,l,a,u=[-1]){const d=y;S(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(p.root);let h=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),h&&W(e,t)),n})):[],p.update(),h=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();n.intro&&D(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),N()}S(d)}class Y{$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const X=[];function Z(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!X.length;for(const t of s)t[1](),X.push(t,e);if(t){for(let t=0;t<X.length;t+=2)X[t][0](X[t+1]);X.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const tt=(()=>{const{subscribe:t,set:e,update:n}=Z({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=tt.views[t];o.props=n,e(o)}}})(),et=(()=>{const{subscribe:t,set:e,update:n}=Z([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})();let nt;const ot=t=>{et.addError(t.type)},st=()=>new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{nt=n.result,t.oldVersion<4&&(t=>{if(nt.objectStoreNames.contains("topics")||nt.createObjectStore("topics",{keyPath:"file"}),!nt.objectStoreNames.contains("questions")){const t=nt.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});t.indexNames.contains("file")||t.createIndex("file","file",{unique:!1})}nt.objectStoreNames.contains("hash")||(nt.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")});nt.objectStoreNames.contains("admin")||nt.createObjectStore("admin",{keyPath:"config"}),nt.objectStoreNames.contains("config")&&nt.deleteObjectStore("config")})()},n.onerror=ot,n.onsuccess=e=>{nt=n.result,nt.onerror=ot,console.log("db init success!"),t()}})),rt=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=o=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),it=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=o=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),ct=t=>new Promise(((e,n)=>{const o=nt.transaction(["hash"],"readonly").objectStore("hash"),s=o.get(t);s.onsuccess=n=>{const r=s.result?s.result:{file:t};console.log("Store:",o.name,"get:",r),e(r)},s.onerror=e=>{console.log("Store:",o.name,"get:",t,"error",e),n()}})),lt=(t,e)=>{const n=t.objectStore("hash");return rt(n,e)},at=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},ut=(t,e)=>{const n=new Map;return t.forEach((t=>{t.hasOwnProperty(e)||et.throwError(`Object has no property: ${e}`);const o=t[e];n.has(o)&&et.throwError(`Duplicate key: ${e}`),n.set(o,t)})),n},dt=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},ft=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},pt=t=>{for(let o=0;o<t.length;o++){let s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;let r=t[o];t[o]=t[s],t[s]=r}var e,n},ht=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=t=>{c.result.forEach((t=>{rt(i,t)})),s()}})))(t,"questions","file",e),gt=t=>{const e=nt.transaction(["questions"],"readonly").objectStore("questions");return mt(e,t)},mt=(t,e)=>new Promise(((n,o)=>{const s=t.index("file").getAll(e.file);s.onsuccess=t=>{n(s.result)}})),bt=async(t,e)=>{const n=nt.transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,new Promise(((e,o)=>{n.put(t).onsuccess=t=>{e()}})))));await Promise.all(o)},$t=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=t=>{const r=ut(n,"id"),i=ut(s.result,"id");i.forEach((t=>{r.has(t.id)||rt(o,t.id)})),r.forEach((t=>{i.has(t.id)?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(i.get(t.id),t),it(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=o=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{et.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},vt=t=>{const e=nt.transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];((t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=t=>{n(s.result)},s.onerror=e=>{console.log("Store:",t.name,"questGet:",e),o()}})))(e,n).then((t=>{t&&t.total<s&&(t.failed=o,t.total=s,t.ratio=ft(o,s),it(e,t))}))}))},wt=(t,e)=>{const n=t.objectStore("topics");rt(n,e)},xt=t=>{const e=nt.transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=s=>{const r=ut(o.result,"file"),i=t.map((t=>t.file));for(let t of r.keys())i.includes(t)||(wt(e,t),lt(e,t),ht(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!dt(t.tags,e.tags)||!dt(t.details,e.details)))(t,r.get(t.file))&&it(n,t)}))}},_t=(()=>{const{subscribe:t,set:e,update:n}=Z();return{subscribe:t,setAdmin:t=>{(t=>{const e=nt.transaction(["admin"],"readwrite").objectStore("admin");it(e,t)})(t),e(t)},initAdmin:async()=>new Promise(((t,e)=>{const n=nt.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=e=>{let o=n.result;o||(o={config:"admin",langUrl:"https://api.github.com/repos/dead-end/cards-russian/contents/",backupUrl:"",file:"",token:""}),t(o)}})).then((t=>e(t)))}})(),kt=t=>{try{return JSON.parse((e=t,decodeURIComponent(escape(window.atob(e)))))}catch(t){et.addError(`githubParseContent - unable to parse json content: ${t}`)}var e},Ct=t=>{const e={Accept:"application/vnd.github.v3+json"};return t&&t.token&&(e.authorization=`token ${t.token}`),e},yt=()=>{const t=l(_t);return{backupUrl:t.backupUrl+t.file+".json",headers:Ct(t)}},St=async(t,e)=>{const n=await fetch(t,{method:"HEAD",headers:e}).catch((e=>{et.addError(`githubGetEtag - url: ${t} error: ${e}`)}));if(!n||404===n.status)return;if(!n.ok)return void et.addError(`githubGetEtag - url: ${t} error: ${n.statusText}`);const o=n.headers.get("ETag");if(!o)return;const s=o.startsWith("W/")?3:1;return o.substring(s,o.length-1)},qt=async(t,e)=>{const n=await fetch(t,e).catch((e=>{et.addError(`githubGetJsonContent - url: ${t} error: ${e}`)}));if(n){if(n.ok)return n.json();et.addError(`githubGetJsonContent - url: ${t} error: ${n.statusText}`)}},Tt=async t=>{const{fileUrl:e,headers:n}=(t=>{const e=l(_t);return{fileUrl:e.langUrl+t,headers:Ct(e)}})(t);let o=await ct(t);if(o.value){const t=await(async(t,e,n)=>{const o=await St(t,e);if(!o)return!1;const s=o===n;return console.log("url :",t,"ETag",o,"hash",n,"matches",s),s})(e,n,o.value);if(t)return}const s=await qt(e,n);if(!s)return;const r=kt(s.content);return r?(o.value=s.sha,o.lastLoaded=new Date,await(t=>new Promise(((e,n)=>{const o=nt.transaction(["hash"],"readwrite").objectStore("hash"),s=o.put(t);s.onsuccess=n=>{console.log("Store:",o.name,"put:",t),e()},s.onerror=e=>{console.log("Store:",o.name,"put:",t,"error",e),n()}})))(o),console.log("githubGetJson",r),r):void 0};function Lt(t,e,n){const o=t.slice();return o[2]=e[n],o}function Vt(t){let e,n,o=t[2]+"";return{c(){e=h("li"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&x(n,o)},d(t){t&&f(e)}}}function Et(e){let n,o,s,r,i,c,l,a,g,b=e[0],w=[];for(let t=0;t<b.length;t+=1)w[t]=Vt(Lt(e,b,t));return{c(){n=h("div"),o=h("h4"),o.textContent="Errors",s=m(),r=h("ul");for(let t=0;t<w.length;t+=1)w[t].c();i=m(),c=h("div"),l=h("button"),l.textContent="Ok",v(o,"class","is-text-danger"),v(l,"class","button"),v(c,"class","is-floating"),v(n,"class","card card-shadow block content")},m(t,f){d(t,n,f),u(n,o),u(n,s),u(n,r);for(let t=0;t<w.length;t+=1)w[t].m(r,null);u(n,i),u(n,c),u(c,l),a||(g=$(l,"click",e[1]),a=!0)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const o=Lt(t,b,n);w[n]?w[n].p(o,e):(w[n]=Vt(o),w[n].c(),w[n].m(r,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=b.length}},i:t,o:t,d(t){t&&f(n),p(w,t),a=!1,g()}}}function jt(t,e,n){let o;a(t,et,(t=>n(0,o=t)));return[o,()=>{et.resetErrors()}]}class Ut extends Y{constructor(t){super(),K(this,t,jt,Et,i,{})}}function At(t){let e,n,o,s,r,i,c,l,a,p,$,v,w,_,k=t[4]&&Ht(t);return{c(){e=h("tr"),n=h("td"),n.textContent="Questions",o=m(),s=h("td"),r=g(t[2]),i=m(),c=h("tr"),l=h("td"),l.textContent="Status",a=m(),p=h("td"),$=g(t[1]),v=g("%"),w=m(),k&&k.c(),_=b()},m(t,f){d(t,e,f),u(e,n),u(e,o),u(e,s),u(s,r),d(t,i,f),d(t,c,f),u(c,l),u(c,a),u(c,p),u(p,$),u(p,v),d(t,w,f),k&&k.m(t,f),d(t,_,f)},p(t,e){4&e&&x(r,t[2]),2&e&&x($,t[1]),t[4]?k?k.p(t,e):(k=Ht(t),k.c(),k.m(_.parentNode,_)):k&&(k.d(1),k=null)},d(t){t&&f(e),t&&f(i),t&&f(c),t&&f(w),k&&k.d(t),t&&f(_)}}}function Ht(t){let e,n,o,s,r,i,c,l,a,p,b,$=at(t[4].lastLoaded)+"",v=(t[4].value?t[4].value:"")+"";return{c(){e=h("tr"),n=h("td"),n.textContent="Last loaded",o=m(),s=h("td"),r=g($),i=m(),c=h("tr"),l=h("td"),l.textContent="Hash",a=m(),p=h("td"),b=g(v)},m(t,f){d(t,e,f),u(e,n),u(e,o),u(e,s),u(s,r),d(t,i,f),d(t,c,f),u(c,l),u(c,a),u(c,p),u(p,b)},p(t,e){16&e&&$!==($=at(t[4].lastLoaded)+"")&&x(r,$),16&e&&v!==(v=(t[4].value?t[4].value:"")+"")&&x(b,v)},d(t){t&&f(e),t&&f(i),t&&f(c)}}}function Pt(t){let e,n,o=t[0].desc+"";return{c(){e=h("p"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&x(n,o)},d(t){t&&f(e)}}}function Mt(e){let n,o,s,r,i,c,l,a,p,$,v,w,_,k,C,y,S,q,T=e[0].title+"",L=at(e[0].lastLearned)+"",V=e[0].tags.join(", ")+"",E=e[3]&&At(e),j=e[0].desc&&Pt(e);return{c(){n=h("h4"),o=g(T),s=m(),r=h("table"),i=h("tr"),c=h("td"),c.textContent="Last learned",l=m(),a=h("td"),p=g(L),$=m(),v=h("tr"),w=h("td"),w.textContent="Tags",_=m(),k=h("td"),C=g(V),y=m(),E&&E.c(),S=m(),j&&j.c(),q=b()},m(t,e){d(t,n,e),u(n,o),d(t,s,e),d(t,r,e),u(r,i),u(i,c),u(i,l),u(i,a),u(a,p),u(r,$),u(r,v),u(v,w),u(v,_),u(v,k),u(k,C),u(r,y),E&&E.m(r,null),d(t,S,e),j&&j.m(t,e),d(t,q,e)},p(t,[e]){1&e&&T!==(T=t[0].title+"")&&x(o,T),1&e&&L!==(L=at(t[0].lastLearned)+"")&&x(p,L),1&e&&V!==(V=t[0].tags.join(", ")+"")&&x(C,V),t[3]?E?E.p(t,e):(E=At(t),E.c(),E.m(r,null)):E&&(E.d(1),E=null),t[0].desc?j?j.p(t,e):(j=Pt(t),j.c(),j.m(q.parentNode,q)):j&&(j.d(1),j=null)},i:t,o:t,d(t){t&&f(n),t&&f(s),t&&f(r),E&&E.d(),t&&f(S),j&&j.d(t),t&&f(q)}}}function Nt(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return T((async()=>{c&&n(4,o=await ct(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class Bt extends Y{constructor(t){super(),K(this,t,Nt,Mt,i,{topic:0,status:1,size:2,details:3})}}function It(t){let e,n,o,s,r,i,c,l,a;return n=new Bt({props:{topic:t[0],details:!1}}),{c(){e=h("div"),F(n.$$.fragment),o=m(),s=h("div"),r=h("button"),r.textContent="Show",v(r,"class","button"),v(s,"class","is-floating"),v(e,"class","card card-shadow content"),v(e,"id",i=t[0].file)},m(i,f){d(i,e,f),Q(n,e,null),u(e,o),u(e,s),u(s,r),c=!0,l||(a=$(r,"click",t[2]),l=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&v(e,"id",i)},i(t){c||(D(n.$$.fragment,t),c=!0)},o(t){z(n.$$.fragment,t),c=!1},d(t){t&&f(e),J(n),l=!1,a()}}}function Ot(t,e,n){let{topic:o}=e;const s=t=>{tt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Gt extends Y{constructor(t){super(),K(this,t,Ot,It,i,{topic:0})}}function Rt(t,e,n){const o=t.slice();return o[13]=e[n],o}function Dt(t,e,n){const o=t.slice();return o[16]=e[n],o}function zt(t){let e,n,o,r,i,c,l,a,g,b,w,x,_,C,y,S,q,T,L,V,E=t[1],j=[];for(let e=0;e<E.length;e+=1)j[e]=Ft(Dt(t,E,e));let U=t[2]&&Qt(t);return{c(){e=h("div"),n=h("label"),n.textContent="Sort",o=m(),r=h("select"),i=h("option"),i.textContent="-- Select --",c=h("option"),c.textContent="Last learned",l=m(),a=h("label"),a.textContent="Tag Filter",g=m(),b=h("select"),w=h("option"),w.textContent="-- Select --";for(let t=0;t<j.length;t+=1)j[t].c();x=m(),U&&U.c(),_=m(),C=h("button"),C.textContent="Translate",y=m(),S=h("button"),S.textContent="Hashes",q=m(),T=h("button"),T.textContent="Admin",v(n,"class","is-valign-center"),v(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,v(r,"id","sort-select"),void 0===t[3]&&H((()=>t[6].call(r))),v(a,"for","tag-select"),w.__value="",w.value=w.__value,v(b,"id","tag-select"),void 0===t[2]&&H((()=>t[7].call(b))),v(C,"class","button"),v(S,"class","button"),v(T,"class","button"),v(e,"class","is-floating")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),k(r,t[3]),u(e,l),u(e,a),u(e,g),u(e,b),u(b,w);for(let t=0;t<j.length;t+=1)j[t].m(b,null);k(b,t[2]),u(e,x),U&&U.m(e,null),u(e,_),u(e,C),u(e,y),u(e,S),u(e,q),u(e,T),L||(V=[$(r,"change",t[6]),$(r,"change",t[4]),$(b,"change",t[7]),$(b,"change",t[4]),$(C,"click",t[9]),$(S,"click",t[10]),$(T,"click",t[11])],L=!0)},p(t,n){if(8&n&&k(r,t[3]),2&n){let e;for(E=t[1],e=0;e<E.length;e+=1){const o=Dt(t,E,e);j[e]?j[e].p(o,n):(j[e]=Ft(o),j[e].c(),j[e].m(b,null))}for(;e<j.length;e+=1)j[e].d(1);j.length=E.length}6&n&&k(b,t[2]),t[2]?U?U.p(t,n):(U=Qt(t),U.c(),U.m(e,_)):U&&(U.d(1),U=null)},d(t){t&&f(e),p(j,t),U&&U.d(),L=!1,s(V)}}}function Ft(t){let e,n,o,s=t[16]+"";return{c(){e=h("option"),n=g(s),e.__value=o=t[16],e.value=e.__value},m(t,o){d(t,e,o),u(e,n)},p(t,r){2&r&&s!==(s=t[16]+"")&&x(n,s),2&r&&o!==(o=t[16])&&(e.__value=o,e.value=e.__value)},d(t){t&&f(e)}}}function Qt(e){let n,o,s;return{c(){n=h("button"),n.textContent="Show",v(n,"class","button")},m(t,r){d(t,n,r),o||(s=$(n,"click",e[8]),o=!0)},p:t,d(t){t&&f(n),o=!1,s()}}}function Jt(t){let e,n;return e=new Gt({props:{topic:t[13]}}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[13]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function Wt(t){let e,n,o,s=t[1]&&zt(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Jt(Rt(t,r,e));const c=t=>z(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=m(),n=h("div");for(let t=0;t<i.length;t+=1)i[t].c();v(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),d(t,e,r),d(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?s.p(t,o):(s=zt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Rt(t,r,e);i[e]?(i[e].p(s,o),D(i[e],1)):(i[e]=Jt(s),i[e].c(),D(i[e],1),i[e].m(n,null))}for(G(),e=r.length;e<i.length;e+=1)c(e);R()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)D(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)z(i[t]);o=!1},d(t){s&&s.d(t),t&&f(e),t&&f(n),p(i,t)}}}function Kt(t,e,n){let o,s,r,{id:i=null}=e,c=[],l=[];var a;T((()=>{new Promise(((t,e)=>{const n=nt.transaction(["topics"],"readonly").objectStore("topics"),o=n.getAll();o.onsuccess=e=>{console.log("Store:",n.name,"topicGetAll:"),t(o.result)},o.onerror=t=>{console.log("Store:",n.name,"topicGetAll error:",t),e()}})).then((t=>{c=t,n(0,l=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(c))}))})),a=()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}},q().$$.after_update.push(a);return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[l,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,l=t)},i,function(){r=C(this),n(3,r)},function(){s=C(this),n(2,s),n(1,o)},()=>tt.setView("ViewTagInfo",{tag:s,topics:l}),()=>tt.setView("ViewTranslate"),()=>tt.setView("ViewHashes"),()=>tt.setView("ViewAdmin")]}class Yt extends Y{constructor(t){super(),K(this,t,Kt,Wt,i,{id:5})}}class Xt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&et.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class Zt{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new Xt(t,e)}_pattern(){let t="";for(let e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return this.map.hasOwnProperty(t)||et.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(let e in this.map)this.map[e].check(t)}_substitute(t){const e=this;return t.replaceAll(this.regex,(function(t){return e.tag(t)}))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(let o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}}function te(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=h("div"),n=h("h5"),n.textContent="Details",o=m(),s=h("div"),r=h("p"),v(s,"class","card content is-info"),v(e,"class","block")},m(t,c){d(t,e,c),u(e,n),u(e,o),u(e,s),u(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&f(e)}}}function ee(t){let e,n,o,r,i,c,l,a,p,b,w,x,_,k,C,y,S,q,T,L,V,E,j,U,A,H;r=new Bt({props:{topic:t[0],status:t[1],size:t[3]}});let P=t[0].details&&te(t);return{c(){e=h("div"),n=h("div"),o=h("div"),F(r.$$.fragment),i=m(),c=h("div"),l=h("label"),l.textContent="Number of correct answers",a=m(),p=h("select"),b=h("option"),b.textContent="-- Select --",w=h("option"),w.textContent="Set 0",x=h("option"),x.textContent="Set 1",_=h("option"),_.textContent="Set 2",k=h("option"),k.textContent="Set 3",C=m(),P&&P.c(),y=m(),S=h("div"),q=h("button"),q.textContent="Back",T=m(),L=h("button"),L.textContent="Listing",V=m(),E=h("button"),j=g("Start"),v(o,"class","is-text-left"),v(l,"for","sf-set"),b.__value="",b.value=b.__value,w.__value="0",w.value=w.__value,x.__value="1",x.value=x.__value,_.__value="2",_.value=_.__value,k.__value="3",k.value=k.__value,v(p,"id","sf-set"),v(c,"class","is-floating"),v(q,"class","button"),v(L,"class","button"),v(E,"class","button"),E.disabled=t[2],v(S,"class","is-floating"),v(e,"class","card card-shadow content")},m(s,f){d(s,e,f),u(e,n),u(n,o),Q(r,o,null),u(n,i),u(n,c),u(c,l),u(c,a),u(c,p),u(p,b),u(p,w),u(p,x),u(p,_),u(p,k),u(n,C),P&&P.m(n,null),u(e,y),u(e,S),u(S,q),u(S,T),u(S,L),u(S,V),u(S,E),u(E,j),U=!0,A||(H=[$(p,"change",t[8]),$(q,"click",t[5]),$(L,"click",t[6]),$(E,"click",t[7])],A=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?P?P.p(t,e):(P=te(t),P.c(),P.m(n,null)):P&&(P.d(1),P=null),(!U||4&e)&&(E.disabled=t[2])},i(t){U||(D(r.$$.fragment,t),U=!0)},o(t){z(r.$$.fragment,t),U=!1},d(t){t&&f(e),J(r),P&&P.d(),A=!1,s(H)}}}function ne(t,e,n){let{topic:o}=e,{questions:s=null}=e;const r=new Zt;let i=0,c=!0,l=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return ft(n,t.length*e)})(t,3)),n(2,c=((t,e)=>{for(let n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,l=t.length)};T((async()=>{try{s||(await(async t=>{const e=await Tt(t);if(e){const n=nt.transaction(["questions"],"readwrite");$t(n,t,e)}})(o.file),console.log("Loading questions for topics"),n(9,s=await gt(o)),a())}catch(t){et.addError("ViewTopicInfo: "+t.message)}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,l,r,()=>{tt.setView("ViewTopicList",{id:o.file})},()=>{tt.setView("ViewTopicQuests",{topic:o})},()=>{tt.setView("ViewQuestAnswer",{topics:[o],questions:s})},t=>{if(!s)return;const e=t.target;bt(s,e.selectedIndex-1),e.selectedIndex=0,a()},s]}class oe extends Y{constructor(t){super(),K(this,t,ne,ee,i,{topic:0,questions:9})}}function se(e){let n,o,s,r,i,c,l,a,p,b,$,w,_,k,C,y=e[0].progress+"",S=e[0].total+"",q=e[0].ratio+"";return{c(){n=h("div"),o=g("Progress: "),s=h("span"),r=g(y),i=g(" /\n  "),c=h("span"),c.textContent="3",l=m(),a=h("span"),p=g("Total: "),b=h("span"),$=g(S),w=g(" Wrong:\n    "),_=h("span"),k=g(q),C=g("%"),v(s,"class","is-text-success"),v(c,"class","is-text-success"),v(b,"class","is-text-success"),v(_,"class","is-text-danger"),v(a,"class","hide-sm"),v(n,"class","h6")},m(t,e){d(t,n,e),u(n,o),u(n,s),u(s,r),u(n,i),u(n,c),u(n,l),u(n,a),u(a,p),u(a,b),u(b,$),u(a,w),u(a,_),u(_,k),u(_,C)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&x(r,y),1&e&&S!==(S=t[0].total+"")&&x($,S),1&e&&q!==(q=t[0].ratio+"")&&x(k,q)},i:t,o:t,d(t){t&&f(n)}}}function re(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class ie extends Y{constructor(t){super(),K(this,t,re,se,i,{question:0})}}function ce(t,e,n){const o=t.slice();return o[9]=e[n],o}function le(t){let e,n,o,s,r,i="2"===t[0]&&ae(t);return s=new ie({props:{question:t[9]}}),{c(){e=h("div"),n=h("div"),i&&i.c(),o=m(),F(s.$$.fragment),v(e,"class","is-flex-spread grid-full")},m(t,c){d(t,e,c),u(e,n),i&&i.m(n,null),u(e,o),Q(s,e,null),r=!0},p(t,e){"2"===t[0]?i?i.p(t,e):(i=ae(t),i.c(),i.m(n,null)):i&&(i.d(1),i=null);const o={};2&e&&(o.question=t[9]),s.$set(o)},i(t){r||(D(s.$$.fragment,t),r=!0)},o(t){z(s.$$.fragment,t),r=!1},d(t){t&&f(e),i&&i.d(),J(s)}}}function ae(t){let e,n,o,s,r,i,c=t[9].id+"",l=t[9].file+"";return{c(){e=h("span"),n=g("Id: "),o=g(c),s=m(),r=h("span"),i=g(l),v(e,"class","h6"),v(r,"class","hide-sm")},m(t,c){d(t,e,c),u(e,n),u(e,o),d(t,s,c),d(t,r,c),u(r,i)},p(t,e){2&e&&c!==(c=t[9].id+"")&&x(o,c),2&e&&l!==(l=t[9].file+"")&&x(i,l)},d(t){t&&f(e),t&&f(s),t&&f(r)}}}function ue(t){let e,n,o,s,r,i,c,l,a,p,g,b,$=t[3].toHtml(t[9].quest)+"",w=t[3].toHtml(t[9].answer)+"",x=("1"===t[0]||"2"===t[0])&&le(t);return{c(){x&&x.c(),e=m(),n=h("div"),o=h("div"),s=h("p"),i=m(),c=h("div"),l=h("div"),a=h("p"),p=m(),v(o,"class","content"),v(n,"class",r="card "+t[5]()),v(l,"class","content"),v(c,"class",g="card "+t[5]())},m(t,r){x&&x.m(t,r),d(t,e,r),d(t,n,r),u(n,o),u(o,s),s.innerHTML=$,d(t,i,r),d(t,c,r),u(c,l),u(l,a),a.innerHTML=w,u(c,p),b=!0},p(t,n){"1"===t[0]||"2"===t[0]?x?(x.p(t,n),1&n&&D(x,1)):(x=le(t),x.c(),D(x,1),x.m(e.parentNode,e)):x&&(G(),z(x,1,1,(()=>{x=null})),R()),(!b||2&n)&&$!==($=t[3].toHtml(t[9].quest)+"")&&(s.innerHTML=$),(!b||2&n)&&w!==(w=t[3].toHtml(t[9].answer)+"")&&(a.innerHTML=w)},i(t){b||(D(x),b=!0)},o(t){z(x),b=!1},d(t){x&&x.d(t),t&&f(e),t&&f(n),t&&f(i),t&&f(c)}}}function de(t){let e,n,o,r,i,c,l,a,g,b,w,x,_,C,y,S,q,T,L,V=t[1],E=[];for(let e=0;e<V.length;e+=1)E[e]=ue(ce(t,V,e));const j=t=>z(E[t],1,1,(()=>{E[t]=null}));return{c(){e=h("div"),n=h("label"),n.textContent="Details",o=m(),r=h("select"),i=h("option"),i.textContent="Simple",c=h("option"),c.textContent="Progress",l=h("option"),l.textContent="ID's",a=m(),g=h("label"),g.textContent="Tag Filter",b=m(),w=h("select"),x=h("option"),x.textContent="-- Select --",_=h("option"),_.textContent="Total",C=h("option"),C.textContent="Ratio",y=m(),S=h("div");for(let t=0;t<E.length;t+=1)E[t].c();v(n,"for","details-select"),i.__value="0",i.value=i.__value,c.__value="1",c.value=c.__value,l.__value="2",l.value=l.__value,v(r,"id","details-select"),void 0===t[0]&&H((()=>t[7].call(r))),v(g,"for","quest-sort"),x.__value="",x.value=x.__value,_.__value="total",_.value=_.__value,C.__value="ratio",C.value=C.__value,v(w,"id","quest-sort"),void 0===t[2]&&H((()=>t[8].call(w))),v(e,"class","is-floating"),v(S,"class","grid grid-2")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),u(r,l),k(r,t[0]),u(e,a),u(e,g),u(e,b),u(e,w),u(w,x),u(w,_),u(w,C),k(w,t[2]),d(s,y,f),d(s,S,f);for(let t=0;t<E.length;t+=1)E[t].m(S,null);q=!0,T||(L=[$(r,"change",t[7]),$(w,"change",t[8]),$(w,"change",t[4])],T=!0)},p(t,[e]){if(1&e&&k(r,t[0]),4&e&&k(w,t[2]),43&e){let n;for(V=t[1],n=0;n<V.length;n+=1){const o=ce(t,V,n);E[n]?(E[n].p(o,e),D(E[n],1)):(E[n]=ue(o),E[n].c(),D(E[n],1),E[n].m(S,null))}for(G(),n=V.length;n<E.length;n+=1)j(n);R()}},i(t){if(!q){for(let t=0;t<V.length;t+=1)D(E[t]);q=!0}},o(t){E=E.filter(Boolean);for(let t=0;t<E.length;t+=1)z(E[t]);q=!1},d(t){t&&f(e),t&&f(y),t&&f(S),p(E,t),T=!1,s(L)}}}function fe(t,e,n){let{questions:o}=e,s="0",r=[],i="";const c=new Zt;T((()=>{console.log("questions",o),n(1,r=o)}));const l=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(6,o=t.questions)},[s,r,i,c,()=>{if(!i)return void n(1,r=o);let t=[...o];"ratio"===i?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===i&&t.sort(((t,e)=>e.total-t.total)),n(1,r=t)},l,o,function(){s=C(this),n(0,s)},function(){i=C(this),n(2,i)}]}class pe extends Y{constructor(t){super(),K(this,t,fe,de,i,{questions:6})}}function he(t){let e,n;return e=new pe({props:{questions:t[1]}}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function ge(t){let e,n,o,s,r,i,c,l,a,p,b=t[0].title+"",w=0!==t[1].length&&he(t);return{c(){e=h("div"),n=h("h4"),o=g(b),s=m(),w&&w.c(),r=m(),i=h("div"),c=h("button"),c.textContent="Back",v(c,"class","button"),v(i,"class","is-floating"),v(e,"class","card card-shadow content")},m(f,h){d(f,e,h),u(e,n),u(n,o),u(e,s),w&&w.m(e,null),u(e,r),u(e,i),u(i,c),l=!0,a||(p=$(c,"click",t[3]),a=!0)},p(t,[n]){(!l||1&n)&&b!==(b=t[0].title+"")&&x(o,b),0!==t[1].length?w?(w.p(t,n),2&n&&D(w,1)):(w=he(t),w.c(),D(w,1),w.m(e,r)):w&&(G(),z(w,1,1,(()=>{w=null})),R())},i(t){l||(D(w),l=!0)},o(t){z(w),l=!1},d(t){t&&f(e),w&&w.d(),a=!1,p()}}}function me(t,e,n){let{topic:o}=e,s=[];T((()=>{gt(o).then((t=>{n(1,s=t)}))}));const r=t=>{tt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class be extends Y{constructor(t){super(),K(this,t,me,ge,i,{topic:0})}}function $e(t,e,n){const o=t.slice();return o[15]=e[n],o}function ve(t){let e,n,o=t[15].title+"";return{c(){e=h("li"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){2&e&&o!==(o=t[15].title+"")&&x(n,o)},d(t){t&&f(e)}}}function we(t){let e,n,o,r,i,c,l,a,p,g;return{c(){e=h("div"),n=h("label"),n.textContent="Number of correct answers",o=m(),r=h("select"),i=h("option"),i.textContent="-- Select --",c=h("option"),c.textContent="Set 0",l=h("option"),l.textContent="Set 1",a=h("option"),a.textContent="Set 2",v(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,l.__value="1",l.value=l.__value,a.__value="2",a.value=a.__value,v(r,"id","sf-set"),void 0===t[5]&&H((()=>t[14].call(r))),v(e,"class","is-floating")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),u(r,l),u(r,a),k(r,t[5]),p||(g=[$(r,"change",t[14]),$(r,"change",t[9])],p=!0)},p(t,e){32&e&&k(r,t[5])},d(t){t&&f(e),p=!1,s(g)}}}function xe(t){let e,n,o,r,i,c,l,a,p,g,b,x,C;return{c(){e=h("div"),n=h("label"),n.textContent="Load Questions",o=m(),r=h("select"),i=h("option"),i.textContent="30",c=h("option"),c.textContent="All",l=m(),a=h("div"),p=h("label"),p.textContent="Fraction",g=m(),b=h("input"),v(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,v(r,"id","load-quests"),void 0===t[2]&&H((()=>t[12].call(r))),v(e,"class","is-floating"),v(p,"for","relevant"),v(b,"id","relevant"),v(b,"type","number"),v(b,"min","0.2"),v(b,"max","1"),v(b,"step","0.2"),v(a,"class","is-floating")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),k(r,t[2]),d(s,l,f),d(s,a,f),u(a,p),u(a,g),u(a,b),_(b,t[3]),x||(C=[$(r,"change",t[12]),$(b,"input",t[13])],x=!0)},p(t,e){4&e&&k(r,t[2]),8&e&&w(b.value)!==t[3]&&_(b,t[3])},d(t){t&&f(e),t&&f(l),t&&f(a),x=!1,s(C)}}}function _e(e){let n,o,s;return{c(){n=h("button"),n.textContent="Load",v(n,"class","button")},m(t,r){d(t,n,r),o||(s=$(n,"click",e[10]),o=!0)},p:t,d(t){t&&f(n),o=!1,s()}}}function ke(e){let n,o,r,i,c;return{c(){n=h("button"),n.textContent="Listing",o=m(),r=h("button"),r.textContent="Start",v(n,"class","button"),v(r,"class","button")},m(t,s){d(t,n,s),d(t,o,s),d(t,r,s),i||(c=[$(n,"click",e[6]),$(r,"click",e[8])],i=!0)},p:t,d(t){t&&f(n),t&&f(o),t&&f(r),i=!1,s(c)}}}function Ce(e){let n,o,s,r,i,c,l,a,b,w,_,k,C,y,S,q,T,L=e[1],V=[];for(let t=0;t<L.length;t+=1)V[t]=ve($e(e,L,t));function E(t,e){return t[4]?we:xe}let j=E(e),U=j(e);function A(t,e){return t[4]?ke:_e}let H=A(e),P=H(e);return{c(){n=h("div"),o=h("div"),s=h("div"),r=h("h4"),i=g("Tag: "),c=g(e[0]),l=m(),a=h("p"),a.textContent="Files incluging the tag:",b=m(),w=h("ul");for(let t=0;t<V.length;t+=1)V[t].c();_=m(),U.c(),k=m(),C=h("div"),y=h("button"),y.textContent="Back",S=m(),P.c(),v(s,"class","is-text-left"),v(y,"class","button"),v(C,"class","is-floating"),v(n,"class","card card-shadow content")},m(t,f){d(t,n,f),u(n,o),u(o,s),u(s,r),u(r,i),u(r,c),u(s,l),u(s,a),u(s,b),u(s,w);for(let t=0;t<V.length;t+=1)V[t].m(w,null);u(n,_),U.m(n,null),u(n,k),u(n,C),u(C,y),u(C,S),P.m(C,null),q||(T=$(y,"click",e[7]),q=!0)},p(t,[e]){if(1&e&&x(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=$e(t,L,n);V[n]?V[n].p(o,e):(V[n]=ve(o),V[n].c(),V[n].m(w,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=L.length}j===(j=E(t))&&U?U.p(t,e):(U.d(1),U=j(t),U&&(U.c(),U.m(n,k))),H===(H=A(t))&&P?P.p(t,e):(P.d(1),P=H(t),P&&(P.c(),P.m(C,null)))},i:t,o:t,d(t){t&&f(n),p(V,t),U.d(),P.d(),q=!1,T()}}}function ye(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i=null}=e,c="30",l=.6,a=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(11,i=t.questions)},[s,r,c,l,a,o,()=>{tt.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{tt.setView("ViewTopicList")},()=>{tt.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;bt(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(11,i=await(async(t,e,n)=>{const o=nt.transaction(["questions"],"readonly").objectStore("questions");let s=[];return t.forEach((t=>{s.push(mt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if(pt(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),pt(o)),o.splice(0,e)}))})(r,t,l)),n(4,a=!0)}catch(t){et.addError("ViewTagInfo: "+t.message)}},i,function(){c=C(this),n(2,c)},function(){l=w(this.value),n(3,l)},function(){o=C(this),n(5,o)}]}class Se extends Y{constructor(t){super(),K(this,t,ye,Ce,i,{tag:0,topics:1,questions:11})}}function qe(t){let e,n,o,s,r,i,c,l,a,p,b,w;return i=new pe({props:{questions:t[1]}}),{c(){e=h("div"),n=h("h4"),o=g("Tag: "),s=g(t[0]),r=m(),F(i.$$.fragment),c=m(),l=h("div"),a=h("button"),a.textContent="Back",v(a,"class","button"),v(l,"class","is-floating"),v(e,"class","card card-shadow content")},m(f,h){d(f,e,h),u(e,n),u(n,o),u(n,s),u(e,r),Q(i,e,null),u(e,c),u(e,l),u(l,a),p=!0,b||(w=$(a,"click",t[4]),b=!0)},p(t,[e]){(!p||1&e)&&x(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){p||(D(i.$$.fragment,t),p=!0)},o(t){z(i.$$.fragment,t),p=!1},d(t){t&&f(e),J(i),b=!1,w()}}}function Te(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{tt.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class Le extends Y{constructor(t){super(),K(this,t,Te,qe,i,{tag:0,topics:3,questions:1})}}function Ve(e){let n,o,s,r,i,c,l,a,p,b,$,w,_,k,C,y,S,q,T,L,V,E,j,U,A=e[0][0]+"",H=e[0][1]+"",P=e[0][2]+"",M=e[0][3]+"";return{c(){n=h("table"),o=h("tr"),s=h("td"),s.textContent="No correct Answers",r=m(),i=h("td"),c=g(A),l=m(),a=h("tr"),p=h("td"),p.textContent="One correct Answer",b=m(),$=h("td"),w=g(H),_=m(),k=h("tr"),C=h("td"),C.textContent="Two correct Answers",y=m(),S=h("td"),q=g(P),T=m(),L=h("tr"),V=h("td"),V.textContent="Learned",E=m(),j=h("td"),U=g(M),v(n,"class","table hide-md")},m(t,e){d(t,n,e),u(n,o),u(o,s),u(o,r),u(o,i),u(i,c),u(n,l),u(n,a),u(a,p),u(a,b),u(a,$),u($,w),u(n,_),u(n,k),u(k,C),u(k,y),u(k,S),u(S,q),u(n,T),u(n,L),u(L,V),u(L,E),u(L,j),u(j,U)},p(t,[e]){1&e&&A!==(A=t[0][0]+"")&&x(c,A),1&e&&H!==(H=t[0][1]+"")&&x(w,H),1&e&&P!==(P=t[0][2]+"")&&x(q,P),1&e&&M!==(M=t[0][3]+"")&&x(U,M)},i:t,o:t,d(t){t&&f(n)}}}function Ee(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class je extends Y{constructor(t){super(),K(this,t,Ee,Ve,i,{statistic:0})}}function Ue(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=h("p")},m(t,o){d(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&f(e)}}}function Ae(t){let e,n,o,s,r,i,c,l,a,p,b,$,w,_,k,C,y,S,q,T=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",V=t[3].toHtml(t[0].answer)+"";l=new ie({props:{question:t[0]}});let E=t[1].details&&Ue(t);return{c(){e=h("div"),n=h("div"),o=h("div"),s=h("div"),r=g("Question: "),i=g(T),c=m(),F(l.$$.fragment),a=m(),p=h("div"),b=h("p"),$=m(),w=h("div"),_=h("h5"),_.textContent="Answer",k=m(),C=h("div"),y=h("p"),S=m(),E&&E.c(),v(s,"class","h5"),v(o,"class","is-flex-spread block"),v(p,"class","card content is-primary"),v(C,"class","card content is-info"),w.hidden=t[2],v(e,"class","grid grid-2")},m(t,f){d(t,e,f),u(e,n),u(n,o),u(o,s),u(s,r),u(s,i),u(o,c),Q(l,o,null),u(n,a),u(n,p),u(p,b),b.innerHTML=L,u(e,$),u(e,w),u(w,_),u(w,k),u(w,C),u(C,y),y.innerHTML=V,u(C,S),E&&E.m(C,null),q=!0},p(t,[e]){(!q||1&e)&&T!==(T=t[0].id+"")&&x(i,T);const n={};1&e&&(n.question=t[0]),l.$set(n),(!q||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&(b.innerHTML=L),(!q||1&e)&&V!==(V=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=V),t[1].details?E?E.p(t,e):(E=Ue(t),E.c(),E.m(C,null)):E&&(E.d(1),E=null),(!q||4&e)&&(w.hidden=t[2])},i(t){q||(D(l.$$.fragment,t),q=!0)},o(t){z(l.$$.fragment,t),q=!1},d(t){t&&f(e),J(l),E&&E.d()}}}function He(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Zt;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class Pe extends Y{constructor(t){super(),K(this,t,He,Ae,i,{question:0,topic:1,hideAnswer:2})}}function Me(t){let e,n,o,r,i,c,l,a,p,b,w,x,_,k,C,y,S,q,T,L,V,E,j,U;function A(t,e){return t[0]?Be:Ne}let H=A(t),P=H(t);return o=new je({props:{statistic:t[3]}}),i=new Pe({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=h("div"),P.c(),n=m(),F(o.$$.fragment),r=m(),F(i.$$.fragment),c=m(),l=h("div"),a=h("button"),p=g("Show"),w=m(),x=h("button"),_=g("Correct"),k=m(),C=h("button"),y=g("Wrong"),S=m(),q=h("button"),T=g("Skip"),L=m(),V=h("button"),V.textContent="Stop",v(a,"class","button"),a.hidden=b=!t[4],v(x,"class","button is-success"),x.hidden=t[4],v(C,"class","button is-danger"),C.hidden=t[4],v(q,"class","button is-warning"),q.hidden=t[4],v(V,"class","button"),v(l,"class","is-floating"),v(e,"class","card card-shadow content")},m(s,f){d(s,e,f),P.m(e,null),u(e,n),Q(o,e,null),u(e,r),Q(i,e,null),u(e,c),u(e,l),u(l,a),u(a,p),u(l,w),u(l,x),u(x,_),u(l,k),u(l,C),u(C,y),u(l,S),u(l,q),u(q,T),u(l,L),u(l,V),E=!0,j||(U=[$(a,"click",t[9]),$(x,"click",t[10]),$(C,"click",t[11]),$(q,"click",t[12]),$(V,"click",t[6])],j=!0)},p(t,s){H===(H=A(t))&&P?P.p(t,s):(P.d(1),P=H(t),P&&(P.c(),P.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!E||16&s&&b!==(b=!t[4]))&&(a.hidden=b),(!E||16&s)&&(x.hidden=t[4]),(!E||16&s)&&(C.hidden=t[4]),(!E||16&s)&&(q.hidden=t[4])},i(t){E||(D(o.$$.fragment,t),D(i.$$.fragment,t),E=!0)},o(t){z(o.$$.fragment,t),z(i.$$.fragment,t),E=!1},d(t){t&&f(e),P.d(),J(o),J(i),j=!1,s(U)}}}function Ne(t){let e,n,o=t[1].title+"";return{c(){e=h("h4"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&x(n,o)},d(t){t&&f(e)}}}function Be(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=h("h4"),n=g("Tag: "),o=g(t[0]),s=m(),r=h("h6"),i=g(c)},m(t,c){d(t,e,c),u(e,n),u(e,o),d(t,s,c),d(t,r,c),u(r,i)},p(t,e){1&e&&x(o,t[0]),2&e&&c!==(c=t[1].title+"")&&x(i,c)},d(t){t&&f(e),t&&f(s),t&&f(r)}}}function Ie(t){let e,n,o=t[2]&&Me(t);return{c(){o&&o.c(),e=b()},m(t,s){o&&o.m(t,s),d(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&D(o,1)):(o=Me(t),o.c(),D(o,1),o.m(e.parentNode,e)):o&&(G(),z(o,1,1,(()=>{o=null})),R())},i(t){n||(D(o),n=!0)},o(t){z(o),n=!1},d(t){o&&o.d(t),t&&f(e)}}}function Oe(t,e,n){let o,s,r,i,{tag:c=null}=e,{topics:l}=e,{questions:a}=e,u=!0;const d=t=>{if(void 0===t)return i.push(s),void f();var e;((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=ft(t.failed,t.total)})(s,t),(e=s,new Promise(((t,n)=>{const o=nt.transaction(["questions"],"readwrite").objectStore("questions");o.put(e).onsuccess=n=>{console.log("Store:",o.name," update:",e),t()}}))).then((()=>{s.progress<3&&i.push(s),0===i.length&&p(),f()}))},f=()=>{n(2,s=i.shift()),n(1,o=l.find((t=>t.file===s.file))),n(3,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(a)),n(4,u=!0),console.log("next",s)};T((()=>{i=a.filter((t=>t.progress<3)),pt(i),f()}));const p=()=>{o?(n(1,o.lastLearned=new Date,o),(t=>{const e=nt.transaction(["topics"],"readwrite").objectStore("topics");it(e,t)})(o),tt.setView("ViewTopicList",{id:o.file})):tt.setView("ViewTopicList")};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(7,l=t.topics),"questions"in t&&n(8,a=t.questions)},[c,o,s,r,u,d,p,l,a,()=>n(4,u=!1),()=>d(!0),()=>d(!1),()=>d()]}class Ge extends Y{constructor(t){super(),K(this,t,Oe,Ie,i,{tag:0,topics:7,questions:8})}}function Re(e){let n,o,r,i,c,l,a,p,b,w,k,C,y,S,q,T,L,V,E,j,U,A,H,P;return{c(){n=h("h4"),n.textContent="Translate",o=m(),r=h("label"),i=g(e[0]),c=m(),l=h("textarea"),a=m(),p=h("label"),b=g(e[1]),w=m(),k=h("textarea"),C=m(),y=h("div"),S=h("button"),S.textContent="Back",q=m(),T=h("button"),T.textContent="Translate",L=m(),V=h("button"),V.textContent="Reset",E=m(),j=h("button"),j.textContent="Switch",U=m(),A=h("p"),A.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',v(r,"for","src"),v(l,"id","src"),v(p,"for","dst"),v(k,"id","dst"),k.readOnly=!0,k.value=e[3],v(S,"class","button"),v(T,"class","button"),v(V,"class","button"),v(j,"class","button"),v(y,"class","is-floating")},m(t,s){d(t,n,s),d(t,o,s),d(t,r,s),u(r,i),d(t,c,s),d(t,l,s),_(l,e[2]),d(t,a,s),d(t,p,s),u(p,b),d(t,w,s),d(t,k,s),d(t,C,s),d(t,y,s),u(y,S),u(y,q),u(y,T),u(y,L),u(y,V),u(y,E),u(y,j),d(t,U,s),d(t,A,s),H||(P=[$(l,"input",e[8]),$(S,"click",e[9]),$(T,"click",e[10]),$(V,"click",e[11]),$(j,"click",e[12])],H=!0)},p(t,[e]){1&e&&x(i,t[0]),4&e&&_(l,t[2]),2&e&&x(b,t[1]),8&e&&(k.value=t[3])},i:t,o:t,d(t){t&&f(n),t&&f(o),t&&f(r),t&&f(c),t&&f(l),t&&f(a),t&&f(p),t&&f(w),t&&f(k),t&&f(C),t&&f(y),t&&f(U),t&&f(A),H=!1,s(P)}}}function De(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",l="";const a=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||et.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,l=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=l),a()},d=()=>{n(2,c=""),n(3,l="")},f=()=>{tt.setView("ViewTopicList")};return[o,s,c,l,a,u,d,f,function(){c=this.value,n(2,c)},()=>f(),()=>a(),()=>d(),()=>u()]}class ze extends Y{constructor(t){super(),K(this,t,De,Re,i,{})}}function Fe(t,e,n){const o=t.slice();return o[9]=e[n],o}function Qe(t){let e,n,o,s,r,i,c,l,a,p,b,w,_,k,C,y=t[9].file+"",S=t[9].value+"",q=at(t[9].lastLoaded)+"";function T(){return t[6](t[9])}return{c(){e=h("tr"),n=h("td"),o=g(y),s=m(),r=h("td"),i=g(S),c=m(),l=h("td"),a=g(q),p=m(),b=h("td"),w=h("button"),w.textContent="Delete",_=m(),v(w,"class","button")},m(t,f){d(t,e,f),u(e,n),u(n,o),u(e,s),u(e,r),u(r,i),u(e,c),u(e,l),u(l,a),u(e,p),u(e,b),u(b,w),u(e,_),k||(C=$(w,"click",T),k=!0)},p(e,n){t=e,1&n&&y!==(y=t[9].file+"")&&x(o,y),1&n&&S!==(S=t[9].value+"")&&x(i,S),1&n&&q!==(q=at(t[9].lastLoaded)+"")&&x(a,q)},d(t){t&&f(e),k=!1,C()}}}function Je(e){let n,o,r,i,c,l,a,g,b,w,x,_,C,y,S,q=e[0],T=[];for(let t=0;t<q.length;t+=1)T[t]=Qe(Fe(e,q,t));return{c(){n=h("div"),o=h("label"),o.textContent="Tag Filter",r=m(),i=h("select"),c=h("option"),c.textContent="By Name",l=h("option"),l.textContent="By Date",a=m(),g=h("table"),b=h("tr"),b.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",w=m();for(let t=0;t<T.length;t+=1)T[t].c();x=m(),_=h("div"),C=h("button"),C.textContent="Back",v(o,"for","sort-select"),c.__value="file",c.value=c.__value,l.__value="lastLoaded",l.value=l.__value,v(i,"id","sort-select"),void 0===e[1]&&H((()=>e[5].call(i))),v(n,"class","block"),v(C,"class","button"),v(_,"class","is-floating")},m(t,s){d(t,n,s),u(n,o),u(n,r),u(n,i),u(i,c),u(i,l),k(i,e[1]),d(t,a,s),d(t,g,s),u(g,b),u(g,w);for(let t=0;t<T.length;t+=1)T[t].m(g,null);d(t,x,s),d(t,_,s),u(_,C),y||(S=[$(i,"change",e[5]),$(i,"change",e[2]),$(C,"click",e[7])],y=!0)},p(t,[e]){if(2&e&&k(i,t[1]),9&e){let n;for(q=t[0],n=0;n<q.length;n+=1){const o=Fe(t,q,n);T[n]?T[n].p(o,e):(T[n]=Qe(o),T[n].c(),T[n].m(g,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=q.length}},i:t,o:t,d(t){t&&f(n),t&&f(a),t&&f(g),p(T,t),t&&f(x),t&&f(_),y=!1,s(S)}}}function We(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),o.sort(((t,e)=>+(e[s]>t[s])||-(e[s]<t[s]))),n(0,o)},i=async()=>{n(0,o=await new Promise(((t,e)=>{const n=nt.transaction(["hash"],"readonly").objectStore("hash"),o=n.getAll();o.onsuccess=e=>{const s=o.result;console.log("Store:",n.name,"get all:",s.length),t(s)},o.onerror=t=>{console.log("Store:",n.name,"get all error:",t),e()}}))),r()},c=async t=>{await(t=>{const e=nt.transaction(["hash"],"readwrite").objectStore("hash");return rt(e,t)})(t),i()},l=()=>{tt.setView("ViewTopicList")};T((()=>{i()}));return[o,s,r,c,l,function(){s=C(this),n(1,s)},t=>c(t.file),()=>l()]}class Ke extends Y{constructor(t){super(),K(this,t,We,Je,i,{})}}function Ye(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=g("..."),n=g(o)},m(t,o){d(t,e,o),d(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&x(n,o)},d(t){t&&f(e),t&&f(n)}}}function Xe(e){let n,o,s,r,i,c,l,a,p,b,$,v,w,_,k,C,y,S,q,T,L,V,E,j=e[0].langUrl+"",U=(e[0].backupUrl?e[0].backupUrl:"")+"",A=(e[0].file?e[0].file:"")+"",H=e[0].token&&Ye(e);return{c(){n=h("table"),o=h("tr"),s=h("td"),s.textContent="Github URL Language",r=m(),i=h("td"),c=g(j),l=m(),a=h("tr"),p=h("td"),p.textContent="Github URL Backup",b=m(),$=h("td"),v=g(U),w=m(),_=h("tr"),k=h("td"),k.textContent="Github File",C=m(),y=h("td"),S=g(A),q=m(),T=h("tr"),L=h("td"),L.textContent="Token",V=m(),E=h("td"),H&&H.c()},m(t,e){d(t,n,e),u(n,o),u(o,s),u(o,r),u(o,i),u(i,c),u(n,l),u(n,a),u(a,p),u(a,b),u(a,$),u($,v),u(n,w),u(n,_),u(_,k),u(_,C),u(_,y),u(y,S),u(n,q),u(n,T),u(T,L),u(T,V),u(T,E),H&&H.m(E,null)},p(t,[e]){1&e&&j!==(j=t[0].langUrl+"")&&x(c,j),1&e&&U!==(U=(t[0].backupUrl?t[0].backupUrl:"")+"")&&x(v,U),1&e&&A!==(A=(t[0].file?t[0].file:"")+"")&&x(S,A),t[0].token?H?H.p(t,e):(H=Ye(t),H.c(),H.m(E,null)):H&&(H.d(1),H=null)},i:t,o:t,d(t){t&&f(n),H&&H.d()}}}function Ze(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class tn extends Y{constructor(t){super(),K(this,t,Ze,Xe,i,{admin:0})}}function en(t){let e,n;return{c(){e=h("div"),n=g(t[2]),v(e,"class","block is-text-success")},m(t,o){d(t,e,o),u(e,n)},p(t,e){4&e&&x(n,t[2])},d(t){t&&f(e)}}}function nn(t){let e,n,o,s;const r=[sn,on],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=b()},m(t,n){i[e].m(t,n),d(t,o,n),s=!0},p(t,s){let l=e;e=c(t),e===l?i[e].p(t,s):(G(),z(i[l],1,1,(()=>{i[l]=null})),R(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),D(n,1),n.m(o.parentNode,o))},i(t){s||(D(n),s=!0)},o(t){z(n),s=!1},d(t){i[e].d(t),t&&f(o)}}}function on(t){let e,n,o,r,i,c,l,a,p,g,b;n=new tn({props:{admin:t[0]}});let w=t[0].file&&t[0].backupUrl&&t[0].token&&rn(t);return{c(){e=h("div"),F(n.$$.fragment),o=m(),r=h("div"),i=h("button"),i.textContent="Back",c=m(),l=h("button"),l.textContent="Update",a=m(),w&&w.c(),v(i,"class","button"),v(l,"class","button"),v(r,"class","is-floating"),v(e,"class","block")},m(s,f){d(s,e,f),Q(n,e,null),u(e,o),u(e,r),u(r,i),u(r,c),u(r,l),u(r,a),w&&w.m(r,null),p=!0,g||(b=[$(i,"click",t[4]),$(l,"click",t[12])],g=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?w?w.p(t,e):(w=rn(t),w.c(),w.m(r,null)):w&&(w.d(1),w=null)},i(t){p||(D(n.$$.fragment,t),p=!0)},o(t){z(n.$$.fragment,t),p=!1},d(t){t&&f(e),J(n),w&&w.d(),g=!1,s(b)}}}function sn(e){let n,o,r,i,c,l,a,p,g,b,w,x,k,C,y,S,q,T,L,V,E,j,U,A,H,P;return{c(){n=h("form"),o=h("div"),r=h("label"),r.textContent="Github URL Language",i=m(),c=h("input"),l=m(),a=h("label"),a.textContent="Github URL Backup",p=m(),g=h("input"),b=m(),w=h("label"),w.textContent="Github File",x=m(),k=h("input"),C=m(),y=h("label"),y.textContent="Token",S=m(),q=h("input"),T=m(),L=h("div"),V=h("button"),V.textContent="Save",E=m(),j=h("button"),j.textContent="Cancel",U=m(),A=h("button"),A.textContent="Back",v(r,"for","langUrl"),v(c,"id","langUrl"),v(c,"type","url"),v(a,"for","backupUrl"),v(g,"id","backupUrl"),v(g,"type","url"),v(w,"for","file"),v(k,"id","file"),v(k,"type","text"),v(y,"for","token"),v(q,"id","token"),v(q,"type","password"),v(o,"class","block"),v(V,"class","button"),v(j,"class","button"),v(A,"class","button"),v(L,"class","is-floating")},m(t,s){var f;d(t,n,s),u(n,o),u(o,r),u(o,i),u(o,c),_(c,e[0].langUrl),u(o,l),u(o,a),u(o,p),u(o,g),_(g,e[0].backupUrl),u(o,b),u(o,w),u(o,x),u(o,k),_(k,e[0].file),u(o,C),u(o,y),u(o,S),u(o,q),_(q,e[0].token),u(n,T),u(n,L),u(L,V),u(L,E),u(L,j),u(L,U),u(L,A),H||(P=[$(c,"input",e[7]),$(g,"input",e[8]),$(k,"input",e[9]),$(q,"input",e[10]),$(j,"click",e[11]),$(A,"click",e[4]),$(n,"submit",(f=e[3],function(t){return t.preventDefault(),f.call(this,t)}))],H=!0)},p(t,e){1&e&&_(c,t[0].langUrl),1&e&&_(g,t[0].backupUrl),1&e&&k.value!==t[0].file&&_(k,t[0].file),1&e&&q.value!==t[0].token&&_(q,t[0].token)},i:t,o:t,d(t){t&&f(n),H=!1,s(P)}}}function rn(e){let n,o,r,i,c;return{c(){n=h("button"),n.textContent="Backup",o=m(),r=h("button"),r.textContent="Restore",v(n,"class","button"),v(r,"class","button")},m(t,s){d(t,n,s),d(t,o,s),d(t,r,s),i||(c=[$(n,"click",e[5]),$(r,"click",e[6])],i=!0)},p:t,d(t){t&&f(n),t&&f(o),t&&f(r),i=!1,s(c)}}}function cn(t){let e,n,o,s,r,i=t[2]&&en(t),c=t[0]&&nn(t);return{c(){e=h("h4"),e.textContent="Configuration",n=m(),i&&i.c(),o=m(),c&&c.c(),s=b()},m(t,l){d(t,e,l),d(t,n,l),i&&i.m(t,l),d(t,o,l),c&&c.m(t,l),d(t,s,l),r=!0},p(t,[e]){t[2]?i?i.p(t,e):(i=en(t),i.c(),i.m(o.parentNode,o)):i&&(i.d(1),i=null),t[0]?c?(c.p(t,e),1&e&&D(c,1)):(c=nn(t),c.c(),D(c,1),c.m(s.parentNode,s)):c&&(G(),z(c,1,1,(()=>{c=null})),R())},i(t){r||(D(c),r=!0)},o(t){z(c),r=!1},d(t){t&&f(e),t&&f(n),i&&i.d(t),t&&f(o),c&&c.d(t),t&&f(s)}}}function ln(t,e,n){let o,s;a(t,_t,(t=>n(13,o=t)));let r=!1,i="";T((async()=>{n(0,s=o)}));return[s,r,i,t=>{s.langUrl&&_t.setAdmin(s),n(1,r=!1)},()=>{tt.setView("ViewTopicList")},async()=>{(async t=>{const{backupUrl:e,headers:n}=yt(),o=await St(e,n);console.log("sha",o);const s={method:"PUT",headers:n,body:JSON.stringify({sha:o,content:(r=JSON.stringify(t),window.btoa(unescape(encodeURIComponent(r)))),message:"backup"})};var r;const i=await fetch(e,s).catch((t=>{et.addError(`githubBackup - url: ${e} error: ${t}`)}));i&&(i.ok||et.addError(`githubBackup - url: ${e} error: ${i.statusText}`))})(await new Promise(((t,e)=>{const n=[],o=nt.transaction(["questions"],"readonly").objectStore("questions"),s=o.openCursor();s.onsuccess=e=>{const r=s.result;if(r){const t=r.value;n.push([t.id,t.failed,t.total]),r.continue()}else console.log("Store:",o.name,"questGetBackup finished:",n.length),t(n)},s.onerror=t=>{console.log("Store:",o.name,"questGetBackup:",t),e()}}))),n(2,i="Backup done!")},async()=>{const t=await(async()=>{const{backupUrl:t,headers:e}=yt(),n=await qt(t,e);if(n)return kt(n.content)})();t&&(vt(t),n(2,i="Restore done!"))},function(){s.langUrl=this.value,n(0,s)},function(){s.backupUrl=this.value,n(0,s)},function(){s.file=this.value,n(0,s)},function(){s.token=this.value,n(0,s)},()=>n(1,r=!1),()=>n(1,r=!0)]}class an extends Y{constructor(t){super(),K(this,t,ln,cn,i,{})}}function un(t){let e,n;return e=new Ut({}),{c(){F(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function dn(t){let n,o,s,r,i,c,l,a,p,g=0!==t[0].length&&un();const b=[t[1].props];var $=t[1].component;function w(t){let n={};for(let t=0;t<b.length;t+=1)n=e(n,b[t]);return{props:n}}return $&&(c=new $(w())),{c(){n=h("div"),o=h("h2"),o.textContent="Cards",s=m(),g&&g.c(),r=m(),i=h("div"),c&&F(c.$$.fragment),l=m(),a=h("div"),a.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',v(i,"id","main"),v(i,"class","block"),v(a,"class","block"),v(n,"class","container")},m(t,e){d(t,n,e),u(n,o),u(n,s),g&&g.m(n,null),u(n,r),u(n,i),c&&Q(c,i,null),u(n,l),u(n,a),p=!0},p(t,[e]){0!==t[0].length?g?1&e&&D(g,1):(g=un(),g.c(),D(g,1),g.m(n,r)):g&&(G(),z(g,1,1,(()=>{g=null})),R());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(b,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if($!==($=t[1].component)){if(c){G();const t=c;z(t.$$.fragment,1,0,(()=>{J(t,1)})),R()}$?(c=new $(w()),F(c.$$.fragment),D(c.$$.fragment,1),Q(c,i,null)):c=null}else $&&c.$set(o)},i(t){p||(D(g),c&&D(c.$$.fragment,t),p=!0)},o(t){z(g),c&&z(c.$$.fragment,t),p=!1},d(t){t&&f(n),g&&g.d(),c&&J(c)}}}function fn(t,e,n){let o,s;return a(t,et,(t=>n(0,o=t))),a(t,tt,(t=>n(1,s=t))),T((()=>{try{(async()=>{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("service-worker.js");console.log("Registration of serivce worker done - scope:",t.scope)}})()}catch(t){et.addError("App onMount(): "+t)}tt.views={ViewTopicList:{component:Yt},ViewTopicInfo:{component:oe},ViewTopicQuests:{component:be},ViewTagInfo:{component:Se},ViewTagQuests:{component:Le},ViewQuestAnswer:{component:Ge},ViewTranslate:{component:ze},ViewHashes:{component:Ke},ViewAdmin:{component:an}},(async()=>{await st(),await _t.initAdmin();const t=await Tt("data/topics.json");t&&xt(t)})().then((()=>{tt.setView("ViewTopicList")}))})),[o,s]}return new class extends Y{constructor(t){super(),K(this,t,fn,dn,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

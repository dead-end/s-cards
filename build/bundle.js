var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(t,e,n){t.$$.on_destroy.push(c(e,n))}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function h(){return g(" ")}function m(){return g("")}function b(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function x(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function _(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let k;function C(t){k=t}function S(){if(!k)throw new Error("Function called outside component initialization");return k}function y(t){S().$$.on_mount.push(t)}const q=[],T=[],V=[],L=[],E=Promise.resolve();let j=!1;function A(t){V.push(t)}const H=new Set;let M=0;function N(){const t=k;do{for(;M<q.length;){const t=q[M];M++,C(t),P(t.$$)}for(C(null),q.length=0,M=0;T.length;)T.pop()();for(let t=0;t<V.length;t+=1){const e=V[t];H.has(e)||(H.add(e),e())}V.length=0}while(q.length);for(;L.length;)L.pop()();j=!1,H.clear(),C(t)}function P(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;let U;function O(){U={r:0,c:[],p:U}}function B(){U.r||s(U.c),U=U.p}function D(t,e){t&&t.i&&(I.delete(t),t.i(e))}function G(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),U.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function z(t){t&&t.c()}function Q(t,e,o,i){const{fragment:c,on_mount:l,on_destroy:a,after_update:u}=t.$$;c&&c.m(e,o),i||A((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(A)}function R(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function J(t,e){-1===t.$$.dirty[0]&&(q.push(t),j||(j=!0,E.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,n,r,i,c,l,a,u=[-1]){const f=k;C(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};a&&a(p.root);let g=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),g&&J(e,t)),n})):[],p.update(),g=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();n.intro&&D(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),N()}C(f)}class W{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const K=[];function Y(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!K.length;for(const t of s)t[1](),K.push(t,e);if(t){for(let t=0;t<K.length;t+=2)K[t][0](K[t+1]);K.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const X=(()=>{const{subscribe:t,set:e,update:n}=Y({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=X.views[t];o.props=n,e(o)}}})(),Z=(()=>{const{subscribe:t,set:e,update:n}=Y([]);return{subscribe:t,addError:t=>{console.log("Added error:",t),n((e=>(e.push(t),e)))},resetErrors:()=>{e([])}}})();let tt;const et=t=>{Z.addError(t.type)},nt=()=>new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{tt=n.result,t.oldVersion<4&&(t=>{if(tt.objectStoreNames.contains("topics")||tt.createObjectStore("topics",{keyPath:"file"}),!tt.objectStoreNames.contains("questions")){const t=tt.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});t.indexNames.contains("file")||t.createIndex("file","file",{unique:!1})}tt.objectStoreNames.contains("hash")||(tt.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")});tt.objectStoreNames.contains("admin")||tt.createObjectStore("admin",{keyPath:"config"}),tt.objectStoreNames.contains("config")&&tt.deleteObjectStore("config")})()},n.onerror=et,n.onsuccess=e=>{tt=n.result,tt.onerror=et,console.log("db init success!"),t()}})),ot=(t,e)=>{const n=t.delete(e);n.onsuccess=n=>{console.log("Store:",t.name,"delete:",e)},n.onerror=n=>{console.log("Store:",t.name,"delete:",e,"error",n)}},st=(t,e)=>{const n=t.put(e);n.onsuccess=n=>{console.log("Store:",t.name,"put:",e)},n.onerror=n=>{console.log("Store:",t.name,"put:",e,"error",n)}},rt=t=>new Promise(((e,n)=>{const o=tt.transaction(["hash"],"readonly").objectStore("hash"),s=o.get(t);s.onsuccess=n=>{const r=s.result?s.result:{file:t};console.log("Store:",o.name,"get:",r),e(r)},s.onerror=e=>{console.log("Store:",o.name,"get:",t,"error",e),n()}})),it=(t,e)=>{const n=t.objectStore("hash");ot(n,e)},ct=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},lt=(t,e)=>{const n=new Map;return t.forEach((t=>{if(!t.hasOwnProperty(e))throw new Error(`Object has no property: ${e}`);const o=t[e];if(n.has(o))throw new Error(`Duplicate key: ${e}`);n.set(o,t)})),n},at=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},ut=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},dt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=t=>{c.result.forEach((t=>{ot(i,t)})),s()}})))(t,"questions","file",e),ft=t=>{const e=tt.transaction(["questions"],"readonly").objectStore("questions");return pt(e,t)},pt=(t,e)=>new Promise(((n,o)=>{const s=t.index("file").getAll(e.file);s.onsuccess=t=>{n(s.result)}})),gt=async(t,e)=>{const n=tt.transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,new Promise(((e,o)=>{n.put(t).onsuccess=t=>{e()}})))));await Promise.all(o)},ht=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=t=>{const r=lt(n,"id"),i=lt(s.result,"id");i.forEach((t=>{r.has(t.id)||ot(o,t.id)})),r.forEach((t=>{i.has(t.id)?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(i.get(t.id),t),st(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{const n=t.add(e);n.onsuccess=n=>{console.log("Store:",t.name,"add:",e)},n.onerror=n=>{console.log("Store:",t.name,"add:",e,"error",n)}})(o,t))}))}},mt=(t,e)=>{const n=t.objectStore("topics");ot(n,e)},bt=t=>{const e=tt.transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=s=>{const r=lt(o.result,"file"),i=t.map((t=>t.file));for(let t of r.keys())i.includes(t)||(mt(e,t),it(e,t),dt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!at(t.tags,e.tags)||!at(t.details,e.details)))(t,r.get(t.file))&&st(n,t)}))}},$t=(()=>{const{subscribe:t,set:e,update:n}=Y();return{subscribe:t,setAdmin:t=>{(t=>{const e=tt.transaction(["admin"],"readwrite").objectStore("admin");st(e,t)})(t),e(t)},initAdmin:async()=>new Promise(((t,e)=>{const n=tt.transaction(["admin"],"readonly").objectStore("admin"),o=n.get("admin");o.onsuccess=e=>{let s=o.result;s||(s={config:"admin",langUrl:"https://api.github.com/repos/dead-end/cards-russian/contents/",token:""}),console.log("Store:",n.name,"langUrl:",s.langUrl),t(s)}})).then((t=>e(t)))}})(),wt=async t=>{const e=function(t){let e;return c(t,(t=>e=t))(),e}($t),n=e.langUrl+t,o=(t=>t&&t.token?{Accept:"application/vnd.github.v3+json",authorization:`token ${t.token}`}:{Accept:"application/vnd.github.v3+json"})(e);let s=await rt(t);if(s.value){const t=await(async(t,e,n)=>{const o=await fetch(t,{method:"HEAD",headers:e}).catch((e=>{Z.addError(`githubCheckEtag - url: ${t} error: ${e}`)}));if(!o)return!1;if(!o.ok)return Z.addError(`githubCheckEtag - url: ${t} status: ${o.statusText}`),!1;const s=o.headers.get("ETag");if(!s)return console.log("url :",t,"no ETag found"),!1;const r=s.endsWith('"'+n+'"');return console.log("url :",t,"ETag",s,"matches",r),r})(n,o,s.value);if(t)return}const r=await(async(t,e)=>{const n=await fetch(t,e).catch((e=>{Z.addError(`githubGetJsonContent - url: ${t} error: ${e}`)}));if(n){if(n.ok)return n.json();Z.addError(`githubGetJsonContent - url: ${t} error: ${n.statusText}`)}})(n,o);if(!r)return;let i;try{i=JSON.parse((l=r.content,decodeURIComponent(escape(window.atob(l)))))}catch(t){return void Z.addError(`githubGetJson - url: ${n} unable to parse data: ${t}`)}var l;return s.value=r.sha,s.lastLoaded=new Date,await(t=>new Promise(((e,n)=>{const o=tt.transaction(["hash"],"readwrite").objectStore("hash"),s=o.put(t);s.onsuccess=n=>{console.log("Store:",o.name,"put:",t),e()},s.onerror=e=>{console.log("Store:",o.name,"put:",t,"error",e),n()}})))(s),console.log("githubGetJson",i),i},vt=async t=>{const e=await wt(t);if(e){const n=tt.transaction(["questions"],"readwrite");ht(n,t,e)}};function xt(t,e,n){const o=t.slice();return o[2]=e[n],o}function _t(t){let e,n,o=t[2]+"";return{c(){e=p("li"),n=g(o)},m(t,o){u(t,e,o),a(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&w(n,o)},d(t){t&&d(e)}}}function kt(e){let n,o,s,r,i,c,l,g,m,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=_t(xt(e,w,t));return{c(){n=p("div"),o=p("h4"),o.textContent="Errors",s=h(),r=p("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=h(),c=p("div"),l=p("button"),l.textContent="Ok",$(o,"class","is-text-danger"),$(l,"class","button"),$(c,"class","buttons"),$(n,"class","card card-shadow block content")},m(t,d){u(t,n,d),a(n,o),a(n,s),a(n,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);a(n,i),a(n,c),a(c,l),g||(m=b(l,"click",e[1]),g=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=xt(t,w,n);v[n]?v[n].p(o,e):(v[n]=_t(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&d(n),f(v,t),g=!1,m()}}}function Ct(t,e,n){let o;l(t,Z,(t=>n(0,o=t)));return[o,()=>{Z.resetErrors()}]}class St extends W{constructor(t){super(),F(this,t,Ct,kt,i,{})}}function yt(t){let e,n,o,s,r,i,c,l,f,b,$,v,x,_,k=t[4]&&qt(t);return{c(){e=p("tr"),n=p("td"),n.textContent="Questions",o=h(),s=p("td"),r=g(t[2]),i=h(),c=p("tr"),l=p("td"),l.textContent="Status",f=h(),b=p("td"),$=g(t[1]),v=g("%"),x=h(),k&&k.c(),_=m()},m(t,d){u(t,e,d),a(e,n),a(e,o),a(e,s),a(s,r),u(t,i,d),u(t,c,d),a(c,l),a(c,f),a(c,b),a(b,$),a(b,v),u(t,x,d),k&&k.m(t,d),u(t,_,d)},p(t,e){4&e&&w(r,t[2]),2&e&&w($,t[1]),t[4]?k?k.p(t,e):(k=qt(t),k.c(),k.m(_.parentNode,_)):k&&(k.d(1),k=null)},d(t){t&&d(e),t&&d(i),t&&d(c),t&&d(x),k&&k.d(t),t&&d(_)}}}function qt(t){let e,n,o,s,r,i,c,l,f,m,b,$=ct(t[4].lastLoaded)+"",v=(t[4].value?t[4].value:"")+"";return{c(){e=p("tr"),n=p("td"),n.textContent="Last loaded",o=h(),s=p("td"),r=g($),i=h(),c=p("tr"),l=p("td"),l.textContent="Hash",f=h(),m=p("td"),b=g(v)},m(t,d){u(t,e,d),a(e,n),a(e,o),a(e,s),a(s,r),u(t,i,d),u(t,c,d),a(c,l),a(c,f),a(c,m),a(m,b)},p(t,e){16&e&&$!==($=ct(t[4].lastLoaded)+"")&&w(r,$),16&e&&v!==(v=(t[4].value?t[4].value:"")+"")&&w(b,v)},d(t){t&&d(e),t&&d(i),t&&d(c)}}}function Tt(t){let e,n,o=t[0].desc+"";return{c(){e=p("p"),n=g(o)},m(t,o){u(t,e,o),a(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&w(n,o)},d(t){t&&d(e)}}}function Vt(e){let n,o,s,r,i,c,l,f,b,$,v,x,_,k,C,S,y,q,T=e[0].title+"",V=ct(e[0].lastLearned)+"",L=e[0].tags.join(", ")+"",E=e[3]&&yt(e),j=e[0].desc&&Tt(e);return{c(){n=p("h4"),o=g(T),s=h(),r=p("table"),i=p("tr"),c=p("td"),c.textContent="Last learned",l=h(),f=p("td"),b=g(V),$=h(),v=p("tr"),x=p("td"),x.textContent="Tags",_=h(),k=p("td"),C=g(L),S=h(),E&&E.c(),y=h(),j&&j.c(),q=m()},m(t,e){u(t,n,e),a(n,o),u(t,s,e),u(t,r,e),a(r,i),a(i,c),a(i,l),a(i,f),a(f,b),a(r,$),a(r,v),a(v,x),a(v,_),a(v,k),a(k,C),a(r,S),E&&E.m(r,null),u(t,y,e),j&&j.m(t,e),u(t,q,e)},p(t,[e]){1&e&&T!==(T=t[0].title+"")&&w(o,T),1&e&&V!==(V=ct(t[0].lastLearned)+"")&&w(b,V),1&e&&L!==(L=t[0].tags.join(", ")+"")&&w(C,L),t[3]?E?E.p(t,e):(E=yt(t),E.c(),E.m(r,null)):E&&(E.d(1),E=null),t[0].desc?j?j.p(t,e):(j=Tt(t),j.c(),j.m(q.parentNode,q)):j&&(j.d(1),j=null)},i:t,o:t,d(t){t&&d(n),t&&d(s),t&&d(r),E&&E.d(),t&&d(y),j&&j.d(t),t&&d(q)}}}function Lt(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return y((async()=>{c&&n(4,o=await rt(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class Et extends W{constructor(t){super(),F(this,t,Lt,Vt,i,{topic:0,status:1,size:2,details:3})}}function jt(t){let e,n,o,s,r,i,c,l,f;return n=new Et({props:{topic:t[0],details:!1}}),{c(){e=p("div"),z(n.$$.fragment),o=h(),s=p("div"),r=p("button"),r.textContent="Show",$(r,"class","button"),$(s,"class","buttons"),$(e,"class","card card-shadow content"),$(e,"id",i=t[0].file)},m(i,d){u(i,e,d),Q(n,e,null),a(e,o),a(e,s),a(s,r),c=!0,l||(f=b(r,"click",t[2]),l=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&$(e,"id",i)},i(t){c||(D(n.$$.fragment,t),c=!0)},o(t){G(n.$$.fragment,t),c=!1},d(t){t&&d(e),R(n),l=!1,f()}}}function At(t,e,n){let{topic:o}=e;const s=t=>{X.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Ht extends W{constructor(t){super(),F(this,t,At,jt,i,{topic:0})}}function Mt(t,e,n){const o=t.slice();return o[11]=e[n],o}function Nt(t,e,n){const o=t.slice();return o[14]=e[n],o}function Pt(t){let e,n,o,r,i,c,l,g,m,w,v,_,k,C,S,y=t[1],q=[];for(let e=0;e<y.length;e+=1)q[e]=It(Nt(t,y,e));let T=t[2]&&Ut(t);return{c(){e=p("div"),n=p("label"),n.textContent="Tag Filter",o=h(),r=p("select"),i=p("option"),i.textContent="-- Select --";for(let t=0;t<q.length;t+=1)q[t].c();c=h(),l=p("div"),T&&T.c(),g=h(),m=p("button"),m.textContent="Translate",w=h(),v=p("button"),v.textContent="Hashes",_=h(),k=p("button"),k.textContent="Admin",$(n,"for","tag-select"),i.__value="",i.value=i.__value,$(r,"id","tag-select"),void 0===t[2]&&A((()=>t[5].call(r))),$(e,"class","block"),$(m,"class","button"),$(v,"class","button"),$(k,"class","button"),$(l,"class","buttons")},m(s,d){u(s,e,d),a(e,n),a(e,o),a(e,r),a(r,i);for(let t=0;t<q.length;t+=1)q[t].m(r,null);x(r,t[2]),u(s,c,d),u(s,l,d),T&&T.m(l,null),a(l,g),a(l,m),a(l,w),a(l,v),a(l,_),a(l,k),C||(S=[b(r,"change",t[5]),b(r,"change",t[3]),b(m,"click",t[7]),b(v,"click",t[8]),b(k,"click",t[9])],C=!0)},p(t,e){if(2&e){let n;for(y=t[1],n=0;n<y.length;n+=1){const o=Nt(t,y,n);q[n]?q[n].p(o,e):(q[n]=It(o),q[n].c(),q[n].m(r,null))}for(;n<q.length;n+=1)q[n].d(1);q.length=y.length}6&e&&x(r,t[2]),t[2]?T?T.p(t,e):(T=Ut(t),T.c(),T.m(l,g)):T&&(T.d(1),T=null)},d(t){t&&d(e),f(q,t),t&&d(c),t&&d(l),T&&T.d(),C=!1,s(S)}}}function It(t){let e,n,o,s=t[14]+"";return{c(){e=p("option"),n=g(s),e.__value=o=t[14],e.value=e.__value},m(t,o){u(t,e,o),a(e,n)},p(t,r){2&r&&s!==(s=t[14]+"")&&w(n,s),2&r&&o!==(o=t[14])&&(e.__value=o,e.value=e.__value)},d(t){t&&d(e)}}}function Ut(e){let n,o,s;return{c(){n=p("button"),n.textContent="Show",$(n,"class","button")},m(t,r){u(t,n,r),o||(s=b(n,"click",e[6]),o=!0)},p:t,d(t){t&&d(n),o=!1,s()}}}function Ot(t){let e,n;return e=new Ht({props:{topic:t[11]}}),{c(){z(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[11]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function Bt(t){let e,n,o,s=t[1]&&Pt(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Ot(Mt(t,r,e));const c=t=>G(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=h(),n=p("div");for(let t=0;t<i.length;t+=1)i[t].c();$(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),u(t,e,r),u(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?s.p(t,o):(s=Pt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Mt(t,r,e);i[e]?(i[e].p(s,o),D(i[e],1)):(i[e]=Ot(s),i[e].c(),D(i[e],1),i[e].m(n,null))}for(O(),e=r.length;e<i.length;e+=1)c(e);B()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)D(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)G(i[t]);o=!1},d(t){s&&s.d(t),t&&d(e),t&&d(n),f(i,t)}}}function Dt(t,e,n){let o,s,{id:r=null}=e,i=[],c=[];var l;y((()=>{new Promise(((t,e)=>{const n=tt.transaction(["topics"],"readonly").objectStore("topics"),o=n.getAll();o.onsuccess=e=>{console.log("Store:",n.name,"topicGetAll:"),t(o.result)},o.onerror=t=>{console.log("Store:",n.name,"topicGetAll error:",t),e()}})).then((t=>{i=t,n(0,c=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(i))}))})),l=()=>{if(r){const t=document.getElementById(r);t&&t.scrollIntoView()}},S().$$.after_update.push(l);return t.$$set=t=>{"id"in t&&n(4,r=t.id)},[c,o,s,()=>{n(0,c=s?i.filter((t=>t.tags.includes(s))):i)},r,function(){s=_(this),n(2,s),n(1,o)},()=>X.setView("ViewTagInfo",{tag:s,topics:c}),()=>X.setView("ViewTranslate"),()=>X.setView("ViewHashes"),()=>X.setView("ViewAdmin")]}class Gt extends W{constructor(t){super(),F(this,t,Dt,Bt,i,{id:4})}}class zt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(){if(this.count%2)throw new Error(`Unbalanced tag: ${this.md} count: ${this.count}`);this.count=0}}class Qt{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new zt(t,e)}_pattern(){let t="";for(let e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){if(!this.map.hasOwnProperty(t))throw new Error("Unknown element: "+t);return this.map[t].getTag()}_check(){for(let t in this.map)this.map[t].check()}_substitute(t){const e=this;return t.replaceAll(this.regex,(function(t){return e.tag(t)}))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(let o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(),n}}function Rt(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=p("div"),n=p("h5"),n.textContent="Details",o=h(),s=p("div"),r=p("p"),$(s,"class","card content is-info")},m(t,c){u(t,e,c),a(e,n),a(e,o),a(e,s),a(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&d(e)}}}function Jt(t){let e,n,o,r,i,c,l,f,m,w,v,x,_,k,C,S,y,q,T,V,L,E,j,A,H,M;r=new Et({props:{topic:t[0],status:t[1],size:t[3]}});let N=t[0].details&&Rt(t);return{c(){e=p("div"),n=p("div"),o=p("div"),z(r.$$.fragment),i=h(),c=p("div"),l=p("label"),l.textContent="Number of correct answers",f=h(),m=p("select"),w=p("option"),w.textContent="-- Select --",v=p("option"),v.textContent="Set 0",x=p("option"),x.textContent="Set 1",_=p("option"),_.textContent="Set 2",k=p("option"),k.textContent="Set 3",C=h(),N&&N.c(),S=h(),y=p("div"),q=p("button"),q.textContent="Back",T=h(),V=p("button"),V.textContent="Listing",L=h(),E=p("button"),j=g("Start"),$(o,"class","is-text-left"),$(l,"for","sf-set"),w.__value="",w.value=w.__value,v.__value="0",v.value=v.__value,x.__value="1",x.value=x.__value,_.__value="2",_.value=_.__value,k.__value="3",k.value=k.__value,$(m,"id","sf-set"),$(n,"class","grid grid-4"),$(q,"class","button"),$(V,"class","button"),$(E,"class","button"),E.disabled=t[2],$(y,"class","buttons"),$(e,"class","card card-shadow content")},m(s,d){u(s,e,d),a(e,n),a(n,o),Q(r,o,null),a(n,i),a(n,c),a(c,l),a(c,f),a(c,m),a(m,w),a(m,v),a(m,x),a(m,_),a(m,k),a(n,C),N&&N.m(n,null),a(e,S),a(e,y),a(y,q),a(y,T),a(y,V),a(y,L),a(y,E),a(E,j),A=!0,H||(M=[b(m,"change",t[8]),b(q,"click",t[5]),b(V,"click",t[6]),b(E,"click",t[7])],H=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?N?N.p(t,e):(N=Rt(t),N.c(),N.m(n,null)):N&&(N.d(1),N=null),(!A||4&e)&&(E.disabled=t[2])},i(t){A||(D(r.$$.fragment,t),A=!0)},o(t){G(r.$$.fragment,t),A=!1},d(t){t&&d(e),R(r),N&&N.d(),H=!1,s(M)}}}function Ft(t,e,n){let{topic:o}=e,{questions:s=null}=e;const r=new Qt;let i=0,c=!0,l=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return ut(n,t.length*e)})(t,3)),n(2,c=((t,e)=>{for(let n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,l=t.length)};y((async()=>{try{s||(await vt(o.file),console.log("Loading questions for topics"),n(9,s=await ft(o)),a())}catch(t){Z.addError("ViewTopicInfo: "+t.message)}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,l,r,()=>{X.setView("ViewTopicList",{id:o.file})},()=>{X.setView("ViewTopicQuests",{topic:o})},()=>{X.setView("ViewQuestAnswer",{topics:[o],questions:s})},t=>{const e=t.target;s&&(gt(s,e.selectedIndex-1),e.selectedIndex=0,a())},s]}class Wt extends W{constructor(t){super(),F(this,t,Ft,Jt,i,{topic:0,questions:9})}}function Kt(e){let n,o,s,r,i,c,l,f,m,b,v,x,_,k,C,S=e[0].progress+"",y=e[0].total+"",q=e[0].ratio+"";return{c(){n=p("div"),o=g("Progress: "),s=p("span"),r=g(S),i=g(" /\n  "),c=p("span"),c.textContent="3",l=h(),f=p("span"),m=g("Total: "),b=p("span"),v=g(y),x=g(" Wrong:\n    "),_=p("span"),k=g(q),C=g("%"),$(s,"class","is-text-success"),$(c,"class","is-text-success"),$(b,"class","is-text-success"),$(_,"class","is-text-danger"),$(f,"class","hide-sm"),$(n,"class","h6")},m(t,e){u(t,n,e),a(n,o),a(n,s),a(s,r),a(n,i),a(n,c),a(n,l),a(n,f),a(f,m),a(f,b),a(b,v),a(f,x),a(f,_),a(_,k),a(_,C)},p(t,[e]){1&e&&S!==(S=t[0].progress+"")&&w(r,S),1&e&&y!==(y=t[0].total+"")&&w(v,y),1&e&&q!==(q=t[0].ratio+"")&&w(k,q)},i:t,o:t,d(t){t&&d(n)}}}function Yt(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class Xt extends W{constructor(t){super(),F(this,t,Yt,Kt,i,{question:0})}}function Zt(t,e,n){const o=t.slice();return o[4]=e[n],o}function te(t){let e,n,o,s,r,i=t[1]>1&&ee(t);return s=new Xt({props:{question:t[4]}}),{c(){e=p("div"),n=p("div"),i&&i.c(),o=h(),z(s.$$.fragment),$(e,"class","is-flex-spread grid-full")},m(t,c){u(t,e,c),a(e,n),i&&i.m(n,null),a(e,o),Q(s,e,null),r=!0},p(t,e){t[1]>1?i?i.p(t,e):(i=ee(t),i.c(),i.m(n,null)):i&&(i.d(1),i=null);const o={};1&e&&(o.question=t[4]),s.$set(o)},i(t){r||(D(s.$$.fragment,t),r=!0)},o(t){G(s.$$.fragment,t),r=!1},d(t){t&&d(e),i&&i.d(),R(s)}}}function ee(t){let e,n,o,s,r,i,c=t[4].id+"",l=t[4].file+"";return{c(){e=p("span"),n=g("Id: "),o=g(c),s=h(),r=p("span"),i=g(l),$(e,"class","h6"),$(r,"class","hide-sm")},m(t,c){u(t,e,c),a(e,n),a(e,o),u(t,s,c),u(t,r,c),a(r,i)},p(t,e){1&e&&c!==(c=t[4].id+"")&&w(o,c),1&e&&l!==(l=t[4].file+"")&&w(i,l)},d(t){t&&d(e),t&&d(s),t&&d(r)}}}function ne(t){let e,n,o,s,r,i,c,l,f,g,m,b,w=t[2].toHtml(t[4].quest)+"",v=t[2].toHtml(t[4].answer)+"",x=t[1]>0&&te(t);return{c(){x&&x.c(),e=h(),n=p("div"),o=p("div"),s=p("p"),i=h(),c=p("div"),l=p("div"),f=p("p"),g=h(),$(o,"class","content"),$(n,"class",r="card "+t[3]()),$(l,"class","content"),$(c,"class",m="card "+t[3]())},m(t,r){x&&x.m(t,r),u(t,e,r),u(t,n,r),a(n,o),a(o,s),s.innerHTML=w,u(t,i,r),u(t,c,r),a(c,l),a(l,f),f.innerHTML=v,a(c,g),b=!0},p(t,n){t[1]>0?x?(x.p(t,n),2&n&&D(x,1)):(x=te(t),x.c(),D(x,1),x.m(e.parentNode,e)):x&&(O(),G(x,1,1,(()=>{x=null})),B()),(!b||1&n)&&w!==(w=t[2].toHtml(t[4].quest)+"")&&(s.innerHTML=w),(!b||1&n)&&v!==(v=t[2].toHtml(t[4].answer)+"")&&(f.innerHTML=v)},i(t){b||(D(x),b=!0)},o(t){G(x),b=!1},d(t){x&&x.d(t),t&&d(e),t&&d(n),t&&d(i),t&&d(c)}}}function oe(t){let e,n,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=ne(Zt(t,o,e));const r=t=>G(s[t],1,1,(()=>{s[t]=null}));return{c(){e=p("div");for(let t=0;t<s.length;t+=1)s[t].c();$(e,"class","grid grid-2")},m(t,o){u(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(15&n){let i;for(o=t[0],i=0;i<o.length;i+=1){const r=Zt(t,o,i);s[i]?(s[i].p(r,n),D(s[i],1)):(s[i]=ne(r),s[i].c(),D(s[i],1),s[i].m(e,null))}for(O(),i=o.length;i<s.length;i+=1)r(i);B()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)D(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)G(s[t]);n=!1},d(t){t&&d(e),f(s,t)}}}function se(t,e,n){let{questions:o}=e,{details:s}=e;const r=new Qt,i=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(0,o=t.questions),"details"in t&&n(1,s=t.details)},[o,s,r,i]}class re extends W{constructor(t){super(),F(this,t,se,oe,i,{questions:0,details:1})}}function ie(t){let e,n,o,r,i,c,l,f,m,v,_,k,C,S,y,q,T,V,L,E=t[0].title+"";return C=new re({props:{questions:t[1],details:parseInt(t[2])}}),{c(){e=p("div"),n=p("h4"),o=g(E),r=h(),i=p("div"),c=p("label"),c.textContent="Details",l=h(),f=p("select"),m=p("option"),m.textContent="Simple",v=p("option"),v.textContent="Progress",_=p("option"),_.textContent="ID's",k=h(),z(C.$$.fragment),S=h(),y=p("div"),q=p("button"),q.textContent="Back",$(c,"for","details-select"),m.__value="0",m.value=m.__value,v.__value="1",v.value=v.__value,_.__value="2",_.value=_.__value,$(f,"id","details-select"),void 0===t[2]&&A((()=>t[4].call(f))),$(i,"class","block"),$(q,"class","button"),$(y,"class","buttons"),$(e,"class","card card-shadow content")},m(s,d){u(s,e,d),a(e,n),a(n,o),a(e,r),a(e,i),a(i,c),a(i,l),a(i,f),a(f,m),a(f,v),a(f,_),x(f,t[2]),a(e,k),Q(C,e,null),a(e,S),a(e,y),a(y,q),T=!0,V||(L=[b(f,"change",t[4]),b(q,"click",t[5])],V=!0)},p(t,[e]){(!T||1&e)&&E!==(E=t[0].title+"")&&w(o,E),4&e&&x(f,t[2]);const n={};2&e&&(n.questions=t[1]),4&e&&(n.details=parseInt(t[2])),C.$set(n)},i(t){T||(D(C.$$.fragment,t),T=!0)},o(t){G(C.$$.fragment,t),T=!1},d(t){t&&d(e),R(C),V=!1,s(L)}}}function ce(t,e,n){let{topic:o}=e,s=[],r="0";y((()=>{ft(o).then((t=>{n(1,s=t)}))}));const i=t=>{X.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,i,function(){r=_(this),n(2,r)},()=>i(o)]}class le extends W{constructor(t){super(),F(this,t,ce,ie,i,{topic:0})}}function ae(t,e,n){const o=t.slice();return o[9]=e[n],o}function ue(t){let e,n,o=t[9].title+"";return{c(){e=p("li"),n=g(o)},m(t,o){u(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[9].title+"")&&w(n,o)},d(t){t&&d(e)}}}function de(e){let n,o,r,i,c,l,m,v,_,k,C,S,y,q,T,V,L,E,j,H,M,N,P,I,U,O,B,D,G=e[1],z=[];for(let t=0;t<G.length;t+=1)z[t]=ue(ae(e,G,t));return{c(){n=p("div"),o=p("div"),r=p("div"),i=p("h4"),c=g("Tag: "),l=g(e[0]),m=h(),v=p("p"),v.textContent="Files incluging the tag:",_=h(),k=p("ul");for(let t=0;t<z.length;t+=1)z[t].c();C=h(),S=p("div"),y=p("label"),y.textContent="Number of correct answers",q=h(),T=p("select"),V=p("option"),V.textContent="-- Select --",L=p("option"),L.textContent="Set 0",E=p("option"),E.textContent="Set 1",j=p("option"),j.textContent="Set 2",H=h(),M=p("div"),N=p("button"),N.textContent="Back",P=h(),I=p("button"),I.textContent="Listing",U=h(),O=p("button"),O.textContent="Start",$(r,"class","is-text-left"),$(o,"class","grid grid-4"),$(y,"for","sf-set"),V.__value="-1",V.value=V.__value,L.__value="0",L.value=L.__value,E.__value="1",E.value=E.__value,j.__value="2",j.value=j.__value,$(T,"id","sf-set"),void 0===e[2]&&A((()=>e[8].call(T))),$(S,"class","block"),$(N,"class","button"),$(I,"class","button"),$(O,"class","button"),$(M,"class","buttons"),$(n,"class","card card-shadow content")},m(t,s){u(t,n,s),a(n,o),a(o,r),a(r,i),a(i,c),a(i,l),a(r,m),a(r,v),a(r,_),a(r,k);for(let t=0;t<z.length;t+=1)z[t].m(k,null);a(n,C),a(n,S),a(S,y),a(S,q),a(S,T),a(T,V),a(T,L),a(T,E),a(T,j),x(T,e[2]),a(n,H),a(n,M),a(M,N),a(M,P),a(M,I),a(M,U),a(M,O),B||(D=[b(T,"change",e[8]),b(T,"change",e[6]),b(N,"click",e[4]),b(I,"click",e[3]),b(O,"click",e[5])],B=!0)},p(t,[e]){if(1&e&&w(l,t[0]),2&e){let n;for(G=t[1],n=0;n<G.length;n+=1){const o=ae(t,G,n);z[n]?z[n].p(o,e):(z[n]=ue(o),z[n].c(),z[n].m(k,null))}for(;n<z.length;n+=1)z[n].d(1);z.length=G.length}4&e&&x(T,t[2])},i:t,o:t,d(t){t&&d(n),f(z,t),B=!1,s(D)}}}function fe(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i=null}=e;return y((async()=>{try{if(!i){const t=[];r.forEach((e=>{t.push(vt(e.file))})),await Promise.all(t),console.log("Loading questions for topics"),n(7,i=await(async(t,e)=>{const n=tt.transaction(["questions"],"readonly").objectStore("questions");let o=[];return t.forEach((t=>{o.push(pt(n,t))})),Promise.all(o).then((t=>{let n=[].concat(...t);return n.sort(((t,e)=>e.ratio-t.ratio)),n.splice(0,e)}))})(r,30))}}catch(t){Z.addError("ViewTagInfo: "+t.message)}})),t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(7,i=t.questions)},[s,r,o,()=>{X.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{X.setView("ViewTopicList")},()=>{X.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;gt(i,e.selectedIndex-1),e.selectedIndex=0},i,function(){o=_(this),n(2,o)}]}class pe extends W{constructor(t){super(),F(this,t,fe,de,i,{tag:0,topics:1,questions:7})}}function ge(t){let e,n,o,s,r,i,c,l,f,m,v,x;return i=new re({props:{questions:t[1]}}),{c(){e=p("div"),n=p("h4"),o=g("Tag: "),s=g(t[0]),r=h(),z(i.$$.fragment),c=h(),l=p("div"),f=p("button"),f.textContent="Back",$(f,"class","button"),$(l,"class","buttons"),$(e,"class","card card-shadow content")},m(d,p){u(d,e,p),a(e,n),a(n,o),a(n,s),a(e,r),Q(i,e,null),a(e,c),a(e,l),a(l,f),m=!0,v||(x=b(f,"click",t[4]),v=!0)},p(t,[e]){(!m||1&e)&&w(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){m||(D(i.$$.fragment,t),m=!0)},o(t){G(i.$$.fragment,t),m=!1},d(t){t&&d(e),R(i),v=!1,x()}}}function he(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{X.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class me extends W{constructor(t){super(),F(this,t,he,ge,i,{tag:0,topics:3,questions:1})}}function be(e){let n,o,s,r,i,c,l,f,m,b,v,x,_,k,C,S,y,q,T,V,L,E,j,A,H=e[0][0]+"",M=e[0][1]+"",N=e[0][2]+"",P=e[0][3]+"";return{c(){n=p("table"),o=p("tr"),s=p("td"),s.textContent="No correct Answers",r=h(),i=p("td"),c=g(H),l=h(),f=p("tr"),m=p("td"),m.textContent="One correct Answer",b=h(),v=p("td"),x=g(M),_=h(),k=p("tr"),C=p("td"),C.textContent="Two correct Answers",S=h(),y=p("td"),q=g(N),T=h(),V=p("tr"),L=p("td"),L.textContent="Learned",E=h(),j=p("td"),A=g(P),$(n,"class","table hide-md")},m(t,e){u(t,n,e),a(n,o),a(o,s),a(o,r),a(o,i),a(i,c),a(n,l),a(n,f),a(f,m),a(f,b),a(f,v),a(v,x),a(n,_),a(n,k),a(k,C),a(k,S),a(k,y),a(y,q),a(n,T),a(n,V),a(V,L),a(V,E),a(V,j),a(j,A)},p(t,[e]){1&e&&H!==(H=t[0][0]+"")&&w(c,H),1&e&&M!==(M=t[0][1]+"")&&w(x,M),1&e&&N!==(N=t[0][2]+"")&&w(q,N),1&e&&P!==(P=t[0][3]+"")&&w(A,P)},i:t,o:t,d(t){t&&d(n)}}}function $e(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class we extends W{constructor(t){super(),F(this,t,$e,be,i,{statistic:0})}}function ve(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=p("p")},m(t,o){u(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&d(e)}}}function xe(t){let e,n,o,s,r,i,c,l,f,m,b,v,x,_,k,C,S,y,q,T=t[0].id+"",V=t[3].toHtml(t[0].quest)+"",L=t[3].toHtml(t[0].answer)+"";l=new Xt({props:{question:t[0]}});let E=t[1].details&&ve(t);return{c(){e=p("div"),n=p("div"),o=p("div"),s=p("div"),r=g("Question: "),i=g(T),c=h(),z(l.$$.fragment),f=h(),m=p("div"),b=p("p"),v=h(),x=p("div"),_=p("h5"),_.textContent="Answer",k=h(),C=p("div"),S=p("p"),y=h(),E&&E.c(),$(s,"class","h5"),$(o,"class","is-flex-spread block"),$(m,"class","card content is-primary"),$(C,"class","card content is-info"),x.hidden=t[2],$(e,"class","grid grid-2")},m(t,d){u(t,e,d),a(e,n),a(n,o),a(o,s),a(s,r),a(s,i),a(o,c),Q(l,o,null),a(n,f),a(n,m),a(m,b),b.innerHTML=V,a(e,v),a(e,x),a(x,_),a(x,k),a(x,C),a(C,S),S.innerHTML=L,a(C,y),E&&E.m(C,null),q=!0},p(t,[e]){(!q||1&e)&&T!==(T=t[0].id+"")&&w(i,T);const n={};1&e&&(n.question=t[0]),l.$set(n),(!q||1&e)&&V!==(V=t[3].toHtml(t[0].quest)+"")&&(b.innerHTML=V),(!q||1&e)&&L!==(L=t[3].toHtml(t[0].answer)+"")&&(S.innerHTML=L),t[1].details?E?E.p(t,e):(E=ve(t),E.c(),E.m(C,null)):E&&(E.d(1),E=null),(!q||4&e)&&(x.hidden=t[2])},i(t){q||(D(l.$$.fragment,t),q=!0)},o(t){G(l.$$.fragment,t),q=!1},d(t){t&&d(e),R(l),E&&E.d()}}}function _e(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Qt;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class ke extends W{constructor(t){super(),F(this,t,_e,xe,i,{question:0,topic:1,hideAnswer:2})}}function Ce(t){let e,n,o,r,i,c,l,f,m,w,v,x,_,k,C,S,y,q,T,V,L,E,j,A;function H(t,e){return t[0]?ye:Se}let M=H(t),N=M(t);return o=new we({props:{statistic:t[3]}}),i=new ke({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=p("div"),N.c(),n=h(),z(o.$$.fragment),r=h(),z(i.$$.fragment),c=h(),l=p("div"),f=p("button"),m=g("Show"),v=h(),x=p("button"),_=g("Correct"),k=h(),C=p("button"),S=g("Wrong"),y=h(),q=p("button"),T=g("Skip"),V=h(),L=p("button"),L.textContent="Stop",$(f,"class","button"),f.hidden=w=!t[4],$(x,"class","button is-success"),x.hidden=t[4],$(C,"class","button is-danger"),C.hidden=t[4],$(q,"class","button is-warning"),q.hidden=t[4],$(L,"class","button"),$(l,"class","buttons"),$(e,"class","card card-shadow content")},m(s,d){u(s,e,d),N.m(e,null),a(e,n),Q(o,e,null),a(e,r),Q(i,e,null),a(e,c),a(e,l),a(l,f),a(f,m),a(l,v),a(l,x),a(x,_),a(l,k),a(l,C),a(C,S),a(l,y),a(l,q),a(q,T),a(l,V),a(l,L),E=!0,j||(A=[b(f,"click",t[9]),b(x,"click",t[10]),b(C,"click",t[11]),b(q,"click",t[12]),b(L,"click",t[6])],j=!0)},p(t,s){M===(M=H(t))&&N?N.p(t,s):(N.d(1),N=M(t),N&&(N.c(),N.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!E||16&s&&w!==(w=!t[4]))&&(f.hidden=w),(!E||16&s)&&(x.hidden=t[4]),(!E||16&s)&&(C.hidden=t[4]),(!E||16&s)&&(q.hidden=t[4])},i(t){E||(D(o.$$.fragment,t),D(i.$$.fragment,t),E=!0)},o(t){G(o.$$.fragment,t),G(i.$$.fragment,t),E=!1},d(t){t&&d(e),N.d(),R(o),R(i),j=!1,s(A)}}}function Se(t){let e,n,o=t[1].title+"";return{c(){e=p("h4"),n=g(o)},m(t,o){u(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&w(n,o)},d(t){t&&d(e)}}}function ye(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=p("h4"),n=g("Tag: "),o=g(t[0]),s=h(),r=p("h6"),i=g(c)},m(t,c){u(t,e,c),a(e,n),a(e,o),u(t,s,c),u(t,r,c),a(r,i)},p(t,e){1&e&&w(o,t[0]),2&e&&c!==(c=t[1].title+"")&&w(i,c)},d(t){t&&d(e),t&&d(s),t&&d(r)}}}function qe(t){let e,n,o=t[2]&&Ce(t);return{c(){o&&o.c(),e=m()},m(t,s){o&&o.m(t,s),u(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&D(o,1)):(o=Ce(t),o.c(),D(o,1),o.m(e.parentNode,e)):o&&(O(),G(o,1,1,(()=>{o=null})),B())},i(t){n||(D(o),n=!0)},o(t){G(o),n=!1},d(t){o&&o.d(t),t&&d(e)}}}function Te(t,e,n){let o,s,r,i,{tag:c=null}=e,{topics:l}=e,{questions:a}=e,u=!0;const d=t=>{if(void 0===t)return i.push(s),void f();var e;((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=ut(t.failed,t.total)})(s,t),(e=s,new Promise(((t,n)=>{const o=tt.transaction(["questions"],"readwrite").objectStore("questions");o.put(e).onsuccess=n=>{console.log("Store:",o.name," update:",e),t()}}))).then((()=>{s.progress<3&&i.push(s),0===i.length&&p(),f()}))},f=()=>{n(2,s=i.shift()),n(1,o=l.find((t=>t.file===s.file))),n(3,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(a)),n(4,u=!0),console.log("next",s)};y((()=>{i=a.filter((t=>t.progress<3)),(t=>{for(let o=0;o<t.length;o++){let s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;let r=t[o];t[o]=t[s],t[s]=r}var e,n})(i),f()}));const p=()=>{o?(n(1,o.lastLearned=new Date,o),(t=>{const e=tt.transaction(["topics"],"readwrite").objectStore("topics");st(e,t)})(o),X.setView("ViewTopicList",{id:o.file})):X.setView("ViewTopicList")};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(7,l=t.topics),"questions"in t&&n(8,a=t.questions)},[c,o,s,r,u,d,p,l,a,()=>n(4,u=!1),()=>d(!0),()=>d(!1),()=>d()]}class Ve extends W{constructor(t){super(),F(this,t,Te,qe,i,{tag:0,topics:7,questions:8})}}function Le(e){let n,o,r,i,c,l,f,m,x,_,k,C,S,y,q,T,V,L,E,j,A,H,M,N;return{c(){n=p("h4"),n.textContent="Translate",o=h(),r=p("label"),i=g(e[0]),c=h(),l=p("textarea"),f=h(),m=p("label"),x=g(e[1]),_=h(),k=p("textarea"),C=h(),S=p("div"),y=p("button"),y.textContent="Translate",q=h(),T=p("button"),T.textContent="Reset",V=h(),L=p("button"),L.textContent="Switch",E=h(),j=p("button"),j.textContent="Back",A=h(),H=p("p"),H.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',$(r,"for","src"),$(l,"id","src"),$(m,"for","dst"),$(k,"id","dst"),k.readOnly=!0,k.value=e[3],$(y,"class","button"),$(T,"class","button"),$(L,"class","button"),$(j,"class","button"),$(S,"class","buttons")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),a(r,i),u(t,c,s),u(t,l,s),v(l,e[2]),u(t,f,s),u(t,m,s),a(m,x),u(t,_,s),u(t,k,s),u(t,C,s),u(t,S,s),a(S,y),a(S,q),a(S,T),a(S,V),a(S,L),a(S,E),a(S,j),u(t,A,s),u(t,H,s),M||(N=[b(l,"input",e[8]),b(y,"click",e[9]),b(T,"click",e[10]),b(L,"click",e[11]),b(j,"click",e[12])],M=!0)},p(t,[e]){1&e&&w(i,t[0]),4&e&&v(l,t[2]),2&e&&w(x,t[1]),8&e&&(k.value=t[3])},i:t,o:t,d(t){t&&d(n),t&&d(o),t&&d(r),t&&d(c),t&&d(l),t&&d(f),t&&d(m),t&&d(_),t&&d(k),t&&d(C),t&&d(S),t&&d(A),t&&d(H),M=!1,s(N)}}}function Ee(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",l="";const a=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||Z.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,l=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=l),a()},d=()=>{n(2,c=""),n(3,l="")},f=()=>{X.setView("ViewTopicList")};return[o,s,c,l,a,u,d,f,function(){c=this.value,n(2,c)},()=>a(),()=>d(),()=>u(),()=>f()]}class je extends W{constructor(t){super(),F(this,t,Ee,Le,i,{})}}function Ae(t,e,n){const o=t.slice();return o[6]=e[n],o}function He(t){let e,n,o,s,r,i,c,l,f,m,b=t[6].file+"",$=t[6].value+"",v=ct(t[6].lastLoaded)+"";return{c(){e=p("tr"),n=p("td"),o=g(b),s=h(),r=p("td"),i=g($),c=h(),l=p("td"),f=g(v),m=h()},m(t,d){u(t,e,d),a(e,n),a(n,o),a(e,s),a(e,r),a(r,i),a(e,c),a(e,l),a(l,f),a(e,m)},p(t,e){1&e&&b!==(b=t[6].file+"")&&w(o,b),1&e&&$!==($=t[6].value+"")&&w(i,$),1&e&&v!==(v=ct(t[6].lastLoaded)+"")&&w(f,v)},d(t){t&&d(e)}}}function Me(e){let n,o,r,i,c,l,g,m,w,v,_,k,C,S,y,q=e[0],T=[];for(let t=0;t<q.length;t+=1)T[t]=He(Ae(e,q,t));return{c(){n=p("div"),o=p("label"),o.textContent="Tag Filter",r=h(),i=p("select"),c=p("option"),c.textContent="By Name",l=p("option"),l.textContent="By Date",g=h(),m=p("table"),w=p("tr"),w.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th>",v=h();for(let t=0;t<T.length;t+=1)T[t].c();_=h(),k=p("div"),C=p("button"),C.textContent="Back",$(o,"for","sort-select"),c.__value="file",c.value=c.__value,l.__value="lastLoaded",l.value=l.__value,$(i,"id","sort-select"),void 0===e[1]&&A((()=>e[4].call(i))),$(n,"class","block"),$(C,"class","button"),$(k,"class","buttons")},m(t,s){u(t,n,s),a(n,o),a(n,r),a(n,i),a(i,c),a(i,l),x(i,e[1]),u(t,g,s),u(t,m,s),a(m,w),a(m,v);for(let t=0;t<T.length;t+=1)T[t].m(m,null);u(t,_,s),u(t,k,s),a(k,C),S||(y=[b(i,"change",e[4]),b(i,"change",e[2]),b(C,"click",e[5])],S=!0)},p(t,[e]){if(2&e&&x(i,t[1]),1&e){let n;for(q=t[0],n=0;n<q.length;n+=1){const o=Ae(t,q,n);T[n]?T[n].p(o,e):(T[n]=He(o),T[n].c(),T[n].m(m,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=q.length}},i:t,o:t,d(t){t&&d(n),t&&d(g),t&&d(m),f(T,t),t&&d(_),t&&d(k),S=!1,s(y)}}}function Ne(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),o.sort(((t,e)=>+(e[s]>t[s])||-(e[s]<t[s]))),n(0,o)},i=()=>{X.setView("ViewTopicList")};y((async()=>{n(0,o=await new Promise(((t,e)=>{const n=tt.transaction(["hash"],"readonly").objectStore("hash"),o=n.getAll();o.onsuccess=e=>{const s=o.result;console.log("Store:",n.name,"get all:",s.length),t(s)},o.onerror=t=>{console.log("Store:",n.name,"get all error:",t),e()}}))),r()}));return[o,s,r,i,function(){s=_(this),n(1,s)},()=>i()]}class Pe extends W{constructor(t){super(),F(this,t,Ne,Me,i,{})}}function Ie(t){let e;function n(t,e){return t[1]?Oe:Ue}let o=n(t),s=o(t);return{c(){s.c(),e=m()},m(t,n){s.m(t,n),u(t,e,n)},p(t,r){o===(o=n(t))&&s?s.p(t,r):(s.d(1),s=o(t),s&&(s.c(),s.m(e.parentNode,e)))},d(t){s.d(t),t&&d(e)}}}function Ue(t){let e,n,o,r,i,c,l,f,m,v,x,_,k,C,S,y,q,T,V,L=t[0].langUrl+"",E=t[0].token&&Be(t);return{c(){e=p("div"),n=p("table"),o=p("tr"),r=p("td"),r.textContent="Github URL",i=h(),c=p("td"),l=g(L),f=h(),m=p("tr"),v=p("td"),v.textContent="Token",x=h(),_=p("td"),E&&E.c(),k=h(),C=p("div"),S=p("button"),S.textContent="Update",y=h(),q=p("button"),q.textContent="Back",$(S,"class","button"),$(q,"class","button"),$(C,"class","buttons"),$(e,"class","block")},m(s,d){u(s,e,d),a(e,n),a(n,o),a(o,r),a(o,i),a(o,c),a(c,l),a(n,f),a(n,m),a(m,v),a(m,x),a(m,_),E&&E.m(_,null),a(e,k),a(e,C),a(C,S),a(C,y),a(C,q),T||(V=[b(S,"click",t[7]),b(q,"click",t[3])],T=!0)},p(t,e){1&e&&L!==(L=t[0].langUrl+"")&&w(l,L),t[0].token?E?E.p(t,e):(E=Be(t),E.c(),E.m(_,null)):E&&(E.d(1),E=null)},d(t){t&&d(e),E&&E.d(),T=!1,s(V)}}}function Oe(t){let e,n,o,r,i,c,l,f,g,m,w,x,_,k,C,S,y,q;return{c(){e=p("form"),n=p("div"),o=p("label"),o.textContent="Github URL language",r=h(),i=p("input"),c=h(),l=p("label"),l.textContent="Token",f=h(),g=p("input"),m=h(),w=p("div"),x=p("button"),x.textContent="Save",_=h(),k=p("button"),k.textContent="Cancel",C=h(),S=p("button"),S.textContent="Back",$(o,"for","langUrl"),$(i,"id","langUrl"),$(i,"type","url"),$(l,"for","token"),$(g,"id","token"),$(g,"type","password"),$(n,"class","block"),$(x,"class","button"),$(k,"class","button"),$(S,"class","button"),$(w,"class","buttons")},m(s,d){var p;u(s,e,d),a(e,n),a(n,o),a(n,r),a(n,i),v(i,t[0].langUrl),a(n,c),a(n,l),a(n,f),a(n,g),v(g,t[0].token),a(e,m),a(e,w),a(w,x),a(w,_),a(w,k),a(w,C),a(w,S),y||(q=[b(i,"input",t[4]),b(g,"input",t[5]),b(k,"click",t[6]),b(S,"click",t[3]),b(e,"submit",(p=t[2],function(t){return t.preventDefault(),p.call(this,t)}))],y=!0)},p(t,e){1&e&&v(i,t[0].langUrl),1&e&&g.value!==t[0].token&&v(g,t[0].token)},d(t){t&&d(e),y=!1,s(q)}}}function Be(t){let e,n,o=t[0].token.substring(0,3)+"";return{c(){e=g(o),n=g("...")},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){1&n&&o!==(o=t[0].token.substring(0,3)+"")&&w(e,o)},d(t){t&&d(e),t&&d(n)}}}function De(e){let n,o,s,r=e[0]&&Ie(e);return{c(){n=p("h4"),n.textContent="Configuration",o=h(),r&&r.c(),s=m()},m(t,e){u(t,n,e),u(t,o,e),r&&r.m(t,e),u(t,s,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=Ie(t),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},i:t,o:t,d(t){t&&d(n),t&&d(o),r&&r.d(t),t&&d(s)}}}function Ge(t,e,n){let o,s;l(t,$t,(t=>n(8,o=t)));let r=!1;y((async()=>{n(0,s=o)}));return[s,r,t=>{s.langUrl&&$t.setAdmin(s),n(1,r=!1)},()=>{X.setView("ViewTopicList")},function(){s.langUrl=this.value,n(0,s)},function(){s.token=this.value,n(0,s)},()=>n(1,r=!1),()=>n(1,r=!0)]}class ze extends W{constructor(t){super(),F(this,t,Ge,De,i,{})}}function Qe(t){let e,n;return e=new St({}),{c(){z(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function Re(t){let n,o,s,r,i,c,l,f,g,m=0!==t[0].length&&Qe();const b=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<b.length;t+=1)n=e(n,b[t]);return{props:n}}return w&&(c=new w(v())),{c(){n=p("div"),o=p("h2"),o.textContent="Cards",s=h(),m&&m.c(),r=h(),i=p("div"),c&&z(c.$$.fragment),l=h(),f=p("div"),f.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',$(i,"id","main"),$(i,"class","block"),$(f,"class","block"),$(n,"class","container")},m(t,e){u(t,n,e),a(n,o),a(n,s),m&&m.m(n,null),a(n,r),a(n,i),c&&Q(c,i,null),a(n,l),a(n,f),g=!0},p(t,[e]){0!==t[0].length?m?1&e&&D(m,1):(m=Qe(),m.c(),D(m,1),m.m(n,r)):m&&(O(),G(m,1,1,(()=>{m=null})),B());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(b,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(w!==(w=t[1].component)){if(c){O();const t=c;G(t.$$.fragment,1,0,(()=>{R(t,1)})),B()}w?(c=new w(v()),z(c.$$.fragment),D(c.$$.fragment,1),Q(c,i,null)):c=null}else w&&c.$set(o)},i(t){g||(D(m),c&&D(c.$$.fragment,t),g=!0)},o(t){G(m),c&&G(c.$$.fragment,t),g=!1},d(t){t&&d(n),m&&m.d(),c&&R(c)}}}function Je(t,e,n){let o,s;return l(t,Z,(t=>n(0,o=t))),l(t,X,(t=>n(1,s=t))),y((()=>{try{(async()=>{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("service-worker.js");console.log("Registration of serivce worker done - scope:",t.scope)}})()}catch(t){Z.addError("App onMount(): "+t)}X.views={ViewTopicList:{component:Gt},ViewTopicInfo:{component:Wt},ViewTopicQuests:{component:le},ViewTagInfo:{component:pe},ViewTagQuests:{component:me},ViewQuestAnswer:{component:Ve},ViewTranslate:{component:je},ViewHashes:{component:Pe},ViewAdmin:{component:ze}},(async()=>{await nt(),await $t.initAdmin();const t=await wt("data/topics.json");t&&bt(t)})().then((()=>{X.setView("ViewTopicList")}))})),[o,s]}return new class extends W{constructor(t){super(),F(this,t,Je,Re,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

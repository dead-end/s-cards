var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function g(){return p(" ")}function h(){return p("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}let v;function x(t){v=t}function _(){if(!v)throw new Error("Function called outside component initialization");return v}function S(t){_().$$.on_mount.push(t)}const y=[],k=[],M=[],E=[],C=Promise.resolve();let H=!1;function T(t){M.push(t)}let q=!1;const j=new Set;function L(){if(!q){q=!0;do{for(let t=0;t<y.length;t+=1){const e=y[t];x(e),P(e.$$)}for(x(null),y.length=0;k.length;)k.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];j.has(e)||(j.add(e),e())}M.length=0}while(y.length);for(;E.length;)E.pop()();H=!1,q=!1,j.clear()}}function P(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const A=new Set;let z;function O(){z={r:0,c:[],p:z}}function V(){z.r||s(z.c),z=z.p}function I(t,e){t&&t.i&&(A.delete(t),t.i(e))}function B(t,e,n,o){if(t&&t.o){if(A.has(t))return;A.add(t),z.c.push((()=>{A.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function D(t){t&&t.c()}function N(t,e,o,i){const{fragment:c,on_mount:l,on_destroy:a,after_update:u}=t.$$;c&&c.m(e,o),i||T((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(T)}function Q(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e){-1===t.$$.dirty[0]&&(y.push(t),H||(H=!0,C.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function W(e,n,r,i,c,l,a,d=[-1]){const f=v;x(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:o(),dirty:d,skip_bound:!1,root:n.target||f.$$.root};a&&a(p.root);let g=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),g&&U(e,t)),n})):[],p.update(),g=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();n.intro&&I(e.$$.fragment),N(e,n.target,n.anchor,n.customElement),L()}x(f)}class R{$destroy(){Q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];function K(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!F.length;for(const t of s)t[1](),F.push(t,e);if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const J=(()=>{const{subscribe:t,set:e,update:n}=K({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=J.views[t];o.props=n,e(o)}}})(),Y=(()=>{const{subscribe:t,set:e,update:n}=K([]);return{subscribe:t,addError:t=>{console.log("Added error:",t),n((e=>(e.push(t),e)))},resetErrors:()=>{e([])}}})(),G=t=>fetch(t).then((e=>{if(!e.ok)throw Error(`Unable to get JSON: ${t} - ${e.statusText}`);return e.json()})).catch((t=>Y.addError(t))),X=t=>fetch(t,{method:"HEAD"}).then((e=>{if(!e.ok)throw Error(`Unable to last modified for: ${t} - ${e.statusText}`);const n=e.headers.get("Last-Modified");if(console.log("url: ",t,"header:",n),n)return new Date(n)})).catch((t=>Y.addError(t)));let Z;const tt=t=>{Y.addError(t.type)},et=()=>new Promise(((t,e)=>{const n=indexedDB.open("s-card",1);n.onupgradeneeded=t=>{Z=n.result,t.oldVersion<1&&(Z.createObjectStore("topics",{keyPath:"file"}),Z.createObjectStore("questions",{keyPath:"id",autoIncrement:!0}).createIndex("file","file",{unique:!1}),Z.createObjectStore("config",{keyPath:"key"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")})},n.onerror=tt,n.onsuccess=e=>{Z=n.result,Z.onerror=tt,console.log("db init success!"),t()}})),nt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()>9?t.getMonth():"0"+t.getMonth(),o=t.getHours()>9?t.getHours():"0"+t.getHours(),s=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${n}.${t.getFullYear()} ${o}:${s}`},ot=(t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return st(n,t.length*e)},st=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},rt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=t=>{c.result.forEach((t=>{i.delete(t).onsuccess=e=>{console.log("Store:",i.name,"deleted:",t)}})),s()}})))(t,"questions","file",e),it=t=>new Promise(((e,n)=>{const o=Z.transaction(["questions"],"readonly").objectStore("questions").index("file").getAll(t.file);o.onsuccess=t=>{e(o.result)}})),ct=t=>new Promise(((e,n)=>{const o=[],s=IDBKeyRange.only(t),r=Z.transaction(["questions"],"readwrite").objectStore("questions"),i=r.index("file").openCursor(s);i.onsuccess=t=>{const n=i.result;if(n){const t=n.value;o.push(t.progress),n.continue()}else console.log("Store:",r.name,"progress values:",o),e(o)}})),lt=t=>{const e=Z.transaction(["topics","questions"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=s=>{const r=((t,e)=>{const n=new Map;return t.forEach((t=>{if(!t.hasOwnProperty(e))throw new Error(`Object has no property: ${e}`);n.set(t[e],t)})),n})(o.result,"file"),i=t.map((t=>t.file));for(let t of r.keys())i.includes(t)||(n.delete(t).onsuccess=()=>{console.log("Store:",n.name,"deleted:",t),rt(e,t)});t.forEach((t=>{at(t,r.get(t.file))&&(n.put(t).onsuccess=e=>{console.log("Store:",n.name,"update:",t.file)})}))}},at=(t,e)=>{if(!e)return!0;if(e.lastModified&&(t.lastModified=e.lastModified),t.title!==e.title||t.desc!==e.desc)return!0;const n=t.details?t.details:[],o=e.details?e.details:[];return n.toString()!==o.toString()},ut=async t=>{console.log(t);const e=(t=>new Promise(((e,n)=>{const o=Z.transaction(["topics"],"readonly").objectStore("topics"),s=o.get(t);s.onsuccess=t=>{const n=s.result.lastModified;console.log("Store:",o.name,"get lastModified:",n),e(n)}})))(t),n=X(t),[o,s]=await Promise.all([e,n]);if(console.log("lmStore",o,"lmJson",s),!s)return;if(o&&o>=s)return;const r=await G(t);r.forEach((e=>((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(e,t))),console.log(r);const i=Z.transaction(["topics","questions"],"readwrite");rt(i,t).then((()=>{((t,e,n)=>new Promise(((o,s)=>{const r=t.objectStore(e);n.forEach((t=>{r.add(t).onsuccess=e=>{console.log("Store:",r.name,"added:",t)}})),o()})))(i,"questions",r).then((()=>{((t,e,n)=>{const o=t.objectStore("topics"),s=o.get(e);o.get(e).onsuccess=t=>{const e=s.result;e.lastModified=n,o.put(e).onsuccess=()=>{console.log("Store:",o.name,"set lastModified:",e)}}})(i,t,s)}))}))},dt=async()=>{await et();const t=new Promise(((t,e)=>{const n=Z.transaction(["config"],"readonly").objectStore("config").get("topics-last-modified");n.onsuccess=e=>{const o=n.result;o?t(o.value):t()}})),e=X("data/topics.json"),[n,o]=await Promise.all([t,e]);console.log("last modified store:",n),console.log("last modified head:",o),o&&(null!==n||n<o)&&await G("data/topics.json").then((t=>{lt(t),(t=>{const e={key:"topics-last-modified",value:t},n=Z.transaction(["config"],"readwrite").objectStore("config");n.put(e).onsuccess=()=>{console.log("Store:",n.name,"set lastModified:",e)}})(o)}))};function ft(t,e,n){const o=t.slice();return o[2]=e[n],o}function pt(t){let e,n,o=t[2]+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&b(n,o)},d(t){t&&u(e)}}}function gt(e){let n,o,s,r,i,c,p,h,b,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=pt(ft(e,w,t));return{c(){n=f("div"),o=f("h4"),o.textContent="Errors",s=g(),r=f("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=g(),c=f("div"),p=f("button"),p.textContent="Ok",$(o,"class","is-text-danger"),$(p,"class","button"),$(c,"class","buttons"),$(n,"class","card card-shadow block content")},m(t,u){a(t,n,u),l(n,o),l(n,s),l(n,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);l(n,i),l(n,c),l(c,p),h||(b=m(p,"click",e[1]),h=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=ft(t,w,n);v[n]?v[n].p(o,e):(v[n]=pt(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&u(n),d(v,t),h=!1,b()}}}function ht(t,e,n){let o;c(t,Y,(t=>n(0,o=t)));return[o,()=>{Y.resetErrors()}]}class mt extends R{constructor(t){super(),W(this,t,ht,gt,i,{})}}function $t(t){let e,n,o=t[0].desc+"";return{c(){e=f("p"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&b(n,o)},d(t){t&&u(e)}}}function bt(e){let n,o,s,r,i,c,d,m,$,w,v,x,_,S,y,k,M,E,C,H,T,q,j,L,P,A,z,O,V,I,B=e[0].title+"",D=nt(e[0].lastModified)+"",N=e[0].tags.join(", ")+"",Q=e[0].desc&&$t(e);return{c(){n=f("h4"),o=p(B),s=g(),r=f("table"),i=f("tr"),c=f("td"),c.textContent="Modified",d=g(),m=f("td"),$=p(D),w=g(),v=f("tr"),x=f("td"),x.textContent="Status",_=g(),S=f("td"),y=p(e[1]),k=p("%"),M=g(),E=f("tr"),C=f("td"),C.textContent="Size",H=g(),T=f("td"),q=p(e[2]),j=g(),L=f("tr"),P=f("td"),P.textContent="Tags",A=g(),z=f("td"),O=p(N),V=g(),Q&&Q.c(),I=h()},m(t,e){a(t,n,e),l(n,o),a(t,s,e),a(t,r,e),l(r,i),l(i,c),l(i,d),l(i,m),l(m,$),l(r,w),l(r,v),l(v,x),l(v,_),l(v,S),l(S,y),l(S,k),l(r,M),l(r,E),l(E,C),l(E,H),l(E,T),l(T,q),l(r,j),l(r,L),l(L,P),l(L,A),l(L,z),l(z,O),a(t,V,e),Q&&Q.m(t,e),a(t,I,e)},p(t,[e]){1&e&&B!==(B=t[0].title+"")&&b(o,B),1&e&&D!==(D=nt(t[0].lastModified)+"")&&b($,D),2&e&&b(y,t[1]),4&e&&b(q,t[2]),1&e&&N!==(N=t[0].tags.join(", ")+"")&&b(O,N),t[0].desc?Q?Q.p(t,e):(Q=$t(t),Q.c(),Q.m(I.parentNode,I)):Q&&(Q.d(1),Q=null)},i:t,o:t,d(t){t&&u(n),t&&u(s),t&&u(r),t&&u(V),Q&&Q.d(t),t&&u(I)}}}function wt(t,e,n){let{topic:o}=e,{status:s=0}=e,{size:r=0}=e;return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"status"in t&&n(1,s=t.status),"size"in t&&n(2,r=t.size)},[o,s,r]}class vt extends R{constructor(t){super(),W(this,t,wt,bt,i,{topic:0,status:1,size:2})}}function xt(t){let e,n,o,s,r,i,c,d,p;return n=new vt({props:{topic:t[0],status:t[1],size:t[2]}}),{c(){e=f("div"),D(n.$$.fragment),o=g(),s=f("div"),r=f("button"),r.textContent="Show",$(r,"class","button"),$(s,"class","buttons"),$(e,"class","card card-shadow content"),$(e,"id",i=t[0].file)},m(i,u){a(i,e,u),N(n,e,null),l(e,o),l(e,s),l(s,r),c=!0,d||(p=m(r,"click",t[4]),d=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),2&o&&(s.status=t[1]),4&o&&(s.size=t[2]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&$(e,"id",i)},i(t){c||(I(n.$$.fragment,t),c=!0)},o(t){B(n.$$.fragment,t),c=!1},d(t){t&&u(e),Q(n),d=!1,p()}}}function _t(t,e,n){let{topic:o}=e,s=0,r=0;const i=t=>{J.setView("TopicShow",{topic:t})};S((()=>{ct(o.file).then((t=>{n(1,s=ot(t,3)),n(2,r=t.length)}))}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,i,()=>i(o)]}class St extends R{constructor(t){super(),W(this,t,_t,xt,i,{topic:0})}}function yt(t,e,n){const o=t.slice();return o[7]=e[n],o}function kt(t,e,n){const o=t.slice();return o[10]=e[n],o}function Mt(t){let e,n,o,r,i,c,p,h=t[1],b=[];for(let e=0;e<h.length;e+=1)b[e]=Et(kt(t,h,e));return{c(){e=f("div"),n=f("label"),n.textContent="Tag Filter",o=g(),r=f("select"),i=f("option"),i.textContent="-- Select --";for(let t=0;t<b.length;t+=1)b[t].c();$(n,"for","tag-select"),i.__value="",i.value=i.__value,$(r,"id","tag-select"),void 0===t[2]&&T((()=>t[5].call(r))),$(e,"class","block")},m(s,u){a(s,e,u),l(e,n),l(e,o),l(e,r),l(r,i);for(let t=0;t<b.length;t+=1)b[t].m(r,null);w(r,t[2]),c||(p=[m(r,"change",t[5]),m(r,"change",t[3])],c=!0)},p(t,e){if(2&e){let n;for(h=t[1],n=0;n<h.length;n+=1){const o=kt(t,h,n);b[n]?b[n].p(o,e):(b[n]=Et(o),b[n].c(),b[n].m(r,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=h.length}6&e&&w(r,t[2])},d(t){t&&u(e),d(b,t),c=!1,s(p)}}}function Et(t){let e,n,o,s=t[10]+"";return{c(){e=f("option"),n=p(s),e.__value=o=t[10],e.value=e.__value},m(t,o){a(t,e,o),l(e,n)},p(t,r){2&r&&s!==(s=t[10]+"")&&b(n,s),2&r&&o!==(o=t[10])&&(e.__value=o,e.value=e.__value)},d(t){t&&u(e)}}}function Ct(t){let e,n;return e=new St({props:{topic:t[7]}}),{c(){D(e.$$.fragment)},m(t,o){N(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[7]),e.$set(o)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Ht(t){let e,n,o,s=t[1]&&Mt(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Ct(yt(t,r,e));const c=t=>B(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=g(),n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();$(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),a(t,e,r),a(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?s.p(t,o):(s=Mt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=yt(t,r,e);i[e]?(i[e].p(s,o),I(i[e],1)):(i[e]=Ct(s),i[e].c(),I(i[e],1),i[e].m(n,null))}for(O(),e=r.length;e<i.length;e+=1)c(e);V()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)I(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)B(i[t]);o=!1},d(t){s&&s.d(t),t&&u(e),t&&u(n),d(i,t)}}}function Tt(t,e,n){let o,s,{id:r=null}=e,i=[],c=[];var l;return S((()=>{new Promise(((t,e)=>{const n=Z.transaction(["topics"],"readonly").objectStore("topics").getAll();n.onsuccess=e=>{t(n.result)}})).then((t=>{i=t,n(0,c=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(i))}))})),l=()=>{if(r){const t=document.getElementById(r);t&&t.scrollIntoView()}},_().$$.after_update.push(l),t.$$set=t=>{"id"in t&&n(4,r=t.id)},[c,o,s,()=>{n(0,c=s?i.filter((t=>t.tags.includes(s))):i)},r,function(){s=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(2,s),n(1,o)}]}class qt extends R{constructor(t){super(),W(this,t,Tt,Ht,i,{id:4})}}class jt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(){if(this.count%2)throw new Error(`Unbalanced tag: ${this.md} count: ${this.count}`);this.count=0}}class Lt{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new jt(t,e)}_pattern(){let t="";for(let e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){if(!this.map.hasOwnProperty(t))throw new Error("Unknown element: "+t);return this.map[t].getTag()}_check(){for(let t in this.map)this.map[t].check()}_substitute(t){const e=this;return t.replaceAll(this.regex,(function(t){return e.tag(t)}))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(let o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(),n}}function Pt(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=f("div"),n=f("h5"),n.textContent="Details",o=g(),s=f("div"),r=f("p"),$(s,"class","card content is-info")},m(t,c){a(t,e,c),l(e,n),l(e,o),l(e,s),l(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&u(e)}}}function At(t){let e,n,o,r,i,c,d,h,b,w,v,x,_,S,y,k,M,E,C,H,T,q,j,L,P,A;r=new vt({props:{topic:t[0],status:t[1],size:t[3]}});let z=t[0].details&&Pt(t);return{c(){e=f("div"),n=f("div"),o=f("div"),D(r.$$.fragment),i=g(),c=f("div"),d=f("label"),d.textContent="Number of correct answers",h=g(),b=f("select"),w=f("option"),w.textContent="-- Select --",v=f("option"),v.textContent="Set 0",x=f("option"),x.textContent="Set 1",_=f("option"),_.textContent="Set 2",S=f("option"),S.textContent="Set 3",y=g(),z&&z.c(),k=g(),M=f("div"),E=f("button"),E.textContent="Back",C=g(),H=f("button"),H.textContent="Listing",T=g(),q=f("button"),j=p("Start"),$(o,"class","is-text-left"),$(d,"for","sf-set"),w.__value="",w.value=w.__value,v.__value="0",v.value=v.__value,x.__value="1",x.value=x.__value,_.__value="2",_.value=_.__value,S.__value="3",S.value=S.__value,$(b,"id","sf-set"),$(n,"class","grid grid-4"),$(E,"class","button"),$(H,"class","button"),$(q,"class","button"),q.disabled=t[2],$(M,"class","buttons"),$(e,"class","card card-shadow content")},m(s,u){a(s,e,u),l(e,n),l(n,o),N(r,o,null),l(n,i),l(n,c),l(c,d),l(c,h),l(c,b),l(b,w),l(b,v),l(b,x),l(b,_),l(b,S),l(n,y),z&&z.m(n,null),l(e,k),l(e,M),l(M,E),l(M,C),l(M,H),l(M,T),l(M,q),l(q,j),L=!0,P||(A=[m(b,"change",t[8]),m(E,"click",t[5]),m(H,"click",t[6]),m(q,"click",t[7])],P=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?z?z.p(t,e):(z=Pt(t),z.c(),z.m(n,null)):z&&(z.d(1),z=null),(!L||4&e)&&(q.disabled=t[2])},i(t){L||(I(r.$$.fragment,t),L=!0)},o(t){B(r.$$.fragment,t),L=!1},d(t){t&&u(e),Q(r),z&&z.d(),P=!1,s(A)}}}function zt(t,e,n){let{topic:o}=e;const s=new Lt;let r=0,i=!0,c=0;const l=()=>{ct(o.file).then((t=>{n(1,r=ot(t,3)),n(2,i=((t,e)=>{for(let n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,c=t.length)}))};S((()=>{ut(o.file).then((()=>l())).catch((t=>{Y.addError(t.message)}))}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,r,i,c,s,()=>{J.setView("TopicList",{id:o.file})},()=>{J.setView("QuestList",{topic:o})},()=>{J.setView("QuestShow",{topic:o})},t=>{const e=t.target;((t,e)=>{const n=IDBKeyRange.only(t),o=Z.transaction(["questions"],"readwrite").objectStore("questions"),s=o.index("file").openCursor(n);s.onsuccess=t=>{const n=s.result;if(n){const t=n.value;t.progress!==e&&(t.progress=e,o.put(t),console.log("Store:",o.name," update:",t.id)),n.continue()}else console.log("Store:",o.name," set progress done:",e)}})(o.file,e.selectedIndex-1),e.selectedIndex=0,l()}]}class Ot extends R{constructor(t){super(),W(this,t,zt,At,i,{topic:0})}}function Vt(e){let n,o,s,r,i,c,d,h,m,w,v,x,_,S,y,k=e[0].progress+"",M=e[0].total+"",E=e[0].ratio+"";return{c(){n=f("span"),o=p("Progress: "),s=f("span"),r=p(k),i=p(" /\n  "),c=f("span"),c.textContent="3",d=g(),h=f("span"),m=p("Total: "),w=f("span"),v=p(M),x=p(" Wrong:\n    "),_=f("span"),S=p(E),y=p("%"),$(s,"class","is-text-success"),$(c,"class","is-text-success"),$(w,"class","is-text-success"),$(_,"class","is-text-danger"),$(h,"class","hide-sm"),$(n,"class","h6")},m(t,e){a(t,n,e),l(n,o),l(n,s),l(s,r),l(n,i),l(n,c),l(n,d),l(n,h),l(h,m),l(h,w),l(w,v),l(h,x),l(h,_),l(_,S),l(_,y)},p(t,[e]){1&e&&k!==(k=t[0].progress+"")&&b(r,k),1&e&&M!==(M=t[0].total+"")&&b(v,M),1&e&&E!==(E=t[0].ratio+"")&&b(S,E)},i:t,o:t,d(t){t&&u(n)}}}function It(t,e,n){let{quest:o}=e;return t.$$set=t=>{"quest"in t&&n(0,o=t.quest)},[o]}class Bt extends R{constructor(t){super(),W(this,t,It,Vt,i,{quest:0})}}function Dt(t,e,n){const o=t.slice();return o[6]=e[n],o}function Nt(t){let e,n,o,s,r,i,c,d,h,m,w,v,x,_,S,y,k,M,E=t[6].id+"",C=t[2].toHtml(t[6].quest)+"",H=t[2].toHtml(t[6].answer)+"";return i=new Bt({props:{quest:t[6]}}),{c(){e=f("div"),n=f("div"),o=p("Id: "),s=p(E),r=g(),D(i.$$.fragment),c=g(),d=f("div"),h=f("div"),m=f("p"),v=g(),x=f("div"),_=f("div"),S=f("p"),y=g(),$(n,"class","h6"),$(e,"class","is-flex-spread grid-full"),$(h,"class","content"),$(d,"class",w="card "+t[4]()),$(_,"class","content"),$(x,"class",k="card "+t[4]())},m(t,u){a(t,e,u),l(e,n),l(n,o),l(n,s),l(e,r),N(i,e,null),a(t,c,u),a(t,d,u),l(d,h),l(h,m),m.innerHTML=C,a(t,v,u),a(t,x,u),l(x,_),l(_,S),S.innerHTML=H,l(x,y),M=!0},p(t,e){(!M||2&e)&&E!==(E=t[6].id+"")&&b(s,E);const n={};2&e&&(n.quest=t[6]),i.$set(n),(!M||2&e)&&C!==(C=t[2].toHtml(t[6].quest)+"")&&(m.innerHTML=C),(!M||2&e)&&H!==(H=t[2].toHtml(t[6].answer)+"")&&(S.innerHTML=H)},i(t){M||(I(i.$$.fragment,t),M=!0)},o(t){B(i.$$.fragment,t),M=!1},d(t){t&&u(e),Q(i),t&&u(c),t&&u(d),t&&u(v),t&&u(x)}}}function Qt(t){let e,n,o,s,r,i,c,h,w,v,x,_=t[0].title+"",S=t[1],y=[];for(let e=0;e<S.length;e+=1)y[e]=Nt(Dt(t,S,e));const k=t=>B(y[t],1,1,(()=>{y[t]=null}));return{c(){e=f("div"),n=f("h4"),o=p(_),s=g(),r=f("div");for(let t=0;t<y.length;t+=1)y[t].c();i=g(),c=f("div"),h=f("button"),h.textContent="Back",$(r,"class","grid grid-2"),$(h,"class","button"),$(c,"class","buttons"),$(e,"class","card card-shadow content")},m(u,d){a(u,e,d),l(e,n),l(n,o),l(e,s),l(e,r);for(let t=0;t<y.length;t+=1)y[t].m(r,null);l(e,i),l(e,c),l(c,h),w=!0,v||(x=m(h,"click",t[5]),v=!0)},p(t,[e]){if((!w||1&e)&&_!==(_=t[0].title+"")&&b(o,_),22&e){let n;for(S=t[1],n=0;n<S.length;n+=1){const o=Dt(t,S,n);y[n]?(y[n].p(o,e),I(y[n],1)):(y[n]=Nt(o),y[n].c(),I(y[n],1),y[n].m(r,null))}for(O(),n=S.length;n<y.length;n+=1)k(n);V()}},i(t){if(!w){for(let t=0;t<S.length;t+=1)I(y[t]);w=!0}},o(t){y=y.filter(Boolean);for(let t=0;t<y.length;t+=1)B(y[t]);w=!1},d(t){t&&u(e),d(y,t),v=!1,x()}}}function Ut(t,e,n){let{topic:o}=e,s=[];const r=new Lt;S((()=>{it(o).then((t=>{n(1,s=t)}))}));const i=t=>{J.setView("TopicShow",{topic:t})},c=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,i,c,()=>i(o)]}class Wt extends R{constructor(t){super(),W(this,t,Ut,Qt,i,{topic:0})}}function Rt(e){let n,o,s,r,i,c,d,h,m,w,v,x,_,S,y,k,M,E,C,H,T,q,j,L,P=e[0][0]+"",A=e[0][1]+"",z=e[0][2]+"",O=e[0][3]+"";return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="No correct Answers",r=g(),i=f("td"),c=p(P),d=g(),h=f("tr"),m=f("td"),m.textContent="One correct Answer",w=g(),v=f("td"),x=p(A),_=g(),S=f("tr"),y=f("td"),y.textContent="Two correct Answers",k=g(),M=f("td"),E=p(z),C=g(),H=f("tr"),T=f("td"),T.textContent="Learned",q=g(),j=f("td"),L=p(O),$(n,"class","table hide-md")},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,d),l(n,h),l(h,m),l(h,w),l(h,v),l(v,x),l(n,_),l(n,S),l(S,y),l(S,k),l(S,M),l(M,E),l(n,C),l(n,H),l(H,T),l(H,q),l(H,j),l(j,L)},p(t,[e]){1&e&&P!==(P=t[0][0]+"")&&b(c,P),1&e&&A!==(A=t[0][1]+"")&&b(x,A),1&e&&z!==(z=t[0][2]+"")&&b(E,z),1&e&&O!==(O=t[0][3]+"")&&b(L,O)},i:t,o:t,d(t){t&&u(n)}}}function Ft(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Kt extends R{constructor(t){super(),W(this,t,Ft,Rt,i,{statistic:0})}}function Jt(t){let e,n,o,r,i,c,d,h,w,v,x,_,S,y,k,M,E,C,H,T,q,j,L,P,A,z,O,V,U,W,R,F,K,J,Y,G,X,Z,tt,et,nt,ot,st,rt=t[0].title+"",it=t[3].id+"",ct=t[4].toHtml(t[3].quest)+"",lt=t[4].toHtml(t[3].answer)+"";i=new Kt({props:{statistic:t[1]}}),y=new Bt({props:{quest:t[3]}});let at=t[0].details&&Yt(t);return{c(){e=f("div"),n=f("h4"),o=p(rt),r=g(),D(i.$$.fragment),c=g(),d=f("div"),h=f("div"),w=f("div"),v=f("div"),x=p("Question: "),_=p(it),S=g(),D(y.$$.fragment),k=g(),M=f("div"),E=f("p"),C=g(),H=f("div"),T=f("h5"),T.textContent="Answer",q=g(),j=f("div"),L=f("p"),P=g(),at&&at.c(),A=g(),z=f("div"),O=f("button"),V=p("Show"),W=g(),R=f("button"),F=p("Correct"),K=g(),J=f("button"),Y=p("Wrong"),G=g(),X=f("button"),Z=p("Skip"),tt=g(),et=f("button"),et.textContent="Stop",$(v,"class","h5"),$(w,"class","is-flex-spread block"),$(M,"class","card content is-primary"),$(j,"class","card content is-info"),H.hidden=t[2],$(d,"class","grid grid-2"),$(O,"class","button"),O.hidden=U=!t[2],$(R,"class","button is-success"),R.hidden=t[2],$(J,"class","button is-danger"),J.hidden=t[2],$(X,"class","button is-warning"),X.hidden=t[2],$(et,"class","button"),$(z,"class","buttons"),$(e,"class","card card-shadow content")},m(s,u){a(s,e,u),l(e,n),l(n,o),l(e,r),N(i,e,null),l(e,c),l(e,d),l(d,h),l(h,w),l(w,v),l(v,x),l(v,_),l(w,S),N(y,w,null),l(h,k),l(h,M),l(M,E),E.innerHTML=ct,l(d,C),l(d,H),l(H,T),l(H,q),l(H,j),l(j,L),L.innerHTML=lt,l(j,P),at&&at.m(j,null),l(e,A),l(e,z),l(z,O),l(O,V),l(z,W),l(z,R),l(R,F),l(z,K),l(z,J),l(J,Y),l(z,G),l(z,X),l(X,Z),l(z,tt),l(z,et),nt=!0,ot||(st=[m(O,"click",t[7]),m(R,"click",t[8]),m(J,"click",t[9]),m(X,"click",t[10]),m(et,"click",t[6])],ot=!0)},p(t,e){(!nt||1&e)&&rt!==(rt=t[0].title+"")&&b(o,rt);const n={};2&e&&(n.statistic=t[1]),i.$set(n),(!nt||8&e)&&it!==(it=t[3].id+"")&&b(_,it);const s={};8&e&&(s.quest=t[3]),y.$set(s),(!nt||8&e)&&ct!==(ct=t[4].toHtml(t[3].quest)+"")&&(E.innerHTML=ct),(!nt||8&e)&&lt!==(lt=t[4].toHtml(t[3].answer)+"")&&(L.innerHTML=lt),t[0].details?at?at.p(t,e):(at=Yt(t),at.c(),at.m(j,null)):at&&(at.d(1),at=null),(!nt||4&e)&&(H.hidden=t[2]),(!nt||4&e&&U!==(U=!t[2]))&&(O.hidden=U),(!nt||4&e)&&(R.hidden=t[2]),(!nt||4&e)&&(J.hidden=t[2]),(!nt||4&e)&&(X.hidden=t[2])},i(t){nt||(I(i.$$.fragment,t),I(y.$$.fragment,t),nt=!0)},o(t){B(i.$$.fragment,t),B(y.$$.fragment,t),nt=!1},d(t){t&&u(e),Q(i),Q(y),at&&at.d(),ot=!1,s(st)}}}function Yt(t){let e,n=t[4].toHtml(t[0].details)+"";return{c(){e=f("p")},m(t,o){a(t,e,o),e.innerHTML=n},p(t,o){1&o&&n!==(n=t[4].toHtml(t[0].details)+"")&&(e.innerHTML=n)},d(t){t&&u(e)}}}function Gt(t){let e,n,o=t[3]&&Jt(t);return{c(){o&&o.c(),e=h()},m(t,s){o&&o.m(t,s),a(t,e,s),n=!0},p(t,[n]){t[3]?o?(o.p(t,n),8&n&&I(o,1)):(o=Jt(t),o.c(),I(o,1),o.m(e.parentNode,e)):o&&(O(),B(o,1,1,(()=>{o=null})),V())},i(t){n||(I(o),n=!0)},o(t){B(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function Xt(t,e,n){let{topic:o}=e;const s=new Lt;let r,i,c,l,a=!0;const u=t=>{if(void 0===t)return c.push(l),void d();((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=st(t.failed,t.total)})(l,t),(t=>new Promise(((e,n)=>{const o=Z.transaction(["questions"],"readwrite").objectStore("questions");o.put(t).onsuccess=n=>{console.log("Store:",o.name," update:",t),e()}})))(l).then((()=>{l.progress<3&&c.push(l),0===c.length&&f(),d()}))},d=()=>{n(3,l=c.shift()),console.log("next",l),n(1,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(i)),n(2,a=!0)};S((()=>{it(o).then((t=>{i=t,c=i.filter((t=>t.progress<3)),(t=>{for(let o=0;o<t.length;o++){let s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;let r=t[o];t[o]=t[s],t[s]=r}var e,n})(c),d()}))}));const f=()=>{J.setView("TopicList",{id:o.file})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,r,a,l,s,u,f,()=>n(2,a=!1),()=>u(!0),()=>u(!1),()=>u()]}class Zt extends R{constructor(t){super(),W(this,t,Xt,Gt,i,{topic:0})}}function te(t){let e,n;return e=new mt({}),{c(){D(e.$$.fragment)},m(t,o){N(e,t,o),n=!0},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function ee(t){let n,o,s,r,i,c,d,p,h,m=0!==t[0].length&&te();const b=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<b.length;t+=1)n=e(n,b[t]);return{props:n}}return w&&(c=new w(v())),{c(){n=f("div"),o=f("h2"),o.textContent="Cards",s=g(),m&&m.c(),r=g(),i=f("div"),c&&D(c.$$.fragment),d=g(),p=f("div"),p.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',$(i,"id","main"),$(i,"class","block"),$(p,"class","block"),$(n,"class","container")},m(t,e){a(t,n,e),l(n,o),l(n,s),m&&m.m(n,null),l(n,r),l(n,i),c&&N(c,i,null),l(n,d),l(n,p),h=!0},p(t,[e]){0!==t[0].length?m?1&e&&I(m,1):(m=te(),m.c(),I(m,1),m.m(n,r)):m&&(O(),B(m,1,1,(()=>{m=null})),V());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(b,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(w!==(w=t[1].component)){if(c){O();const t=c;B(t.$$.fragment,1,0,(()=>{Q(t,1)})),V()}w?(c=new w(v()),D(c.$$.fragment),I(c.$$.fragment,1),N(c,i,null)):c=null}else w&&c.$set(o)},i(t){h||(I(m),c&&I(c.$$.fragment,t),h=!0)},o(t){B(m),c&&B(c.$$.fragment,t),h=!1},d(t){t&&u(n),m&&m.d(),c&&Q(c)}}}function ne(t,e,n){let o,s;return c(t,Y,(t=>n(0,o=t))),c(t,J,(t=>n(1,s=t))),S((()=>{try{(async()=>{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("service-worker.js");console.log("Registration of serivce worker done - scope:",t.scope)}})()}catch(t){Y.addError(t)}J.views={TopicList:{component:qt},TopicShow:{component:Ot},QuestList:{component:Wt},QuestShow:{component:Zt}},dt().then((()=>{J.setView("TopicList")}))})),[o,s]}return new class extends R{constructor(t){super(),W(this,t,ne,ee,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

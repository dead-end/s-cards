var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function g(){return p(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let b;function w(t){b=t}function v(t){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.on_mount.push(t)}const x=[],S=[],y=[],_=[],k=Promise.resolve();let C=!1;function M(t){y.push(t)}let j=!1;const E=new Set;function q(){if(!j){j=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];w(e),P(e.$$)}for(w(null),x.length=0;S.length;)S.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];E.has(e)||(E.add(e),e())}y.length=0}while(x.length);for(;_.length;)_.pop()();C=!1,j=!1,E.clear()}}function P(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const T=new Set;let A;function L(){A={r:0,c:[],p:A}}function D(){A.r||s(A.c),A=A.p}function V(t,e){t&&t.i&&(T.delete(t),t.i(e))}function O(t,e,n,o){if(t&&t.o){if(T.has(t))return;T.add(t),A.c.push((()=>{T.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function B(t){t&&t.c()}function H(t,e,o,c){const{fragment:i,on_mount:l,on_destroy:a,after_update:u}=t.$$;i&&i.m(e,o),c||M((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(M)}function I(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(x.push(t),C||(C=!0,k.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(e,n,r,c,i,l,a,d=[-1]){const f=b;w(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:i,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:o(),dirty:d,skip_bound:!1,root:n.target||f.$$.root};a&&a(p.root);let g=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&i(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),g&&N(e,t)),n})):[],p.update(),g=!0,s(p.before_update),p.fragment=!!c&&c(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();n.intro&&V(e.$$.fragment),H(e,n.target,n.anchor,n.customElement),q()}w(f)}class z{$destroy(){I(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];function K(e,n=t){let o;const s=new Set;function r(t){if(c(e,t)&&(e=t,o)){const t=!F.length;for(const t of s)t[1](),F.push(t,e);if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(c,i=t){const l=[c,i];return s.add(l),1===s.size&&(o=n(r)||t),c(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const R=(()=>{const{subscribe:t,set:e,update:n}=K({});return{views:{},subscribe:t,setView:(t,n)=>{const o=R.views[t];o.props=n,e(o)}}})(),W=(()=>{const{subscribe:t,set:e,update:n}=K([]);return{subscribe:t,addError:t=>{console.log("Added error:",t),n((e=>(e.push(t),e)))},resetErrors:()=>{e([])}}})(),J=t=>fetch(t,{method:"HEAD"}).then((e=>{const n=e.headers.get("Last-Modified");if(console.log("url: ",t," header: ",n),n)return new Date(n)})).catch((t=>console.error(t)));let U;const Y=t=>{W.addError(t.target.error)},G=t=>{if(t.oldVersion<1){U=t.target.result,U.createObjectStore("topics",{keyPath:"file"});U.createObjectStore("questions",{keyPath:"id"}).createIndex("file","file",{unique:!1});U.createObjectStore("config",{keyPath:"key"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}}};function X(t){if(!t)return"";const e=new Date;e.setTime(t);const n=e.getDate()>9?e.getDate():"0"+e.getDate(),o=e.getMonth()>9?e.getMonth():"0"+e.getMonth(),s=e.getHours()>9?e.getHours():"0"+e.getHours(),r=e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes();return`${n}.${o}.${e.getFullYear()} ${s}:${r}`}const Z=(t,e)=>(100*t/e).toFixed(0)+"%";const tt=t=>{const e=U.transaction(["topics"],"readwrite").objectStore("topics");e.getAll().onsuccess=n=>{const o=((t,e)=>{const n=new Map;return t.forEach((t=>{n.set(t[e],t)})),n})(n.target.result,"file"),s=t.map((t=>t.file));for(let t in o)s.includes(t)||(e.delete(t).onsuccess=()=>{console.log("Store:",e.name," deleted:",t)});t.forEach((t=>{const n=o.get(t.file);n&&n.lastModified&&(t.lastModified=n.lastModified),e.put(t).onsuccess=t=>{console.log("Store:",e.name," update:",t.target.result)}}))}},et=t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e},nt=t=>new Promise(((e,n)=>{U.transaction(["questions"],"readonly").objectStore("questions").index("file").getAll(t.file).onsuccess=t=>{e(t.target.result)}})),ot=async t=>{console.log(t);const e=(t=>new Promise(((e,n)=>{const o=U.transaction(["topics"],"readonly").objectStore("topics");o.get(t).onsuccess=t=>{const n=t.target.result.lastModified;console.log("Store:",o.name," get lastModified:",n),e(n)}})))(t),n=J(t),[o,s]=await Promise.all([e,n]);if(console.log("lmStore",o,"lmJson",s),o&&o>=s)return;const r=await(c=t,fetch(c).then((t=>t.json())).catch((t=>console.error(t))));var c;r.forEach((e=>((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(e,t))),console.log(r);const i=U.transaction(["topics","questions"],"readwrite");await((t,e,n,o)=>new Promise(((s,r)=>{const c=t.objectStore(e);c.index(n).getAllKeys(o).onsuccess=t=>{t.target.result.forEach((t=>{c.delete(t).onsuccess=e=>{console.log("Store: ",c.name," deleted: ",t)}})),s()}})))(i,"questions","file",t),((t,e,n)=>{new Promise(((o,s)=>{const r=t.objectStore(e);n.forEach((t=>{r.add(t).onsuccess=e=>{console.log("Store: ",r.name,"  added: ",t)}})),o()}))})(i,"questions",r),((t,e,n)=>{const o=t.objectStore("topics");o.get(e).onsuccess=t=>{const e=t.target.result;e.lastModified=n,o.put(e).onsuccess=()=>{console.log("Store:",o.name," set lastModified:",e)}}})(i,t,s)},st=async()=>{await new Promise(((t,e)=>{const n=indexedDB.open("s-card",1);n.onupgradeneeded=G,n.onerror=Y,n.onsuccess=e=>{U=e.target.result,U.onerror=Y,console.log("db init success!"),t()}}));const t=new Promise(((t,e)=>{U.transaction(["config"],"readonly").objectStore("config").get("topics-last-modified").onsuccess=e=>{const n=e.target.result;n?t(n.value):t()}})),e=J("data/topics.json"),[n,o]=await Promise.all([t,e]);console.log("last modified store:",n),console.log("last modified head:",o),(!n||n<o)&&await"data/topics.json".then((t=>{tt(t),(t=>{const e={key:"topics-last-modified",value:t},n=U.transaction(["config"],"readwrite").objectStore("config");n.put(e).onsuccess=()=>{console.log("Store:",n.name," set lastModified:",e)}})(o)}))};function rt(e){let n;return{c(){n=f("h2"),n.textContent="Cards"},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}class ct extends z{constructor(t){super(),Q(this,t,null,rt,c,{})}}function it(e){let n;return{c(){n=f("div"),n.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',m(n,"class","block")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}class lt extends z{constructor(t){super(),Q(this,t,null,it,c,{})}}function at(t,e,n){const o=t.slice();return o[2]=e[n],o}function ut(t){let e,n,o=t[2]+"";return{c(){e=f("li"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&$(n,o)},d(t){t&&u(e)}}}function dt(e){let n,o,s,r,c,i,p,$,b,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=ut(at(e,w,t));return{c(){n=f("div"),o=f("h4"),o.textContent="Errors",s=g(),r=f("ul");for(let t=0;t<v.length;t+=1)v[t].c();c=g(),i=f("div"),p=f("button"),p.textContent="Ok",m(o,"class","is-text-danger"),m(p,"class","button"),m(i,"class","buttons"),m(n,"class","card card-shadow block content")},m(t,u){a(t,n,u),l(n,o),l(n,s),l(n,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);l(n,c),l(n,i),l(i,p),$||(b=h(p,"click",e[1]),$=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=at(t,w,n);v[n]?v[n].p(o,e):(v[n]=ut(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&u(n),d(v,t),$=!1,b()}}}function ft(t,e,n){let o;i(t,W,(t=>n(0,o=t)));return[o,()=>{W.resetErrors()}]}class pt extends z{constructor(t){super(),Q(this,t,ft,dt,c,{})}}function gt(t){let e,n,o=t[0].desc+"";return{c(){e=f("p"),n=p(o)},m(t,o){a(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&$(n,o)},d(t){t&&u(e)}}}function ht(e){let n,o,s,r,c,i,d,b,w,v,x,S=e[0].title+"",y=e[0].desc&&gt(e);return{c(){n=f("div"),o=f("h4"),s=p(S),r=g(),c=f("table"),c.innerHTML="<tr><td>Modified</td> \n      <td></td></tr> \n    <tr><td>Status</td> \n      <td></td></tr>",i=g(),y&&y.c(),d=g(),b=f("div"),w=f("button"),w.textContent="Show",m(w,"class","button"),m(b,"class","buttons"),m(n,"class","card card-shadow content")},m(t,u){a(t,n,u),l(n,o),l(o,s),l(n,r),l(n,c),l(n,i),y&&y.m(n,null),l(n,d),l(n,b),l(b,w),v||(x=h(w,"click",e[2]),v=!0)},p(t,[e]){1&e&&S!==(S=t[0].title+"")&&$(s,S),t[0].desc?y?y.p(t,e):(y=gt(t),y.c(),y.m(n,d)):y&&(y.d(1),y=null)},i:t,o:t,d(t){t&&u(n),y&&y.d(),v=!1,x()}}}function mt(t,e,n){let{topic:o}=e;const s=t=>{R.setView("TopicShow",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class $t extends z{constructor(t){super(),Q(this,t,mt,ht,c,{topic:0})}}function bt(t,e,n){const o=t.slice();return o[1]=e[n],o}function wt(t){let e,n;return e=new $t({props:{topic:t[1]}}),{c(){B(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[1]),e.$set(o)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function vt(t){let e,n,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=wt(bt(t,o,e));const r=t=>O(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("div");for(let t=0;t<s.length;t+=1)s[t].c();m(e,"class","grid grid-4")},m(t,o){a(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(1&n){let c;for(o=t[0],c=0;c<o.length;c+=1){const r=bt(t,o,c);s[c]?(s[c].p(r,n),V(s[c],1)):(s[c]=wt(r),s[c].c(),V(s[c],1),s[c].m(e,null))}for(L(),c=o.length;c<s.length;c+=1)r(c);D()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)V(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)O(s[t]);n=!1},d(t){t&&u(e),d(s,t)}}}function xt(t,e,n){let o=[];return v((()=>{new Promise(((t,e)=>{U.transaction(["topics"],"readonly").objectStore("topics").getAll().onsuccess=e=>{t(e.target.result)}})).then((t=>{n(0,o=t)}))})),[o]}class St extends z{constructor(t){super(),Q(this,t,xt,vt,c,{})}}function yt(e){let n,o,r,c,i,d,b,w,v,x,S,y,_,k,C,M,j,E,q,P,T,A,L,D,V,O,B,H,I,N,Q,z,F,K,R,W,J,U,Y,G,Z,tt,et,nt,ot,st,rt,ct,it,lt,at,ut,dt,ft,pt,gt=e[0].title+"",ht=e[0].file+"",mt=X(e[0].lastModified)+"",$t=e[0].desc+"";return{c(){n=f("div"),o=f("h4"),r=p(gt),c=g(),i=f("div"),d=f("table"),b=f("tr"),w=f("td"),w.textContent="File",v=g(),x=f("td"),S=p(ht),y=g(),_=f("tr"),k=f("td"),k.textContent="Modified",C=g(),M=f("td"),j=p(mt),E=g(),q=f("tr"),P=f("td"),P.textContent="Description",T=g(),A=f("td"),L=p($t),D=g(),V=f("tr"),O=f("td"),O.textContent="Status",B=g(),H=f("td"),I=p(e[1]),N=g(),Q=f("tr"),z=f("td"),z.textContent="Size",F=g(),K=f("td"),R=p(e[3]),W=g(),J=f("div"),U=f("label"),U.textContent="Number of correct answers",Y=g(),G=f("select"),Z=f("option"),Z.textContent="-- Select --",tt=f("option"),tt.textContent="Set 0",et=f("option"),et.textContent="Set 1",nt=f("option"),nt.textContent="Set 2",ot=f("option"),ot.textContent="Set 3",st=g(),rt=f("div"),ct=f("button"),ct.textContent="Back",it=g(),lt=f("button"),lt.textContent="Listing",at=g(),ut=f("button"),dt=p("Start"),m(d,"class","is-text-left"),m(U,"for","sf-set"),Z.__value="",Z.value=Z.__value,tt.__value="0",tt.value=tt.__value,et.__value="1",et.value=et.__value,nt.__value="2",nt.value=nt.__value,ot.__value="3",ot.value=ot.__value,m(G,"id","sf-set"),m(i,"class","grid grid-4"),m(ct,"class","button"),m(lt,"class","button"),m(ut,"class","button"),ut.disabled=e[2],m(rt,"class","buttons"),m(n,"class","card card-shadow content")},m(t,s){a(t,n,s),l(n,o),l(o,r),l(n,c),l(n,i),l(i,d),l(d,b),l(b,w),l(b,v),l(b,x),l(x,S),l(d,y),l(d,_),l(_,k),l(_,C),l(_,M),l(M,j),l(d,E),l(d,q),l(q,P),l(q,T),l(q,A),l(A,L),l(d,D),l(d,V),l(V,O),l(V,B),l(V,H),l(H,I),l(d,N),l(d,Q),l(Q,z),l(Q,F),l(Q,K),l(K,R),l(i,W),l(i,J),l(J,U),l(J,Y),l(J,G),l(G,Z),l(G,tt),l(G,et),l(G,nt),l(G,ot),l(n,st),l(n,rt),l(rt,ct),l(rt,it),l(rt,lt),l(rt,at),l(rt,ut),l(ut,dt),ft||(pt=[h(G,"change",e[7]),h(ct,"click",e[4]),h(lt,"click",e[5]),h(ut,"click",e[6])],ft=!0)},p(t,[e]){1&e&&gt!==(gt=t[0].title+"")&&$(r,gt),1&e&&ht!==(ht=t[0].file+"")&&$(S,ht),1&e&&mt!==(mt=X(t[0].lastModified)+"")&&$(j,mt),1&e&&$t!==($t=t[0].desc+"")&&$(L,$t),2&e&&$(I,t[1]),8&e&&$(R,t[3]),4&e&&(ut.disabled=t[2])},i:t,o:t,d(t){t&&u(n),ft=!1,s(pt)}}}function _t(t,e,n){let{topic:o}=e,s="",r=!0,c=0;const i=()=>{var t;(t=o.file,new Promise(((e,n)=>{const o=[],s=IDBKeyRange.only(t),r=U.transaction(["questions"],"readwrite").objectStore("questions");r.index("file").openCursor(s).onsuccess=t=>{const n=t.target.result;n?(o.push(n.value.progress),n.continue()):(console.log("Store:",r.name," progress values:",o),e(o))}}))).then((t=>{n(1,s=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return Z(n,t.length*e)})(t,3)),n(2,r=((t,e)=>{for(let n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,c=t.length)}))};v((()=>{ot(o.file).then((()=>i())).catch((t=>{W.addError(t.message)}))}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,c,()=>{R.setView("TopicList")},()=>{R.setView("QuestList",{topic:o})},()=>{R.setView("QuestShow",{topic:o})},t=>{console.log("index",t.target.selectedIndex),((t,e)=>{const n=IDBKeyRange.only(t),o=U.transaction(["questions"],"readwrite").objectStore("questions");o.index("file").openCursor(n).onsuccess=t=>{const n=t.target.result;if(n){const t=n.value;t.progress!==e&&(t.progress=e,t.failed=0,o.put(t),console.log("Store:",o.name," update:",t.id)),n.continue()}else console.log("Store:",o.name," set progress done:",e)}})(o.file,t.target.selectedIndex-1),t.target.selectedIndex=0,i()}]}class kt extends z{constructor(t){super(),Q(this,t,_t,yt,c,{topic:0})}}function Ct(t,e,n){const o=t.slice();return o[5]=e[n],o}function Mt(t){let e,n,o,s,r,c,i,d,g=t[5].total+"",h=t[5].ratio+"";return{c(){e=f("span"),n=p("( Total: "),o=f("span"),s=p(g),r=p(" /\n            "),c=f("span"),i=p(h),d=p(")"),m(o,"class","is-text-success"),m(c,"class","is-text-danger"),m(e,"class","h6")},m(t,u){a(t,e,u),l(e,n),l(e,o),l(o,s),l(e,r),l(e,c),l(c,i),l(e,d)},p(t,e){2&e&&g!==(g=t[5].total+"")&&$(s,g),2&e&&h!==(h=t[5].ratio+"")&&$(i,h)},d(t){t&&u(e)}}}function jt(t){let e,n,o,s,r,c,i,d,h,b,w,v,x,S,y,_,k,C=t[5].id+"",M=t[5].quest+"",j=t[5].answer+"",E=0!=t[5].total&&Mt(t);return{c(){e=f("div"),n=f("div"),o=p(C),s=g(),E&&E.c(),r=g(),c=f("div"),i=f("div"),d=f("p"),h=p(M),w=g(),v=f("div"),x=f("div"),S=f("p"),y=p(j),_=g(),m(n,"class","h5"),m(e,"class","is-flex-spread grid-full"),m(i,"class","content"),m(c,"class",b="card "+t[3]()),m(x,"class","content"),m(v,"class",k="card "+t[3]())},m(t,u){a(t,e,u),l(e,n),l(n,o),l(e,s),E&&E.m(e,null),a(t,r,u),a(t,c,u),l(c,i),l(i,d),l(d,h),a(t,w,u),a(t,v,u),l(v,x),l(x,S),l(S,y),l(v,_)},p(t,n){2&n&&C!==(C=t[5].id+"")&&$(o,C),0!=t[5].total?E?E.p(t,n):(E=Mt(t),E.c(),E.m(e,null)):E&&(E.d(1),E=null),2&n&&M!==(M=t[5].quest+"")&&$(h,M),2&n&&j!==(j=t[5].answer+"")&&$(y,j)},d(t){t&&u(e),E&&E.d(),t&&u(r),t&&u(c),t&&u(w),t&&u(v)}}}function Et(e){let n,o,s,r,c,i,b,w,v,x,S=e[0].title+"",y=e[1],_=[];for(let t=0;t<y.length;t+=1)_[t]=jt(Ct(e,y,t));return{c(){n=f("div"),o=f("h4"),s=p(S),r=g(),c=f("div");for(let t=0;t<_.length;t+=1)_[t].c();i=g(),b=f("div"),w=f("button"),w.textContent="Back",m(c,"class","grid grid-2"),m(w,"class","button"),m(b,"class","buttons"),m(n,"class","card card-shadow content")},m(t,u){a(t,n,u),l(n,o),l(o,s),l(n,r),l(n,c);for(let t=0;t<_.length;t+=1)_[t].m(c,null);l(n,i),l(n,b),l(b,w),v||(x=h(w,"click",e[4]),v=!0)},p(t,[e]){if(1&e&&S!==(S=t[0].title+"")&&$(s,S),10&e){let n;for(y=t[1],n=0;n<y.length;n+=1){const o=Ct(t,y,n);_[n]?_[n].p(o,e):(_[n]=jt(o),_[n].c(),_[n].m(c,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=y.length}},i:t,o:t,d(t){t&&u(n),d(_,t),v=!1,x()}}}function qt(t,e,n){let{topic:o}=e,s=[];v((()=>{nt(o).then((t=>{n(1,s=t)}))}));const r=t=>{R.setView("TopicShow",{topic:t})},c=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,c,()=>r(o)]}class Pt extends z{constructor(t){super(),Q(this,t,qt,Et,c,{topic:0})}}function Tt(e){let n,o,s,r,c,i,d,h,b,w,v,x,S,y,_,k,C,M,j,E,q,P,T,A,L=e[0][0]+"",D=e[0][1]+"",V=e[0][2]+"",O=e[0][3]+"";return{c(){n=f("table"),o=f("tr"),s=f("td"),s.textContent="No correct Answers",r=g(),c=f("td"),i=p(L),d=g(),h=f("tr"),b=f("td"),b.textContent="One correct Answer",w=g(),v=f("td"),x=p(D),S=g(),y=f("tr"),_=f("td"),_.textContent="Two correct Answers",k=g(),C=f("td"),M=p(V),j=g(),E=f("tr"),q=f("td"),q.textContent="Learned",P=g(),T=f("td"),A=p(O),m(n,"class","table hide-md")},m(t,e){a(t,n,e),l(n,o),l(o,s),l(o,r),l(o,c),l(c,i),l(n,d),l(n,h),l(h,b),l(h,w),l(h,v),l(v,x),l(n,S),l(n,y),l(y,_),l(y,k),l(y,C),l(C,M),l(n,j),l(n,E),l(E,q),l(E,P),l(E,T),l(T,A)},p(t,[e]){1&e&&L!==(L=t[0][0]+"")&&$(i,L),1&e&&D!==(D=t[0][1]+"")&&$(x,D),1&e&&V!==(V=t[0][2]+"")&&$(M,V),1&e&&O!==(O=t[0][3]+"")&&$(A,O)},i:t,o:t,d(t){t&&u(n)}}}function At(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Lt extends z{constructor(t){super(),Q(this,t,At,Tt,c,{statistic:0})}}function Dt(t){let e,n,o,r,c,i,d,b,w,v,x,S,y,_,k,C,M,j,E,q,P,T,A,L,D,N,Q,z,F,K,R,W,J,U,Y,G,X,Z,tt,et,nt,ot,st,rt,ct,it,lt,at,ut,dt,ft,pt,gt=t[0].title+"",ht=t[3].progress+"",mt=t[3].failed+"",$t=t[3].total+"",bt=t[3].ratio+"",wt=t[3].quest+"",vt=t[3].answer+"";return c=new Lt({props:{statistic:t[1]}}),{c(){e=f("div"),n=f("h4"),o=p(gt),r=g(),B(c.$$.fragment),i=g(),d=f("div"),b=f("div"),w=f("div"),v=f("div"),v.textContent="Question",x=g(),S=f("span"),y=p("(Progress: "),_=f("span"),k=p(ht),C=p(" /\n          "),M=f("span"),j=p(mt),E=p("\n          Total: "),q=f("span"),P=p($t),T=p(" /\n          "),A=f("span"),L=p(bt),D=p(")"),N=g(),Q=f("div"),z=f("p"),F=p(wt),K=g(),R=f("div"),W=f("h5"),W.textContent="Answer",J=g(),U=f("div"),Y=f("p"),G=p(vt),X=g(),Z=f("div"),tt=f("button"),et=p("Show"),ot=g(),st=f("button"),rt=p("Correct"),ct=g(),it=f("button"),lt=p("Wrong"),at=g(),ut=f("button"),ut.textContent="Stop",m(v,"class","h5"),m(_,"class","is-text-success"),m(M,"class","is-text-danger"),m(q,"class","is-text-success"),m(A,"class","is-text-danger"),m(S,"class","h6"),m(w,"class","is-flex-spread block"),m(Q,"class","card content is-primary"),m(U,"class","card content is-info"),R.hidden=t[2],m(d,"class","grid grid-2"),m(tt,"class","button"),tt.hidden=nt=!t[2],m(st,"class","button is-success"),st.hidden=t[2],m(it,"class","button is-danger"),it.hidden=t[2],m(ut,"class","button"),m(Z,"class","buttons"),m(e,"class","card card-shadow content")},m(s,u){a(s,e,u),l(e,n),l(n,o),l(e,r),H(c,e,null),l(e,i),l(e,d),l(d,b),l(b,w),l(w,v),l(w,x),l(w,S),l(S,y),l(S,_),l(_,k),l(S,C),l(S,M),l(M,j),l(S,E),l(S,q),l(q,P),l(S,T),l(S,A),l(A,L),l(S,D),l(b,N),l(b,Q),l(Q,z),l(z,F),l(d,K),l(d,R),l(R,W),l(R,J),l(R,U),l(U,Y),l(Y,G),l(e,X),l(e,Z),l(Z,tt),l(tt,et),l(Z,ot),l(Z,st),l(st,rt),l(Z,ct),l(Z,it),l(it,lt),l(Z,at),l(Z,ut),dt=!0,ft||(pt=[h(tt,"click",t[5]),h(st,"click",t[6]),h(it,"click",t[7]),h(ut,"click",t[4])],ft=!0)},p(t,[e]){(!dt||1&e)&&gt!==(gt=t[0].title+"")&&$(o,gt);const n={};2&e&&(n.statistic=t[1]),c.$set(n),(!dt||8&e)&&ht!==(ht=t[3].progress+"")&&$(k,ht),(!dt||8&e)&&mt!==(mt=t[3].failed+"")&&$(j,mt),(!dt||8&e)&&$t!==($t=t[3].total+"")&&$(P,$t),(!dt||8&e)&&bt!==(bt=t[3].ratio+"")&&$(L,bt),(!dt||8&e)&&wt!==(wt=t[3].quest+"")&&$(F,wt),(!dt||8&e)&&vt!==(vt=t[3].answer+"")&&$(G,vt),(!dt||4&e)&&(R.hidden=t[2]),(!dt||4&e&&nt!==(nt=!t[2]))&&(tt.hidden=nt),(!dt||4&e)&&(st.hidden=t[2]),(!dt||4&e)&&(it.hidden=t[2])},i(t){dt||(V(c.$$.fragment,t),dt=!0)},o(t){O(c.$$.fragment,t),dt=!1},d(t){t&&u(e),I(c),ft=!1,s(pt)}}}function Vt(t,e,n){let{topic:o}=e,s=[],r=!0,c=[],i=[],l={};const a=t=>{((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=Z(t.failed,t.total)})(l,t),(t=>new Promise(((e,n)=>{const o=U.transaction(["questions"],"readwrite").objectStore("questions");o.put(t).onsuccess=n=>{console.log("Store:",o.name," update:",t),e()}})))(l).then((()=>{l.progress<3&&i.push(l),0===i.length&&d(),n(1,s=et(c)),u(),n(2,r=!r)}))},u=()=>{n(3,l=i.shift()),console.log("next",l)};v((()=>{nt(o).then((t=>{c=t,i=c.filter((t=>t.progress<3)),function(t){for(let o=0;o<t.length;o++){let s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;let r=t[o];t[o]=t[s],t[s]=r}var e,n}(i),n(1,s=et(c)),u()}))}));const d=()=>{R.setView("TopicList")};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,l,d,()=>{n(2,r=!r)},()=>{a(!0)},()=>{a(!1)}]}class Ot extends z{constructor(t){super(),Q(this,t,Vt,Dt,c,{topic:0})}}function Bt(t){let e,n;return e=new pt({}),{c(){B(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function Ht(t){let n,o,s,r,c,i,d,p,h;o=new ct({});let $=0!==t[0].length&&Bt();const b=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<b.length;t+=1)n=e(n,b[t]);return{props:n}}return w&&(i=new w(v())),p=new lt({}),{c(){n=f("div"),B(o.$$.fragment),s=g(),$&&$.c(),r=g(),c=f("div"),i&&B(i.$$.fragment),d=g(),B(p.$$.fragment),m(c,"id","main"),m(c,"class","block"),m(n,"class","container")},m(t,e){a(t,n,e),H(o,n,null),l(n,s),$&&$.m(n,null),l(n,r),l(n,c),i&&H(i,c,null),l(n,d),H(p,n,null),h=!0},p(t,[e]){0!==t[0].length?$?1&e&&V($,1):($=Bt(),$.c(),V($,1),$.m(n,r)):$&&(L(),O($,1,1,(()=>{$=null})),D());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const c=t[r],i=e[r];if(i){for(const t in c)t in i||(o[t]=1);for(const t in i)s[t]||(n[t]=i[t],s[t]=1);t[r]=i}else for(const t in c)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(b,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(w!==(w=t[1].component)){if(i){L();const t=i;O(t.$$.fragment,1,0,(()=>{I(t,1)})),D()}w?(i=new w(v()),B(i.$$.fragment),V(i.$$.fragment,1),H(i,c,null)):i=null}else w&&i.$set(o)},i(t){h||(V(o.$$.fragment,t),V($),i&&V(i.$$.fragment,t),V(p.$$.fragment,t),h=!0)},o(t){O(o.$$.fragment,t),O($),i&&O(i.$$.fragment,t),O(p.$$.fragment,t),h=!1},d(t){t&&u(n),I(o),$&&$.d(),i&&I(i),I(p)}}}function It(t,e,n){let o,s;return i(t,W,(t=>n(0,o=t))),i(t,R,(t=>n(1,s=t))),v((()=>{try{(async()=>{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("service-worker.js");console.log("Registration of serivce worker done - scope:",t.scope)}})()}catch(t){W.addError(t)}R.views={TopicList:{component:St},TopicShow:{component:kt},QuestList:{component:Pt},QuestShow:{component:Ot}},st().then((()=>{R.setView("TopicList")}))})),[o,s]}return new class extends z{constructor(t){super(),Q(this,t,It,Ht,c,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

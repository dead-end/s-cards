var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function a(t,e,n){t.$$.on_destroy.push(c(e,n))}function l(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function g(){return h(" ")}function m(){return h("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function w(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e){t.value=null==e?"":e}function x(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function C(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function _(t){const e=t.querySelector(":checked")||function(t){for(const e of t.options)if(!e.disabled)return e}(t);return e&&e.__value}function y(t,e){return new t(e)}let E;function S(t){E=t}function q(){if(!E)throw new Error("Function called outside component initialization");return E}function L(t){q().$$.on_mount.push(t)}function T(t){q().$$.after_update.push(t)}function U(){const t=q();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,o,e),s}(e,n,{cancelable:o});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const V=[],M=[];let j=[];const H=[],O=Promise.resolve();let R=!1;function A(t){j.push(t)}const N=new Set;let B=0;function G(){if(0!==B)return;const t=E;do{try{for(;B<V.length;){const t=V[B];B++,S(t),P(t.$$)}}catch(t){throw V.length=0,B=0,t}for(S(null),V.length=0,B=0;M.length;)M.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];N.has(e)||(N.add(e),e())}j.length=0}while(V.length);for(;H.length;)H.pop()();R=!1,N.clear(),S(t)}function P(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;let D;function F(){D={r:0,c:[],p:D}}function z(){D.r||s(D.c),D=D.p}function J(t,e){t&&t.i&&(I.delete(t),t.i(e))}function W(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),D.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function Q(t){t&&t.c()}function K(t,e,o,i){const{fragment:c,after_update:a}=t.$$;c&&c.m(e,o),i||A((()=>{const e=t.$$.on_mount.map(n).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...e):s(e),t.$$.on_mount=[]})),a.forEach(A)}function Y(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];j.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),j=e}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function X(t,e){-1===t.$$.dirty[0]&&(V.push(t),R||(R=!0,O.then(G)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(e,n,r,i,c,a,l,u=[-1]){const f=E;S(e);const p=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};l&&l(p.root);let h=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),h&&X(e,t)),n})):[],p.update(),h=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();n.intro&&J(e.$$.fragment),K(e,n.target,n.anchor,n.customElement),G()}S(f)}class tt{$destroy(){Y(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!et.length;for(const t of s)t[1](),et.push(t,e);if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const a=[i,c];return s.add(a),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(a),0===s.size&&o&&(o(),o=null)}}}}const ot=(()=>{const{subscribe:t,set:e}=nt({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=ot.views[t];o.props=n,e(o)}}})(),st=(()=>{const{subscribe:t,set:e,update:n}=nt([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})(),rt=t=>{st.addError(t.type)},it=new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{const e=n.result;t.oldVersion<4&&(t=>{if(t.objectStoreNames.contains("topics")||t.createObjectStore("topics",{keyPath:"file"}),!t.objectStoreNames.contains("questions")){const e=t.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});e.indexNames.contains("file")||e.createIndex("file","file",{unique:!1})}t.objectStoreNames.contains("hash")||(t.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}),t.objectStoreNames.contains("admin")||t.createObjectStore("admin",{keyPath:"config"}),t.objectStoreNames.contains("config")&&t.deleteObjectStore("config")})(e),console.log("db upgrade success!")},n.onerror=t=>{st.addError(t.type),e()},n.onsuccess=()=>{const e=n.result;e.onerror=rt,console.log("db init success!"),t(e)}})),ct=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=()=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),at=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=()=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),lt=(t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=()=>{console.log("Store:",t.name,"id:",e,"get:",s.result?s.result:"NOT-FOUND"),n(s.result)},s.onerror=n=>{st.addError(`Store: ${t.name} id: ${e} storeGet error: ${n}`),o()}})),ut=t=>new Promise(((e,n)=>{const o=t.getAll();o.onsuccess=()=>{console.log("Store:",t.name,"getAll num:",o.result.length),e(o.result)},o.onerror=e=>{st.addError(`Store: ${t.name} storeGetAll error: ${e}`),n()}})),dt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},ft=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},pt=(t,e)=>{for(const n in t)if(t[n]!==e)return!1;return!0},ht=(t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return gt(n,t.length*e)},gt=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},mt=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),$t=t=>{for(let e=0;e<t.length;e++){const n=mt(0,t.length-1);if(e===n)continue;const o=t[e];t[e]=t[n],t[n]=o}},wt=(t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n};function bt(t){return t instanceof Error?t.message:String(t)}const vt=(t,e)=>t.endsWith(e)?t:t+e,kt=t=>{const e=[];return t.split("\n").forEach((t=>{(t=t.trim())&&e.push(t)})),e},xt=t=>t.join("\n");var Ct;!function(t){t[t.OK=0]="OK",t[t.ERROR=1]="ERROR",t[t.UNDEF=2]="UNDEF"}(Ct||(Ct={}));class _t{constructor(){this.status=Ct.UNDEF}isOk(){if(this.status===Ct.UNDEF)throw new Error("Status not set!");return this.status===Ct.OK}hasError(){if(this.status===Ct.UNDEF)throw new Error("Status not set!");return this.status===Ct.ERROR}getMessage(){if(this.status!==Ct.ERROR)throw new Error("Status is not ERROR!");if(!this.message)throw new Error("Status is ERROR but no message is set!");return this.message}getValue(){if(this.status!==Ct.OK)throw new Error("Status is not OK!");if(!this.wrapper)throw new Error("Value not set!");return this.wrapper.value}setOk(t){return this.status=Ct.OK,this.wrapper={value:t},this}setError(t){return this.status=Ct.ERROR,this.message=t,this}}const yt="https://api.github.com/repos/dead-end/cards-russian/contents/",Et=(()=>{const t=nt();return{subscribe:t.subscribe,init:async()=>{const e=await new Promise((t=>{it.then((e=>{const n=e.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=()=>{let e=n.result;e||(e={config:"admin",langUrl:yt,linkUrl:"https://github.com/dead-end/cards-russian/blob/master/",backupUrl:"",file:"",token:""}),t(e)}}))}));t.set(e),console.log("init admin",e)},get:()=>function(t){let e;return c(t,(t=>e=t))(),e}(t),put:async e=>{const n=new _t;try{return await(async t=>{t.langUrl=vt(t.langUrl,"/"),t.linkUrl?t.linkUrl=vt(t.linkUrl,"/"):t.linkUrl=yt;const e=(await it).transaction(["admin"],"readwrite").objectStore("admin");at(e,t)})(e),t.set(e),n.setOk()}catch(t){return n.setError(`Unable to store admin config - ${t}`)}}}})();function St(t,e,n){const o=t.slice();return o[2]=e[n],o}function qt(t){let e,n,o=t[2]+"";return{c(){e=p("li"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&v(n,o)},d(t){t&&d(e)}}}function Lt(e){let n,o,s,r,i,c,a,h,m,w=e[0],v=[];for(let t=0;t<w.length;t+=1)v[t]=qt(St(e,w,t));return{c(){n=p("div"),o=p("h4"),o.textContent="Errors",s=g(),r=p("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=g(),c=p("div"),a=p("button"),a.textContent="Ok",b(o,"class","is-text-danger"),b(a,"class","button"),b(c,"class","is-floating"),b(n,"class","card card-shadow block content")},m(t,d){u(t,n,d),l(n,o),l(n,s),l(n,r);for(let t=0;t<v.length;t+=1)v[t]&&v[t].m(r,null);l(n,i),l(n,c),l(c,a),h||(m=$(a,"click",e[1]),h=!0)},p(t,[e]){if(1&e){let n;for(w=t[0],n=0;n<w.length;n+=1){const o=St(t,w,n);v[n]?v[n].p(o,e):(v[n]=qt(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=w.length}},i:t,o:t,d(t){t&&d(n),f(v,t),h=!1,m()}}}function Tt(t,e,n){let o;a(t,st,(t=>n(0,o=t)));return[o,()=>{st.resetErrors()}]}class Ut extends tt{constructor(t){super(),Z(this,t,Tt,Lt,i,{})}}const Vt=async t=>{const e=(await it).transaction(["hash"],"readonly").objectStore("hash");return lt(e,t)},Mt=async()=>{const t=(await it).transaction(["hash"],"readonly").objectStore("hash");return ut(t)},jt=async t=>{const e=(await it).transaction(["hash"],"readwrite").objectStore("hash");return ct(e,t)},Ht=(t,e)=>{const n=t.objectStore("hash");return ct(n,e)},Ot=async(t,e,n,o,s)=>{const r=new _t;try{const c={content:(i=e,window.btoa(unescape(encodeURIComponent(i)))),message:o};n&&(c.sha=n);const a={method:"PUT",headers:{Accept:"application/vnd.github.v3+json",authorization:`token ${s}`},body:JSON.stringify(c)},l=await fetch(t,a);if(!l.ok)return r.setError(`githubWriteContent - Url: ${t} Error: ${l.statusText}`)}catch(e){return r.setError(`githubWriteContent - Url: ${t} Error: ${e}`)}var i;return r.setOk()},Rt=async(t,e)=>{const n=new _t;try{const s={Accept:"application/vnd.github.v3+json"};e&&(s.authorization=`token ${e}`);const r=await fetch(t,s);if(!r.ok)return n.setError(`githubReadContent - Url: ${t} Read error: ${r.statusText}`);const i=await r.json(),c=(o=i.content,decodeURIComponent(escape(window.atob(o))));return n.setOk({content:c,hash:i.sha})}catch(e){return n.setError(`githubReadContent - Url: ${t} Error: ${e}`)}var o},At=async(t,e)=>{const n=new _t;try{const o={Accept:"application/vnd.github.v3+json"};e&&(o.authorization=`token ${e}`);const s=await fetch(t,{method:"HEAD",headers:o});if(404===s.status)return n.setOk();if(!s.ok)return n.setError(`githubGetHash - Url: ${t} Error: ${s.statusText}`);const r=s.headers.get("ETag");if(!r)return console.log("githubGetHash - no ETag found",t),n.setOk();const i=r.startsWith("W/")?3:1,c=r.substring(i,r.length-1);return console.log("githubGetHash:",c),n.setOk(c)}catch(e){return n.setError(`githubGetHash - Url: ${t} Error: ${e}`)}},Nt=async()=>{const t=new _t;try{const e=Et.get(),n=e.backupUrl+e.file,o=await Rt(n,e.token);if(o.hasError())return t.setError(`repoReadBackup - unable to read data: ${o.getMessage()}`);const s=JSON.parse(o.getValue().content);return t.setOk(s)}catch(e){return t.setError(`repoReadBackup - unable to restore data: ${e}`)}},Bt=async t=>{const e=Et.get();if(!e.token)return(new _t).setError(`repoWriteBackup - file: ${e.backupUrl} Token required`);const n=await At(e.backupUrl,e.token),o=JSON.stringify(t),s=e.backupUrl+e.file;return Ot(s,o,n.getValue(),"backup",e.token)},Gt=async(t,e,n,o)=>{const s=new _t,r=Et.get();if(!r.token)return s.setError(`repoWriteContent - file: ${t} Token required`);const i=r.langUrl+t,c=JSON.stringify(e,null,2),a=await Ot(i,c,n,o,r.token);return a.hasError()?s.setError(`repoWriteJson - unable to write: ${a.getMessage()}`):(await jt(t),s.setOk())},Pt=async t=>{const e=new _t;try{const n=Et.get(),o=n.langUrl+t,s=await Rt(o,n.token);return s.hasError()?e.setError(`repoGetJson - unable to read data: ${s.getMessage()}`):e.setOk({json:JSON.parse(s.getValue().content),hash:s.getValue().hash})}catch(t){return e.setError(`repoGetJson - unable get json: ${t}`)}},It=async t=>{const e=new _t;try{const n=Et.get(),o=n.langUrl+t;let s=await Vt(t);if(s&&s.value){const r=await At(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);if(r.getValue()&&r.getValue()===s.value)return console.log("repoGetJsonCache - cache ok",t),e.setOk()}const r=await Rt(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);const i=JSON.parse(r.getValue().content);return await(async t=>{const e=(await it).transaction(["hash"],"readwrite").objectStore("hash");return at(e,t)})({file:t,value:r.getValue().hash,lastLoaded:new Date}),console.log("repoGetJsonCache",t,i),e.setOk(i)}catch(n){return e.setError(`repoGetJsonCache - file: ${t} - ${n}`)}};class Dt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&st.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class Ft{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new Dt(t,e)}_pattern(){let t="";for(const e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return t in this.map||st.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(const e in this.map)this.map[e].check(t)}_substitute(t){return t.replaceAll(this.regex,(t=>this.tag(t)))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(const o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}static remove(t){return t.replace(/[_*~]/g,"")}}const zt=t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e},Jt=(t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=gt(t.failed,t.total)},Wt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=()=>{c.result.forEach((t=>{ct(i,t)})),s()},c.onerror=t=>{st.addError(`Store: ${i.name} delete index error: ${t}`),r()}})))(t,"questions","file",e),Qt=async t=>{const e=(await it).transaction(["questions"],"readwrite").objectStore("questions");return at(e,t)},Kt=async t=>{const e=(await it).transaction(["questions"],"readonly").objectStore("questions");return Yt(e,t)},Yt=(t,e)=>new Promise((n=>{const o=t.index("file").getAll(e.file);o.onsuccess=()=>{n(o.result)}})),Xt=async(t,e)=>{const n=(await it).transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,at(n,t))));await Promise.all(o)},Zt=async(t,e,n)=>{const o=(await it).transaction(["questions"],"readonly").objectStore("questions"),s=[];return t.forEach((t=>{s.push(Yt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if($t(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),$t(o)),o.splice(0,e)}))},te=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=()=>{const t=re(n),r=re(s.result);r.forEach((e=>{t.has(e.id)||ct(o,e.id)})),t.forEach((t=>{const n=r.get(t.id);n?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(n,t),at(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=()=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{st.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},ee=()=>new Promise(((t,e)=>{const n=[];it.then((o=>{const s=o.transaction(["questions"],"readonly").objectStore("questions"),r=s.openCursor();r.onsuccess=()=>{const e=r.result;if(e){const t=e.value;n.push([t.id,t.failed,t.total]),e.continue()}else console.log("Store:",s.name,"questGetBackup finished:",n.length),t(n)},r.onerror=t=>{console.log("Store:",s.name,"questGetBackup:",t),e()}}))})),ne=async t=>{const e=(await it).transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];lt(e,n).then((t=>{t?t.total>=s?console.log(`question: ${n} total db: ${t.total} total backup: ${s} => ignore`):(t.failed=o,t.total=s,t.ratio=gt(t.failed,t.total),at(e,t)):console.log("question to restore not found in db",n)}))}))},oe=async t=>{const e=await It(t);if(e.hasError())return void st.addError(`Unable to get file: ${t} - ${e.getMessage()}`);const n=e.getValue();if(n){const e=(await it).transaction(["questions"],"readwrite");te(e,t,n)}},se=async t=>{const e=[];return t.forEach((t=>{e.push(oe(t))})),Promise.all(e)},re=t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e},ie=(t,e)=>{for(let n of t)if(Ft.remove(n).toLowerCase().includes(e))return!0;return!1},ce=(t,e)=>{const n=t.toLowerCase();return new Promise(((t,o)=>{const s=[];let r=0,i=0;it.then((c=>{const a=c.transaction(["questions"],"readonly").objectStore("questions"),l=a.openCursor();l.onsuccess=()=>{const o=l.result;if(o){const t=o.value;(ie(t.quest,n)||ie(t.answer,n))&&(s.length<e&&s.push(t),i++),r++,o.continue()}else console.log("Store:",a.name,"questSearch finished:",s.length),t([s,r,i])},l.onerror=t=>{console.log("Store:",a.name,"questSearch:",t),o()}}))}))},ae=t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()},le=async t=>{const e=(await it).transaction(["topics"],"readonly").objectStore("topics");return lt(e,t)},ue=async()=>{const t=(await it).transaction(["topics"],"readonly").objectStore("topics");return ut(t)},de=async t=>{const e=(await it).transaction(["topics"],"readwrite").objectStore("topics");at(e,t)},fe=(t,e)=>{const n=t.objectStore("topics");ct(n,e)},pe=async t=>{const e=(await it).transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=()=>{const s=he(o.result),r=t.map((t=>t.file));for(const t of s.keys())r.includes(t)||(fe(e,t),Ht(e,t),Wt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!ft(t.tags,e.tags)||!ft(t.details,e.details)))(t,s.get(t.file))&&at(n,t)}))}},he=t=>{const e=new Map;return t.forEach((t=>{e.set(t.file,t)})),e},ge=async()=>{const t=await It("data/topics.json");if(t.hasError())return void st.addError(`Unable to load topics - ${t.getMessage()}`);const e=t.getValue();e&&await pe(e)};function me(t){let e,n,o,s,r,i,c,a,f,$,w,b,k,x,C=t[4]&&$e(t);return{c(){e=p("tr"),n=p("td"),n.textContent="Questions",o=g(),s=p("td"),r=h(t[2]),i=g(),c=p("tr"),a=p("td"),a.textContent="Status",f=g(),$=p("td"),w=h(t[1]),b=h("%"),k=g(),C&&C.c(),x=m()},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(s,r),u(t,i,d),u(t,c,d),l(c,a),l(c,f),l(c,$),l($,w),l($,b),u(t,k,d),C&&C.m(t,d),u(t,x,d)},p(t,e){4&e&&v(r,t[2]),2&e&&v(w,t[1]),t[4]?C?C.p(t,e):(C=$e(t),C.c(),C.m(x.parentNode,x)):C&&(C.d(1),C=null)},d(t){t&&d(e),t&&d(i),t&&d(c),t&&d(k),C&&C.d(t),t&&d(x)}}}function $e(t){let e,n,o,s,r,i,c,a,f,m,$,w=dt(t[4].lastLoaded)+"",b=t[4].value+"";return{c(){e=p("tr"),n=p("td"),n.textContent="Last loaded",o=g(),s=p("td"),r=h(w),i=g(),c=p("tr"),a=p("td"),a.textContent="Hash",f=g(),m=p("td"),$=h(b)},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(s,r),u(t,i,d),u(t,c,d),l(c,a),l(c,f),l(c,m),l(m,$)},p(t,e){16&e&&w!==(w=dt(t[4].lastLoaded)+"")&&v(r,w),16&e&&b!==(b=t[4].value+"")&&v($,b)},d(t){t&&d(e),t&&d(i),t&&d(c)}}}function we(t){let e,n,o=t[0].desc+"";return{c(){e=p("p"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&v(n,o)},d(t){t&&d(e)}}}function be(e){let n,o,s,r,i,c,a,f,$,w,b,k,x,C,_,y,E,S,q,L,T,U,V,M,j=e[0].title+"",H=e[0].file+"",O=e[0].tags.join(", ")+"",R=dt(e[0].lastLearned)+"",A=e[3]&&me(e),N=e[0].desc&&we(e);return{c(){n=p("h4"),o=h(j),s=g(),r=p("table"),i=p("tr"),c=p("td"),c.textContent="File",a=g(),f=p("td"),$=h(H),w=g(),b=p("tr"),k=p("td"),k.textContent="Tags",x=g(),C=p("td"),_=h(O),y=g(),E=p("tr"),S=p("td"),S.textContent="Last learned",q=g(),L=p("td"),T=h(R),U=g(),A&&A.c(),V=g(),N&&N.c(),M=m()},m(t,e){u(t,n,e),l(n,o),u(t,s,e),u(t,r,e),l(r,i),l(i,c),l(i,a),l(i,f),l(f,$),l(r,w),l(r,b),l(b,k),l(b,x),l(b,C),l(C,_),l(r,y),l(r,E),l(E,S),l(E,q),l(E,L),l(L,T),l(r,U),A&&A.m(r,null),u(t,V,e),N&&N.m(t,e),u(t,M,e)},p(t,[e]){1&e&&j!==(j=t[0].title+"")&&v(o,j),1&e&&H!==(H=t[0].file+"")&&v($,H),1&e&&O!==(O=t[0].tags.join(", ")+"")&&v(_,O),1&e&&R!==(R=dt(t[0].lastLearned)+"")&&v(T,R),t[3]?A?A.p(t,e):(A=me(t),A.c(),A.m(r,null)):A&&(A.d(1),A=null),t[0].desc?N?N.p(t,e):(N=we(t),N.c(),N.m(M.parentNode,M)):N&&(N.d(1),N=null)},i:t,o:t,d(t){t&&d(n),t&&d(s),t&&d(r),A&&A.d(),t&&d(V),N&&N.d(t),t&&d(M)}}}function ve(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return L((async()=>{c&&n(4,o=await Vt(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class ke extends tt{constructor(t){super(),Z(this,t,ve,be,i,{topic:0,status:1,size:2,details:3})}}function xe(t){let e,n,o,s,r,i,c,a,f;return n=new ke({props:{topic:t[0],details:!1}}),{c(){e=p("div"),Q(n.$$.fragment),o=g(),s=p("div"),r=p("button"),r.textContent="Show",b(r,"class","button"),b(s,"class","is-floating"),b(e,"class","card card-shadow content"),b(e,"id",i=t[0].file)},m(i,d){u(i,e,d),K(n,e,null),l(e,o),l(e,s),l(s,r),c=!0,a||(f=$(r,"click",t[2]),a=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&b(e,"id",i)},i(t){c||(J(n.$$.fragment,t),c=!0)},o(t){W(n.$$.fragment,t),c=!1},d(t){t&&d(e),Y(n),a=!1,f()}}}function Ce(t,e,n){let{topic:o}=e;const s=t=>{ot.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class _e extends tt{constructor(t){super(),Z(this,t,Ce,xe,i,{topic:0})}}function ye(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Ee(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Se extends tt{constructor(t){super(),Z(this,t,Ee,ye,i,{onClick:0})}}function qe(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Le(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Te extends tt{constructor(t){super(),Z(this,t,Le,qe,i,{onClick:0})}}function Ue(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5l-3.9 19.5m-2.1-19.5l-3.9 19.5"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function Ve(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Me extends tt{constructor(t){super(),Z(this,t,Ve,Ue,i,{onClick:0})}}function je(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function He(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Oe extends tt{constructor(t){super(),Z(this,t,He,je,i,{onClick:0})}}function Re(t,e,n){const o=t.slice();return o[14]=e[n],o}function Ae(t,e,n){const o=t.slice();return o[17]=e[n],o}function Ne(t){let e,n,o,r,i,c,a,h,m,w,v,k,x,_,y,E,S,q,L,T,U,V,M,j=t[1],H=[];for(let e=0;e<j.length;e+=1)H[e]=Be(Ae(t,j,e));let O=t[2]&&Ge(t);return _=new Oe({props:{onClick:t[9]}}),E=new Me({props:{onClick:t[10]}}),q=new Te({props:{onClick:t[11]}}),T=new Se({props:{onClick:t[12]}}),{c(){e=p("div"),n=p("label"),n.textContent="Sort",o=g(),r=p("select"),i=p("option"),i.textContent="-- Select --",c=p("option"),c.textContent="Last learned",a=g(),h=p("label"),h.textContent="Tag Filter",m=g(),w=p("select"),v=p("option"),v.textContent="-- Select --";for(let t=0;t<H.length;t+=1)H[t].c();k=g(),O&&O.c(),x=g(),Q(_.$$.fragment),y=g(),Q(E.$$.fragment),S=g(),Q(q.$$.fragment),L=g(),Q(T.$$.fragment),b(n,"class","is-valign-center"),b(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,b(r,"id","sort-select"),void 0===t[3]&&A((()=>t[6].call(r))),b(h,"for","tag-select"),v.__value="",v.value=v.__value,b(w,"id","tag-select"),void 0===t[2]&&A((()=>t[7].call(w))),b(e,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),C(r,t[3]),l(e,a),l(e,h),l(e,m),l(e,w),l(w,v);for(let t=0;t<H.length;t+=1)H[t]&&H[t].m(w,null);C(w,t[2]),l(e,k),O&&O.m(e,null),l(e,x),K(_,e,null),l(e,y),K(E,e,null),l(e,S),K(q,e,null),l(e,L),K(T,e,null),U=!0,V||(M=[$(r,"change",t[6]),$(r,"change",t[4]),$(w,"change",t[7]),$(w,"change",t[4])],V=!0)},p(t,n){if(8&n&&C(r,t[3]),2&n){let e;for(j=t[1],e=0;e<j.length;e+=1){const o=Ae(t,j,e);H[e]?H[e].p(o,n):(H[e]=Be(o),H[e].c(),H[e].m(w,null))}for(;e<H.length;e+=1)H[e].d(1);H.length=j.length}6&n&&C(w,t[2]),t[2]?O?O.p(t,n):(O=Ge(t),O.c(),O.m(e,x)):O&&(O.d(1),O=null)},i(t){U||(J(_.$$.fragment,t),J(E.$$.fragment,t),J(q.$$.fragment,t),J(T.$$.fragment,t),U=!0)},o(t){W(_.$$.fragment,t),W(E.$$.fragment,t),W(q.$$.fragment,t),W(T.$$.fragment,t),U=!1},d(t){t&&d(e),f(H,t),O&&O.d(),Y(_),Y(E),Y(q),Y(T),V=!1,s(M)}}}function Be(t){let e,n,o,s=t[17]+"";return{c(){e=p("option"),n=h(s),e.__value=o=t[17],e.value=e.__value},m(t,o){u(t,e,o),l(e,n)},p(t,r){2&r&&s!==(s=t[17]+"")&&v(n,s),2&r&&o!==(o=t[17])&&(e.__value=o,e.value=e.__value)},d(t){t&&d(e)}}}function Ge(e){let n,o,s;return{c(){n=p("button"),n.textContent="Show",b(n,"class","button")},m(t,r){u(t,n,r),o||(s=$(n,"click",e[8]),o=!0)},p:t,d(t){t&&d(n),o=!1,s()}}}function Pe(t){let e,n;return e=new _e({props:{topic:t[14]}}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[14]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ie(t){let e,n,o,s=t[1]&&Ne(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Pe(Re(t,r,e));const c=t=>W(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=g(),n=p("div");for(let t=0;t<i.length;t+=1)i[t].c();b(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),u(t,e,r),u(t,n,r);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?(s.p(t,o),2&o&&J(s,1)):(s=Ne(t),s.c(),J(s,1),s.m(e.parentNode,e)):s&&(F(),W(s,1,1,(()=>{s=null})),z()),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Re(t,r,e);i[e]?(i[e].p(s,o),J(i[e],1)):(i[e]=Pe(s),i[e].c(),J(i[e],1),i[e].m(n,null))}for(F(),e=r.length;e<i.length;e+=1)c(e);z()}},i(t){if(!o){J(s);for(let t=0;t<r.length;t+=1)J(i[t]);o=!0}},o(t){W(s),i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)W(i[t]);o=!1},d(t){s&&s.d(t),t&&d(e),t&&d(n),f(i,t)}}}function De(t,e,n){let o,s,r,{id:i}=e,c=[],a=[];L((()=>{ue().then((t=>(t.sort(((t,e)=>+(t.title>e.title)||-(t.title<e.title))),t))).then((t=>{c=t,n(0,a=t),n(1,o=ae(c))}))})),T((()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}}));return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[a,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,a=t)},i,function(){r=_(this),n(3,r)},function(){s=_(this),n(2,s),n(1,o)},()=>ot.setView("ViewTagInfo",{tag:s,topics:a}),()=>ot.setView("ViewTranslate"),()=>ot.setView("ViewHashes"),()=>ot.setView("ViewAdmin"),()=>ot.setView("ViewSearch")]}class Fe extends tt{constructor(t){super(),Z(this,t,De,Ie,i,{id:5})}}function ze(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=p("div"),n=p("h5"),n.textContent="Details",o=g(),s=p("div"),r=p("p"),b(s,"class","card content is-info"),b(e,"class","block")},m(t,c){u(t,e,c),l(e,n),l(e,o),l(e,s),l(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&d(e)}}}function Je(t){let e,n,o,r,i,c,a,f,m,w,v,k,x,C,_,y,E,S,q,L,T,U,V,M,j,H;r=new ke({props:{topic:t[0],status:t[1],size:t[3]}});let O=t[0].details&&ze(t);return{c(){e=p("div"),n=p("div"),o=p("div"),Q(r.$$.fragment),i=g(),c=p("div"),a=p("label"),a.textContent="Number of correct answers",f=g(),m=p("select"),w=p("option"),w.textContent="-- Select --",v=p("option"),v.textContent="Set 0",k=p("option"),k.textContent="Set 1",x=p("option"),x.textContent="Set 2",C=p("option"),C.textContent="Set 3",_=g(),O&&O.c(),y=g(),E=p("div"),S=p("button"),S.textContent="Back",q=g(),L=p("button"),L.textContent="Listing",T=g(),U=p("button"),V=h("Start"),b(o,"class","is-text-left"),b(a,"for","sf-set"),w.__value="",w.value=w.__value,v.__value="0",v.value=v.__value,k.__value="1",k.value=k.__value,x.__value="2",x.value=x.__value,C.__value="3",C.value=C.__value,b(m,"id","sf-set"),b(c,"class","is-floating"),b(S,"class","button"),b(L,"class","button"),b(U,"class","button"),U.disabled=t[2],b(E,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,d){u(s,e,d),l(e,n),l(n,o),K(r,o,null),l(n,i),l(n,c),l(c,a),l(c,f),l(c,m),l(m,w),l(m,v),l(m,k),l(m,x),l(m,C),l(n,_),O&&O.m(n,null),l(e,y),l(e,E),l(E,S),l(E,q),l(E,L),l(E,T),l(E,U),l(U,V),M=!0,j||(H=[$(m,"change",t[8]),$(S,"click",t[5]),$(L,"click",t[6]),$(U,"click",t[7])],j=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?O?O.p(t,e):(O=ze(t),O.c(),O.m(n,null)):O&&(O.d(1),O=null),(!M||4&e)&&(U.disabled=t[2])},i(t){M||(J(r.$$.fragment,t),M=!0)},o(t){W(r.$$.fragment,t),M=!1},d(t){t&&d(e),Y(r),O&&O.d(),j=!1,s(H)}}}function We(t,e,n){let{topic:o}=e,{questions:s}=e;const r=new Ft;let i=0,c=!0,a=0;const l=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=ht(t,3)),n(2,c=pt(t,3)),n(3,a=t.length)};L((async()=>{try{s||(await oe(o.file),console.log("Loading questions for topics"),n(9,s=await Kt(o)),l())}catch(t){st.addError("ViewTopicInfo: "+bt(t))}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,a,r,()=>{ot.setView("ViewTopicList",{id:o.file})},()=>{ot.setView("ViewTopicQuests",{topic:o})},()=>{ot.setView("ViewQuestAnswer",{topics:[o],questions:s})},async t=>{if(!s)return;const e=t.target;await Xt(s,e.selectedIndex-1),e.selectedIndex=0,l()},s]}class Qe extends tt{constructor(t){super(),Z(this,t,We,Je,i,{topic:0,questions:9})}}function Ke(e){let n,o,s,r,i,c,a,f,m,$,w,k,x,C,_,y=e[0].progress+"",E=e[0].total+"",S=e[0].ratio+"";return{c(){n=p("div"),o=h("Progress: "),s=p("span"),r=h(y),i=h(" /\n  "),c=p("span"),c.textContent="3",a=g(),f=p("span"),m=h("Total: "),$=p("span"),w=h(E),k=h(" Wrong:\n    "),x=p("span"),C=h(S),_=h("%"),b(s,"class","is-text-success"),b(c,"class","is-text-success"),b($,"class","is-text-success"),b(x,"class","is-text-danger"),b(f,"class","hide-sm"),b(n,"class","h6")},m(t,e){u(t,n,e),l(n,o),l(n,s),l(s,r),l(n,i),l(n,c),l(n,a),l(n,f),l(f,m),l(f,$),l($,w),l(f,k),l(f,x),l(x,C),l(x,_)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&v(r,y),1&e&&E!==(E=t[0].total+"")&&v(w,E),1&e&&S!==(S=t[0].ratio+"")&&v(C,S)},i:t,o:t,d(t){t&&d(n)}}}function Ye(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class Xe extends tt{constructor(t){super(),Z(this,t,Ye,Ke,i,{question:0})}}function Ze(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg>',b(n,"class","icon reset-button")},m(t,i){u(t,n,i),o||(s=$(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&d(n),o=!1,s()}}}function tn(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class en extends tt{constructor(t){super(),Z(this,t,tn,Ze,i,{onClick:0})}}function nn(t,e,n){const o=t.slice();return o[11]=e[n],o}function on(t){let e,n,o,s,r,i,c,a,f,m,$,w,k,x,C,_=t[11].id+"",y=t[11].file+"";function E(){return t[10](t[11])}return w=new en({props:{onClick:E}}),x=new Xe({props:{question:t[11]}}),{c(){e=p("div"),n=p("div"),o=p("span"),s=h("Id: "),r=h(_),i=g(),c=p("span"),a=p("a"),f=h(y),$=g(),Q(w.$$.fragment),k=g(),Q(x.$$.fragment),b(o,"class","h6"),b(a,"href",m=t[3].linkUrl+t[11].file),b(a,"target","_blank"),b(c,"class","hide-sm"),b(e,"class","is-flex-spread grid-full")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(o,s),l(o,r),l(n,i),l(n,c),l(c,a),l(a,f),l(n,$),K(w,n,null),l(e,k),K(x,e,null),C=!0},p(e,n){t=e,(!C||2&n)&&_!==(_=t[11].id+"")&&v(r,_),(!C||2&n)&&y!==(y=t[11].file+"")&&v(f,y),(!C||10&n&&m!==(m=t[3].linkUrl+t[11].file))&&b(a,"href",m);const o={};2&n&&(o.onClick=E),w.$set(o);const s={};2&n&&(s.question=t[11]),x.$set(s)},i(t){C||(J(w.$$.fragment,t),J(x.$$.fragment,t),C=!0)},o(t){W(w.$$.fragment,t),W(x.$$.fragment,t),C=!1},d(t){t&&d(e),Y(w),Y(x)}}}function sn(t){let e,n,o,s,r,i,c,a,f,h,m=t[4].toHtml(t[11].quest)+"",$=t[4].toHtml(t[11].answer)+"",w=t[0]&&on(t);return{c(){w&&w.c(),e=g(),n=p("div"),o=p("div"),s=p("p"),r=g(),i=p("div"),c=p("div"),a=p("p"),f=g(),b(o,"class","content"),b(n,"class","card "+t[6]()),b(c,"class","content"),b(i,"class","card "+t[6]())},m(t,d){w&&w.m(t,d),u(t,e,d),u(t,n,d),l(n,o),l(o,s),s.innerHTML=m,u(t,r,d),u(t,i,d),l(i,c),l(c,a),a.innerHTML=$,l(i,f),h=!0},p(t,n){t[0]?w?(w.p(t,n),1&n&&J(w,1)):(w=on(t),w.c(),J(w,1),w.m(e.parentNode,e)):w&&(F(),W(w,1,1,(()=>{w=null})),z()),(!h||2&n)&&m!==(m=t[4].toHtml(t[11].quest)+"")&&(s.innerHTML=m),(!h||2&n)&&$!==($=t[4].toHtml(t[11].answer)+"")&&(a.innerHTML=$)},i(t){h||(J(w),h=!0)},o(t){W(w),h=!1},d(t){w&&w.d(t),t&&d(e),t&&d(n),t&&d(r),t&&d(i)}}}function rn(t){let e,n,o,r,i,c,a,h,m,w,v,k,x,_,y,E,S=t[1],q=[];for(let e=0;e<S.length;e+=1)q[e]=sn(nn(t,S,e));const L=t=>W(q[t],1,1,(()=>{q[t]=null}));return{c(){e=p("div"),n=p("label"),n.textContent="Details",o=g(),r=p("input"),i=g(),c=p("label"),c.textContent="Sort",a=g(),h=p("select"),m=p("option"),m.textContent="-- Select --",w=p("option"),w.textContent="Total",v=p("option"),v.textContent="Ratio",k=g(),x=p("div");for(let t=0;t<q.length;t+=1)q[t].c();b(n,"for","details-checkbox"),b(r,"type","checkbox"),b(r,"id","details-checkbox"),b(c,"for","quest-sort"),m.__value="",m.value=m.__value,w.__value="total",w.value=w.__value,v.__value="ratio",v.value=v.__value,b(h,"id","quest-sort"),void 0===t[2]&&A((()=>t[9].call(h))),b(e,"class","is-floating"),b(x,"class","grid grid-2")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),r.checked=t[0],l(e,i),l(e,c),l(e,a),l(e,h),l(h,m),l(h,w),l(h,v),C(h,t[2]),u(s,k,d),u(s,x,d);for(let t=0;t<q.length;t+=1)q[t]&&q[t].m(x,null);_=!0,y||(E=[$(r,"change",t[8]),$(h,"change",t[9]),$(h,"change",t[5])],y=!0)},p(t,[e]){if(1&e&&(r.checked=t[0]),4&e&&C(h,t[2]),91&e){let n;for(S=t[1],n=0;n<S.length;n+=1){const o=nn(t,S,n);q[n]?(q[n].p(o,e),J(q[n],1)):(q[n]=sn(o),q[n].c(),J(q[n],1),q[n].m(x,null))}for(F(),n=S.length;n<q.length;n+=1)L(n);z()}},i(t){if(!_){for(let t=0;t<S.length;t+=1)J(q[t]);_=!0}},o(t){q=q.filter(Boolean);for(let t=0;t<q.length;t+=1)W(q[t]);_=!1},d(t){t&&d(e),t&&d(k),t&&d(x),f(q,t),y=!1,s(E)}}}function cn(t,e,n){let o;a(t,Et,(t=>n(3,o=t)));let{questions:s}=e,r=!1,i=[],c="";const l=new Ft;T((()=>{console.log("afterUpdate questions:",s),n(1,i=s)}));const u=wt(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(7,s=t.questions)},[r,i,c,o,l,()=>{if(!c)return void n(1,i=s);let t=[...s];"ratio"===c?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===c&&t.sort(((t,e)=>e.total-t.total)),n(1,i=t)},u,s,function(){r=this.checked,n(0,r)},function(){c=_(this),n(2,c)},t=>ot.setView("ViewQuestEdit",{question:t})]}class an extends tt{constructor(t){super(),Z(this,t,cn,rn,i,{questions:7})}}function ln(t){let e,n;return e=new an({props:{questions:t[1]}}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function un(t){let e,n,o,s,r,i,c,a,f,m,w=t[0].title+"",k=0!==t[1].length&&ln(t);return{c(){e=p("div"),n=p("h4"),o=h(w),s=g(),k&&k.c(),r=g(),i=p("div"),c=p("button"),c.textContent="Back",b(c,"class","button"),b(i,"class","is-floating"),b(e,"class","card card-shadow content")},m(d,p){u(d,e,p),l(e,n),l(n,o),l(e,s),k&&k.m(e,null),l(e,r),l(e,i),l(i,c),a=!0,f||(m=$(c,"click",t[3]),f=!0)},p(t,[n]){(!a||1&n)&&w!==(w=t[0].title+"")&&v(o,w),0!==t[1].length?k?(k.p(t,n),2&n&&J(k,1)):(k=ln(t),k.c(),J(k,1),k.m(e,r)):k&&(F(),W(k,1,1,(()=>{k=null})),z())},i(t){a||(J(k),a=!0)},o(t){W(k),a=!1},d(t){t&&d(e),k&&k.d(),f=!1,m()}}}function dn(t,e,n){let{topic:o}=e,s=[];L((()=>{Kt(o).then((t=>{n(1,s=t)}))}));const r=t=>{ot.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class fn extends tt{constructor(t){super(),Z(this,t,dn,un,i,{topic:0})}}function pn(t,e,n){const o=t.slice();return o[15]=e[n],o}function hn(t){let e,n,o=t[15].title+"";return{c(){e=p("li"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[15].title+"")&&v(n,o)},d(t){t&&d(e)}}}function gn(t){let e,n,o,r,i,c,a,f,h,m;return{c(){e=p("div"),n=p("label"),n.textContent="Number of correct answers",o=g(),r=p("select"),i=p("option"),i.textContent="-- Select --",c=p("option"),c.textContent="Set 0",a=p("option"),a.textContent="Set 1",f=p("option"),f.textContent="Set 2",b(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,a.__value="1",a.value=a.__value,f.__value="2",f.value=f.__value,b(r,"id","sf-set"),void 0===t[5]&&A((()=>t[14].call(r))),b(e,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),l(r,a),l(r,f),C(r,t[5]),h||(m=[$(r,"change",t[14]),$(r,"change",t[9])],h=!0)},p(t,e){32&e&&C(r,t[5])},d(t){t&&d(e),h=!1,s(m)}}}function mn(t){let e,n,o,r,i,c,a,f,h,m,w,v,k,x,_,y,E,S;return{c(){e=p("div"),n=p("label"),n.textContent="Load Questions",o=g(),r=p("select"),i=p("option"),i.textContent="30",c=p("option"),c.textContent="All",a=g(),f=p("div"),h=p("label"),h.textContent="Used fraction (sorted by ratio)",m=g(),w=p("select"),v=p("option"),v.textContent="40 %",k=p("option"),k.textContent="50 %",x=p("option"),x.textContent="60 %",_=p("option"),_.textContent="70 %",y=p("option"),y.textContent="80 %",b(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,b(r,"id","load-quests"),void 0===t[2]&&A((()=>t[12].call(r))),b(e,"class","is-floating"),b(h,"for","relevant"),v.__value="0.4",v.value=v.__value,k.__value="0.5",k.value=k.__value,x.__value="0.6",x.value=x.__value,_.__value="0.7",_.value=_.__value,y.__value="0.8",y.value=y.__value,b(w,"id","relevant"),void 0===t[3]&&A((()=>t[13].call(w))),b(f,"class","is-floating")},m(s,d){u(s,e,d),l(e,n),l(e,o),l(e,r),l(r,i),l(r,c),C(r,t[2]),u(s,a,d),u(s,f,d),l(f,h),l(f,m),l(f,w),l(w,v),l(w,k),l(w,x),l(w,_),l(w,y),C(w,t[3]),E||(S=[$(r,"change",t[12]),$(w,"change",t[13])],E=!0)},p(t,e){4&e&&C(r,t[2]),8&e&&C(w,t[3])},d(t){t&&d(e),t&&d(a),t&&d(f),E=!1,s(S)}}}function $n(e){let n,o,s;return{c(){n=p("button"),n.textContent="Load",b(n,"class","button")},m(t,r){u(t,n,r),o||(s=$(n,"click",e[10]),o=!0)},p:t,d(t){t&&d(n),o=!1,s()}}}function wn(e){let n,o,r,i,c;return{c(){n=p("button"),n.textContent="Listing",o=g(),r=p("button"),r.textContent="Start",b(n,"class","button"),b(r,"class","button")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),i||(c=[$(n,"click",e[6]),$(r,"click",e[8])],i=!0)},p:t,d(t){t&&d(n),t&&d(o),t&&d(r),i=!1,s(c)}}}function bn(e){let n,o,s,r,i,c,a,m,w,k,x,C,_,y,E,S,q,L=e[1],T=[];for(let t=0;t<L.length;t+=1)T[t]=hn(pn(e,L,t));function U(t,e){return t[4]?gn:mn}let V=U(e),M=V(e);function j(t,e){return t[4]?wn:$n}let H=j(e),O=H(e);return{c(){n=p("div"),o=p("div"),s=p("div"),r=p("h4"),i=h("Tag: "),c=h(e[0]),a=g(),m=p("p"),m.textContent="Files incluging the tag:",w=g(),k=p("ul");for(let t=0;t<T.length;t+=1)T[t].c();x=g(),M.c(),C=g(),_=p("div"),y=p("button"),y.textContent="Back",E=g(),O.c(),b(s,"class","is-text-left"),b(y,"class","button"),b(_,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,d){u(t,n,d),l(n,o),l(o,s),l(s,r),l(r,i),l(r,c),l(s,a),l(s,m),l(s,w),l(s,k);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(k,null);l(n,x),M.m(n,null),l(n,C),l(n,_),l(_,y),l(_,E),O.m(_,null),S||(q=$(y,"click",e[7]),S=!0)},p(t,[e]){if(1&e&&v(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=pn(t,L,n);T[n]?T[n].p(o,e):(T[n]=hn(o),T[n].c(),T[n].m(k,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}V===(V=U(t))&&M?M.p(t,e):(M.d(1),M=V(t),M&&(M.c(),M.m(n,C))),H===(H=j(t))&&O?O.p(t,e):(O.d(1),O=H(t),O&&(O.c(),O.m(_,null)))},i:t,o:t,d(t){t&&d(n),f(T,t),M.d(),O.d(),S=!1,q()}}}function vn(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i}=e,c="30",a="0.5",l=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(11,i=t.questions)},[s,r,c,a,l,o,()=>{ot.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{ot.setView("ViewTopicList",{id:""})},()=>{ot.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;Xt(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(11,i=await Zt(r,t,parseFloat(a))),n(4,l=!0)}catch(t){st.addError("ViewTagInfo: "+bt(t))}},i,function(){c=_(this),n(2,c)},function(){a=_(this),n(3,a)},function(){o=_(this),n(5,o)}]}class kn extends tt{constructor(t){super(),Z(this,t,vn,bn,i,{tag:0,topics:1,questions:11})}}function xn(t){let e,n,o,s,r,i,c,a,f,m,w,k;return i=new an({props:{questions:t[1]}}),{c(){e=p("div"),n=p("h4"),o=h("Tag: "),s=h(t[0]),r=g(),Q(i.$$.fragment),c=g(),a=p("div"),f=p("button"),f.textContent="Back",b(f,"class","button"),b(a,"class","is-floating"),b(e,"class","card card-shadow content")},m(d,p){u(d,e,p),l(e,n),l(n,o),l(n,s),l(e,r),K(i,e,null),l(e,c),l(e,a),l(a,f),m=!0,w||(k=$(f,"click",t[4]),w=!0)},p(t,[e]){(!m||1&e)&&v(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){m||(J(i.$$.fragment,t),m=!0)},o(t){W(i.$$.fragment,t),m=!1},d(t){t&&d(e),Y(i),w=!1,k()}}}function Cn(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{ot.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class _n extends tt{constructor(t){super(),Z(this,t,Cn,xn,i,{tag:0,topics:3,questions:1})}}function yn(e){let n,o,s,r,i,c,a,f,m,$,w,k,x,C,_,y,E,S,q,L,T,U,V,M,j=e[0][0]+"",H=e[0][1]+"",O=e[0][2]+"",R=e[0][3]+"";return{c(){n=p("table"),o=p("tr"),s=p("td"),s.textContent="No correct Answers",r=g(),i=p("td"),c=h(j),a=g(),f=p("tr"),m=p("td"),m.textContent="One correct Answer",$=g(),w=p("td"),k=h(H),x=g(),C=p("tr"),_=p("td"),_.textContent="Two correct Answers",y=g(),E=p("td"),S=h(O),q=g(),L=p("tr"),T=p("td"),T.textContent="Learned",U=g(),V=p("td"),M=h(R),b(n,"class","table hide-md")},m(t,e){u(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,a),l(n,f),l(f,m),l(f,$),l(f,w),l(w,k),l(n,x),l(n,C),l(C,_),l(C,y),l(C,E),l(E,S),l(n,q),l(n,L),l(L,T),l(L,U),l(L,V),l(V,M)},p(t,[e]){1&e&&j!==(j=t[0][0]+"")&&v(c,j),1&e&&H!==(H=t[0][1]+"")&&v(k,H),1&e&&O!==(O=t[0][2]+"")&&v(S,O),1&e&&R!==(R=t[0][3]+"")&&v(M,R)},i:t,o:t,d(t){t&&d(n)}}}function En(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Sn extends tt{constructor(t){super(),Z(this,t,En,yn,i,{statistic:0})}}function qn(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=p("p")},m(t,o){u(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&d(e)}}}function Ln(t){let e,n,o,s,r,i,c,a,f,m,$,w,k,x,C,_,y,E,S,q=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",T=t[3].toHtml(t[0].answer)+"";a=new Xe({props:{question:t[0]}});let U=t[1].details&&qn(t);return{c(){e=p("div"),n=p("div"),o=p("div"),s=p("div"),r=h("Question: "),i=h(q),c=g(),Q(a.$$.fragment),f=g(),m=p("div"),$=p("p"),w=g(),k=p("div"),x=p("h5"),x.textContent="Answer",C=g(),_=p("div"),y=p("p"),E=g(),U&&U.c(),b(s,"class","h5"),b(o,"class","is-flex-spread block"),b(m,"class","card content is-primary"),b(_,"class","card content is-info"),k.hidden=t[2],b(e,"class","grid grid-2")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(o,s),l(s,r),l(s,i),l(o,c),K(a,o,null),l(n,f),l(n,m),l(m,$),$.innerHTML=L,l(e,w),l(e,k),l(k,x),l(k,C),l(k,_),l(_,y),y.innerHTML=T,l(_,E),U&&U.m(_,null),S=!0},p(t,[e]){(!S||1&e)&&q!==(q=t[0].id+"")&&v(i,q);const n={};1&e&&(n.question=t[0]),a.$set(n),(!S||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&($.innerHTML=L),(!S||1&e)&&T!==(T=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=T),t[1].details?U?U.p(t,e):(U=qn(t),U.c(),U.m(_,null)):U&&(U.d(1),U=null),(!S||4&e)&&(k.hidden=t[2])},i(t){S||(J(a.$$.fragment,t),S=!0)},o(t){W(a.$$.fragment,t),S=!1},d(t){t&&d(e),Y(a),U&&U.d()}}}function Tn(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Ft;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class Un extends tt{constructor(t){super(),Z(this,t,Tn,Ln,i,{question:0,topic:1,hideAnswer:2})}}function Vn(t){let e,n,o,r,i,c,a,f,m,w,v,k,x,C,_,y,E,S,q,L,T,U,V,M;function j(t,e){return t[0]?jn:Mn}let H=j(t),O=H(t);return o=new Sn({props:{statistic:t[3]}}),i=new Un({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=p("div"),O.c(),n=g(),Q(o.$$.fragment),r=g(),Q(i.$$.fragment),c=g(),a=p("div"),f=p("button"),m=h("Show"),v=g(),k=p("button"),x=h("Correct"),C=g(),_=p("button"),y=h("Wrong"),E=g(),S=p("button"),q=h("Skip"),L=g(),T=p("button"),T.textContent="Stop",b(f,"class","button"),f.hidden=w=!t[4],b(k,"class","button is-success"),k.hidden=t[4],b(_,"class","button is-danger"),_.hidden=t[4],b(S,"class","button is-warning"),S.hidden=t[4],b(T,"class","button"),b(a,"class","is-floating"),b(e,"class","card card-shadow content")},m(s,d){u(s,e,d),O.m(e,null),l(e,n),K(o,e,null),l(e,r),K(i,e,null),l(e,c),l(e,a),l(a,f),l(f,m),l(a,v),l(a,k),l(k,x),l(a,C),l(a,_),l(_,y),l(a,E),l(a,S),l(S,q),l(a,L),l(a,T),U=!0,V||(M=[$(f,"click",t[10]),$(k,"click",t[11]),$(_,"click",t[12]),$(S,"click",t[13]),$(T,"click",t[7])],V=!0)},p(t,s){H===(H=j(t))&&O?O.p(t,s):(O.d(1),O=H(t),O&&(O.c(),O.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!U||16&s&&w!==(w=!t[4]))&&(f.hidden=w),(!U||16&s)&&(k.hidden=t[4]),(!U||16&s)&&(_.hidden=t[4]),(!U||16&s)&&(S.hidden=t[4])},i(t){U||(J(o.$$.fragment,t),J(i.$$.fragment,t),U=!0)},o(t){W(o.$$.fragment,t),W(i.$$.fragment,t),U=!1},d(t){t&&d(e),O.d(),Y(o),Y(i),V=!1,s(M)}}}function Mn(t){let e,n,o=t[1].title+"";return{c(){e=p("h4"),n=h(o)},m(t,o){u(t,e,o),l(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&v(n,o)},d(t){t&&d(e)}}}function jn(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=p("h4"),n=h("Tag: "),o=h(t[0]),s=g(),r=p("h6"),i=h(c)},m(t,c){u(t,e,c),l(e,n),l(e,o),u(t,s,c),u(t,r,c),l(r,i)},p(t,e){1&e&&v(o,t[0]),2&e&&c!==(c=t[1].title+"")&&v(i,c)},d(t){t&&d(e),t&&d(s),t&&d(r)}}}function Hn(t){let e,n,o=t[2]&&Vn(t);return{c(){o&&o.c(),e=m()},m(t,s){o&&o.m(t,s),u(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&J(o,1)):(o=Vn(t),o.c(),J(o,1),o.m(e.parentNode,e)):o&&(F(),W(o,1,1,(()=>{o=null})),z())},i(t){n||(J(o),n=!0)},o(t){W(o),n=!1},d(t){o&&o.d(t),t&&d(e)}}}function On(t,e,n){let o,s,r,i,{tag:c}=e,{topics:a}=e,{questions:l}=e,u=!0;var d;!function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong",t[t.Skip=2]="Skip"}(d||(d={}));const f=t=>{if(t===d.Skip)return i.push(s),void p();Jt(s,t===d.Correct),Qt(s).then((()=>{s.progress<3&&i.push(s),0===i.length&&h(),p()}))},p=()=>{const t=i.shift();if(!t)return;n(2,s=t);const e=a.find((t=>t.file===s.file));e&&(n(1,o=e),n(3,r=zt(l)),n(4,u=!0),console.log("next",s))};L((()=>{i=l.filter((t=>t.progress<3)),$t(i),p()}));const h=async()=>{c?ot.setView("ViewTopicList",{id:""}):(n(1,o.lastLearned=new Date,o),await de(o),ot.setView("ViewTopicList",{id:o.file}))};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(8,a=t.topics),"questions"in t&&n(9,l=t.questions)},[c,o,s,r,u,d,f,h,a,l,()=>n(4,u=!1),()=>f(d.Correct),()=>f(d.Wrong),()=>f(d.Skip)]}class Rn extends tt{constructor(t){super(),Z(this,t,On,Hn,i,{tag:0,topics:8,questions:9})}}function An(e){let n,o,r,i,c,a,f,m,w,x,C,_,y,E,S,q,L,T,U,V,M,j,H,O,R;return{c(){n=p("h4"),n.textContent="Translate",o=g(),r=p("div"),i=p("label"),c=h(e[0]),a=g(),f=p("textarea"),m=g(),w=p("label"),x=h(e[1]),C=g(),_=p("textarea"),y=g(),E=p("div"),S=p("button"),S.textContent="Back",q=g(),L=p("button"),L.textContent="Translate",T=g(),U=p("button"),U.textContent="Reset",V=g(),M=p("button"),M.textContent="Switch",j=g(),H=p("p"),H.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',b(i,"for","src"),b(f,"id","src"),b(f,"class","input"),b(w,"for","dst"),b(_,"id","dst"),_.readOnly=!0,_.value=e[3],b(_,"class","input"),b(r,"class","block"),b(S,"class","button"),b(L,"class","button"),b(U,"class","button"),b(M,"class","button"),b(E,"class","is-floating")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),l(r,i),l(i,c),l(r,a),l(r,f),k(f,e[2]),l(r,m),l(r,w),l(w,x),l(r,C),l(r,_),u(t,y,s),u(t,E,s),l(E,S),l(E,q),l(E,L),l(E,T),l(E,U),l(E,V),l(E,M),u(t,j,s),u(t,H,s),O||(R=[$(f,"input",e[8]),$(S,"click",e[9]),$(L,"click",e[10]),$(U,"click",e[11]),$(M,"click",e[12])],O=!0)},p(t,[e]){1&e&&v(c,t[0]),4&e&&k(f,t[2]),2&e&&v(x,t[1]),8&e&&(_.value=t[3])},i:t,o:t,d(t){t&&d(n),t&&d(o),t&&d(r),t&&d(y),t&&d(E),t&&d(j),t&&d(H),O=!1,s(R)}}}function Nn(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",a="";const l=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||st.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,a=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=a),l()},d=()=>{n(2,c=""),n(3,a="")},f=()=>{ot.setView("ViewTopicList",{id:""})};return[o,s,c,a,l,u,d,f,function(){c=this.value,n(2,c)},()=>f(),()=>l(),()=>d(),()=>u()]}class Bn extends tt{constructor(t){super(),Z(this,t,Nn,An,i,{})}}function Gn(t,e,n){const o=t.slice();return o[10]=e[n],o}function Pn(t){let e,n,o,s,r,i,c,a,f,m,w,k,x,C,_,y=t[10].file+"",E=t[10].value+"",S=dt(t[10].lastLoaded)+"";function q(){return t[7](t[10])}return{c(){e=p("tr"),n=p("td"),o=h(y),s=g(),r=p("td"),i=h(E),c=g(),a=p("td"),f=h(S),m=g(),w=p("td"),k=p("button"),k.textContent="Delete",x=g(),b(k,"class","button")},m(t,d){u(t,e,d),l(e,n),l(n,o),l(e,s),l(e,r),l(r,i),l(e,c),l(e,a),l(a,f),l(e,m),l(e,w),l(w,k),l(e,x),C||(_=$(k,"click",q),C=!0)},p(e,n){t=e,1&n&&y!==(y=t[10].file+"")&&v(o,y),1&n&&E!==(E=t[10].value+"")&&v(i,E),1&n&&S!==(S=dt(t[10].lastLoaded)+"")&&v(f,S)},d(t){t&&d(e),C=!1,_()}}}function In(e){let n,o,r,i,c,a,h,m,w,v,k,x,_,y,E,S,q,L=e[0],T=[];for(let t=0;t<L.length;t+=1)T[t]=Pn(Gn(e,L,t));return{c(){n=p("div"),o=p("label"),o.textContent="Tag Filter",r=g(),i=p("select"),c=p("option"),c.textContent="By Name",a=p("option"),a.textContent="By Date",h=g(),m=p("button"),m.textContent="Load All",w=g(),v=p("table"),k=p("tr"),k.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",x=g();for(let t=0;t<T.length;t+=1)T[t].c();_=g(),y=p("div"),E=p("button"),E.textContent="Back",b(o,"for","sort-select"),c.__value="file",c.value=c.__value,a.__value="lastLoaded",a.value=a.__value,b(i,"id","sort-select"),void 0===e[1]&&A((()=>e[6].call(i))),b(m,"class","button"),b(n,"class","is-floating"),b(E,"class","button"),b(y,"class","is-floating")},m(t,s){u(t,n,s),l(n,o),l(n,r),l(n,i),l(i,c),l(i,a),C(i,e[1]),l(n,h),l(n,m),u(t,w,s),u(t,v,s),l(v,k),l(v,x);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(v,null);u(t,_,s),u(t,y,s),l(y,E),S||(q=[$(i,"change",e[6]),$(i,"change",e[2]),$(m,"click",e[5]),$(E,"click",e[8])],S=!0)},p(t,[e]){if(2&e&&C(i,t[1]),9&e){let n;for(L=t[0],n=0;n<L.length;n+=1){const o=Gn(t,L,n);T[n]?T[n].p(o,e):(T[n]=Pn(o),T[n].c(),T[n].m(v,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}},i:t,o:t,d(t){t&&d(n),t&&d(w),t&&d(v),f(T,t),t&&d(_),t&&d(y),S=!1,s(q)}}}function Dn(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),"file"===s?o.sort(((t,e)=>+(e.file>t.file)||-(e.file<t.file))):o.sort(((t,e)=>+(e.lastLoaded>t.lastLoaded)||-(e.lastLoaded<t.lastLoaded))),n(0,o)},i=async()=>{n(0,o=await Mt()),r()},c=async t=>{await jt(t),i()},a=()=>{ot.setView("ViewTopicList",{id:""})};L((()=>{i()}));return[o,s,r,c,a,async()=>{const t=(await ue()).map((t=>t.file));await se(t),i()},function(){s=_(this),n(1,s)},t=>c(t.file),()=>a()]}class Fn extends tt{constructor(t){super(),Z(this,t,Dn,In,i,{})}}function zn(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=h("..."),n=h(o)},m(t,o){u(t,e,o),u(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&v(n,o)},d(t){t&&d(e),t&&d(n)}}}function Jn(e){let n,o,s,r,i,c,a,f,m,$,w,b,k,x,C,_,y,E,S,q,L,T,U,V,M,j,H,O,R,A=e[0].langUrl+"",N=e[0].linkUrl+"",B=(e[0].backupUrl?e[0].backupUrl:"")+"",G=(e[0].file?e[0].file:"")+"",P=e[0].token&&zn(e);return{c(){n=p("table"),o=p("tr"),s=p("td"),s.textContent="Github URL Language",r=g(),i=p("td"),c=h(A),a=g(),f=p("tr"),m=p("td"),m.textContent="Github Link URL",$=g(),w=p("td"),b=h(N),k=g(),x=p("tr"),C=p("td"),C.textContent="Github URL Backup",_=g(),y=p("td"),E=h(B),S=g(),q=p("tr"),L=p("td"),L.textContent="Github File",T=g(),U=p("td"),V=h(G),M=g(),j=p("tr"),H=p("td"),H.textContent="Token",O=g(),R=p("td"),P&&P.c()},m(t,e){u(t,n,e),l(n,o),l(o,s),l(o,r),l(o,i),l(i,c),l(n,a),l(n,f),l(f,m),l(f,$),l(f,w),l(w,b),l(n,k),l(n,x),l(x,C),l(x,_),l(x,y),l(y,E),l(n,S),l(n,q),l(q,L),l(q,T),l(q,U),l(U,V),l(n,M),l(n,j),l(j,H),l(j,O),l(j,R),P&&P.m(R,null)},p(t,[e]){1&e&&A!==(A=t[0].langUrl+"")&&v(c,A),1&e&&N!==(N=t[0].linkUrl+"")&&v(b,N),1&e&&B!==(B=(t[0].backupUrl?t[0].backupUrl:"")+"")&&v(E,B),1&e&&G!==(G=(t[0].file?t[0].file:"")+"")&&v(V,G),t[0].token?P?P.p(t,e):(P=zn(t),P.c(),P.m(R,null)):P&&(P.d(1),P=null)},i:t,o:t,d(t){t&&d(n),P&&P.d()}}}function Wn(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class Qn extends tt{constructor(t){super(),Z(this,t,Wn,Jn,i,{admin:0})}}function Kn(e){let n,o,r,i,c,a,f,m,w,k,C,_,y,E;return{c(){n=p("div"),o=p("div"),r=p("h5"),i=h(e[0]),c=g(),a=p("p"),f=h(e[1]),m=g(),w=p("div"),k=p("button"),k.textContent="OK",C=g(),_=p("button"),_.textContent="Cancel",b(k,"class","button"),b(_,"class","button"),b(w,"class","is-floating"),b(o,"class","popup-content"),b(n,"class","popup"),x(n,"display",e[2]?"block":"none")},m(t,s){u(t,n,s),l(n,o),l(o,r),l(r,i),l(o,c),l(o,a),l(a,f),l(o,m),l(o,w),l(w,k),l(w,C),l(w,_),y||(E=[$(k,"click",e[4]),$(_,"click",e[5])],y=!0)},p(t,[e]){1&e&&v(i,t[0]),2&e&&v(f,t[1]),4&e&&x(n,"display",t[2]?"block":"none")},i:t,o:t,d(t){t&&d(n),y=!1,s(E)}}}function Yn(t,e,n){let{title:o=""}=e,{msg:s=""}=e,{doShow:r=!1}=e;const i=U();return t.$$set=t=>{"title"in t&&n(0,o=t.title),"msg"in t&&n(1,s=t.msg),"doShow"in t&&n(2,r=t.doShow)},[o,s,r,i,()=>i("popup","ok"),()=>i("popup","cancel")]}class Xn extends tt{constructor(t){super(),Z(this,t,Yn,Kn,i,{title:0,msg:1,doShow:2})}}function Zn(t){let e,n;return{c(){e=p("div"),n=h(t[2]),b(e,"class","block is-text-success")},m(t,o){u(t,e,o),l(e,n)},p(t,e){4&e&&v(n,t[2])},d(t){t&&d(e)}}}function to(t){let e,n,o,s;const r=[no,eo],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=m()},m(t,n){i[e].m(t,n),u(t,o,n),s=!0},p(t,s){let a=e;e=c(t),e===a?i[e].p(t,s):(F(),W(i[a],1,1,(()=>{i[a]=null})),z(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),J(n,1),n.m(o.parentNode,o))},i(t){s||(J(n),s=!0)},o(t){W(n),s=!1},d(t){i[e].d(t),t&&d(o)}}}function eo(t){let e,n,o,r,i,c,a,f,h,m,w;n=new Qn({props:{admin:t[0]}});let v=t[0].file&&t[0].backupUrl&&t[0].token&&oo(t);return{c(){e=p("div"),Q(n.$$.fragment),o=g(),r=p("div"),i=p("button"),i.textContent="Back",c=g(),a=p("button"),a.textContent="Update",f=g(),v&&v.c(),b(i,"class","button"),b(a,"class","button"),b(r,"class","is-floating"),b(e,"class","block")},m(s,d){u(s,e,d),K(n,e,null),l(e,o),l(e,r),l(r,i),l(r,c),l(r,a),l(r,f),v&&v.m(r,null),h=!0,m||(w=[$(i,"click",t[8]),$(a,"click",t[17])],m=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?v?v.p(t,e):(v=oo(t),v.c(),v.m(r,null)):v&&(v.d(1),v=null)},i(t){h||(J(n.$$.fragment,t),h=!0)},o(t){W(n.$$.fragment,t),h=!1},d(t){t&&d(e),Y(n),v&&v.d(),m=!1,s(w)}}}function no(e){let n,o,r,i,c,a,f,h,m,v,x,C,_,y,E,S,q,L,T,U,V,M,j,H,O,R,A,N,B,G;return{c(){n=p("form"),o=p("div"),r=p("label"),r.textContent="Github URL Language",i=g(),c=p("input"),a=g(),f=p("label"),f.textContent="Github Link URL",h=g(),m=p("input"),v=g(),x=p("label"),x.textContent="Github URL Backup",C=g(),_=p("input"),y=g(),E=p("label"),E.textContent="Github File",S=g(),q=p("input"),L=g(),T=p("label"),T.textContent="Token",U=g(),V=p("input"),M=g(),j=p("div"),H=p("button"),H.textContent="Save",O=g(),R=p("button"),R.textContent="Cancel",A=g(),N=p("button"),N.textContent="Back",b(r,"for","langUrl"),b(c,"id","langUrl"),b(c,"type","url"),b(c,"class","input"),b(f,"for","linkUrl"),b(m,"id","linkUrl"),b(m,"type","url"),b(m,"class","input"),b(x,"for","backupUrl"),b(_,"id","backupUrl"),b(_,"type","url"),b(_,"class","input"),b(E,"for","file"),b(q,"id","file"),b(q,"type","text"),b(q,"class","input"),b(T,"for","token"),b(V,"id","token"),b(V,"type","password"),b(V,"class","input"),b(o,"class","block"),b(H,"class","button"),b(R,"class","button"),b(N,"class","button"),b(j,"class","is-floating")},m(t,s){u(t,n,s),l(n,o),l(o,r),l(o,i),l(o,c),k(c,e[0].langUrl),l(o,a),l(o,f),l(o,h),l(o,m),k(m,e[0].linkUrl),l(o,v),l(o,x),l(o,C),l(o,_),k(_,e[0].backupUrl),l(o,y),l(o,E),l(o,S),l(o,q),k(q,e[0].file),l(o,L),l(o,T),l(o,U),l(o,V),k(V,e[0].token),l(n,M),l(n,j),l(j,H),l(j,O),l(j,R),l(j,A),l(j,N),B||(G=[$(c,"input",e[11]),$(m,"input",e[12]),$(_,"input",e[13]),$(q,"input",e[14]),$(V,"input",e[15]),$(R,"click",e[16]),$(N,"click",e[8]),$(n,"submit",w(e[7]))],B=!0)},p(t,e){1&e&&c.value!==t[0].langUrl&&k(c,t[0].langUrl),1&e&&m.value!==t[0].linkUrl&&k(m,t[0].linkUrl),1&e&&_.value!==t[0].backupUrl&&k(_,t[0].backupUrl),1&e&&q.value!==t[0].file&&k(q,t[0].file),1&e&&V.value!==t[0].token&&k(V,t[0].token)},i:t,o:t,d(t){t&&d(n),B=!1,s(G)}}}function oo(e){let n,o,r,i,c;return{c(){n=p("button"),n.textContent="Backup",o=g(),r=p("button"),r.textContent="Restore",b(n,"class","button"),b(r,"class","button")},m(t,s){u(t,n,s),u(t,o,s),u(t,r,s),i||(c=[$(n,"click",e[18]),$(r,"click",e[19])],i=!0)},p:t,d(t){t&&d(n),t&&d(o),t&&d(r),i=!1,s(c)}}}function so(t){let e,n,o,s,r,i,c=t[2]&&Zn(t),a=t[0]&&to(t);return r=new Xn({props:{title:t[4],msg:t[5],doShow:t[6]}}),r.$on("popup",t[10]),{c(){e=p("h4"),e.textContent="Configuration",n=g(),c&&c.c(),o=g(),a&&a.c(),s=g(),Q(r.$$.fragment)},m(t,l){u(t,e,l),u(t,n,l),c&&c.m(t,l),u(t,o,l),a&&a.m(t,l),u(t,s,l),K(r,t,l),i=!0},p(t,[e]){t[2]?c?c.p(t,e):(c=Zn(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[0]?a?(a.p(t,e),1&e&&J(a,1)):(a=to(t),a.c(),J(a,1),a.m(s.parentNode,s)):a&&(F(),W(a,1,1,(()=>{a=null})),z());const n={};16&e&&(n.title=t[4]),32&e&&(n.msg=t[5]),64&e&&(n.doShow=t[6]),r.$set(n)},i(t){i||(J(a),J(r.$$.fragment,t),i=!0)},o(t){W(a),W(r.$$.fragment,t),i=!1},d(t){t&&d(e),t&&d(n),c&&c.d(t),t&&d(o),a&&a.d(t),t&&d(s),Y(r,t)}}}function ro(t,e,n){let o=Et.get(),s=!1,r="";const i=async()=>{try{const t=await ee(),e=await Bt(t);e.hasError()?(st.addError(`Unable to write backup - ${e.getMessage()}`),n(2,r="Backup FAILED!")):n(2,r="Backup done!")}catch(t){st.addError(`Error on backup - ${t}`)}},c=async()=>{const t=await Nt();t.hasError()?(st.addError(t.getMessage()),n(2,r="Restore FAILED!")):(ne(t.getValue()),n(2,r="Restore done!"))};var a;let l,u;!function(t){t[t.Backup=0]="Backup",t[t.Restore=1]="Restore"}(a||(a={}));let d,f=!1;const p=t=>{switch(t){case a.Backup:n(4,l="Information"),n(5,u="Do you realy want to create a backup?"),d=i;break;case a.Restore:n(4,l="Warning"),n(5,u="Do you realy want to restore the backup?"),d=c;break;default:console.log("Unkown type",t)}n(6,f=!0)};return[o,s,r,a,l,u,f,async()=>{if(o.langUrl){const t=await Et.put(o);t.hasError()&&st.addError(`Error on save - ${t.getMessage()}`)}n(1,s=!1)},()=>{ot.setView("ViewTopicList",{id:""})},p,t=>{n(6,f=!1),"ok"===t.detail&&d()},function(){o.langUrl=this.value,n(0,o)},function(){o.linkUrl=this.value,n(0,o)},function(){o.backupUrl=this.value,n(0,o)},function(){o.file=this.value,n(0,o)},function(){o.token=this.value,n(0,o)},()=>n(1,s=!1),()=>n(1,s=!0),()=>p(a.Backup),()=>p(a.Restore)]}class io extends tt{constructor(t){super(),Z(this,t,ro,so,i,{})}}function co(t){let e,n;return{c(){e=p("div"),n=h(t[2]),b(e,"class","is-text-danger")},m(t,o){u(t,e,o),l(e,n)},p(t,e){4&e&&v(n,t[2])},d(t){t&&d(e)}}}function ao(t){let e,n,o,s,r,i,c,a;return c=new an({props:{questions:t[1]}}),{c(){e=p("div"),n=h("Total: "),o=h(t[3]),s=h(" found: "),r=h(t[4]),i=g(),Q(c.$$.fragment)},m(t,d){u(t,e,d),l(e,n),l(e,o),l(e,s),l(e,r),u(t,i,d),K(c,t,d),a=!0},p(t,e){(!a||8&e)&&v(o,t[3]),(!a||16&e)&&v(r,t[4]);const n={};2&e&&(n.questions=t[1]),c.$set(n)},i(t){a||(J(c.$$.fragment,t),a=!0)},o(t){W(c.$$.fragment,t),a=!1},d(t){t&&d(e),t&&d(i),Y(c,t)}}}function lo(t){let e,n,o,r,i,c,a,f,h,m,v,x,C,_,y,E,S,q;m=new Se({props:{onClick:t[5]}});let L=t[2]&&co(t),T=0!==t[1].length&&ao(t);return{c(){e=p("h4"),e.textContent="Search",n=g(),o=p("form"),r=p("div"),i=p("label"),i.textContent="Search String",c=g(),a=p("div"),f=p("input"),h=g(),Q(m.$$.fragment),v=g(),L&&L.c(),x=g(),T&&T.c(),C=g(),_=p("div"),y=p("button"),y.textContent="Back",b(i,"for","searchStr"),b(f,"id","searchStr"),b(f,"class","input"),b(a,"class","is-floating"),b(r,"class",""),b(y,"class","button"),b(_,"class","is-floating")},m(s,d){u(s,e,d),u(s,n,d),u(s,o,d),l(o,r),l(r,i),l(r,c),l(r,a),l(a,f),k(f,t[0]),l(a,h),K(m,a,null),l(r,v),L&&L.m(r,null),u(s,x,d),T&&T.m(s,d),u(s,C,d),u(s,_,d),l(_,y),E=!0,S||(q=[$(f,"input",t[7]),$(o,"submit",w(t[5])),$(y,"click",t[6])],S=!0)},p(t,[e]){1&e&&f.value!==t[0]&&k(f,t[0]),t[2]?L?L.p(t,e):(L=co(t),L.c(),L.m(r,null)):L&&(L.d(1),L=null),0!==t[1].length?T?(T.p(t,e),2&e&&J(T,1)):(T=ao(t),T.c(),J(T,1),T.m(C.parentNode,C)):T&&(F(),W(T,1,1,(()=>{T=null})),z())},i(t){E||(J(m.$$.fragment,t),J(T),E=!0)},o(t){W(m.$$.fragment,t),W(T),E=!1},d(t){t&&d(e),t&&d(n),t&&d(o),Y(m),L&&L.d(),t&&d(x),T&&T.d(t),t&&d(C),t&&d(_),S=!1,s(q)}}}const uo=30;function fo(t,e,n){let o="",s=[],r="",i=0,c=0;return[o,s,r,i,c,async()=>{console.log("Searching:",o);const t=o.trim();!t||t.length<3?n(2,r="Please enter search string with at least 3 chars!"):(r&&n(2,r=""),n(1,s=[]),n(1,[s,i,c]=await ce(t,uo),s,n(3,i),n(4,c)),0===s.length?n(2,r="Nothing found!"):s.length<c&&n(2,r=`More than: ${uo} questions found! (Total: ${c})`))},()=>{ot.setView("ViewTopicList",{id:""})},function(){o=this.value,n(0,o)}]}class po extends tt{constructor(t){super(),Z(this,t,fo,lo,i,{})}}function ho(e){let n,o,r,i,c,a,f,m,x,C,_,y,E,S,q,L,T,U,V,M,j,H,O,R,A,N,B,G,P,I,D,F=e[0].id+"";return{c(){n=p("div"),o=p("form"),r=p("div"),i=p("h5"),c=h("Question: "),a=h(F),f=g(),m=p("div"),x=p("textarea"),C=g(),_=p("div"),y=p("p"),E=g(),S=p("h5"),S.textContent="Answer",q=g(),L=p("div"),T=p("textarea"),U=g(),V=p("div"),M=p("p"),j=g(),H=p("h5"),H.textContent="Comment",O=g(),R=p("input"),A=g(),N=p("div"),B=p("button"),B.textContent="Cancel",G=g(),P=p("button"),P.textContent="Save",b(x,"rows","10"),b(x,"id","quest"),b(x,"class","input"),b(_,"class","card content is-primary"),b(m,"class","grid grid-2"),b(T,"rows","10"),b(T,"id","answer"),b(T,"class","input"),b(V,"class","card content is-primary"),b(L,"class","grid grid-2"),b(R,"type","input"),b(R,"class","input"),b(r,"class","block"),b(B,"class","button"),b(P,"class","button"),b(N,"class","is-floating"),b(n,"class","card card-shadow content")},m(t,s){u(t,n,s),l(n,o),l(o,r),l(r,i),l(i,c),l(i,a),l(r,f),l(r,m),l(m,x),k(x,e[1]),l(m,C),l(m,_),l(_,y),y.innerHTML=e[3],l(r,E),l(r,S),l(r,q),l(r,L),l(L,T),k(T,e[2]),l(L,U),l(L,V),l(V,M),M.innerHTML=e[4],l(r,j),l(r,H),l(r,O),l(r,R),k(R,e[5]),l(o,A),l(o,N),l(N,B),l(N,G),l(N,P),I||(D=[$(x,"input",e[8]),$(T,"input",e[9]),$(R,"input",e[10]),$(B,"click",e[7]),$(o,"submit",w(e[6]))],I=!0)},p(t,[e]){1&e&&F!==(F=t[0].id+"")&&v(a,F),2&e&&k(x,t[1]),8&e&&(y.innerHTML=t[3]),4&e&&k(T,t[2]),16&e&&(M.innerHTML=t[4]),32&e&&k(R,t[5])},i:t,o:t,d(t){t&&d(n),I=!1,s(D)}}}function go(t,e,n){const o=new Ft;let{question:s}=e,r="",i="",c=xt(s.quest),a=xt(s.answer),l=`Update question: '${s.id}' in: '${s.file}'`;return t.$$set=t=>{"question"in t&&n(0,s=t.question)},t.$$.update=()=>{2&t.$$.dirty&&n(3,r=o.toHtml(kt(c))),4&t.$$.dirty&&n(4,i=o.toHtml(kt(a)))},[s,c,a,r,i,l,async()=>{const t=await Pt(s.file);if(t.hasError())return void st.addError(t.getMessage());const e=t.getValue();for(let t=0;t<e.json.length;t++){const n=e.json[t];if(n.id===s.id){n.quest=kt(c),n.answer=kt(a);break}}const n=await Gt(s.file,e.json,e.hash,l);if(n.hasError())return void st.addError(n.getMessage());await oe(s.file);const o=await le(s.file);ot.setView("ViewTopicQuests",{topic:o})},()=>{ot.setView("ViewTopicList",{id:""})},function(){c=this.value,n(1,c)},function(){a=this.value,n(2,a)},function(){l=this.value,n(5,l)}]}class mo extends tt{constructor(t){super(),Z(this,t,go,ho,i,{question:0})}}function $o(t){let e,n;return e=new Ut({}),{c(){Q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function wo(t){let n,o,s,r,i,c,a,f,h,m=0!==t[0].length&&$o();const $=[t[1].props];var w=t[1].component;function v(t){let n={};for(let t=0;t<$.length;t+=1)n=e(n,$[t]);return{props:n}}return w&&(c=y(w,v())),{c(){n=p("div"),o=p("h2"),o.textContent="Cards",s=g(),m&&m.c(),r=g(),i=p("div"),c&&Q(c.$$.fragment),a=g(),f=p("div"),f.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',b(i,"id","main"),b(i,"class","block"),b(f,"class","block"),b(n,"class","container")},m(t,e){u(t,n,e),l(n,o),l(n,s),m&&m.m(n,null),l(n,r),l(n,i),c&&K(c,i,null),l(n,a),l(n,f),h=!0},p(t,[e]){0!==t[0].length?m?1&e&&J(m,1):(m=$o(),m.c(),J(m,1),m.m(n,r)):m&&(F(),W(m,1,1,(()=>{m=null})),z());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}($,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(2&e&&w!==(w=t[1].component)){if(c){F();const t=c;W(t.$$.fragment,1,0,(()=>{Y(t,1)})),z()}w?(c=y(w,v()),Q(c.$$.fragment),J(c.$$.fragment,1),K(c,i,null)):c=null}else w&&c.$set(o)},i(t){h||(J(m),c&&J(c.$$.fragment,t),h=!0)},o(t){W(m),c&&W(c.$$.fragment,t),h=!1},d(t){t&&d(n),m&&m.d(),c&&Y(c)}}}function bo(t,e,n){let o,s;return a(t,st,(t=>n(0,o=t))),a(t,ot,(t=>n(1,s=t))),L((async()=>{ot.views={ViewTopicList:{component:Fe},ViewTopicInfo:{component:Qe},ViewTopicQuests:{component:fn},ViewTagInfo:{component:kn},ViewTagQuests:{component:_n},ViewQuestAnswer:{component:Rn},ViewTranslate:{component:Bn},ViewHashes:{component:Fn},ViewAdmin:{component:io},ViewSearch:{component:po},ViewQuestEdit:{component:mo}},await Et.init(),await ge(),ot.setView("ViewTopicList",{id:""})})),[o,s]}return new class extends tt{constructor(t){super(),Z(this,t,bo,wo,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

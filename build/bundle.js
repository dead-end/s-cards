var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(t){let e;return c(t,(t=>e=t))(),e}function a(t,e,n){t.$$.on_destroy.push(c(e,n))}function u(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function b(){return g("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function _(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function k(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let C;function y(t){C=t}function S(){if(!C)throw new Error("Function called outside component initialization");return C}function q(t){S().$$.on_mount.push(t)}const T=[],L=[],E=[],V=[],j=Promise.resolve();let U=!1;function A(t){E.push(t)}const H=new Set;let P=0;function M(){const t=C;do{for(;P<T.length;){const t=T[P];P++,y(t),N(t.$$)}for(y(null),T.length=0,P=0;L.length;)L.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];H.has(e)||(H.add(e),e())}E.length=0}while(T.length);for(;V.length;)V.pop()();U=!1,H.clear(),y(t)}function N(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const B=new Set;let I;function O(){I={r:0,c:[],p:I}}function G(){I.r||s(I.c),I=I.p}function R(t,e){t&&t.i&&(B.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(B.has(t))return;B.add(t),I.c.push((()=>{B.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function z(t){t&&t.c()}function F(t,e,o,i){const{fragment:c,on_mount:l,on_destroy:a,after_update:u}=t.$$;c&&c.m(e,o),i||A((()=>{const e=l.map(n).filter(r);a?a.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(A)}function Q(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function J(t,e){-1===t.$$.dirty[0]&&(T.push(t),U||(U=!0,j.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function W(e,n,r,i,c,l,a,u=[-1]){const d=C;y(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(p.root);let h=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),h&&J(e,t)),n})):[],p.update(),h=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();n.intro&&R(e.$$.fragment),F(e,n.target,n.anchor,n.customElement),M()}y(d)}class K{$destroy(){Q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Y=[];function X(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!Y.length;for(const t of s)t[1](),Y.push(t,e);if(t){for(let t=0;t<Y.length;t+=2)Y[t][0](Y[t+1]);Y.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return s.add(l),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(l),0===s.size&&(o(),o=null)}}}}const Z=(()=>{const{subscribe:t,set:e,update:n}=X({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=Z.views[t];o.props=n,e(o)}}})(),tt=(()=>{const{subscribe:t,set:e,update:n}=X([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})();let et;const nt=t=>{tt.addError(t.type)},ot=()=>new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{et=n.result,t.oldVersion<4&&(t=>{if(et.objectStoreNames.contains("topics")||et.createObjectStore("topics",{keyPath:"file"}),!et.objectStoreNames.contains("questions")){const t=et.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});t.indexNames.contains("file")||t.createIndex("file","file",{unique:!1})}et.objectStoreNames.contains("hash")||(et.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")});et.objectStoreNames.contains("admin")||et.createObjectStore("admin",{keyPath:"config"}),et.objectStoreNames.contains("config")&&et.deleteObjectStore("config")})()},n.onerror=nt,n.onsuccess=e=>{et=n.result,et.onerror=nt,console.log("db init success!"),t()}})),st=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=o=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{tt.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),rt=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=o=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{tt.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),it=t=>new Promise(((e,n)=>{const o=et.transaction(["hash"],"readonly").objectStore("hash"),s=o.get(t);s.onsuccess=n=>{const r=s.result?s.result:{file:t};console.log("Store:",o.name,"get:",r),e(r)},s.onerror=e=>{console.log("Store:",o.name,"get:",t,"error",e),n()}})),ct=(t,e)=>{const n=t.objectStore("hash");return st(n,e)},lt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},at=(t,e)=>{const n=new Map;return t.forEach((t=>{t.hasOwnProperty(e)||tt.throwError(`Object has no property: ${e}`);const o=t[e];n.has(o)&&tt.throwError(`Duplicate key: ${e}`),n.set(o,t)})),n},ut=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},dt=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},ft=t=>{for(let o=0;o<t.length;o++){let s=(e=0,n=t.length-1,Math.floor(Math.random()*(n-e+1)+e));if(o===s)continue;let r=t[o];t[o]=t[s],t[s]=r}var e,n},pt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=t=>{c.result.forEach((t=>{st(i,t)})),s()}})))(t,"questions","file",e),ht=t=>{const e=et.transaction(["questions"],"readonly").objectStore("questions");return gt(e,t)},gt=(t,e)=>new Promise(((n,o)=>{const s=t.index("file").getAll(e.file);s.onsuccess=t=>{n(s.result)}})),mt=async(t,e)=>{const n=et.transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,new Promise(((e,o)=>{n.put(t).onsuccess=t=>{e()}})))));await Promise.all(o)},bt=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=t=>{const r=at(n,"id"),i=at(s.result,"id");i.forEach((t=>{r.has(t.id)||st(o,t.id)})),r.forEach((t=>{i.has(t.id)?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(i.get(t.id),t),rt(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=o=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{tt.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},$t=t=>{const e=et.transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];((t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=t=>{n(s.result)},s.onerror=e=>{console.log("Store:",t.name,"questGet:",e),o()}})))(e,n).then((t=>{t&&t.total<s&&(t.failed=o,t.total=s,t.ratio=dt(o,s),rt(e,t))}))}))},vt=(t,e)=>{const n=t.objectStore("topics");st(n,e)},wt=t=>{const e=et.transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=s=>{const r=at(o.result,"file"),i=t.map((t=>t.file));for(let t of r.keys())i.includes(t)||(vt(e,t),ct(e,t),pt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!ut(t.tags,e.tags)||!ut(t.details,e.details)))(t,r.get(t.file))&&rt(n,t)}))}},xt=(()=>{const{subscribe:t,set:e,update:n}=X();return{subscribe:t,setAdmin:t=>{(t=>{const e=et.transaction(["admin"],"readwrite").objectStore("admin");rt(e,t)})(t),e(t)},initAdmin:async()=>new Promise(((t,e)=>{const n=et.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=e=>{let o=n.result;o||(o={config:"admin",langUrl:"https://api.github.com/repos/dead-end/cards-russian/contents/",backupUrl:"",file:"",token:""}),t(o)}})).then((t=>e(t)))}})(),_t=t=>{try{return JSON.parse((e=t,decodeURIComponent(escape(window.atob(e)))))}catch(t){tt.addError(`githubParseContent - unable to parse json content: ${t}`)}var e},kt=t=>{const e={Accept:"application/vnd.github.v3+json"};return t&&t.token&&(e.authorization=`token ${t.token}`),e},Ct=()=>{const t=l(xt);return{backupUrl:t.backupUrl+t.file+".json",headers:kt(t)}},yt=async(t,e)=>{const n=await fetch(t,{method:"HEAD",headers:e}).catch((e=>{tt.addError(`githubGetEtag - url: ${t} error: ${e}`)}));if(!n||404===n.status)return;if(!n.ok)return void tt.addError(`githubGetEtag - url: ${t} error: ${n.statusText}`);const o=n.headers.get("ETag");if(!o)return;const s=o.startsWith("W/")?3:1;return o.substring(s,o.length-1)},St=async(t,e)=>{const n=await fetch(t,e).catch((e=>{tt.addError(`githubGetJsonContent - url: ${t} error: ${e}`)}));if(n){if(n.ok)return n.json();tt.addError(`githubGetJsonContent - url: ${t} error: ${n.statusText}`)}},qt=async t=>{const{fileUrl:e,headers:n}=(t=>{const e=l(xt);return{fileUrl:e.langUrl+t,headers:kt(e)}})(t);let o=await it(t);if(o.value){const t=await(async(t,e,n)=>{const o=await yt(t,e);if(!o)return!1;const s=o===n;return console.log("url :",t,"ETag",o,"hash",n,"matches",s),s})(e,n,o.value);if(t)return}const s=await St(e,n);if(!s)return;const r=_t(s.content);return r?(o.value=s.sha,o.lastLoaded=new Date,await(t=>new Promise(((e,n)=>{const o=et.transaction(["hash"],"readwrite").objectStore("hash"),s=o.put(t);s.onsuccess=n=>{console.log("Store:",o.name,"put:",t),e()},s.onerror=e=>{console.log("Store:",o.name,"put:",t,"error",e),n()}})))(o),console.log("githubGetJson",r),r):void 0},Tt=async t=>{const e=await qt(t);if(e){const n=et.transaction(["questions"],"readwrite");bt(n,t,e)}};function Lt(t,e,n){const o=t.slice();return o[2]=e[n],o}function Et(t){let e,n,o=t[2]+"";return{c(){e=h("li"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&w(n,o)},d(t){t&&f(e)}}}function Vt(e){let n,o,s,r,i,c,l,a,g,b=e[0],w=[];for(let t=0;t<b.length;t+=1)w[t]=Et(Lt(e,b,t));return{c(){n=h("div"),o=h("h4"),o.textContent="Errors",s=m(),r=h("ul");for(let t=0;t<w.length;t+=1)w[t].c();i=m(),c=h("div"),l=h("button"),l.textContent="Ok",v(o,"class","is-text-danger"),v(l,"class","button"),v(c,"class","is-floating"),v(n,"class","card card-shadow block content")},m(t,f){d(t,n,f),u(n,o),u(n,s),u(n,r);for(let t=0;t<w.length;t+=1)w[t].m(r,null);u(n,i),u(n,c),u(c,l),a||(g=$(l,"click",e[1]),a=!0)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const o=Lt(t,b,n);w[n]?w[n].p(o,e):(w[n]=Et(o),w[n].c(),w[n].m(r,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=b.length}},i:t,o:t,d(t){t&&f(n),p(w,t),a=!1,g()}}}function jt(t,e,n){let o;a(t,tt,(t=>n(0,o=t)));return[o,()=>{tt.resetErrors()}]}class Ut extends K{constructor(t){super(),W(this,t,jt,Vt,i,{})}}function At(t){let e,n,o,s,r,i,c,l,a,p,$,v,x,_,k=t[4]&&Ht(t);return{c(){e=h("tr"),n=h("td"),n.textContent="Questions",o=m(),s=h("td"),r=g(t[2]),i=m(),c=h("tr"),l=h("td"),l.textContent="Status",a=m(),p=h("td"),$=g(t[1]),v=g("%"),x=m(),k&&k.c(),_=b()},m(t,f){d(t,e,f),u(e,n),u(e,o),u(e,s),u(s,r),d(t,i,f),d(t,c,f),u(c,l),u(c,a),u(c,p),u(p,$),u(p,v),d(t,x,f),k&&k.m(t,f),d(t,_,f)},p(t,e){4&e&&w(r,t[2]),2&e&&w($,t[1]),t[4]?k?k.p(t,e):(k=Ht(t),k.c(),k.m(_.parentNode,_)):k&&(k.d(1),k=null)},d(t){t&&f(e),t&&f(i),t&&f(c),t&&f(x),k&&k.d(t),t&&f(_)}}}function Ht(t){let e,n,o,s,r,i,c,l,a,p,b,$=lt(t[4].lastLoaded)+"",v=(t[4].value?t[4].value:"")+"";return{c(){e=h("tr"),n=h("td"),n.textContent="Last loaded",o=m(),s=h("td"),r=g($),i=m(),c=h("tr"),l=h("td"),l.textContent="Hash",a=m(),p=h("td"),b=g(v)},m(t,f){d(t,e,f),u(e,n),u(e,o),u(e,s),u(s,r),d(t,i,f),d(t,c,f),u(c,l),u(c,a),u(c,p),u(p,b)},p(t,e){16&e&&$!==($=lt(t[4].lastLoaded)+"")&&w(r,$),16&e&&v!==(v=(t[4].value?t[4].value:"")+"")&&w(b,v)},d(t){t&&f(e),t&&f(i),t&&f(c)}}}function Pt(t){let e,n,o=t[0].desc+"";return{c(){e=h("p"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&w(n,o)},d(t){t&&f(e)}}}function Mt(e){let n,o,s,r,i,c,l,a,p,$,v,x,_,k,C,y,S,q,T=e[0].title+"",L=lt(e[0].lastLearned)+"",E=e[0].tags.join(", ")+"",V=e[3]&&At(e),j=e[0].desc&&Pt(e);return{c(){n=h("h4"),o=g(T),s=m(),r=h("table"),i=h("tr"),c=h("td"),c.textContent="Last learned",l=m(),a=h("td"),p=g(L),$=m(),v=h("tr"),x=h("td"),x.textContent="Tags",_=m(),k=h("td"),C=g(E),y=m(),V&&V.c(),S=m(),j&&j.c(),q=b()},m(t,e){d(t,n,e),u(n,o),d(t,s,e),d(t,r,e),u(r,i),u(i,c),u(i,l),u(i,a),u(a,p),u(r,$),u(r,v),u(v,x),u(v,_),u(v,k),u(k,C),u(r,y),V&&V.m(r,null),d(t,S,e),j&&j.m(t,e),d(t,q,e)},p(t,[e]){1&e&&T!==(T=t[0].title+"")&&w(o,T),1&e&&L!==(L=lt(t[0].lastLearned)+"")&&w(p,L),1&e&&E!==(E=t[0].tags.join(", ")+"")&&w(C,E),t[3]?V?V.p(t,e):(V=At(t),V.c(),V.m(r,null)):V&&(V.d(1),V=null),t[0].desc?j?j.p(t,e):(j=Pt(t),j.c(),j.m(q.parentNode,q)):j&&(j.d(1),j=null)},i:t,o:t,d(t){t&&f(n),t&&f(s),t&&f(r),V&&V.d(),t&&f(S),j&&j.d(t),t&&f(q)}}}function Nt(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return q((async()=>{c&&n(4,o=await it(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class Bt extends K{constructor(t){super(),W(this,t,Nt,Mt,i,{topic:0,status:1,size:2,details:3})}}function It(t){let e,n,o,s,r,i,c,l,a;return n=new Bt({props:{topic:t[0],details:!1}}),{c(){e=h("div"),z(n.$$.fragment),o=m(),s=h("div"),r=h("button"),r.textContent="Show",v(r,"class","button"),v(s,"class","is-floating"),v(e,"class","card card-shadow content"),v(e,"id",i=t[0].file)},m(i,f){d(i,e,f),F(n,e,null),u(e,o),u(e,s),u(s,r),c=!0,l||(a=$(r,"click",t[2]),l=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&v(e,"id",i)},i(t){c||(R(n.$$.fragment,t),c=!0)},o(t){D(n.$$.fragment,t),c=!1},d(t){t&&f(e),Q(n),l=!1,a()}}}function Ot(t,e,n){let{topic:o}=e;const s=t=>{Z.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Gt extends K{constructor(t){super(),W(this,t,Ot,It,i,{topic:0})}}function Rt(t,e,n){const o=t.slice();return o[13]=e[n],o}function Dt(t,e,n){const o=t.slice();return o[16]=e[n],o}function zt(t){let e,n,o,r,i,c,l,a,g,b,w,x,k,C,y,S,q,T,L,E,V=t[1],j=[];for(let e=0;e<V.length;e+=1)j[e]=Ft(Dt(t,V,e));let U=t[2]&&Qt(t);return{c(){e=h("div"),n=h("label"),n.textContent="Sort",o=m(),r=h("select"),i=h("option"),i.textContent="-- Select --",c=h("option"),c.textContent="Last learned",l=m(),a=h("label"),a.textContent="Tag Filter",g=m(),b=h("select"),w=h("option"),w.textContent="-- Select --";for(let t=0;t<j.length;t+=1)j[t].c();x=m(),U&&U.c(),k=m(),C=h("button"),C.textContent="Translate",y=m(),S=h("button"),S.textContent="Hashes",q=m(),T=h("button"),T.textContent="Admin",v(n,"class","is-valign-center"),v(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,v(r,"id","sort-select"),void 0===t[3]&&A((()=>t[6].call(r))),v(a,"for","tag-select"),w.__value="",w.value=w.__value,v(b,"id","tag-select"),void 0===t[2]&&A((()=>t[7].call(b))),v(C,"class","button"),v(S,"class","button"),v(T,"class","button"),v(e,"class","is-floating")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),_(r,t[3]),u(e,l),u(e,a),u(e,g),u(e,b),u(b,w);for(let t=0;t<j.length;t+=1)j[t].m(b,null);_(b,t[2]),u(e,x),U&&U.m(e,null),u(e,k),u(e,C),u(e,y),u(e,S),u(e,q),u(e,T),L||(E=[$(r,"change",t[6]),$(r,"change",t[4]),$(b,"change",t[7]),$(b,"change",t[4]),$(C,"click",t[9]),$(S,"click",t[10]),$(T,"click",t[11])],L=!0)},p(t,n){if(8&n&&_(r,t[3]),2&n){let e;for(V=t[1],e=0;e<V.length;e+=1){const o=Dt(t,V,e);j[e]?j[e].p(o,n):(j[e]=Ft(o),j[e].c(),j[e].m(b,null))}for(;e<j.length;e+=1)j[e].d(1);j.length=V.length}6&n&&_(b,t[2]),t[2]?U?U.p(t,n):(U=Qt(t),U.c(),U.m(e,k)):U&&(U.d(1),U=null)},d(t){t&&f(e),p(j,t),U&&U.d(),L=!1,s(E)}}}function Ft(t){let e,n,o,s=t[16]+"";return{c(){e=h("option"),n=g(s),e.__value=o=t[16],e.value=e.__value},m(t,o){d(t,e,o),u(e,n)},p(t,r){2&r&&s!==(s=t[16]+"")&&w(n,s),2&r&&o!==(o=t[16])&&(e.__value=o,e.value=e.__value)},d(t){t&&f(e)}}}function Qt(e){let n,o,s;return{c(){n=h("button"),n.textContent="Show",v(n,"class","button")},m(t,r){d(t,n,r),o||(s=$(n,"click",e[8]),o=!0)},p:t,d(t){t&&f(n),o=!1,s()}}}function Jt(t){let e,n;return e=new Gt({props:{topic:t[13]}}),{c(){z(e.$$.fragment)},m(t,o){F(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[13]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Wt(t){let e,n,o,s=t[1]&&zt(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Jt(Rt(t,r,e));const c=t=>D(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=m(),n=h("div");for(let t=0;t<i.length;t+=1)i[t].c();v(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),d(t,e,r),d(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?s.p(t,o):(s=zt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Rt(t,r,e);i[e]?(i[e].p(s,o),R(i[e],1)):(i[e]=Jt(s),i[e].c(),R(i[e],1),i[e].m(n,null))}for(O(),e=r.length;e<i.length;e+=1)c(e);G()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)R(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)D(i[t]);o=!1},d(t){s&&s.d(t),t&&f(e),t&&f(n),p(i,t)}}}function Kt(t,e,n){let o,s,r,{id:i=null}=e,c=[],l=[];var a;q((()=>{new Promise(((t,e)=>{const n=et.transaction(["topics"],"readonly").objectStore("topics"),o=n.getAll();o.onsuccess=e=>{console.log("Store:",n.name,"topicGetAll:"),t(o.result)},o.onerror=t=>{console.log("Store:",n.name,"topicGetAll error:",t),e()}})).then((t=>{c=t,n(0,l=t),n(1,o=(t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()})(c))}))})),a=()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}},S().$$.after_update.push(a);return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[l,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):c,console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,l=t)},i,function(){r=k(this),n(3,r)},function(){s=k(this),n(2,s),n(1,o)},()=>Z.setView("ViewTagInfo",{tag:s,topics:l}),()=>Z.setView("ViewTranslate"),()=>Z.setView("ViewHashes"),()=>Z.setView("ViewAdmin")]}class Yt extends K{constructor(t){super(),W(this,t,Kt,Wt,i,{id:5})}}class Xt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&tt.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class Zt{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new Xt(t,e)}_pattern(){let t="";for(let e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return this.map.hasOwnProperty(t)||tt.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(let e in this.map)this.map[e].check(t)}_substitute(t){const e=this;return t.replaceAll(this.regex,(function(t){return e.tag(t)}))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(let o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}}function te(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=h("div"),n=h("h5"),n.textContent="Details",o=m(),s=h("div"),r=h("p"),v(s,"class","card content is-info"),v(e,"class","block")},m(t,c){d(t,e,c),u(e,n),u(e,o),u(e,s),u(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&f(e)}}}function ee(t){let e,n,o,r,i,c,l,a,p,b,w,x,_,k,C,y,S,q,T,L,E,V,j,U,A,H;r=new Bt({props:{topic:t[0],status:t[1],size:t[3]}});let P=t[0].details&&te(t);return{c(){e=h("div"),n=h("div"),o=h("div"),z(r.$$.fragment),i=m(),c=h("div"),l=h("label"),l.textContent="Number of correct answers",a=m(),p=h("select"),b=h("option"),b.textContent="-- Select --",w=h("option"),w.textContent="Set 0",x=h("option"),x.textContent="Set 1",_=h("option"),_.textContent="Set 2",k=h("option"),k.textContent="Set 3",C=m(),P&&P.c(),y=m(),S=h("div"),q=h("button"),q.textContent="Back",T=m(),L=h("button"),L.textContent="Listing",E=m(),V=h("button"),j=g("Start"),v(o,"class","is-text-left"),v(l,"for","sf-set"),b.__value="",b.value=b.__value,w.__value="0",w.value=w.__value,x.__value="1",x.value=x.__value,_.__value="2",_.value=_.__value,k.__value="3",k.value=k.__value,v(p,"id","sf-set"),v(c,"class","is-floating"),v(q,"class","button"),v(L,"class","button"),v(V,"class","button"),V.disabled=t[2],v(S,"class","is-floating"),v(e,"class","card card-shadow content")},m(s,f){d(s,e,f),u(e,n),u(n,o),F(r,o,null),u(n,i),u(n,c),u(c,l),u(c,a),u(c,p),u(p,b),u(p,w),u(p,x),u(p,_),u(p,k),u(n,C),P&&P.m(n,null),u(e,y),u(e,S),u(S,q),u(S,T),u(S,L),u(S,E),u(S,V),u(V,j),U=!0,A||(H=[$(p,"change",t[8]),$(q,"click",t[5]),$(L,"click",t[6]),$(V,"click",t[7])],A=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?P?P.p(t,e):(P=te(t),P.c(),P.m(n,null)):P&&(P.d(1),P=null),(!U||4&e)&&(V.disabled=t[2])},i(t){U||(R(r.$$.fragment,t),U=!0)},o(t){D(r.$$.fragment,t),U=!1},d(t){t&&f(e),Q(r),P&&P.d(),A=!1,s(H)}}}function ne(t,e,n){let{topic:o}=e,{questions:s=null}=e;const r=new Zt;let i=0,c=!0,l=0;const a=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=((t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return dt(n,t.length*e)})(t,3)),n(2,c=((t,e)=>{for(let n in t)if(t[n]!==e)return!1;return!0})(t,3)),n(3,l=t.length)};q((async()=>{try{s||(await Tt(o.file),console.log("Loading questions for topics"),n(9,s=await ht(o)),a())}catch(t){tt.addError("ViewTopicInfo: "+t.message)}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,l,r,()=>{Z.setView("ViewTopicList",{id:o.file})},()=>{Z.setView("ViewTopicQuests",{topic:o})},()=>{Z.setView("ViewQuestAnswer",{topics:[o],questions:s})},t=>{if(!s)return;const e=t.target;mt(s,e.selectedIndex-1),e.selectedIndex=0,a()},s]}class oe extends K{constructor(t){super(),W(this,t,ne,ee,i,{topic:0,questions:9})}}function se(e){let n,o,s,r,i,c,l,a,p,b,$,x,_,k,C,y=e[0].progress+"",S=e[0].total+"",q=e[0].ratio+"";return{c(){n=h("div"),o=g("Progress: "),s=h("span"),r=g(y),i=g(" /\n  "),c=h("span"),c.textContent="3",l=m(),a=h("span"),p=g("Total: "),b=h("span"),$=g(S),x=g(" Wrong:\n    "),_=h("span"),k=g(q),C=g("%"),v(s,"class","is-text-success"),v(c,"class","is-text-success"),v(b,"class","is-text-success"),v(_,"class","is-text-danger"),v(a,"class","hide-sm"),v(n,"class","h6")},m(t,e){d(t,n,e),u(n,o),u(n,s),u(s,r),u(n,i),u(n,c),u(n,l),u(n,a),u(a,p),u(a,b),u(b,$),u(a,x),u(a,_),u(_,k),u(_,C)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&w(r,y),1&e&&S!==(S=t[0].total+"")&&w($,S),1&e&&q!==(q=t[0].ratio+"")&&w(k,q)},i:t,o:t,d(t){t&&f(n)}}}function re(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class ie extends K{constructor(t){super(),W(this,t,re,se,i,{question:0})}}function ce(t,e,n){const o=t.slice();return o[9]=e[n],o}function le(t){let e,n,o,s,r,i="2"===t[0]&&ae(t);return s=new ie({props:{question:t[9]}}),{c(){e=h("div"),n=h("div"),i&&i.c(),o=m(),z(s.$$.fragment),v(e,"class","is-flex-spread grid-full")},m(t,c){d(t,e,c),u(e,n),i&&i.m(n,null),u(e,o),F(s,e,null),r=!0},p(t,e){"2"===t[0]?i?i.p(t,e):(i=ae(t),i.c(),i.m(n,null)):i&&(i.d(1),i=null);const o={};2&e&&(o.question=t[9]),s.$set(o)},i(t){r||(R(s.$$.fragment,t),r=!0)},o(t){D(s.$$.fragment,t),r=!1},d(t){t&&f(e),i&&i.d(),Q(s)}}}function ae(t){let e,n,o,s,r,i,c=t[9].id+"",l=t[9].file+"";return{c(){e=h("span"),n=g("Id: "),o=g(c),s=m(),r=h("span"),i=g(l),v(e,"class","h6"),v(r,"class","hide-sm")},m(t,c){d(t,e,c),u(e,n),u(e,o),d(t,s,c),d(t,r,c),u(r,i)},p(t,e){2&e&&c!==(c=t[9].id+"")&&w(o,c),2&e&&l!==(l=t[9].file+"")&&w(i,l)},d(t){t&&f(e),t&&f(s),t&&f(r)}}}function ue(t){let e,n,o,s,r,i,c,l,a,p,g,b,$=t[3].toHtml(t[9].quest)+"",w=t[3].toHtml(t[9].answer)+"",x=("1"===t[0]||"2"===t[0])&&le(t);return{c(){x&&x.c(),e=m(),n=h("div"),o=h("div"),s=h("p"),i=m(),c=h("div"),l=h("div"),a=h("p"),p=m(),v(o,"class","content"),v(n,"class",r="card "+t[5]()),v(l,"class","content"),v(c,"class",g="card "+t[5]())},m(t,r){x&&x.m(t,r),d(t,e,r),d(t,n,r),u(n,o),u(o,s),s.innerHTML=$,d(t,i,r),d(t,c,r),u(c,l),u(l,a),a.innerHTML=w,u(c,p),b=!0},p(t,n){"1"===t[0]||"2"===t[0]?x?(x.p(t,n),1&n&&R(x,1)):(x=le(t),x.c(),R(x,1),x.m(e.parentNode,e)):x&&(O(),D(x,1,1,(()=>{x=null})),G()),(!b||2&n)&&$!==($=t[3].toHtml(t[9].quest)+"")&&(s.innerHTML=$),(!b||2&n)&&w!==(w=t[3].toHtml(t[9].answer)+"")&&(a.innerHTML=w)},i(t){b||(R(x),b=!0)},o(t){D(x),b=!1},d(t){x&&x.d(t),t&&f(e),t&&f(n),t&&f(i),t&&f(c)}}}function de(t){let e,n,o,r,i,c,l,a,g,b,w,x,k,C,y,S,q,T,L,E=t[1],V=[];for(let e=0;e<E.length;e+=1)V[e]=ue(ce(t,E,e));const j=t=>D(V[t],1,1,(()=>{V[t]=null}));return{c(){e=h("div"),n=h("label"),n.textContent="Details",o=m(),r=h("select"),i=h("option"),i.textContent="Simple",c=h("option"),c.textContent="Progress",l=h("option"),l.textContent="ID's",a=m(),g=h("label"),g.textContent="Tag Filter",b=m(),w=h("select"),x=h("option"),x.textContent="-- Select --",k=h("option"),k.textContent="Total",C=h("option"),C.textContent="Ratio",y=m(),S=h("div");for(let t=0;t<V.length;t+=1)V[t].c();v(n,"for","details-select"),i.__value="0",i.value=i.__value,c.__value="1",c.value=c.__value,l.__value="2",l.value=l.__value,v(r,"id","details-select"),void 0===t[0]&&A((()=>t[7].call(r))),v(g,"for","quest-sort"),x.__value="",x.value=x.__value,k.__value="total",k.value=k.__value,C.__value="ratio",C.value=C.__value,v(w,"id","quest-sort"),void 0===t[2]&&A((()=>t[8].call(w))),v(e,"class","is-floating"),v(S,"class","grid grid-2")},m(s,f){d(s,e,f),u(e,n),u(e,o),u(e,r),u(r,i),u(r,c),u(r,l),_(r,t[0]),u(e,a),u(e,g),u(e,b),u(e,w),u(w,x),u(w,k),u(w,C),_(w,t[2]),d(s,y,f),d(s,S,f);for(let t=0;t<V.length;t+=1)V[t].m(S,null);q=!0,T||(L=[$(r,"change",t[7]),$(w,"change",t[8]),$(w,"change",t[4])],T=!0)},p(t,[e]){if(1&e&&_(r,t[0]),4&e&&_(w,t[2]),43&e){let n;for(E=t[1],n=0;n<E.length;n+=1){const o=ce(t,E,n);V[n]?(V[n].p(o,e),R(V[n],1)):(V[n]=ue(o),V[n].c(),R(V[n],1),V[n].m(S,null))}for(O(),n=E.length;n<V.length;n+=1)j(n);G()}},i(t){if(!q){for(let t=0;t<E.length;t+=1)R(V[t]);q=!0}},o(t){V=V.filter(Boolean);for(let t=0;t<V.length;t+=1)D(V[t]);q=!1},d(t){t&&f(e),t&&f(y),t&&f(S),p(V,t),T=!1,s(L)}}}function fe(t,e,n){let{questions:o}=e,s="0",r=[],i="";const c=new Zt;q((()=>{console.log("questions",o),n(1,r=o)}));const l=((t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n})(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(6,o=t.questions)},[s,r,i,c,()=>{if(!i)return void n(1,r=o);let t=[...o];"ratio"===i?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===i&&t.sort(((t,e)=>e.total-t.total)),n(1,r=t)},l,o,function(){s=k(this),n(0,s)},function(){i=k(this),n(2,i)}]}class pe extends K{constructor(t){super(),W(this,t,fe,de,i,{questions:6})}}function he(t){let e,n;return e=new pe({props:{questions:t[1]}}),{c(){z(e.$$.fragment)},m(t,o){F(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function ge(t){let e,n,o,s,r,i,c,l,a,p,b=t[0].title+"",x=0!==t[1].length&&he(t);return{c(){e=h("div"),n=h("h4"),o=g(b),s=m(),x&&x.c(),r=m(),i=h("div"),c=h("button"),c.textContent="Back",v(c,"class","button"),v(i,"class","is-floating"),v(e,"class","card card-shadow content")},m(f,h){d(f,e,h),u(e,n),u(n,o),u(e,s),x&&x.m(e,null),u(e,r),u(e,i),u(i,c),l=!0,a||(p=$(c,"click",t[3]),a=!0)},p(t,[n]){(!l||1&n)&&b!==(b=t[0].title+"")&&w(o,b),0!==t[1].length?x?(x.p(t,n),2&n&&R(x,1)):(x=he(t),x.c(),R(x,1),x.m(e,r)):x&&(O(),D(x,1,1,(()=>{x=null})),G())},i(t){l||(R(x),l=!0)},o(t){D(x),l=!1},d(t){t&&f(e),x&&x.d(),a=!1,p()}}}function me(t,e,n){let{topic:o}=e,s=[];q((()=>{ht(o).then((t=>{n(1,s=t)}))}));const r=t=>{Z.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class be extends K{constructor(t){super(),W(this,t,me,ge,i,{topic:0})}}function $e(t,e,n){const o=t.slice();return o[9]=e[n],o}function ve(t){let e,n,o=t[9].title+"";return{c(){e=h("li"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){2&e&&o!==(o=t[9].title+"")&&w(n,o)},d(t){t&&f(e)}}}function we(e){let n,o,r,i,c,l,a,b,x,k,C,y,S,q,T,L,E,V,j,U,H,P,M,N,B,I,O,G,R=e[1],D=[];for(let t=0;t<R.length;t+=1)D[t]=ve($e(e,R,t));return{c(){n=h("div"),o=h("div"),r=h("div"),i=h("h4"),c=g("Tag: "),l=g(e[0]),a=m(),b=h("p"),b.textContent="Files incluging the tag:",x=m(),k=h("ul");for(let t=0;t<D.length;t+=1)D[t].c();C=m(),y=h("div"),S=h("label"),S.textContent="Number of correct answers",q=m(),T=h("select"),L=h("option"),L.textContent="-- Select --",E=h("option"),E.textContent="Set 0",V=h("option"),V.textContent="Set 1",j=h("option"),j.textContent="Set 2",U=m(),H=h("div"),P=h("button"),P.textContent="Back",M=m(),N=h("button"),N.textContent="Listing",B=m(),I=h("button"),I.textContent="Start",v(r,"class","is-text-left"),v(S,"for","sf-set"),L.__value="-1",L.value=L.__value,E.__value="0",E.value=E.__value,V.__value="1",V.value=V.__value,j.__value="2",j.value=j.__value,v(T,"id","sf-set"),void 0===e[2]&&A((()=>e[8].call(T))),v(y,"class","is-floating"),v(P,"class","button"),v(N,"class","button"),v(I,"class","button"),v(H,"class","is-floating"),v(n,"class","card card-shadow content")},m(t,s){d(t,n,s),u(n,o),u(o,r),u(r,i),u(i,c),u(i,l),u(r,a),u(r,b),u(r,x),u(r,k);for(let t=0;t<D.length;t+=1)D[t].m(k,null);u(n,C),u(n,y),u(y,S),u(y,q),u(y,T),u(T,L),u(T,E),u(T,V),u(T,j),_(T,e[2]),u(n,U),u(n,H),u(H,P),u(H,M),u(H,N),u(H,B),u(H,I),O||(G=[$(T,"change",e[8]),$(T,"change",e[6]),$(P,"click",e[4]),$(N,"click",e[3]),$(I,"click",e[5])],O=!0)},p(t,[e]){if(1&e&&w(l,t[0]),2&e){let n;for(R=t[1],n=0;n<R.length;n+=1){const o=$e(t,R,n);D[n]?D[n].p(o,e):(D[n]=ve(o),D[n].c(),D[n].m(k,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=R.length}4&e&&_(T,t[2])},i:t,o:t,d(t){t&&f(n),p(D,t),O=!1,s(G)}}}function xe(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i=null}=e;return q((async()=>{try{if(!i){const t=[];r.forEach((e=>{t.push(Tt(e.file))})),await Promise.all(t),console.log("Loading questions for topics"),n(7,i=await(async(t,e,n)=>{const o=et.transaction(["questions"],"readonly").objectStore("questions");let s=[];return t.forEach((t=>{s.push(gt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);ft(o),o.sort(((t,e)=>e.ratio-t.ratio));const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),ft(o)),o.splice(0,e)}))})(r,30,.66))}}catch(t){tt.addError("ViewTagInfo: "+t.message)}})),t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(7,i=t.questions)},[s,r,o,()=>{Z.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{Z.setView("ViewTopicList")},()=>{Z.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;mt(i,e.selectedIndex-1),e.selectedIndex=0},i,function(){o=k(this),n(2,o)}]}class _e extends K{constructor(t){super(),W(this,t,xe,we,i,{tag:0,topics:1,questions:7})}}function ke(t){let e,n,o,s,r,i,c,l,a,p,b,x;return i=new pe({props:{questions:t[1]}}),{c(){e=h("div"),n=h("h4"),o=g("Tag: "),s=g(t[0]),r=m(),z(i.$$.fragment),c=m(),l=h("div"),a=h("button"),a.textContent="Back",v(a,"class","button"),v(l,"class","is-floating"),v(e,"class","card card-shadow content")},m(f,h){d(f,e,h),u(e,n),u(n,o),u(n,s),u(e,r),F(i,e,null),u(e,c),u(e,l),u(l,a),p=!0,b||(x=$(a,"click",t[4]),b=!0)},p(t,[e]){(!p||1&e)&&w(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){p||(R(i.$$.fragment,t),p=!0)},o(t){D(i.$$.fragment,t),p=!1},d(t){t&&f(e),Q(i),b=!1,x()}}}function Ce(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{Z.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class ye extends K{constructor(t){super(),W(this,t,Ce,ke,i,{tag:0,topics:3,questions:1})}}function Se(e){let n,o,s,r,i,c,l,a,p,b,$,x,_,k,C,y,S,q,T,L,E,V,j,U,A=e[0][0]+"",H=e[0][1]+"",P=e[0][2]+"",M=e[0][3]+"";return{c(){n=h("table"),o=h("tr"),s=h("td"),s.textContent="No correct Answers",r=m(),i=h("td"),c=g(A),l=m(),a=h("tr"),p=h("td"),p.textContent="One correct Answer",b=m(),$=h("td"),x=g(H),_=m(),k=h("tr"),C=h("td"),C.textContent="Two correct Answers",y=m(),S=h("td"),q=g(P),T=m(),L=h("tr"),E=h("td"),E.textContent="Learned",V=m(),j=h("td"),U=g(M),v(n,"class","table hide-md")},m(t,e){d(t,n,e),u(n,o),u(o,s),u(o,r),u(o,i),u(i,c),u(n,l),u(n,a),u(a,p),u(a,b),u(a,$),u($,x),u(n,_),u(n,k),u(k,C),u(k,y),u(k,S),u(S,q),u(n,T),u(n,L),u(L,E),u(L,V),u(L,j),u(j,U)},p(t,[e]){1&e&&A!==(A=t[0][0]+"")&&w(c,A),1&e&&H!==(H=t[0][1]+"")&&w(x,H),1&e&&P!==(P=t[0][2]+"")&&w(q,P),1&e&&M!==(M=t[0][3]+"")&&w(U,M)},i:t,o:t,d(t){t&&f(n)}}}function qe(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class Te extends K{constructor(t){super(),W(this,t,qe,Se,i,{statistic:0})}}function Le(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=h("p")},m(t,o){d(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&f(e)}}}function Ee(t){let e,n,o,s,r,i,c,l,a,p,b,$,x,_,k,C,y,S,q,T=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",E=t[3].toHtml(t[0].answer)+"";l=new ie({props:{question:t[0]}});let V=t[1].details&&Le(t);return{c(){e=h("div"),n=h("div"),o=h("div"),s=h("div"),r=g("Question: "),i=g(T),c=m(),z(l.$$.fragment),a=m(),p=h("div"),b=h("p"),$=m(),x=h("div"),_=h("h5"),_.textContent="Answer",k=m(),C=h("div"),y=h("p"),S=m(),V&&V.c(),v(s,"class","h5"),v(o,"class","is-flex-spread block"),v(p,"class","card content is-primary"),v(C,"class","card content is-info"),x.hidden=t[2],v(e,"class","grid grid-2")},m(t,f){d(t,e,f),u(e,n),u(n,o),u(o,s),u(s,r),u(s,i),u(o,c),F(l,o,null),u(n,a),u(n,p),u(p,b),b.innerHTML=L,u(e,$),u(e,x),u(x,_),u(x,k),u(x,C),u(C,y),y.innerHTML=E,u(C,S),V&&V.m(C,null),q=!0},p(t,[e]){(!q||1&e)&&T!==(T=t[0].id+"")&&w(i,T);const n={};1&e&&(n.question=t[0]),l.$set(n),(!q||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&(b.innerHTML=L),(!q||1&e)&&E!==(E=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=E),t[1].details?V?V.p(t,e):(V=Le(t),V.c(),V.m(C,null)):V&&(V.d(1),V=null),(!q||4&e)&&(x.hidden=t[2])},i(t){q||(R(l.$$.fragment,t),q=!0)},o(t){D(l.$$.fragment,t),q=!1},d(t){t&&f(e),Q(l),V&&V.d()}}}function Ve(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Zt;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class je extends K{constructor(t){super(),W(this,t,Ve,Ee,i,{question:0,topic:1,hideAnswer:2})}}function Ue(t){let e,n,o,r,i,c,l,a,p,b,w,x,_,k,C,y,S,q,T,L,E,V,j,U;function A(t,e){return t[0]?He:Ae}let H=A(t),P=H(t);return o=new Te({props:{statistic:t[3]}}),i=new je({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=h("div"),P.c(),n=m(),z(o.$$.fragment),r=m(),z(i.$$.fragment),c=m(),l=h("div"),a=h("button"),p=g("Show"),w=m(),x=h("button"),_=g("Correct"),k=m(),C=h("button"),y=g("Wrong"),S=m(),q=h("button"),T=g("Skip"),L=m(),E=h("button"),E.textContent="Stop",v(a,"class","button"),a.hidden=b=!t[4],v(x,"class","button is-success"),x.hidden=t[4],v(C,"class","button is-danger"),C.hidden=t[4],v(q,"class","button is-warning"),q.hidden=t[4],v(E,"class","button"),v(l,"class","is-floating"),v(e,"class","card card-shadow content")},m(s,f){d(s,e,f),P.m(e,null),u(e,n),F(o,e,null),u(e,r),F(i,e,null),u(e,c),u(e,l),u(l,a),u(a,p),u(l,w),u(l,x),u(x,_),u(l,k),u(l,C),u(C,y),u(l,S),u(l,q),u(q,T),u(l,L),u(l,E),V=!0,j||(U=[$(a,"click",t[9]),$(x,"click",t[10]),$(C,"click",t[11]),$(q,"click",t[12]),$(E,"click",t[6])],j=!0)},p(t,s){H===(H=A(t))&&P?P.p(t,s):(P.d(1),P=H(t),P&&(P.c(),P.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!V||16&s&&b!==(b=!t[4]))&&(a.hidden=b),(!V||16&s)&&(x.hidden=t[4]),(!V||16&s)&&(C.hidden=t[4]),(!V||16&s)&&(q.hidden=t[4])},i(t){V||(R(o.$$.fragment,t),R(i.$$.fragment,t),V=!0)},o(t){D(o.$$.fragment,t),D(i.$$.fragment,t),V=!1},d(t){t&&f(e),P.d(),Q(o),Q(i),j=!1,s(U)}}}function Ae(t){let e,n,o=t[1].title+"";return{c(){e=h("h4"),n=g(o)},m(t,o){d(t,e,o),u(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&w(n,o)},d(t){t&&f(e)}}}function He(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=h("h4"),n=g("Tag: "),o=g(t[0]),s=m(),r=h("h6"),i=g(c)},m(t,c){d(t,e,c),u(e,n),u(e,o),d(t,s,c),d(t,r,c),u(r,i)},p(t,e){1&e&&w(o,t[0]),2&e&&c!==(c=t[1].title+"")&&w(i,c)},d(t){t&&f(e),t&&f(s),t&&f(r)}}}function Pe(t){let e,n,o=t[2]&&Ue(t);return{c(){o&&o.c(),e=b()},m(t,s){o&&o.m(t,s),d(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&R(o,1)):(o=Ue(t),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(O(),D(o,1,1,(()=>{o=null})),G())},i(t){n||(R(o),n=!0)},o(t){D(o),n=!1},d(t){o&&o.d(t),t&&f(e)}}}function Me(t,e,n){let o,s,r,i,{tag:c=null}=e,{topics:l}=e,{questions:a}=e,u=!0;const d=t=>{if(void 0===t)return i.push(s),void f();var e;((t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=dt(t.failed,t.total)})(s,t),(e=s,new Promise(((t,n)=>{const o=et.transaction(["questions"],"readwrite").objectStore("questions");o.put(e).onsuccess=n=>{console.log("Store:",o.name," update:",e),t()}}))).then((()=>{s.progress<3&&i.push(s),0===i.length&&p(),f()}))},f=()=>{n(2,s=i.shift()),n(1,o=l.find((t=>t.file===s.file))),n(3,r=(t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e})(a)),n(4,u=!0),console.log("next",s)};q((()=>{i=a.filter((t=>t.progress<3)),ft(i),f()}));const p=()=>{o?(n(1,o.lastLearned=new Date,o),(t=>{const e=et.transaction(["topics"],"readwrite").objectStore("topics");rt(e,t)})(o),Z.setView("ViewTopicList",{id:o.file})):Z.setView("ViewTopicList")};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(7,l=t.topics),"questions"in t&&n(8,a=t.questions)},[c,o,s,r,u,d,p,l,a,()=>n(4,u=!1),()=>d(!0),()=>d(!1),()=>d()]}class Ne extends K{constructor(t){super(),W(this,t,Me,Pe,i,{tag:0,topics:7,questions:8})}}function Be(e){let n,o,r,i,c,l,a,p,b,_,k,C,y,S,q,T,L,E,V,j,U,A,H,P;return{c(){n=h("h4"),n.textContent="Translate",o=m(),r=h("label"),i=g(e[0]),c=m(),l=h("textarea"),a=m(),p=h("label"),b=g(e[1]),_=m(),k=h("textarea"),C=m(),y=h("div"),S=h("button"),S.textContent="Back",q=m(),T=h("button"),T.textContent="Translate",L=m(),E=h("button"),E.textContent="Reset",V=m(),j=h("button"),j.textContent="Switch",U=m(),A=h("p"),A.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',v(r,"for","src"),v(l,"id","src"),v(p,"for","dst"),v(k,"id","dst"),k.readOnly=!0,k.value=e[3],v(S,"class","button"),v(T,"class","button"),v(E,"class","button"),v(j,"class","button"),v(y,"class","is-floating")},m(t,s){d(t,n,s),d(t,o,s),d(t,r,s),u(r,i),d(t,c,s),d(t,l,s),x(l,e[2]),d(t,a,s),d(t,p,s),u(p,b),d(t,_,s),d(t,k,s),d(t,C,s),d(t,y,s),u(y,S),u(y,q),u(y,T),u(y,L),u(y,E),u(y,V),u(y,j),d(t,U,s),d(t,A,s),H||(P=[$(l,"input",e[8]),$(S,"click",e[9]),$(T,"click",e[10]),$(E,"click",e[11]),$(j,"click",e[12])],H=!0)},p(t,[e]){1&e&&w(i,t[0]),4&e&&x(l,t[2]),2&e&&w(b,t[1]),8&e&&(k.value=t[3])},i:t,o:t,d(t){t&&f(n),t&&f(o),t&&f(r),t&&f(c),t&&f(l),t&&f(a),t&&f(p),t&&f(_),t&&f(k),t&&f(C),t&&f(y),t&&f(U),t&&f(A),H=!1,s(P)}}}function Ie(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",l="";const a=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||tt.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,l=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=l),a()},d=()=>{n(2,c=""),n(3,l="")},f=()=>{Z.setView("ViewTopicList")};return[o,s,c,l,a,u,d,f,function(){c=this.value,n(2,c)},()=>f(),()=>a(),()=>d(),()=>u()]}class Oe extends K{constructor(t){super(),W(this,t,Ie,Be,i,{})}}function Ge(t,e,n){const o=t.slice();return o[9]=e[n],o}function Re(t){let e,n,o,s,r,i,c,l,a,p,b,x,_,k,C,y=t[9].file+"",S=t[9].value+"",q=lt(t[9].lastLoaded)+"";function T(){return t[6](t[9])}return{c(){e=h("tr"),n=h("td"),o=g(y),s=m(),r=h("td"),i=g(S),c=m(),l=h("td"),a=g(q),p=m(),b=h("td"),x=h("button"),x.textContent="Delete",_=m(),v(x,"class","button")},m(t,f){d(t,e,f),u(e,n),u(n,o),u(e,s),u(e,r),u(r,i),u(e,c),u(e,l),u(l,a),u(e,p),u(e,b),u(b,x),u(e,_),k||(C=$(x,"click",T),k=!0)},p(e,n){t=e,1&n&&y!==(y=t[9].file+"")&&w(o,y),1&n&&S!==(S=t[9].value+"")&&w(i,S),1&n&&q!==(q=lt(t[9].lastLoaded)+"")&&w(a,q)},d(t){t&&f(e),k=!1,C()}}}function De(e){let n,o,r,i,c,l,a,g,b,w,x,k,C,y,S,q=e[0],T=[];for(let t=0;t<q.length;t+=1)T[t]=Re(Ge(e,q,t));return{c(){n=h("div"),o=h("label"),o.textContent="Tag Filter",r=m(),i=h("select"),c=h("option"),c.textContent="By Name",l=h("option"),l.textContent="By Date",a=m(),g=h("table"),b=h("tr"),b.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",w=m();for(let t=0;t<T.length;t+=1)T[t].c();x=m(),k=h("div"),C=h("button"),C.textContent="Back",v(o,"for","sort-select"),c.__value="file",c.value=c.__value,l.__value="lastLoaded",l.value=l.__value,v(i,"id","sort-select"),void 0===e[1]&&A((()=>e[5].call(i))),v(n,"class","block"),v(C,"class","button"),v(k,"class","is-floating")},m(t,s){d(t,n,s),u(n,o),u(n,r),u(n,i),u(i,c),u(i,l),_(i,e[1]),d(t,a,s),d(t,g,s),u(g,b),u(g,w);for(let t=0;t<T.length;t+=1)T[t].m(g,null);d(t,x,s),d(t,k,s),u(k,C),y||(S=[$(i,"change",e[5]),$(i,"change",e[2]),$(C,"click",e[7])],y=!0)},p(t,[e]){if(2&e&&_(i,t[1]),9&e){let n;for(q=t[0],n=0;n<q.length;n+=1){const o=Ge(t,q,n);T[n]?T[n].p(o,e):(T[n]=Re(o),T[n].c(),T[n].m(g,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=q.length}},i:t,o:t,d(t){t&&f(n),t&&f(a),t&&f(g),p(T,t),t&&f(x),t&&f(k),y=!1,s(S)}}}function ze(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),o.sort(((t,e)=>+(e[s]>t[s])||-(e[s]<t[s]))),n(0,o)},i=async()=>{n(0,o=await new Promise(((t,e)=>{const n=et.transaction(["hash"],"readonly").objectStore("hash"),o=n.getAll();o.onsuccess=e=>{const s=o.result;console.log("Store:",n.name,"get all:",s.length),t(s)},o.onerror=t=>{console.log("Store:",n.name,"get all error:",t),e()}}))),r()},c=async t=>{await(t=>{const e=et.transaction(["hash"],"readwrite").objectStore("hash");return st(e,t)})(t),i()},l=()=>{Z.setView("ViewTopicList")};q((()=>{i()}));return[o,s,r,c,l,function(){s=k(this),n(1,s)},t=>c(t.file),()=>l()]}class Fe extends K{constructor(t){super(),W(this,t,ze,De,i,{})}}function Qe(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=g("..."),n=g(o)},m(t,o){d(t,e,o),d(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&w(n,o)},d(t){t&&f(e),t&&f(n)}}}function Je(e){let n,o,s,r,i,c,l,a,p,b,$,v,x,_,k,C,y,S,q,T,L,E,V,j=e[0].langUrl+"",U=(e[0].backupUrl?e[0].backupUrl:"")+"",A=(e[0].file?e[0].file:"")+"",H=e[0].token&&Qe(e);return{c(){n=h("table"),o=h("tr"),s=h("td"),s.textContent="Github URL Language",r=m(),i=h("td"),c=g(j),l=m(),a=h("tr"),p=h("td"),p.textContent="Github URL Backup",b=m(),$=h("td"),v=g(U),x=m(),_=h("tr"),k=h("td"),k.textContent="Github File",C=m(),y=h("td"),S=g(A),q=m(),T=h("tr"),L=h("td"),L.textContent="Token",E=m(),V=h("td"),H&&H.c()},m(t,e){d(t,n,e),u(n,o),u(o,s),u(o,r),u(o,i),u(i,c),u(n,l),u(n,a),u(a,p),u(a,b),u(a,$),u($,v),u(n,x),u(n,_),u(_,k),u(_,C),u(_,y),u(y,S),u(n,q),u(n,T),u(T,L),u(T,E),u(T,V),H&&H.m(V,null)},p(t,[e]){1&e&&j!==(j=t[0].langUrl+"")&&w(c,j),1&e&&U!==(U=(t[0].backupUrl?t[0].backupUrl:"")+"")&&w(v,U),1&e&&A!==(A=(t[0].file?t[0].file:"")+"")&&w(S,A),t[0].token?H?H.p(t,e):(H=Qe(t),H.c(),H.m(V,null)):H&&(H.d(1),H=null)},i:t,o:t,d(t){t&&f(n),H&&H.d()}}}function We(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class Ke extends K{constructor(t){super(),W(this,t,We,Je,i,{admin:0})}}function Ye(t){let e,n;return{c(){e=h("div"),n=g(t[2]),v(e,"class","block is-text-success")},m(t,o){d(t,e,o),u(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&f(e)}}}function Xe(t){let e,n,o,s;const r=[tn,Ze],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=b()},m(t,n){i[e].m(t,n),d(t,o,n),s=!0},p(t,s){let l=e;e=c(t),e===l?i[e].p(t,s):(O(),D(i[l],1,1,(()=>{i[l]=null})),G(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),R(n,1),n.m(o.parentNode,o))},i(t){s||(R(n),s=!0)},o(t){D(n),s=!1},d(t){i[e].d(t),t&&f(o)}}}function Ze(t){let e,n,o,r,i,c,l,a,p,g,b;n=new Ke({props:{admin:t[0]}});let w=t[0].file&&t[0].backupUrl&&t[0].token&&en(t);return{c(){e=h("div"),z(n.$$.fragment),o=m(),r=h("div"),i=h("button"),i.textContent="Back",c=m(),l=h("button"),l.textContent="Update",a=m(),w&&w.c(),v(i,"class","button"),v(l,"class","button"),v(r,"class","is-floating"),v(e,"class","block")},m(s,f){d(s,e,f),F(n,e,null),u(e,o),u(e,r),u(r,i),u(r,c),u(r,l),u(r,a),w&&w.m(r,null),p=!0,g||(b=[$(i,"click",t[4]),$(l,"click",t[12])],g=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?w?w.p(t,e):(w=en(t),w.c(),w.m(r,null)):w&&(w.d(1),w=null)},i(t){p||(R(n.$$.fragment,t),p=!0)},o(t){D(n.$$.fragment,t),p=!1},d(t){t&&f(e),Q(n),w&&w.d(),g=!1,s(b)}}}function tn(e){let n,o,r,i,c,l,a,p,g,b,w,_,k,C,y,S,q,T,L,E,V,j,U,A,H,P;return{c(){n=h("form"),o=h("div"),r=h("label"),r.textContent="Github URL Language",i=m(),c=h("input"),l=m(),a=h("label"),a.textContent="Github URL Backup",p=m(),g=h("input"),b=m(),w=h("label"),w.textContent="Github File",_=m(),k=h("input"),C=m(),y=h("label"),y.textContent="Token",S=m(),q=h("input"),T=m(),L=h("div"),E=h("button"),E.textContent="Save",V=m(),j=h("button"),j.textContent="Cancel",U=m(),A=h("button"),A.textContent="Back",v(r,"for","langUrl"),v(c,"id","langUrl"),v(c,"type","url"),v(a,"for","backupUrl"),v(g,"id","backupUrl"),v(g,"type","url"),v(w,"for","file"),v(k,"id","file"),v(k,"type","text"),v(y,"for","token"),v(q,"id","token"),v(q,"type","password"),v(o,"class","block"),v(E,"class","button"),v(j,"class","button"),v(A,"class","button"),v(L,"class","is-floating")},m(t,s){var f;d(t,n,s),u(n,o),u(o,r),u(o,i),u(o,c),x(c,e[0].langUrl),u(o,l),u(o,a),u(o,p),u(o,g),x(g,e[0].backupUrl),u(o,b),u(o,w),u(o,_),u(o,k),x(k,e[0].file),u(o,C),u(o,y),u(o,S),u(o,q),x(q,e[0].token),u(n,T),u(n,L),u(L,E),u(L,V),u(L,j),u(L,U),u(L,A),H||(P=[$(c,"input",e[7]),$(g,"input",e[8]),$(k,"input",e[9]),$(q,"input",e[10]),$(j,"click",e[11]),$(A,"click",e[4]),$(n,"submit",(f=e[3],function(t){return t.preventDefault(),f.call(this,t)}))],H=!0)},p(t,e){1&e&&x(c,t[0].langUrl),1&e&&x(g,t[0].backupUrl),1&e&&k.value!==t[0].file&&x(k,t[0].file),1&e&&q.value!==t[0].token&&x(q,t[0].token)},i:t,o:t,d(t){t&&f(n),H=!1,s(P)}}}function en(e){let n,o,r,i,c;return{c(){n=h("button"),n.textContent="Backup",o=m(),r=h("button"),r.textContent="Restore",v(n,"class","button"),v(r,"class","button")},m(t,s){d(t,n,s),d(t,o,s),d(t,r,s),i||(c=[$(n,"click",e[5]),$(r,"click",e[6])],i=!0)},p:t,d(t){t&&f(n),t&&f(o),t&&f(r),i=!1,s(c)}}}function nn(t){let e,n,o,s,r,i=t[2]&&Ye(t),c=t[0]&&Xe(t);return{c(){e=h("h4"),e.textContent="Configuration",n=m(),i&&i.c(),o=m(),c&&c.c(),s=b()},m(t,l){d(t,e,l),d(t,n,l),i&&i.m(t,l),d(t,o,l),c&&c.m(t,l),d(t,s,l),r=!0},p(t,[e]){t[2]?i?i.p(t,e):(i=Ye(t),i.c(),i.m(o.parentNode,o)):i&&(i.d(1),i=null),t[0]?c?(c.p(t,e),1&e&&R(c,1)):(c=Xe(t),c.c(),R(c,1),c.m(s.parentNode,s)):c&&(O(),D(c,1,1,(()=>{c=null})),G())},i(t){r||(R(c),r=!0)},o(t){D(c),r=!1},d(t){t&&f(e),t&&f(n),i&&i.d(t),t&&f(o),c&&c.d(t),t&&f(s)}}}function on(t,e,n){let o,s;a(t,xt,(t=>n(13,o=t)));let r=!1,i="";q((async()=>{n(0,s=o)}));return[s,r,i,t=>{s.langUrl&&xt.setAdmin(s),n(1,r=!1)},()=>{Z.setView("ViewTopicList")},async()=>{(async t=>{const{backupUrl:e,headers:n}=Ct(),o=await yt(e,n);console.log("sha",o);const s={method:"PUT",headers:n,body:JSON.stringify({sha:o,content:(r=JSON.stringify(t),window.btoa(unescape(encodeURIComponent(r)))),message:"backup"})};var r;const i=await fetch(e,s).catch((t=>{tt.addError(`githubBackup - url: ${e} error: ${t}`)}));i&&(i.ok||tt.addError(`githubBackup - url: ${e} error: ${i.statusText}`))})(await new Promise(((t,e)=>{const n=[],o=et.transaction(["questions"],"readonly").objectStore("questions"),s=o.openCursor();s.onsuccess=e=>{const r=s.result;if(r){const t=r.value;n.push([t.id,t.failed,t.total]),r.continue()}else console.log("Store:",o.name,"questGetBackup finished:",n.length),t(n)},s.onerror=t=>{console.log("Store:",o.name,"questGetBackup:",t),e()}}))),n(2,i="Backup done!")},async()=>{const t=await(async()=>{const{backupUrl:t,headers:e}=Ct(),n=await St(t,e);if(n)return _t(n.content)})();t&&($t(t),n(2,i="Restore done!"))},function(){s.langUrl=this.value,n(0,s)},function(){s.backupUrl=this.value,n(0,s)},function(){s.file=this.value,n(0,s)},function(){s.token=this.value,n(0,s)},()=>n(1,r=!1),()=>n(1,r=!0)]}class sn extends K{constructor(t){super(),W(this,t,on,nn,i,{})}}function rn(t){let e,n;return e=new Ut({}),{c(){z(e.$$.fragment)},m(t,o){F(e,t,o),n=!0},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function cn(t){let n,o,s,r,i,c,l,a,p,g=0!==t[0].length&&rn();const b=[t[1].props];var $=t[1].component;function w(t){let n={};for(let t=0;t<b.length;t+=1)n=e(n,b[t]);return{props:n}}return $&&(c=new $(w())),{c(){n=h("div"),o=h("h2"),o.textContent="Cards",s=m(),g&&g.c(),r=m(),i=h("div"),c&&z(c.$$.fragment),l=m(),a=h("div"),a.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',v(i,"id","main"),v(i,"class","block"),v(a,"class","block"),v(n,"class","container")},m(t,e){d(t,n,e),u(n,o),u(n,s),g&&g.m(n,null),u(n,r),u(n,i),c&&F(c,i,null),u(n,l),u(n,a),p=!0},p(t,[e]){0!==t[0].length?g?1&e&&R(g,1):(g=rn(),g.c(),R(g,1),g.m(n,r)):g&&(O(),D(g,1,1,(()=>{g=null})),G());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(b,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if($!==($=t[1].component)){if(c){O();const t=c;D(t.$$.fragment,1,0,(()=>{Q(t,1)})),G()}$?(c=new $(w()),z(c.$$.fragment),R(c.$$.fragment,1),F(c,i,null)):c=null}else $&&c.$set(o)},i(t){p||(R(g),c&&R(c.$$.fragment,t),p=!0)},o(t){D(g),c&&D(c.$$.fragment,t),p=!1},d(t){t&&f(n),g&&g.d(),c&&Q(c)}}}function ln(t,e,n){let o,s;return a(t,tt,(t=>n(0,o=t))),a(t,Z,(t=>n(1,s=t))),q((()=>{try{(async()=>{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("service-worker.js");console.log("Registration of serivce worker done - scope:",t.scope)}})()}catch(t){tt.addError("App onMount(): "+t)}Z.views={ViewTopicList:{component:Yt},ViewTopicInfo:{component:oe},ViewTopicQuests:{component:be},ViewTagInfo:{component:_e},ViewTagQuests:{component:ye},ViewQuestAnswer:{component:Ne},ViewTranslate:{component:Oe},ViewHashes:{component:Fe},ViewAdmin:{component:sn}},(async()=>{await ot(),await xt.initAdmin();const t=await qt("data/topics.json");t&&wt(t)})().then((()=>{Z.setView("ViewTopicList")}))})),[o,s]}return new class extends K{constructor(t){super(),W(this,t,ln,cn,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map

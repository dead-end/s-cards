var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function a(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function h(){return f(" ")}function g(){return f("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t){return function(e){return e.preventDefault(),t.call(this,e)}}function w(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function k(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function x(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function C(t){const e=t.querySelector(":checked")||function(t){for(const e of t.options)if(!e.disabled)return e}(t);return e&&e.__value}function _(t,e){return new t(e)}let y;function E(t){y=t}function S(){if(!y)throw new Error("Function called outside component initialization");return y}function q(t){S().$$.on_mount.push(t)}function L(t){S().$$.after_update.push(t)}function T(){const t=S();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,o,e),s}(e,n,{cancelable:o});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const V=[],U=[];let M=[];const j=[],H=Promise.resolve();let O=!1;function R(t){M.push(t)}const A=new Set;let N=0;function B(){if(0!==N)return;const t=y;do{try{for(;N<V.length;){const t=V[N];N++,E(t),G(t.$$)}}catch(t){throw V.length=0,N=0,t}for(E(null),V.length=0,N=0;U.length;)U.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];A.has(e)||(A.add(e),e())}M.length=0}while(V.length);for(;j.length;)j.pop()();O=!1,A.clear(),E(t)}function G(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(R)}}const P=new Set;let I;function D(){I={r:0,c:[],p:I}}function F(){I.r||s(I.c),I=I.p}function z(t,e){t&&t.i&&(P.delete(t),t.i(e))}function J(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),I.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function W(t){t&&t.c()}function Q(t,e,o,i){const{fragment:c,after_update:a}=t.$$;c&&c.m(e,o),i||R((()=>{const e=t.$$.on_mount.map(n).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...e):s(e),t.$$.on_mount=[]})),a.forEach(R)}function K(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];M.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),M=e}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(V.push(t),O||(O=!0,H.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,n,r,i,c,a,l,d=[-1]){const p=y;E(e);const f=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(p?p.$$.context:[])),callbacks:o(),dirty:d,skip_bound:!1,root:n.target||p.$$.root};l&&l(f.root);let h=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&c(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),h&&Y(e,t)),n})):[],f.update(),h=!0,s(f.before_update),f.fragment=!!i&&i(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();n.intro&&z(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),B()}E(p)}class Z{$destroy(){K(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const tt=[];function et(e,n=t){let o;const s=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!tt.length;for(const t of s)t[1](),tt.push(t,e);if(t){for(let t=0;t<tt.length;t+=2)tt[t][0](tt[t+1]);tt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const a=[i,c];return s.add(a),1===s.size&&(o=n(r)||t),i(e),()=>{s.delete(a),0===s.size&&o&&(o(),o=null)}}}}const nt=(()=>{const{subscribe:t,set:e}=et({component:""});return{views:{},subscribe:t,setView:(t,n)=>{const o=nt.views[t];o.props=n,e(o)}}})(),ot=(()=>{const{subscribe:t,set:e,update:n}=et([]);return{subscribe:t,addError:t=>{n((e=>(e.push(t),e)))},throwError(t){throw n((e=>(e.push(t),e))),Error(t)},resetErrors:()=>{console.log("reset"),e([])}}})();function st(t,e,n){const o=t.slice();return o[2]=e[n],o}function rt(t){let e,n,o=t[2]+"";return{c(){e=p("li"),n=f(o)},m(t,o){l(t,e,o),a(e,n)},p(t,e){1&e&&o!==(o=t[2]+"")&&b(n,o)},d(t){t&&u(e)}}}function it(e){let n,o,s,r,i,c,f,g,$,b=e[0],v=[];for(let t=0;t<b.length;t+=1)v[t]=rt(st(e,b,t));return{c(){n=p("div"),o=p("h4"),o.textContent="Errors",s=h(),r=p("ul");for(let t=0;t<v.length;t+=1)v[t].c();i=h(),c=p("div"),f=p("button"),f.textContent="Ok",w(o,"class","is-text-danger"),w(f,"class","button"),w(c,"class","is-floating"),w(n,"class","card card-shadow block content")},m(t,u){l(t,n,u),a(n,o),a(n,s),a(n,r);for(let t=0;t<v.length;t+=1)v[t]&&v[t].m(r,null);a(n,i),a(n,c),a(c,f),g||($=m(f,"click",e[1]),g=!0)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const o=st(t,b,n);v[n]?v[n].p(o,e):(v[n]=rt(o),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=b.length}},i:t,o:t,d(t){t&&u(n),d(v,t),g=!1,$()}}}function ct(t,e,n){let o;c(t,ot,(t=>n(0,o=t)));return[o,()=>{ot.resetErrors()}]}class at extends Z{constructor(t){super(),X(this,t,ct,it,i,{})}}const lt=t=>{ot.addError(t.type)},ut=new Promise(((t,e)=>{const n=indexedDB.open("s-card",4);n.onupgradeneeded=t=>{const e=n.result;t.oldVersion<4&&(t=>{if(t.objectStoreNames.contains("topics")||t.createObjectStore("topics",{keyPath:"file"}),!t.objectStoreNames.contains("questions")){const e=t.createObjectStore("questions",{keyPath:"id",autoIncrement:!0});e.indexNames.contains("file")||e.createIndex("file","file",{unique:!1})}t.objectStoreNames.contains("hash")||(t.createObjectStore("hash",{keyPath:"file"}).transaction.oncomplete=()=>{console.log("Upgrade completed!")}),t.objectStoreNames.contains("admin")||t.createObjectStore("admin",{keyPath:"config"}),t.objectStoreNames.contains("config")&&t.deleteObjectStore("config")})(e),console.log("db upgrade success!")},n.onerror=t=>{ot.addError(t.type),e()},n.onsuccess=()=>{const e=n.result;e.onerror=lt,console.log("db init success!"),t(e)}})),dt=(t,e)=>new Promise(((n,o)=>{const s=t.delete(e);s.onsuccess=()=>{console.log("Store:",t.name,"delete:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} delete: ${e} error: ${n}`),o()}})),pt=(t,e)=>new Promise(((n,o)=>{const s=t.put(e);s.onsuccess=()=>{console.log("Store:",t.name,"put:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} put: ${e} error: ${n}`),o()}})),ft=(t,e)=>new Promise(((n,o)=>{const s=t.get(e);s.onsuccess=()=>{console.log("Store:",t.name,"id:",e,"get:",s.result),n(s.result)},s.onerror=n=>{ot.addError(`Store: ${t.name} id: ${e} storeGet error: ${n}`),o()}})),ht=t=>new Promise(((e,n)=>{const o=t.getAll();o.onsuccess=()=>{console.log("Store:",t.name,"getAll num:",o.result.length),e(o.result)},o.onerror=e=>{ot.addError(`Store: ${t.name} storeGetAll error: ${e}`),n()}})),gt=async t=>{const e=(await ut).transaction(["hash"],"readonly").objectStore("hash");return ft(e,t)},mt=async()=>{const t=(await ut).transaction(["hash"],"readonly").objectStore("hash");return ht(t)},$t=async t=>{const e=(await ut).transaction(["hash"],"readwrite").objectStore("hash");return dt(e,t)},wt=(t,e)=>{const n=t.objectStore("hash");return dt(n,e)},bt=t=>{if(!t)return"";const e=t.getDate()>9?t.getDate():"0"+t.getDate(),n=t.getMonth()+1,o=n>9?n:"0"+n,s=t.getHours()>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return`${e}.${o}.${t.getFullYear()} ${s}:${r}`},vt=(t,e)=>{const n=e||[];return(t||[]).toString()===n.toString()},kt=(t,e)=>{for(const n in t)if(t[n]!==e)return!1;return!0},xt=(t,e)=>{let n=0;for(let e=0;e<t.length;e++)n+=t[e];return Ct(n,t.length*e)},Ct=(t,e)=>{if(!e)return 0;const n=100*t/e;return Math.round(n)},_t=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),yt=t=>{for(let e=0;e<t.length;e++){const n=_t(0,t.length-1);if(e===n)continue;const o=t[e];t[e]=t[n],t[n]=o}},Et=(t,e,n)=>{let o=0;return()=>o++%(2*t)<t?e:n};function St(t){return t instanceof Error?t.message:String(t)}const qt=(t,e)=>t.endsWith(e)?t:t+e,Lt=t=>{const e=[];return t.split("\n").forEach((t=>{(t=t.trim())&&e.push(t)})),e},Tt=t=>t.join("\n");var Vt;!function(t){t[t.OK=0]="OK",t[t.ERROR=1]="ERROR",t[t.UNDEF=2]="UNDEF"}(Vt||(Vt={}));class Ut{constructor(){this.status=Vt.UNDEF}isOk(){if(this.status===Vt.UNDEF)throw new Error("Status not set!");return this.status===Vt.OK}hasError(){if(this.status===Vt.UNDEF)throw new Error("Status not set!");return this.status===Vt.ERROR}getMessage(){if(this.status!==Vt.ERROR)throw new Error("Status is not ERROR!");if(!this.message)throw new Error("Status is ERROR but no message is set!");return this.message}getValue(){if(this.status!==Vt.OK)throw new Error("Status is not OK!");if(!this.wrapper)throw new Error("Value not set!");return this.wrapper.value}setOk(t){return this.status=Vt.OK,this.wrapper={value:t},this}setError(t){return this.status=Vt.ERROR,this.message=t,this}}const Mt="https://api.github.com/repos/dead-end/cards-russian/contents/",jt=()=>new Promise((t=>{ut.then((e=>{const n=e.transaction(["admin"],"readonly").objectStore("admin").get("admin");n.onsuccess=()=>{let e=n.result;e||(e={config:"admin",langUrl:Mt,linkUrl:"https://github.com/dead-end/cards-russian/blob/master/",backupUrl:"",file:"",token:""}),t(e)}}))})),Ht=async t=>{const e=(await ut).transaction(["admin"],"readwrite").objectStore("admin");t.langUrl=qt(t.langUrl,"/"),t.linkUrl?t.linkUrl=qt(t.linkUrl,"/"):t.linkUrl=Mt,pt(e,t)},Ot=async(t,e,n,o,s)=>{const r=new Ut;try{const c={content:(i=e,window.btoa(unescape(encodeURIComponent(i)))),message:o};n&&(c.sha=n);const a={method:"PUT",headers:{Accept:"application/vnd.github.v3+json",authorization:`token ${s}`},body:JSON.stringify(c)},l=await fetch(t,a);if(!l.ok)return r.setError(`githubWriteContent - Url: ${t} Error: ${l.statusText}`)}catch(e){return r.setError(`githubWriteContent - Url: ${t} Error: ${e}`)}var i;return r.setOk()},Rt=async(t,e)=>{const n=new Ut;try{const s={Accept:"application/vnd.github.v3+json"};e&&(s.authorization=`token ${e}`);const r=await fetch(t,s);if(!r.ok)return n.setError(`githubReadContent - Url: ${t} Read error: ${r.statusText}`);const i=await r.json(),c=(o=i.content,decodeURIComponent(escape(window.atob(o))));return n.setOk({content:c,hash:i.sha})}catch(e){return n.setError(`githubReadContent - Url: ${t} Error: ${e}`)}var o},At=async(t,e)=>{const n=new Ut;try{const o={Accept:"application/vnd.github.v3+json"};e&&(o.authorization=`token ${e}`);const s=await fetch(t,{method:"HEAD",headers:o});if(404===s.status)return n.setOk();if(!s.ok)return n.setError(`githubGetHash - Url: ${t} Error: ${s.statusText}`);const r=s.headers.get("ETag");if(!r)return console.log("githubGetHash - no ETag found",t),n.setOk();const i=r.startsWith("W/")?3:1,c=r.substring(i,r.length-1);return console.log("githubGetHash:",c),n.setOk(c)}catch(e){return n.setError(`githubGetHash - Url: ${t} Error: ${e}`)}},Nt=async()=>{const t=new Ut;try{const e=await jt(),n=e.backupUrl+e.file,o=await Rt(n,e.token);if(o.hasError())return t.setError(`repoReadBackup - unable to read data: ${o.getMessage()}`);const s=JSON.parse(o.getValue().content);return t.setOk(s)}catch(e){return t.setError(`repoReadBackup - unable to restore data: ${e}`)}},Bt=async t=>{const e=await jt();if(!e.token)return(new Ut).setError(`repoWriteBackup - file: ${e.backupUrl} Token required`);const n=await At(e.backupUrl,e.token),o=JSON.stringify(t),s=e.backupUrl+e.file;return Ot(s,o,n.getValue(),"backup",e.token)},Gt=async(t,e,n,o)=>{const s=new Ut,r=await jt();if(!r.token)return s.setError(`repoWriteContent - file: ${t} Token required`);const i=r.langUrl+t,c=JSON.stringify(e,null,2),a=await Ot(i,c,n,o,r.token);return a.hasError()?s.setError(`repoWriteJson - unable to write: ${a.getMessage()}`):(await $t(t),s.setOk())},Pt=async t=>{const e=new Ut;try{const n=await jt(),o=n.langUrl+t,s=await Rt(o,n.token);return s.hasError()?e.setError(`repoGetJson - unable to read data: ${s.getMessage()}`):e.setOk({json:JSON.parse(s.getValue().content),hash:s.getValue().hash})}catch(t){return e.setError(`repoGetJson - unable get json: ${t}`)}},It=async t=>{const e=new Ut;try{const n=await jt(),o=n.langUrl+t;let s=await gt(t);if(s&&s.value){const r=await At(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);if(r.getValue()&&r.getValue()===s.value)return console.log("repoGetJsonCache - cache ok",t),e.setOk()}const r=await Rt(o,n.token);if(r.hasError())return e.setError(`repoGetJsonCache - file: ${t} - ${r.getMessage()}`);const i=JSON.parse(r.getValue().content);return await(async t=>{const e=(await ut).transaction(["hash"],"readwrite").objectStore("hash");return pt(e,t)})({file:t,value:r.getValue().hash,lastLoaded:new Date}),console.log("repoGetJsonCache",t,i),e.setOk(i)}catch(n){return e.setError(`repoGetJsonCache - file: ${t} - ${n}`)}};class Dt{constructor(t,e){this.count=0,this.md=t,this.tag=e}getTag(){return++this.count%2?`<${this.tag}>`:`</${this.tag}>`}check(t){this.count%2&&ot.addError(`Unbalanced tag: ${this.md} count: ${this.count} data: ${t}`),this.count=0}}class Ft{constructor(){this.map={},this._register("_","u"),this._register("*","b"),this._register("~","i"),this.regex=this._pattern()}_register(t,e){this.map[t]=new Dt(t,e)}_pattern(){let t="";for(const e in this.map)t+=e;return new RegExp(`[${t}]`,"g")}tag(t){return t in this.map||ot.throwError(`Unknown element: ${t}`),this.map[t].getTag()}_check(t){for(const e in this.map)this.map[e].check(t)}_substitute(t){return t.replaceAll(this.regex,(t=>this.tag(t)))}toHtml(t){Array.isArray(t)||(t=[t]);let e=!1,n="";for(const o of t)o.startsWith("- ")?(e||(n+="<ul>",e=!0),n+="<li>"+this._substitute(o.substring(2).trim())+"</li>"):(e?(n+="</ul>",e=!1):""!==n&&(n+="<br />"),n+=this._substitute(o.trim()));return e&&(n+="</ul>"),this._check(t),n}static remove(t){return t.replace(/[_*~]/g,"")}}const zt=t=>{const e=[0,0,0,0];return t.forEach((t=>{e[t.progress]++})),e},Jt=(t,e)=>{e?t.progress++:(t.progress=0,t.failed++),t.total++,t.ratio=Ct(t.failed,t.total)},Wt=(t,e)=>((t,e,n,o)=>new Promise(((s,r)=>{const i=t.objectStore(e),c=i.index(n).getAllKeys(o);c.onsuccess=()=>{c.result.forEach((t=>{dt(i,t)})),s()},c.onerror=t=>{ot.addError(`Store: ${i.name} delete index error: ${t}`),r()}})))(t,"questions","file",e),Qt=async t=>{const e=(await ut).transaction(["questions"],"readwrite").objectStore("questions");return pt(e,t)},Kt=async t=>{const e=(await ut).transaction(["questions"],"readonly").objectStore("questions");return Yt(e,t)},Yt=(t,e)=>new Promise((n=>{const o=t.index("file").getAll(e.file);o.onsuccess=()=>{n(o.result)}})),Xt=async(t,e)=>{const n=(await ut).transaction(["questions"],"readwrite").objectStore("questions"),o=t.map((t=>(t.progress=e,pt(n,t))));await Promise.all(o)},Zt=async(t,e,n)=>{const o=(await ut).transaction(["questions"],"readonly").objectStore("questions"),s=[];return t.forEach((t=>{s.push(Yt(o,t))})),Promise.all(s).then((t=>{let o=[].concat(...t);if(yt(o),o.sort(((t,e)=>e.ratio-t.ratio)),e<=0)return o;const s=Math.round(o.length*n);return console.log("max:",e,"part:",s,"fraction:",n),s>e&&(o=o.splice(0,s),yt(o)),o.splice(0,e)}))},te=(t,e,n)=>{const o=t.objectStore("questions"),s=o.index("file").getAll(e);s.onsuccess=()=>{const t=re(n),r=re(s.result);r.forEach((e=>{t.has(e.id)||dt(o,e.id)})),t.forEach((t=>{const n=r.get(t.id);n?(((t,e)=>{if(t.id!==e.id)throw Error(`Unable to copy question parts: ${t.id} - ${e.id}`);e.file=t.file,e.total=t.total,e.failed=t.failed,e.ratio=t.ratio,e.progress=t.progress})(n,t),pt(o,t)):(((t,e)=>{t.file=e,t.total=0,t.failed=0,t.ratio=0,t.progress=0})(t,e),((t,e)=>{new Promise(((n,o)=>{const s=t.add(e);s.onsuccess=()=>{console.log("Store:",t.name,"add:",e),n()},s.onerror=n=>{ot.addError(`Store: ${t.name} add: ${e} error: ${n}`),o()}}))})(o,t))}))}},ee=()=>new Promise(((t,e)=>{const n=[];ut.then((o=>{const s=o.transaction(["questions"],"readonly").objectStore("questions"),r=s.openCursor();r.onsuccess=()=>{const e=r.result;if(e){const t=e.value;n.push([t.id,t.failed,t.total]),e.continue()}else console.log("Store:",s.name,"questGetBackup finished:",n.length),t(n)},r.onerror=t=>{console.log("Store:",s.name,"questGetBackup:",t),e()}}))})),ne=async t=>{const e=(await ut).transaction(["questions"],"readwrite").objectStore("questions");t.forEach((t=>{const[n,o,s]=[...t];ft(e,n).then((t=>{t?t.total>=s?console.log(`question: ${n} total db: ${t.total} total backup: ${s} => ignore`):(t.failed=o,t.total=s,t.ratio=Ct(t.failed,t.total),pt(e,t)):console.log("question to restore not found in db",n)}))}))},oe=async t=>{const e=await It(t);if(e.hasError())return void ot.addError(`Unable to get file: ${t} - ${e.getMessage()}`);const n=e.getValue();if(n){const e=(await ut).transaction(["questions"],"readwrite");te(e,t,n)}},se=async t=>{const e=[];return t.forEach((t=>{e.push(oe(t))})),Promise.all(e)},re=t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e},ie=(t,e)=>{for(let n of t)if(Ft.remove(n).toLowerCase().includes(e))return!0;return!1},ce=(t,e)=>{const n=t.toLowerCase();return new Promise(((t,o)=>{const s=[];let r=0,i=0;ut.then((c=>{const a=c.transaction(["questions"],"readonly").objectStore("questions"),l=a.openCursor();l.onsuccess=()=>{const o=l.result;if(o){const t=o.value;(ie(t.quest,n)||ie(t.answer,n))&&(s.length<e&&s.push(t),i++),r++,o.continue()}else console.log("Store:",a.name,"questSearch finished:",s.length),t([s,r,i])},l.onerror=t=>{console.log("Store:",a.name,"questSearch:",t),o()}}))}))},ae=t=>{const e=[];return t.forEach((t=>{t.tags.forEach((t=>{e.includes(t)||e.push(t)}))})),e.sort()},le=async()=>{const t=(await ut).transaction(["topics"],"readonly").objectStore("topics");return ht(t)},ue=async t=>{const e=(await ut).transaction(["topics"],"readwrite").objectStore("topics");pt(e,t)},de=(t,e)=>{const n=t.objectStore("topics");dt(n,e)},pe=async t=>{const e=(await ut).transaction(["topics","questions","hash"],"readwrite"),n=e.objectStore("topics"),o=n.getAll();o.onsuccess=()=>{const s=fe(o.result),r=t.map((t=>t.file));for(const t of s.keys())r.includes(t)||(de(e,t),wt(e,t),Wt(e,t));t.forEach((t=>{((t,e)=>!e||(e.lastLearned&&(t.lastLearned=e.lastLearned),t.title!==e.title||t.desc!==e.desc||!vt(t.tags,e.tags)||!vt(t.details,e.details)))(t,s.get(t.file))&&pt(n,t)}))}},fe=t=>{const e=new Map;return t.forEach((t=>{e.set(t.file,t)})),e},he=async()=>{const t=await It("data/topics.json");if(t.hasError())return void ot.addError(`Unable to load topics - ${t.getMessage()}`);const e=t.getValue();e&&await pe(e)};function ge(t){let e,n,o,s,r,i,c,d,m,$,w,v,k,x,C=t[4]&&me(t);return{c(){e=p("tr"),n=p("td"),n.textContent="Questions",o=h(),s=p("td"),r=f(t[2]),i=h(),c=p("tr"),d=p("td"),d.textContent="Status",m=h(),$=p("td"),w=f(t[1]),v=f("%"),k=h(),C&&C.c(),x=g()},m(t,u){l(t,e,u),a(e,n),a(e,o),a(e,s),a(s,r),l(t,i,u),l(t,c,u),a(c,d),a(c,m),a(c,$),a($,w),a($,v),l(t,k,u),C&&C.m(t,u),l(t,x,u)},p(t,e){4&e&&b(r,t[2]),2&e&&b(w,t[1]),t[4]?C?C.p(t,e):(C=me(t),C.c(),C.m(x.parentNode,x)):C&&(C.d(1),C=null)},d(t){t&&u(e),t&&u(i),t&&u(c),t&&u(k),C&&C.d(t),t&&u(x)}}}function me(t){let e,n,o,s,r,i,c,d,g,m,$,w=bt(t[4].lastLoaded)+"",v=t[4].value+"";return{c(){e=p("tr"),n=p("td"),n.textContent="Last loaded",o=h(),s=p("td"),r=f(w),i=h(),c=p("tr"),d=p("td"),d.textContent="Hash",g=h(),m=p("td"),$=f(v)},m(t,u){l(t,e,u),a(e,n),a(e,o),a(e,s),a(s,r),l(t,i,u),l(t,c,u),a(c,d),a(c,g),a(c,m),a(m,$)},p(t,e){16&e&&w!==(w=bt(t[4].lastLoaded)+"")&&b(r,w),16&e&&v!==(v=t[4].value+"")&&b($,v)},d(t){t&&u(e),t&&u(i),t&&u(c)}}}function $e(t){let e,n,o=t[0].desc+"";return{c(){e=p("p"),n=f(o)},m(t,o){l(t,e,o),a(e,n)},p(t,e){1&e&&o!==(o=t[0].desc+"")&&b(n,o)},d(t){t&&u(e)}}}function we(e){let n,o,s,r,i,c,d,m,$,w,v,k,x,C,_,y,E,S,q=e[0].title+"",L=bt(e[0].lastLearned)+"",T=e[0].tags.join(", ")+"",V=e[3]&&ge(e),U=e[0].desc&&$e(e);return{c(){n=p("h4"),o=f(q),s=h(),r=p("table"),i=p("tr"),c=p("td"),c.textContent="Last learned",d=h(),m=p("td"),$=f(L),w=h(),v=p("tr"),k=p("td"),k.textContent="Tags",x=h(),C=p("td"),_=f(T),y=h(),V&&V.c(),E=h(),U&&U.c(),S=g()},m(t,e){l(t,n,e),a(n,o),l(t,s,e),l(t,r,e),a(r,i),a(i,c),a(i,d),a(i,m),a(m,$),a(r,w),a(r,v),a(v,k),a(v,x),a(v,C),a(C,_),a(r,y),V&&V.m(r,null),l(t,E,e),U&&U.m(t,e),l(t,S,e)},p(t,[e]){1&e&&q!==(q=t[0].title+"")&&b(o,q),1&e&&L!==(L=bt(t[0].lastLearned)+"")&&b($,L),1&e&&T!==(T=t[0].tags.join(", ")+"")&&b(_,T),t[3]?V?V.p(t,e):(V=ge(t),V.c(),V.m(r,null)):V&&(V.d(1),V=null),t[0].desc?U?U.p(t,e):(U=$e(t),U.c(),U.m(S.parentNode,S)):U&&(U.d(1),U=null)},i:t,o:t,d(t){t&&u(n),t&&u(s),t&&u(r),V&&V.d(),t&&u(E),U&&U.d(t),t&&u(S)}}}function be(t,e,n){let o,{topic:s}=e,{status:r=0}=e,{size:i=0}=e,{details:c=!0}=e;return q((async()=>{c&&n(4,o=await gt(s.file))})),t.$$set=t=>{"topic"in t&&n(0,s=t.topic),"status"in t&&n(1,r=t.status),"size"in t&&n(2,i=t.size),"details"in t&&n(3,c=t.details)},[s,r,i,c,o]}class ve extends Z{constructor(t){super(),X(this,t,be,we,i,{topic:0,status:1,size:2,details:3})}}function ke(t){let e,n,o,s,r,i,c,d,f;return n=new ve({props:{topic:t[0],details:!1}}),{c(){e=p("div"),W(n.$$.fragment),o=h(),s=p("div"),r=p("button"),r.textContent="Show",w(r,"class","button"),w(s,"class","is-floating"),w(e,"class","card card-shadow content"),w(e,"id",i=t[0].file)},m(i,u){l(i,e,u),Q(n,e,null),a(e,o),a(e,s),a(s,r),c=!0,d||(f=m(r,"click",t[2]),d=!0)},p(t,[o]){const s={};1&o&&(s.topic=t[0]),n.$set(s),(!c||1&o&&i!==(i=t[0].file))&&w(e,"id",i)},i(t){c||(z(n.$$.fragment,t),c=!0)},o(t){J(n.$$.fragment,t),c=!1},d(t){t&&u(e),K(n),d=!1,f()}}}function xe(t,e,n){let{topic:o}=e;const s=t=>{nt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,()=>s(o)]}class Ce extends Z{constructor(t){super(),X(this,t,xe,ke,i,{topic:0})}}function _e(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg>',w(n,"class","icon reset-button")},m(t,i){l(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function ye(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Ee extends Z{constructor(t){super(),X(this,t,ye,_e,i,{onClick:0})}}function Se(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',w(n,"class","icon reset-button")},m(t,i){l(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function qe(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Le extends Z{constructor(t){super(),X(this,t,qe,Se,i,{onClick:0})}}function Te(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5l-3.9 19.5m-2.1-19.5l-3.9 19.5"></path></svg>',w(n,"class","icon reset-button")},m(t,i){l(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function Ve(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class Ue extends Z{constructor(t){super(),X(this,t,Ve,Te,i,{onClick:0})}}function Me(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"></path></svg>',w(n,"class","icon reset-button")},m(t,i){l(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function je(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class He extends Z{constructor(t){super(),X(this,t,je,Me,i,{onClick:0})}}function Oe(t,e,n){const o=t.slice();return o[14]=e[n],o}function Re(t,e,n){const o=t.slice();return o[17]=e[n],o}function Ae(t){let e,n,o,r,i,c,f,g,$,b,v,k,C,_,y,E,S,q,L,T,V,U,M,j=t[1],H=[];for(let e=0;e<j.length;e+=1)H[e]=Ne(Re(t,j,e));let O=t[2]&&Be(t);return _=new He({props:{onClick:t[9]}}),E=new Ue({props:{onClick:t[10]}}),q=new Le({props:{onClick:t[11]}}),T=new Ee({props:{onClick:t[12]}}),{c(){e=p("div"),n=p("label"),n.textContent="Sort",o=h(),r=p("select"),i=p("option"),i.textContent="-- Select --",c=p("option"),c.textContent="Last learned",f=h(),g=p("label"),g.textContent="Tag Filter",$=h(),b=p("select"),v=p("option"),v.textContent="-- Select --";for(let t=0;t<H.length;t+=1)H[t].c();k=h(),O&&O.c(),C=h(),W(_.$$.fragment),y=h(),W(E.$$.fragment),S=h(),W(q.$$.fragment),L=h(),W(T.$$.fragment),w(n,"class","is-valign-center"),w(n,"for","sort-select"),i.__value="",i.value=i.__value,c.__value="time",c.value=c.__value,w(r,"id","sort-select"),void 0===t[3]&&R((()=>t[6].call(r))),w(g,"for","tag-select"),v.__value="",v.value=v.__value,w(b,"id","tag-select"),void 0===t[2]&&R((()=>t[7].call(b))),w(e,"class","is-floating")},m(s,u){l(s,e,u),a(e,n),a(e,o),a(e,r),a(r,i),a(r,c),x(r,t[3]),a(e,f),a(e,g),a(e,$),a(e,b),a(b,v);for(let t=0;t<H.length;t+=1)H[t]&&H[t].m(b,null);x(b,t[2]),a(e,k),O&&O.m(e,null),a(e,C),Q(_,e,null),a(e,y),Q(E,e,null),a(e,S),Q(q,e,null),a(e,L),Q(T,e,null),V=!0,U||(M=[m(r,"change",t[6]),m(r,"change",t[4]),m(b,"change",t[7]),m(b,"change",t[4])],U=!0)},p(t,n){if(8&n&&x(r,t[3]),2&n){let e;for(j=t[1],e=0;e<j.length;e+=1){const o=Re(t,j,e);H[e]?H[e].p(o,n):(H[e]=Ne(o),H[e].c(),H[e].m(b,null))}for(;e<H.length;e+=1)H[e].d(1);H.length=j.length}6&n&&x(b,t[2]),t[2]?O?O.p(t,n):(O=Be(t),O.c(),O.m(e,C)):O&&(O.d(1),O=null)},i(t){V||(z(_.$$.fragment,t),z(E.$$.fragment,t),z(q.$$.fragment,t),z(T.$$.fragment,t),V=!0)},o(t){J(_.$$.fragment,t),J(E.$$.fragment,t),J(q.$$.fragment,t),J(T.$$.fragment,t),V=!1},d(t){t&&u(e),d(H,t),O&&O.d(),K(_),K(E),K(q),K(T),U=!1,s(M)}}}function Ne(t){let e,n,o,s=t[17]+"";return{c(){e=p("option"),n=f(s),e.__value=o=t[17],e.value=e.__value},m(t,o){l(t,e,o),a(e,n)},p(t,r){2&r&&s!==(s=t[17]+"")&&b(n,s),2&r&&o!==(o=t[17])&&(e.__value=o,e.value=e.__value)},d(t){t&&u(e)}}}function Be(e){let n,o,s;return{c(){n=p("button"),n.textContent="Show",w(n,"class","button")},m(t,r){l(t,n,r),o||(s=m(n,"click",e[8]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function Ge(t){let e,n;return e=new Ce({props:{topic:t[14]}}),{c(){W(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.topic=t[14]),e.$set(o)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Pe(t){let e,n,o,s=t[1]&&Ae(t),r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Ge(Oe(t,r,e));const c=t=>J(i[t],1,1,(()=>{i[t]=null}));return{c(){s&&s.c(),e=h(),n=p("div");for(let t=0;t<i.length;t+=1)i[t].c();w(n,"class","grid grid-4")},m(t,r){s&&s.m(t,r),l(t,e,r),l(t,n,r);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,null);o=!0},p(t,[o]){if(t[1]?s?(s.p(t,o),2&o&&z(s,1)):(s=Ae(t),s.c(),z(s,1),s.m(e.parentNode,e)):s&&(D(),J(s,1,1,(()=>{s=null})),F()),1&o){let e;for(r=t[0],e=0;e<r.length;e+=1){const s=Oe(t,r,e);i[e]?(i[e].p(s,o),z(i[e],1)):(i[e]=Ge(s),i[e].c(),z(i[e],1),i[e].m(n,null))}for(D(),e=r.length;e<i.length;e+=1)c(e);F()}},i(t){if(!o){z(s);for(let t=0;t<r.length;t+=1)z(i[t]);o=!0}},o(t){J(s),i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)J(i[t]);o=!1},d(t){s&&s.d(t),t&&u(e),t&&u(n),d(i,t)}}}function Ie(t,e,n){let o,s,r,{id:i}=e,c=[],a=[];q((()=>{le().then((t=>(t.sort(((t,e)=>+(t.title>e.title)||-(t.title<e.title))),t))).then((t=>{c=t,n(0,a=t),n(1,o=ae(c))}))})),L((()=>{if(i){const t=document.getElementById(i);t&&t.scrollIntoView()}}));return t.$$set=t=>{"id"in t&&n(5,i=t.id)},[a,o,s,r,()=>{let t;t=s?c.filter((t=>t.tags.includes(s))):[...c],console.log("sort",r),r&&"time"===r&&(console.log("sorting"),t.sort(((t,e)=>{const n=t.lastLearned?t.lastLearned.getTime():0;return(e.lastLearned?e.lastLearned.getTime():0)-n}))),n(0,a=t)},i,function(){r=C(this),n(3,r)},function(){s=C(this),n(2,s),n(1,o)},()=>nt.setView("ViewTagInfo",{tag:s,topics:a}),()=>nt.setView("ViewTranslate"),()=>nt.setView("ViewHashes"),()=>nt.setView("ViewAdmin"),()=>nt.setView("ViewSearch")]}class De extends Z{constructor(t){super(),X(this,t,Ie,Pe,i,{id:5})}}function Fe(t){let e,n,o,s,r,i=t[4].toHtml(t[0].details)+"";return{c(){e=p("div"),n=p("h5"),n.textContent="Details",o=h(),s=p("div"),r=p("p"),w(s,"class","card content is-info"),w(e,"class","block")},m(t,c){l(t,e,c),a(e,n),a(e,o),a(e,s),a(s,r),r.innerHTML=i},p(t,e){1&e&&i!==(i=t[4].toHtml(t[0].details)+"")&&(r.innerHTML=i)},d(t){t&&u(e)}}}function ze(t){let e,n,o,r,i,c,d,g,$,b,v,k,x,C,_,y,E,S,q,L,T,V,U,M,j,H;r=new ve({props:{topic:t[0],status:t[1],size:t[3]}});let O=t[0].details&&Fe(t);return{c(){e=p("div"),n=p("div"),o=p("div"),W(r.$$.fragment),i=h(),c=p("div"),d=p("label"),d.textContent="Number of correct answers",g=h(),$=p("select"),b=p("option"),b.textContent="-- Select --",v=p("option"),v.textContent="Set 0",k=p("option"),k.textContent="Set 1",x=p("option"),x.textContent="Set 2",C=p("option"),C.textContent="Set 3",_=h(),O&&O.c(),y=h(),E=p("div"),S=p("button"),S.textContent="Back",q=h(),L=p("button"),L.textContent="Listing",T=h(),V=p("button"),U=f("Start"),w(o,"class","is-text-left"),w(d,"for","sf-set"),b.__value="",b.value=b.__value,v.__value="0",v.value=v.__value,k.__value="1",k.value=k.__value,x.__value="2",x.value=x.__value,C.__value="3",C.value=C.__value,w($,"id","sf-set"),w(c,"class","is-floating"),w(S,"class","button"),w(L,"class","button"),w(V,"class","button"),V.disabled=t[2],w(E,"class","is-floating"),w(e,"class","card card-shadow content")},m(s,u){l(s,e,u),a(e,n),a(n,o),Q(r,o,null),a(n,i),a(n,c),a(c,d),a(c,g),a(c,$),a($,b),a($,v),a($,k),a($,x),a($,C),a(n,_),O&&O.m(n,null),a(e,y),a(e,E),a(E,S),a(E,q),a(E,L),a(E,T),a(E,V),a(V,U),M=!0,j||(H=[m($,"change",t[8]),m(S,"click",t[5]),m(L,"click",t[6]),m(V,"click",t[7])],j=!0)},p(t,[e]){const o={};1&e&&(o.topic=t[0]),2&e&&(o.status=t[1]),8&e&&(o.size=t[3]),r.$set(o),t[0].details?O?O.p(t,e):(O=Fe(t),O.c(),O.m(n,null)):O&&(O.d(1),O=null),(!M||4&e)&&(V.disabled=t[2])},i(t){M||(z(r.$$.fragment,t),M=!0)},o(t){J(r.$$.fragment,t),M=!1},d(t){t&&u(e),K(r),O&&O.d(),j=!1,s(H)}}}function Je(t,e,n){let{topic:o}=e,{questions:s}=e;const r=new Ft;let i=0,c=!0,a=0;const l=()=>{if(!s)return;const t=s.map((t=>t.progress));n(1,i=xt(t,3)),n(2,c=kt(t,3)),n(3,a=t.length)};q((async()=>{try{s||(await oe(o.file),console.log("Loading questions for topics"),n(9,s=await Kt(o)),l())}catch(t){ot.addError("ViewTopicInfo: "+St(t))}}));return t.$$set=t=>{"topic"in t&&n(0,o=t.topic),"questions"in t&&n(9,s=t.questions)},[o,i,c,a,r,()=>{nt.setView("ViewTopicList",{id:o.file})},()=>{nt.setView("ViewTopicQuests",{topic:o})},()=>{nt.setView("ViewQuestAnswer",{topics:[o],questions:s})},async t=>{if(!s)return;const e=t.target;await Xt(s,e.selectedIndex-1),e.selectedIndex=0,l()},s]}class We extends Z{constructor(t){super(),X(this,t,Je,ze,i,{topic:0,questions:9})}}function Qe(e){let n,o,s,r,i,c,d,g,m,$,v,k,x,C,_,y=e[0].progress+"",E=e[0].total+"",S=e[0].ratio+"";return{c(){n=p("div"),o=f("Progress: "),s=p("span"),r=f(y),i=f(" /\n  "),c=p("span"),c.textContent="3",d=h(),g=p("span"),m=f("Total: "),$=p("span"),v=f(E),k=f(" Wrong:\n    "),x=p("span"),C=f(S),_=f("%"),w(s,"class","is-text-success"),w(c,"class","is-text-success"),w($,"class","is-text-success"),w(x,"class","is-text-danger"),w(g,"class","hide-sm"),w(n,"class","h6")},m(t,e){l(t,n,e),a(n,o),a(n,s),a(s,r),a(n,i),a(n,c),a(n,d),a(n,g),a(g,m),a(g,$),a($,v),a(g,k),a(g,x),a(x,C),a(x,_)},p(t,[e]){1&e&&y!==(y=t[0].progress+"")&&b(r,y),1&e&&E!==(E=t[0].total+"")&&b(v,E),1&e&&S!==(S=t[0].ratio+"")&&b(C,S)},i:t,o:t,d(t){t&&u(n)}}}function Ke(t,e,n){let{question:o}=e;return t.$$set=t=>{"question"in t&&n(0,o=t.question)},[o]}class Ye extends Z{constructor(t){super(),X(this,t,Ke,Qe,i,{question:0})}}function Xe(e){let n,o,s;return{c(){n=p("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg>',w(n,"class","icon reset-button")},m(t,i){l(t,n,i),o||(s=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&u(n),o=!1,s()}}}function Ze(t,e,n){let{onClick:o}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick)},[o]}class tn extends Z{constructor(t){super(),X(this,t,Ze,Xe,i,{onClick:0})}}function en(t,e,n){const o=t.slice();return o[11]=e[n],o}function nn(t){let e,n,o,s,r,i,c,d,g,m,$,v,k,x,C,_=t[11].id+"",y=t[11].file+"";function E(){return t[10](t[11])}return v=new tn({props:{onClick:E}}),x=new Ye({props:{question:t[11]}}),{c(){e=p("div"),n=p("div"),o=p("span"),s=f("Id: "),r=f(_),i=h(),c=p("span"),d=p("a"),g=f(y),$=h(),W(v.$$.fragment),k=h(),W(x.$$.fragment),w(o,"class","h6"),w(d,"href",m=t[3].linkUrl+t[11].file),w(d,"target","_blank"),w(c,"class","hide-sm"),w(e,"class","is-flex-spread grid-full")},m(t,u){l(t,e,u),a(e,n),a(n,o),a(o,s),a(o,r),a(n,i),a(n,c),a(c,d),a(d,g),a(n,$),Q(v,n,null),a(e,k),Q(x,e,null),C=!0},p(e,n){t=e,(!C||2&n)&&_!==(_=t[11].id+"")&&b(r,_),(!C||2&n)&&y!==(y=t[11].file+"")&&b(g,y),(!C||10&n&&m!==(m=t[3].linkUrl+t[11].file))&&w(d,"href",m);const o={};2&n&&(o.onClick=E),v.$set(o);const s={};2&n&&(s.question=t[11]),x.$set(s)},i(t){C||(z(v.$$.fragment,t),z(x.$$.fragment,t),C=!0)},o(t){J(v.$$.fragment,t),J(x.$$.fragment,t),C=!1},d(t){t&&u(e),K(v),K(x)}}}function on(t){let e,n,o,s,r,i,c,d,f,g,m=t[4].toHtml(t[11].quest)+"",$=t[4].toHtml(t[11].answer)+"",b=t[0]&&nn(t);return{c(){b&&b.c(),e=h(),n=p("div"),o=p("div"),s=p("p"),r=h(),i=p("div"),c=p("div"),d=p("p"),f=h(),w(o,"class","content"),w(n,"class","card "+t[6]()),w(c,"class","content"),w(i,"class","card "+t[6]())},m(t,u){b&&b.m(t,u),l(t,e,u),l(t,n,u),a(n,o),a(o,s),s.innerHTML=m,l(t,r,u),l(t,i,u),a(i,c),a(c,d),d.innerHTML=$,a(i,f),g=!0},p(t,n){t[0]?b?(b.p(t,n),1&n&&z(b,1)):(b=nn(t),b.c(),z(b,1),b.m(e.parentNode,e)):b&&(D(),J(b,1,1,(()=>{b=null})),F()),(!g||2&n)&&m!==(m=t[4].toHtml(t[11].quest)+"")&&(s.innerHTML=m),(!g||2&n)&&$!==($=t[4].toHtml(t[11].answer)+"")&&(d.innerHTML=$)},i(t){g||(z(b),g=!0)},o(t){J(b),g=!1},d(t){b&&b.d(t),t&&u(e),t&&u(n),t&&u(r),t&&u(i)}}}function sn(t){let e,n,o,r,i,c,f,g,$,b,v,k,C,_,y,E,S=t[1],q=[];for(let e=0;e<S.length;e+=1)q[e]=on(en(t,S,e));const L=t=>J(q[t],1,1,(()=>{q[t]=null}));return{c(){e=p("div"),n=p("label"),n.textContent="Details",o=h(),r=p("input"),i=h(),c=p("label"),c.textContent="Tag Filter",f=h(),g=p("select"),$=p("option"),$.textContent="-- Select --",b=p("option"),b.textContent="Total",v=p("option"),v.textContent="Ratio",k=h(),C=p("div");for(let t=0;t<q.length;t+=1)q[t].c();w(n,"for","details-checkbox"),w(r,"type","checkbox"),w(r,"id","details-checkbox"),w(c,"for","quest-sort"),$.__value="",$.value=$.__value,b.__value="total",b.value=b.__value,v.__value="ratio",v.value=v.__value,w(g,"id","quest-sort"),void 0===t[2]&&R((()=>t[9].call(g))),w(e,"class","is-floating"),w(C,"class","grid grid-2")},m(s,u){l(s,e,u),a(e,n),a(e,o),a(e,r),r.checked=t[0],a(e,i),a(e,c),a(e,f),a(e,g),a(g,$),a(g,b),a(g,v),x(g,t[2]),l(s,k,u),l(s,C,u);for(let t=0;t<q.length;t+=1)q[t]&&q[t].m(C,null);_=!0,y||(E=[m(r,"change",t[8]),m(g,"change",t[9]),m(g,"change",t[5])],y=!0)},p(t,[e]){if(1&e&&(r.checked=t[0]),4&e&&x(g,t[2]),91&e){let n;for(S=t[1],n=0;n<S.length;n+=1){const o=en(t,S,n);q[n]?(q[n].p(o,e),z(q[n],1)):(q[n]=on(o),q[n].c(),z(q[n],1),q[n].m(C,null))}for(D(),n=S.length;n<q.length;n+=1)L(n);F()}},i(t){if(!_){for(let t=0;t<S.length;t+=1)z(q[t]);_=!0}},o(t){q=q.filter(Boolean);for(let t=0;t<q.length;t+=1)J(q[t]);_=!1},d(t){t&&u(e),t&&u(k),t&&u(C),d(q,t),y=!1,s(E)}}}function rn(t,e,n){let o,{questions:s}=e,r=!1,i=[],c="";const a=new Ft;q((async()=>{n(3,o=await jt())})),L((()=>{console.log("afterUpdate questions:",s),n(1,i=s)}));const l=Et(2,"is-primary","is-info");return t.$$set=t=>{"questions"in t&&n(7,s=t.questions)},[r,i,c,o,a,()=>{if(!c)return void n(1,i=s);let t=[...s];"ratio"===c?t.sort(((t,e)=>e.ratio-t.ratio)):"total"===c&&t.sort(((t,e)=>e.total-t.total)),n(1,i=t)},l,s,function(){r=this.checked,n(0,r)},function(){c=C(this),n(2,c)},t=>nt.setView("ViewQuestEdit",{question:t})]}class cn extends Z{constructor(t){super(),X(this,t,rn,sn,i,{questions:7})}}function an(t){let e,n;return e=new cn({props:{questions:t[1]}}),{c(){W(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.questions=t[1]),e.$set(o)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ln(t){let e,n,o,s,r,i,c,d,g,$,v=t[0].title+"",k=0!==t[1].length&&an(t);return{c(){e=p("div"),n=p("h4"),o=f(v),s=h(),k&&k.c(),r=h(),i=p("div"),c=p("button"),c.textContent="Back",w(c,"class","button"),w(i,"class","is-floating"),w(e,"class","card card-shadow content")},m(u,p){l(u,e,p),a(e,n),a(n,o),a(e,s),k&&k.m(e,null),a(e,r),a(e,i),a(i,c),d=!0,g||($=m(c,"click",t[3]),g=!0)},p(t,[n]){(!d||1&n)&&v!==(v=t[0].title+"")&&b(o,v),0!==t[1].length?k?(k.p(t,n),2&n&&z(k,1)):(k=an(t),k.c(),z(k,1),k.m(e,r)):k&&(D(),J(k,1,1,(()=>{k=null})),F())},i(t){d||(z(k),d=!0)},o(t){J(k),d=!1},d(t){t&&u(e),k&&k.d(),g=!1,$()}}}function un(t,e,n){let{topic:o}=e,s=[];q((()=>{Kt(o).then((t=>{n(1,s=t)}))}));const r=t=>{nt.setView("ViewTopicInfo",{topic:t})};return t.$$set=t=>{"topic"in t&&n(0,o=t.topic)},[o,s,r,()=>r(o)]}class dn extends Z{constructor(t){super(),X(this,t,un,ln,i,{topic:0})}}function pn(t,e,n){const o=t.slice();return o[15]=e[n],o}function fn(t){let e,n,o=t[15].title+"";return{c(){e=p("li"),n=f(o)},m(t,o){l(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[15].title+"")&&b(n,o)},d(t){t&&u(e)}}}function hn(t){let e,n,o,r,i,c,d,f,g,$;return{c(){e=p("div"),n=p("label"),n.textContent="Number of correct answers",o=h(),r=p("select"),i=p("option"),i.textContent="-- Select --",c=p("option"),c.textContent="Set 0",d=p("option"),d.textContent="Set 1",f=p("option"),f.textContent="Set 2",w(n,"for","sf-set"),i.__value="-1",i.value=i.__value,c.__value="0",c.value=c.__value,d.__value="1",d.value=d.__value,f.__value="2",f.value=f.__value,w(r,"id","sf-set"),void 0===t[5]&&R((()=>t[14].call(r))),w(e,"class","is-floating")},m(s,u){l(s,e,u),a(e,n),a(e,o),a(e,r),a(r,i),a(r,c),a(r,d),a(r,f),x(r,t[5]),g||($=[m(r,"change",t[14]),m(r,"change",t[9])],g=!0)},p(t,e){32&e&&x(r,t[5])},d(t){t&&u(e),g=!1,s($)}}}function gn(t){let e,n,o,r,i,c,d,f,g,$,b,v,k,C,_,y,E,S;return{c(){e=p("div"),n=p("label"),n.textContent="Load Questions",o=h(),r=p("select"),i=p("option"),i.textContent="30",c=p("option"),c.textContent="All",d=h(),f=p("div"),g=p("label"),g.textContent="Used fraction (sorted by ratio)",$=h(),b=p("select"),v=p("option"),v.textContent="40 %",k=p("option"),k.textContent="50 %",C=p("option"),C.textContent="60 %",_=p("option"),_.textContent="70 %",y=p("option"),y.textContent="80 %",w(n,"for","load-quests"),i.__value="30",i.value=i.__value,c.__value="all",c.value=c.__value,w(r,"id","load-quests"),void 0===t[2]&&R((()=>t[12].call(r))),w(e,"class","is-floating"),w(g,"for","relevant"),v.__value="0.4",v.value=v.__value,k.__value="0.5",k.value=k.__value,C.__value="0.6",C.value=C.__value,_.__value="0.7",_.value=_.__value,y.__value="0.8",y.value=y.__value,w(b,"id","relevant"),void 0===t[3]&&R((()=>t[13].call(b))),w(f,"class","is-floating")},m(s,u){l(s,e,u),a(e,n),a(e,o),a(e,r),a(r,i),a(r,c),x(r,t[2]),l(s,d,u),l(s,f,u),a(f,g),a(f,$),a(f,b),a(b,v),a(b,k),a(b,C),a(b,_),a(b,y),x(b,t[3]),E||(S=[m(r,"change",t[12]),m(b,"change",t[13])],E=!0)},p(t,e){4&e&&x(r,t[2]),8&e&&x(b,t[3])},d(t){t&&u(e),t&&u(d),t&&u(f),E=!1,s(S)}}}function mn(e){let n,o,s;return{c(){n=p("button"),n.textContent="Load",w(n,"class","button")},m(t,r){l(t,n,r),o||(s=m(n,"click",e[10]),o=!0)},p:t,d(t){t&&u(n),o=!1,s()}}}function $n(e){let n,o,r,i,c;return{c(){n=p("button"),n.textContent="Listing",o=h(),r=p("button"),r.textContent="Start",w(n,"class","button"),w(r,"class","button")},m(t,s){l(t,n,s),l(t,o,s),l(t,r,s),i||(c=[m(n,"click",e[6]),m(r,"click",e[8])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function wn(e){let n,o,s,r,i,c,g,$,v,k,x,C,_,y,E,S,q,L=e[1],T=[];for(let t=0;t<L.length;t+=1)T[t]=fn(pn(e,L,t));function V(t,e){return t[4]?hn:gn}let U=V(e),M=U(e);function j(t,e){return t[4]?$n:mn}let H=j(e),O=H(e);return{c(){n=p("div"),o=p("div"),s=p("div"),r=p("h4"),i=f("Tag: "),c=f(e[0]),g=h(),$=p("p"),$.textContent="Files incluging the tag:",v=h(),k=p("ul");for(let t=0;t<T.length;t+=1)T[t].c();x=h(),M.c(),C=h(),_=p("div"),y=p("button"),y.textContent="Back",E=h(),O.c(),w(s,"class","is-text-left"),w(y,"class","button"),w(_,"class","is-floating"),w(n,"class","card card-shadow content")},m(t,u){l(t,n,u),a(n,o),a(o,s),a(s,r),a(r,i),a(r,c),a(s,g),a(s,$),a(s,v),a(s,k);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(k,null);a(n,x),M.m(n,null),a(n,C),a(n,_),a(_,y),a(_,E),O.m(_,null),S||(q=m(y,"click",e[7]),S=!0)},p(t,[e]){if(1&e&&b(c,t[0]),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const o=pn(t,L,n);T[n]?T[n].p(o,e):(T[n]=fn(o),T[n].c(),T[n].m(k,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}U===(U=V(t))&&M?M.p(t,e):(M.d(1),M=U(t),M&&(M.c(),M.m(n,C))),H===(H=j(t))&&O?O.p(t,e):(O.d(1),O=H(t),O&&(O.c(),O.m(_,null)))},i:t,o:t,d(t){t&&u(n),d(T,t),M.d(),O.d(),S=!1,q()}}}function bn(t,e,n){let o,{tag:s}=e,{topics:r}=e,{questions:i}=e,c="30",a="0.5",l=!1;return t.$$set=t=>{"tag"in t&&n(0,s=t.tag),"topics"in t&&n(1,r=t.topics),"questions"in t&&n(11,i=t.questions)},[s,r,c,a,l,o,()=>{nt.setView("ViewTagQuests",{tag:s,topics:r,questions:i})},()=>{nt.setView("ViewTopicList",{id:""})},()=>{nt.setView("ViewQuestAnswer",{tag:s,topics:r,questions:i})},t=>{if(!i)return;const e=t.target;Xt(i,e.selectedIndex-1),e.selectedIndex=0},async()=>{try{const t="all"===c?-1:30;n(11,i=await Zt(r,t,parseFloat(a))),n(4,l=!0)}catch(t){ot.addError("ViewTagInfo: "+St(t))}},i,function(){c=C(this),n(2,c)},function(){a=C(this),n(3,a)},function(){o=C(this),n(5,o)}]}class vn extends Z{constructor(t){super(),X(this,t,bn,wn,i,{tag:0,topics:1,questions:11})}}function kn(t){let e,n,o,s,r,i,c,d,g,$,v,k;return i=new cn({props:{questions:t[1]}}),{c(){e=p("div"),n=p("h4"),o=f("Tag: "),s=f(t[0]),r=h(),W(i.$$.fragment),c=h(),d=p("div"),g=p("button"),g.textContent="Back",w(g,"class","button"),w(d,"class","is-floating"),w(e,"class","card card-shadow content")},m(u,p){l(u,e,p),a(e,n),a(n,o),a(n,s),a(e,r),Q(i,e,null),a(e,c),a(e,d),a(d,g),$=!0,v||(k=m(g,"click",t[4]),v=!0)},p(t,[e]){(!$||1&e)&&b(s,t[0]);const n={};2&e&&(n.questions=t[1]),i.$set(n)},i(t){$||(z(i.$$.fragment,t),$=!0)},o(t){J(i.$$.fragment,t),$=!1},d(t){t&&u(e),K(i),v=!1,k()}}}function xn(t,e,n){let{tag:o}=e,{topics:s}=e,{questions:r=[]}=e;const i=()=>{nt.setView("ViewTagInfo",{tag:o,topics:s,questions:r})};return t.$$set=t=>{"tag"in t&&n(0,o=t.tag),"topics"in t&&n(3,s=t.topics),"questions"in t&&n(1,r=t.questions)},[o,r,i,s,()=>i()]}class Cn extends Z{constructor(t){super(),X(this,t,xn,kn,i,{tag:0,topics:3,questions:1})}}function _n(e){let n,o,s,r,i,c,d,g,m,$,v,k,x,C,_,y,E,S,q,L,T,V,U,M,j=e[0][0]+"",H=e[0][1]+"",O=e[0][2]+"",R=e[0][3]+"";return{c(){n=p("table"),o=p("tr"),s=p("td"),s.textContent="No correct Answers",r=h(),i=p("td"),c=f(j),d=h(),g=p("tr"),m=p("td"),m.textContent="One correct Answer",$=h(),v=p("td"),k=f(H),x=h(),C=p("tr"),_=p("td"),_.textContent="Two correct Answers",y=h(),E=p("td"),S=f(O),q=h(),L=p("tr"),T=p("td"),T.textContent="Learned",V=h(),U=p("td"),M=f(R),w(n,"class","table hide-md")},m(t,e){l(t,n,e),a(n,o),a(o,s),a(o,r),a(o,i),a(i,c),a(n,d),a(n,g),a(g,m),a(g,$),a(g,v),a(v,k),a(n,x),a(n,C),a(C,_),a(C,y),a(C,E),a(E,S),a(n,q),a(n,L),a(L,T),a(L,V),a(L,U),a(U,M)},p(t,[e]){1&e&&j!==(j=t[0][0]+"")&&b(c,j),1&e&&H!==(H=t[0][1]+"")&&b(k,H),1&e&&O!==(O=t[0][2]+"")&&b(S,O),1&e&&R!==(R=t[0][3]+"")&&b(M,R)},i:t,o:t,d(t){t&&u(n)}}}function yn(t,e,n){let{statistic:o=[0,0,0,0]}=e;return t.$$set=t=>{"statistic"in t&&n(0,o=t.statistic)},[o]}class En extends Z{constructor(t){super(),X(this,t,yn,_n,i,{statistic:0})}}function Sn(t){let e,n=t[3].toHtml(t[1].details)+"";return{c(){e=p("p")},m(t,o){l(t,e,o),e.innerHTML=n},p(t,o){2&o&&n!==(n=t[3].toHtml(t[1].details)+"")&&(e.innerHTML=n)},d(t){t&&u(e)}}}function qn(t){let e,n,o,s,r,i,c,d,g,m,$,v,k,x,C,_,y,E,S,q=t[0].id+"",L=t[3].toHtml(t[0].quest)+"",T=t[3].toHtml(t[0].answer)+"";d=new Ye({props:{question:t[0]}});let V=t[1].details&&Sn(t);return{c(){e=p("div"),n=p("div"),o=p("div"),s=p("div"),r=f("Question: "),i=f(q),c=h(),W(d.$$.fragment),g=h(),m=p("div"),$=p("p"),v=h(),k=p("div"),x=p("h5"),x.textContent="Answer",C=h(),_=p("div"),y=p("p"),E=h(),V&&V.c(),w(s,"class","h5"),w(o,"class","is-flex-spread block"),w(m,"class","card content is-primary"),w(_,"class","card content is-info"),k.hidden=t[2],w(e,"class","grid grid-2")},m(t,u){l(t,e,u),a(e,n),a(n,o),a(o,s),a(s,r),a(s,i),a(o,c),Q(d,o,null),a(n,g),a(n,m),a(m,$),$.innerHTML=L,a(e,v),a(e,k),a(k,x),a(k,C),a(k,_),a(_,y),y.innerHTML=T,a(_,E),V&&V.m(_,null),S=!0},p(t,[e]){(!S||1&e)&&q!==(q=t[0].id+"")&&b(i,q);const n={};1&e&&(n.question=t[0]),d.$set(n),(!S||1&e)&&L!==(L=t[3].toHtml(t[0].quest)+"")&&($.innerHTML=L),(!S||1&e)&&T!==(T=t[3].toHtml(t[0].answer)+"")&&(y.innerHTML=T),t[1].details?V?V.p(t,e):(V=Sn(t),V.c(),V.m(_,null)):V&&(V.d(1),V=null),(!S||4&e)&&(k.hidden=t[2])},i(t){S||(z(d.$$.fragment,t),S=!0)},o(t){J(d.$$.fragment,t),S=!1},d(t){t&&u(e),K(d),V&&V.d()}}}function Ln(t,e,n){let{question:o}=e,{topic:s}=e,{hideAnswer:r}=e;const i=new Ft;return t.$$set=t=>{"question"in t&&n(0,o=t.question),"topic"in t&&n(1,s=t.topic),"hideAnswer"in t&&n(2,r=t.hideAnswer)},[o,s,r,i]}class Tn extends Z{constructor(t){super(),X(this,t,Ln,qn,i,{question:0,topic:1,hideAnswer:2})}}function Vn(t){let e,n,o,r,i,c,d,g,$,b,v,k,x,C,_,y,E,S,q,L,T,V,U,M;function j(t,e){return t[0]?Mn:Un}let H=j(t),O=H(t);return o=new En({props:{statistic:t[3]}}),i=new Tn({props:{topic:t[1],question:t[2],hideAnswer:t[4]}}),{c(){e=p("div"),O.c(),n=h(),W(o.$$.fragment),r=h(),W(i.$$.fragment),c=h(),d=p("div"),g=p("button"),$=f("Show"),v=h(),k=p("button"),x=f("Correct"),C=h(),_=p("button"),y=f("Wrong"),E=h(),S=p("button"),q=f("Skip"),L=h(),T=p("button"),T.textContent="Stop",w(g,"class","button"),g.hidden=b=!t[4],w(k,"class","button is-success"),k.hidden=t[4],w(_,"class","button is-danger"),_.hidden=t[4],w(S,"class","button is-warning"),S.hidden=t[4],w(T,"class","button"),w(d,"class","is-floating"),w(e,"class","card card-shadow content")},m(s,u){l(s,e,u),O.m(e,null),a(e,n),Q(o,e,null),a(e,r),Q(i,e,null),a(e,c),a(e,d),a(d,g),a(g,$),a(d,v),a(d,k),a(k,x),a(d,C),a(d,_),a(_,y),a(d,E),a(d,S),a(S,q),a(d,L),a(d,T),V=!0,U||(M=[m(g,"click",t[10]),m(k,"click",t[11]),m(_,"click",t[12]),m(S,"click",t[13]),m(T,"click",t[7])],U=!0)},p(t,s){H===(H=j(t))&&O?O.p(t,s):(O.d(1),O=H(t),O&&(O.c(),O.m(e,n)));const r={};8&s&&(r.statistic=t[3]),o.$set(r);const c={};2&s&&(c.topic=t[1]),4&s&&(c.question=t[2]),16&s&&(c.hideAnswer=t[4]),i.$set(c),(!V||16&s&&b!==(b=!t[4]))&&(g.hidden=b),(!V||16&s)&&(k.hidden=t[4]),(!V||16&s)&&(_.hidden=t[4]),(!V||16&s)&&(S.hidden=t[4])},i(t){V||(z(o.$$.fragment,t),z(i.$$.fragment,t),V=!0)},o(t){J(o.$$.fragment,t),J(i.$$.fragment,t),V=!1},d(t){t&&u(e),O.d(),K(o),K(i),U=!1,s(M)}}}function Un(t){let e,n,o=t[1].title+"";return{c(){e=p("h4"),n=f(o)},m(t,o){l(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[1].title+"")&&b(n,o)},d(t){t&&u(e)}}}function Mn(t){let e,n,o,s,r,i,c=t[1].title+"";return{c(){e=p("h4"),n=f("Tag: "),o=f(t[0]),s=h(),r=p("h6"),i=f(c)},m(t,c){l(t,e,c),a(e,n),a(e,o),l(t,s,c),l(t,r,c),a(r,i)},p(t,e){1&e&&b(o,t[0]),2&e&&c!==(c=t[1].title+"")&&b(i,c)},d(t){t&&u(e),t&&u(s),t&&u(r)}}}function jn(t){let e,n,o=t[2]&&Vn(t);return{c(){o&&o.c(),e=g()},m(t,s){o&&o.m(t,s),l(t,e,s),n=!0},p(t,[n]){t[2]?o?(o.p(t,n),4&n&&z(o,1)):(o=Vn(t),o.c(),z(o,1),o.m(e.parentNode,e)):o&&(D(),J(o,1,1,(()=>{o=null})),F())},i(t){n||(z(o),n=!0)},o(t){J(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function Hn(t,e,n){let o,s,r,i,{tag:c}=e,{topics:a}=e,{questions:l}=e,u=!0;var d;!function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong",t[t.Skip=2]="Skip"}(d||(d={}));const p=t=>{if(t===d.Skip)return i.push(s),void f();Jt(s,t===d.Correct),Qt(s).then((()=>{s.progress<3&&i.push(s),0===i.length&&h(),f()}))},f=()=>{const t=i.shift();if(!t)return;n(2,s=t);const e=a.find((t=>t.file===s.file));e&&(n(1,o=e),n(3,r=zt(l)),n(4,u=!0),console.log("next",s))};q((()=>{i=l.filter((t=>t.progress<3)),yt(i),f()}));const h=async()=>{c?nt.setView("ViewTopicList",{id:""}):(n(1,o.lastLearned=new Date,o),await ue(o),nt.setView("ViewTopicList",{id:o.file}))};return t.$$set=t=>{"tag"in t&&n(0,c=t.tag),"topics"in t&&n(8,a=t.topics),"questions"in t&&n(9,l=t.questions)},[c,o,s,r,u,d,p,h,a,l,()=>n(4,u=!1),()=>p(d.Correct),()=>p(d.Wrong),()=>p(d.Skip)]}class On extends Z{constructor(t){super(),X(this,t,Hn,jn,i,{tag:0,topics:8,questions:9})}}function Rn(e){let n,o,r,i,c,d,g,$,k,x,C,_,y,E,S,q,L,T,V,U,M,j,H,O,R;return{c(){n=p("h4"),n.textContent="Translate",o=h(),r=p("div"),i=p("label"),c=f(e[0]),d=h(),g=p("textarea"),$=h(),k=p("label"),x=f(e[1]),C=h(),_=p("textarea"),y=h(),E=p("div"),S=p("button"),S.textContent="Back",q=h(),L=p("button"),L.textContent="Translate",T=h(),V=p("button"),V.textContent="Reset",U=h(),M=p("button"),M.textContent="Switch",j=h(),H=p("p"),H.innerHTML='The translation is done with <a href="https://libretranslate.de/">LibreTranslate</a>',w(i,"for","src"),w(g,"id","src"),w(g,"class","input"),w(k,"for","dst"),w(_,"id","dst"),_.readOnly=!0,_.value=e[3],w(_,"class","input"),w(r,"class","block"),w(S,"class","button"),w(L,"class","button"),w(V,"class","button"),w(M,"class","button"),w(E,"class","is-floating")},m(t,s){l(t,n,s),l(t,o,s),l(t,r,s),a(r,i),a(i,c),a(r,d),a(r,g),v(g,e[2]),a(r,$),a(r,k),a(k,x),a(r,C),a(r,_),l(t,y,s),l(t,E,s),a(E,S),a(E,q),a(E,L),a(E,T),a(E,V),a(E,U),a(E,M),l(t,j,s),l(t,H,s),O||(R=[m(g,"input",e[8]),m(S,"click",e[9]),m(L,"click",e[10]),m(V,"click",e[11]),m(M,"click",e[12])],O=!0)},p(t,[e]){1&e&&b(c,t[0]),4&e&&v(g,t[2]),2&e&&b(x,t[1]),8&e&&(_.value=t[3])},i:t,o:t,d(t){t&&u(n),t&&u(o),t&&u(r),t&&u(y),t&&u(E),t&&u(j),t&&u(H),O=!1,s(R)}}}function An(t,e,n){let o="German",s="Russian",r="de",i="ru",c="",a="";const l=()=>{c&&fetch("https://libretranslate.de/translate",{method:"POST",body:JSON.stringify({q:c,source:r,target:i,format:"text"}),headers:{"Content-Type":"application/json"}}).then((t=>(t.ok||ot.addError(`Unable to get JSON: ${t.statusText}`),t.json()))).then((t=>{n(3,a=t.translatedText)}))},u=()=>{"de"===r?(n(0,o="Russian"),n(1,s="German"),r="ru",i="de"):(n(0,o="German"),n(1,s="Russian"),r="de",i="ru"),n(2,c=a),l()},d=()=>{n(2,c=""),n(3,a="")},p=()=>{nt.setView("ViewTopicList",{id:""})};return[o,s,c,a,l,u,d,p,function(){c=this.value,n(2,c)},()=>p(),()=>l(),()=>d(),()=>u()]}class Nn extends Z{constructor(t){super(),X(this,t,An,Rn,i,{})}}function Bn(t,e,n){const o=t.slice();return o[10]=e[n],o}function Gn(t){let e,n,o,s,r,i,c,d,g,$,v,k,x,C,_,y=t[10].file+"",E=t[10].value+"",S=bt(t[10].lastLoaded)+"";function q(){return t[7](t[10])}return{c(){e=p("tr"),n=p("td"),o=f(y),s=h(),r=p("td"),i=f(E),c=h(),d=p("td"),g=f(S),$=h(),v=p("td"),k=p("button"),k.textContent="Delete",x=h(),w(k,"class","button")},m(t,u){l(t,e,u),a(e,n),a(n,o),a(e,s),a(e,r),a(r,i),a(e,c),a(e,d),a(d,g),a(e,$),a(e,v),a(v,k),a(e,x),C||(_=m(k,"click",q),C=!0)},p(e,n){t=e,1&n&&y!==(y=t[10].file+"")&&b(o,y),1&n&&E!==(E=t[10].value+"")&&b(i,E),1&n&&S!==(S=bt(t[10].lastLoaded)+"")&&b(g,S)},d(t){t&&u(e),C=!1,_()}}}function Pn(e){let n,o,r,i,c,f,g,$,b,v,k,C,_,y,E,S,q,L=e[0],T=[];for(let t=0;t<L.length;t+=1)T[t]=Gn(Bn(e,L,t));return{c(){n=p("div"),o=p("label"),o.textContent="Tag Filter",r=h(),i=p("select"),c=p("option"),c.textContent="By Name",f=p("option"),f.textContent="By Date",g=h(),$=p("button"),$.textContent="Load All",b=h(),v=p("table"),k=p("tr"),k.innerHTML="<th>File</th> \n    <th>Hash</th> \n    <th>Last Loaded</th> \n    <th></th>",C=h();for(let t=0;t<T.length;t+=1)T[t].c();_=h(),y=p("div"),E=p("button"),E.textContent="Back",w(o,"for","sort-select"),c.__value="file",c.value=c.__value,f.__value="lastLoaded",f.value=f.__value,w(i,"id","sort-select"),void 0===e[1]&&R((()=>e[6].call(i))),w($,"class","button"),w(n,"class","is-floating"),w(E,"class","button"),w(y,"class","is-floating")},m(t,s){l(t,n,s),a(n,o),a(n,r),a(n,i),a(i,c),a(i,f),x(i,e[1]),a(n,g),a(n,$),l(t,b,s),l(t,v,s),a(v,k),a(v,C);for(let t=0;t<T.length;t+=1)T[t]&&T[t].m(v,null);l(t,_,s),l(t,y,s),a(y,E),S||(q=[m(i,"change",e[6]),m(i,"change",e[2]),m($,"click",e[5]),m(E,"click",e[8])],S=!0)},p(t,[e]){if(2&e&&x(i,t[1]),9&e){let n;for(L=t[0],n=0;n<L.length;n+=1){const o=Bn(t,L,n);T[n]?T[n].p(o,e):(T[n]=Gn(o),T[n].c(),T[n].m(v,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=L.length}},i:t,o:t,d(t){t&&u(n),t&&u(b),t&&u(v),d(T,t),t&&u(_),t&&u(y),S=!1,s(q)}}}function In(t,e,n){let o=[],s="file";const r=()=>{console.log("sort",s),"file"===s?o.sort(((t,e)=>+(e.file>t.file)||-(e.file<t.file))):o.sort(((t,e)=>+(e.lastLoaded>t.lastLoaded)||-(e.lastLoaded<t.lastLoaded))),n(0,o)},i=async()=>{n(0,o=await mt()),r()},c=async t=>{await $t(t),i()},a=()=>{nt.setView("ViewTopicList",{id:""})};q((()=>{i()}));return[o,s,r,c,a,async()=>{const t=(await le()).map((t=>t.file));await se(t),i()},function(){s=C(this),n(1,s)},t=>c(t.file),()=>a()]}class Dn extends Z{constructor(t){super(),X(this,t,In,Pn,i,{})}}function Fn(t){let e,n,o=t[0].token.substring(t[0].token.length-3)+"";return{c(){e=f("..."),n=f(o)},m(t,o){l(t,e,o),l(t,n,o)},p(t,e){1&e&&o!==(o=t[0].token.substring(t[0].token.length-3)+"")&&b(n,o)},d(t){t&&u(e),t&&u(n)}}}function zn(e){let n,o,s,r,i,c,d,g,m,$,w,v,k,x,C,_,y,E,S,q,L,T,V,U,M,j,H,O,R,A=e[0].langUrl+"",N=e[0].linkUrl+"",B=(e[0].backupUrl?e[0].backupUrl:"")+"",G=(e[0].file?e[0].file:"")+"",P=e[0].token&&Fn(e);return{c(){n=p("table"),o=p("tr"),s=p("td"),s.textContent="Github URL Language",r=h(),i=p("td"),c=f(A),d=h(),g=p("tr"),m=p("td"),m.textContent="Github Link URL",$=h(),w=p("td"),v=f(N),k=h(),x=p("tr"),C=p("td"),C.textContent="Github URL Backup",_=h(),y=p("td"),E=f(B),S=h(),q=p("tr"),L=p("td"),L.textContent="Github File",T=h(),V=p("td"),U=f(G),M=h(),j=p("tr"),H=p("td"),H.textContent="Token",O=h(),R=p("td"),P&&P.c()},m(t,e){l(t,n,e),a(n,o),a(o,s),a(o,r),a(o,i),a(i,c),a(n,d),a(n,g),a(g,m),a(g,$),a(g,w),a(w,v),a(n,k),a(n,x),a(x,C),a(x,_),a(x,y),a(y,E),a(n,S),a(n,q),a(q,L),a(q,T),a(q,V),a(V,U),a(n,M),a(n,j),a(j,H),a(j,O),a(j,R),P&&P.m(R,null)},p(t,[e]){1&e&&A!==(A=t[0].langUrl+"")&&b(c,A),1&e&&N!==(N=t[0].linkUrl+"")&&b(v,N),1&e&&B!==(B=(t[0].backupUrl?t[0].backupUrl:"")+"")&&b(E,B),1&e&&G!==(G=(t[0].file?t[0].file:"")+"")&&b(U,G),t[0].token?P?P.p(t,e):(P=Fn(t),P.c(),P.m(R,null)):P&&(P.d(1),P=null)},i:t,o:t,d(t){t&&u(n),P&&P.d()}}}function Jn(t,e,n){let{admin:o}=e;return t.$$set=t=>{"admin"in t&&n(0,o=t.admin)},[o]}class Wn extends Z{constructor(t){super(),X(this,t,Jn,zn,i,{admin:0})}}function Qn(e){let n,o,r,i,c,d,g,$,v,x,C,_,y,E;return{c(){n=p("div"),o=p("div"),r=p("h5"),i=f(e[0]),c=h(),d=p("p"),g=f(e[1]),$=h(),v=p("div"),x=p("button"),x.textContent="OK",C=h(),_=p("button"),_.textContent="Cancel",w(x,"class","button"),w(_,"class","button"),w(v,"class","is-floating"),w(o,"class","popup-content"),w(n,"class","popup"),k(n,"display",e[2]?"block":"none")},m(t,s){l(t,n,s),a(n,o),a(o,r),a(r,i),a(o,c),a(o,d),a(d,g),a(o,$),a(o,v),a(v,x),a(v,C),a(v,_),y||(E=[m(x,"click",e[4]),m(_,"click",e[5])],y=!0)},p(t,[e]){1&e&&b(i,t[0]),2&e&&b(g,t[1]),4&e&&k(n,"display",t[2]?"block":"none")},i:t,o:t,d(t){t&&u(n),y=!1,s(E)}}}function Kn(t,e,n){let{title:o=""}=e,{msg:s=""}=e,{doShow:r=!1}=e;const i=T();return t.$$set=t=>{"title"in t&&n(0,o=t.title),"msg"in t&&n(1,s=t.msg),"doShow"in t&&n(2,r=t.doShow)},[o,s,r,i,()=>i("popup","ok"),()=>i("popup","cancel")]}class Yn extends Z{constructor(t){super(),X(this,t,Kn,Qn,i,{title:0,msg:1,doShow:2})}}function Xn(t){let e,n;return{c(){e=p("div"),n=f(t[2]),w(e,"class","block is-text-success")},m(t,o){l(t,e,o),a(e,n)},p(t,e){4&e&&b(n,t[2])},d(t){t&&u(e)}}}function Zn(t){let e,n,o,s;const r=[eo,to],i=[];function c(t,e){return t[1]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=g()},m(t,n){i[e].m(t,n),l(t,o,n),s=!0},p(t,s){let a=e;e=c(t),e===a?i[e].p(t,s):(D(),J(i[a],1,1,(()=>{i[a]=null})),F(),n=i[e],n?n.p(t,s):(n=i[e]=r[e](t),n.c()),z(n,1),n.m(o.parentNode,o))},i(t){s||(z(n),s=!0)},o(t){J(n),s=!1},d(t){i[e].d(t),t&&u(o)}}}function to(t){let e,n,o,r,i,c,d,f,g,$,b;n=new Wn({props:{admin:t[0]}});let v=t[0].file&&t[0].backupUrl&&t[0].token&&no(t);return{c(){e=p("div"),W(n.$$.fragment),o=h(),r=p("div"),i=p("button"),i.textContent="Back",c=h(),d=p("button"),d.textContent="Update",f=h(),v&&v.c(),w(i,"class","button"),w(d,"class","button"),w(r,"class","is-floating"),w(e,"class","block")},m(s,u){l(s,e,u),Q(n,e,null),a(e,o),a(e,r),a(r,i),a(r,c),a(r,d),a(r,f),v&&v.m(r,null),g=!0,$||(b=[m(i,"click",t[8]),m(d,"click",t[17])],$=!0)},p(t,e){const o={};1&e&&(o.admin=t[0]),n.$set(o),t[0].file&&t[0].backupUrl&&t[0].token?v?v.p(t,e):(v=no(t),v.c(),v.m(r,null)):v&&(v.d(1),v=null)},i(t){g||(z(n.$$.fragment,t),g=!0)},o(t){J(n.$$.fragment,t),g=!1},d(t){t&&u(e),K(n),v&&v.d(),$=!1,s(b)}}}function eo(e){let n,o,r,i,c,d,f,g,b,k,x,C,_,y,E,S,q,L,T,V,U,M,j,H,O,R,A,N,B,G;return{c(){n=p("form"),o=p("div"),r=p("label"),r.textContent="Github URL Language",i=h(),c=p("input"),d=h(),f=p("label"),f.textContent="Github Link URL",g=h(),b=p("input"),k=h(),x=p("label"),x.textContent="Github URL Backup",C=h(),_=p("input"),y=h(),E=p("label"),E.textContent="Github File",S=h(),q=p("input"),L=h(),T=p("label"),T.textContent="Token",V=h(),U=p("input"),M=h(),j=p("div"),H=p("button"),H.textContent="Save",O=h(),R=p("button"),R.textContent="Cancel",A=h(),N=p("button"),N.textContent="Back",w(r,"for","langUrl"),w(c,"id","langUrl"),w(c,"type","url"),w(c,"class","input"),w(f,"for","linkUrl"),w(b,"id","linkUrl"),w(b,"type","url"),w(b,"class","input"),w(x,"for","backupUrl"),w(_,"id","backupUrl"),w(_,"type","url"),w(_,"class","input"),w(E,"for","file"),w(q,"id","file"),w(q,"type","text"),w(q,"class","input"),w(T,"for","token"),w(U,"id","token"),w(U,"type","password"),w(U,"class","input"),w(o,"class","block"),w(H,"class","button"),w(R,"class","button"),w(N,"class","button"),w(j,"class","is-floating")},m(t,s){l(t,n,s),a(n,o),a(o,r),a(o,i),a(o,c),v(c,e[0].langUrl),a(o,d),a(o,f),a(o,g),a(o,b),v(b,e[0].linkUrl),a(o,k),a(o,x),a(o,C),a(o,_),v(_,e[0].backupUrl),a(o,y),a(o,E),a(o,S),a(o,q),v(q,e[0].file),a(o,L),a(o,T),a(o,V),a(o,U),v(U,e[0].token),a(n,M),a(n,j),a(j,H),a(j,O),a(j,R),a(j,A),a(j,N),B||(G=[m(c,"input",e[11]),m(b,"input",e[12]),m(_,"input",e[13]),m(q,"input",e[14]),m(U,"input",e[15]),m(R,"click",e[16]),m(N,"click",e[8]),m(n,"submit",$(e[7]))],B=!0)},p(t,e){1&e&&c.value!==t[0].langUrl&&v(c,t[0].langUrl),1&e&&b.value!==t[0].linkUrl&&v(b,t[0].linkUrl),1&e&&_.value!==t[0].backupUrl&&v(_,t[0].backupUrl),1&e&&q.value!==t[0].file&&v(q,t[0].file),1&e&&U.value!==t[0].token&&v(U,t[0].token)},i:t,o:t,d(t){t&&u(n),B=!1,s(G)}}}function no(e){let n,o,r,i,c;return{c(){n=p("button"),n.textContent="Backup",o=h(),r=p("button"),r.textContent="Restore",w(n,"class","button"),w(r,"class","button")},m(t,s){l(t,n,s),l(t,o,s),l(t,r,s),i||(c=[m(n,"click",e[18]),m(r,"click",e[19])],i=!0)},p:t,d(t){t&&u(n),t&&u(o),t&&u(r),i=!1,s(c)}}}function oo(t){let e,n,o,s,r,i,c=t[2]&&Xn(t),a=t[0]&&Zn(t);return r=new Yn({props:{title:t[4],msg:t[5],doShow:t[6]}}),r.$on("popup",t[10]),{c(){e=p("h4"),e.textContent="Configuration",n=h(),c&&c.c(),o=h(),a&&a.c(),s=h(),W(r.$$.fragment)},m(t,u){l(t,e,u),l(t,n,u),c&&c.m(t,u),l(t,o,u),a&&a.m(t,u),l(t,s,u),Q(r,t,u),i=!0},p(t,[e]){t[2]?c?c.p(t,e):(c=Xn(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[0]?a?(a.p(t,e),1&e&&z(a,1)):(a=Zn(t),a.c(),z(a,1),a.m(s.parentNode,s)):a&&(D(),J(a,1,1,(()=>{a=null})),F());const n={};16&e&&(n.title=t[4]),32&e&&(n.msg=t[5]),64&e&&(n.doShow=t[6]),r.$set(n)},i(t){i||(z(a),z(r.$$.fragment,t),i=!0)},o(t){J(a),J(r.$$.fragment,t),i=!1},d(t){t&&u(e),t&&u(n),c&&c.d(t),t&&u(o),a&&a.d(t),t&&u(s),K(r,t)}}}function so(t,e,n){let o,s=!1,r="";q((async()=>{n(0,o=await jt())}));const i=async()=>{try{const t=await ee(),e=await Bt(t);e.hasError()?(ot.addError(`Unable to write backup - ${e.getMessage()}`),n(2,r="Backup FAILED!")):n(2,r="Backup done!")}catch(t){ot.addError(`Error on backup - ${t}`)}},c=async()=>{const t=await Nt();t.hasError()?(ot.addError(t.getMessage()),n(2,r="Restore FAILED!")):(ne(t.getValue()),n(2,r="Restore done!"))};var a;let l,u;!function(t){t[t.Backup=0]="Backup",t[t.Restore=1]="Restore"}(a||(a={}));let d,p=!1;const f=t=>{switch(t){case a.Backup:n(4,l="Information"),n(5,u="Do you realy want to create a backup?"),d=i;break;case a.Restore:n(4,l="Warning"),n(5,u="Do you realy want to restore the backup?"),d=c;break;default:console.log("Unkown type",t)}n(6,p=!0)};return[o,s,r,a,l,u,p,()=>{o.langUrl&&Ht(o),n(1,s=!1)},()=>{nt.setView("ViewTopicList",{id:""})},f,t=>{n(6,p=!1),"ok"===t.detail&&d()},function(){o.langUrl=this.value,n(0,o)},function(){o.linkUrl=this.value,n(0,o)},function(){o.backupUrl=this.value,n(0,o)},function(){o.file=this.value,n(0,o)},function(){o.token=this.value,n(0,o)},()=>n(1,s=!1),()=>n(1,s=!0),()=>f(a.Backup),()=>f(a.Restore)]}class ro extends Z{constructor(t){super(),X(this,t,so,oo,i,{})}}function io(t){let e,n;return{c(){e=p("div"),n=f(t[2]),w(e,"class","is-text-danger")},m(t,o){l(t,e,o),a(e,n)},p(t,e){4&e&&b(n,t[2])},d(t){t&&u(e)}}}function co(t){let e,n,o,s,r,i,c,d;return c=new cn({props:{questions:t[1]}}),{c(){e=p("div"),n=f("Total: "),o=f(t[3]),s=f(" found: "),r=f(t[4]),i=h(),W(c.$$.fragment)},m(t,u){l(t,e,u),a(e,n),a(e,o),a(e,s),a(e,r),l(t,i,u),Q(c,t,u),d=!0},p(t,e){(!d||8&e)&&b(o,t[3]),(!d||16&e)&&b(r,t[4]);const n={};2&e&&(n.questions=t[1]),c.$set(n)},i(t){d||(z(c.$$.fragment,t),d=!0)},o(t){J(c.$$.fragment,t),d=!1},d(t){t&&u(e),t&&u(i),K(c,t)}}}function ao(t){let e,n,o,r,i,c,d,f,g,b,k,x,C,_,y,E,S,q;b=new Ee({props:{onClick:t[5]}});let L=t[2]&&io(t),T=0!==t[1].length&&co(t);return{c(){e=p("h4"),e.textContent="Search",n=h(),o=p("form"),r=p("div"),i=p("label"),i.textContent="Search String",c=h(),d=p("div"),f=p("input"),g=h(),W(b.$$.fragment),k=h(),L&&L.c(),x=h(),T&&T.c(),C=h(),_=p("div"),y=p("button"),y.textContent="Back",w(i,"for","searchStr"),w(f,"id","searchStr"),w(f,"class","input"),w(d,"class","is-floating"),w(r,"class",""),w(y,"class","button"),w(_,"class","is-floating")},m(s,u){l(s,e,u),l(s,n,u),l(s,o,u),a(o,r),a(r,i),a(r,c),a(r,d),a(d,f),v(f,t[0]),a(d,g),Q(b,d,null),a(r,k),L&&L.m(r,null),l(s,x,u),T&&T.m(s,u),l(s,C,u),l(s,_,u),a(_,y),E=!0,S||(q=[m(f,"input",t[7]),m(o,"submit",$(t[5])),m(y,"click",t[6])],S=!0)},p(t,[e]){1&e&&f.value!==t[0]&&v(f,t[0]),t[2]?L?L.p(t,e):(L=io(t),L.c(),L.m(r,null)):L&&(L.d(1),L=null),0!==t[1].length?T?(T.p(t,e),2&e&&z(T,1)):(T=co(t),T.c(),z(T,1),T.m(C.parentNode,C)):T&&(D(),J(T,1,1,(()=>{T=null})),F())},i(t){E||(z(b.$$.fragment,t),z(T),E=!0)},o(t){J(b.$$.fragment,t),J(T),E=!1},d(t){t&&u(e),t&&u(n),t&&u(o),K(b),L&&L.d(),t&&u(x),T&&T.d(t),t&&u(C),t&&u(_),S=!1,s(q)}}}const lo=30;function uo(t,e,n){let o="",s=[],r="",i=0,c=0;return[o,s,r,i,c,async()=>{console.log("Searching:",o);const t=o.trim();!t||t.length<3?n(2,r="Please enter search string with at least 3 chars!"):(r&&n(2,r=""),n(1,s=[]),n(1,[s,i,c]=await ce(t,lo),s,n(3,i),n(4,c)),0===s.length?n(2,r="Nothing found!"):s.length<c&&n(2,r=`More than: ${lo} questions found! (Total: ${c})`))},()=>{nt.setView("ViewTopicList",{id:""})},function(){o=this.value,n(0,o)}]}class po extends Z{constructor(t){super(),X(this,t,uo,ao,i,{})}}function fo(e){let n,o,r,i,c,d,g,k,x,C,_,y,E,S,q,L,T,V,U,M,j,H,O,R,A,N,B,G,P,I,D,F=e[0].id+"";return{c(){n=p("div"),o=p("form"),r=p("div"),i=p("div"),c=f("Question: "),d=f(F),g=h(),k=p("div"),x=p("textarea"),C=h(),_=p("div"),y=p("p"),E=h(),S=p("h5"),S.textContent="Answer",q=h(),L=p("div"),T=p("textarea"),V=h(),U=p("div"),M=p("p"),j=h(),H=p("h5"),H.textContent="Comment",O=h(),R=p("input"),A=h(),N=p("div"),B=p("button"),B.textContent="Cancel",G=h(),P=p("button"),P.textContent="Save",w(i,"class","h5"),w(x,"rows","10"),w(x,"id","quest"),w(x,"class","input"),w(_,"class","card content is-primary"),w(k,"class","grid grid-2"),w(T,"rows","10"),w(T,"id","answer"),w(T,"class","input"),w(U,"class","card content is-primary"),w(L,"class","grid grid-2"),w(R,"type","input"),w(R,"class","input"),w(r,"class","block"),w(B,"class","button"),w(P,"class","button"),w(N,"class","is-floating"),w(n,"class","card card-shadow content")},m(t,s){l(t,n,s),a(n,o),a(o,r),a(r,i),a(i,c),a(i,d),a(r,g),a(r,k),a(k,x),v(x,e[1]),a(k,C),a(k,_),a(_,y),y.innerHTML=e[3],a(r,E),a(r,S),a(r,q),a(r,L),a(L,T),v(T,e[2]),a(L,V),a(L,U),a(U,M),M.innerHTML=e[4],a(r,j),a(r,H),a(r,O),a(r,R),v(R,e[5]),a(o,A),a(o,N),a(N,B),a(N,G),a(N,P),I||(D=[m(x,"input",e[8]),m(T,"input",e[9]),m(R,"input",e[10]),m(B,"click",e[7]),m(o,"submit",$(e[6]))],I=!0)},p(t,[e]){1&e&&F!==(F=t[0].id+"")&&b(d,F),2&e&&v(x,t[1]),8&e&&(y.innerHTML=t[3]),4&e&&v(T,t[2]),16&e&&(M.innerHTML=t[4]),32&e&&v(R,t[5])},i:t,o:t,d(t){t&&u(n),I=!1,s(D)}}}function ho(t,e,n){const o=new Ft;let{question:s}=e,r="",i="",c=Tt(s.quest),a=Tt(s.answer),l=`Update question: '${s.id}' in: '${s.file}'`;return t.$$set=t=>{"question"in t&&n(0,s=t.question)},t.$$.update=()=>{2&t.$$.dirty&&n(3,r=o.toHtml(Lt(c))),4&t.$$.dirty&&n(4,i=o.toHtml(Lt(a)))},[s,c,a,r,i,l,async()=>{const t=await Pt(s.file);if(t.hasError())return void ot.addError(t.getMessage());const e=t.getValue();for(let t=0;t<e.json.length;t++){const n=e.json[t];if(n.id===s.id){n.quest=Lt(c),n.answer=Lt(a);break}}const n=await Gt(s.file,e.json,e.hash,l);n.hasError()?ot.addError(n.getMessage()):nt.setView("ViewTopicList",{id:""})},()=>{nt.setView("ViewTopicList",{id:""})},function(){c=this.value,n(1,c)},function(){a=this.value,n(2,a)},function(){l=this.value,n(5,l)}]}class go extends Z{constructor(t){super(),X(this,t,ho,fo,i,{question:0})}}function mo(t){let e,n;return e=new at({}),{c(){W(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function $o(t){let n,o,s,r,i,c,d,f,g,m=0!==t[0].length&&mo();const $=[t[1].props];var b=t[1].component;function v(t){let n={};for(let t=0;t<$.length;t+=1)n=e(n,$[t]);return{props:n}}return b&&(c=_(b,v())),{c(){n=p("div"),o=p("h2"),o.textContent="Cards",s=h(),m&&m.c(),r=h(),i=p("div"),c&&W(c.$$.fragment),d=h(),f=p("div"),f.innerHTML='<div class="is-text-right">by Volker Senkel 2021</div>',w(i,"id","main"),w(i,"class","block"),w(f,"class","block"),w(n,"class","container")},m(t,e){l(t,n,e),a(n,o),a(n,s),m&&m.m(n,null),a(n,r),a(n,i),c&&Q(c,i,null),a(n,d),a(n,f),g=!0},p(t,[e]){0!==t[0].length?m?1&e&&z(m,1):(m=mo(),m.c(),z(m,1),m.m(n,r)):m&&(D(),J(m,1,1,(()=>{m=null})),F());const o=2&e?function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],c=e[r];if(c){for(const t in i)t in c||(o[t]=1);for(const t in c)s[t]||(n[t]=c[t],s[t]=1);t[r]=c}else for(const t in i)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}($,[(s=t[1].props,"object"==typeof s&&null!==s?s:{})]):{};var s;if(2&e&&b!==(b=t[1].component)){if(c){D();const t=c;J(t.$$.fragment,1,0,(()=>{K(t,1)})),F()}b?(c=_(b,v()),W(c.$$.fragment),z(c.$$.fragment,1),Q(c,i,null)):c=null}else b&&c.$set(o)},i(t){g||(z(m),c&&z(c.$$.fragment,t),g=!0)},o(t){J(m),c&&J(c.$$.fragment,t),g=!1},d(t){t&&u(n),m&&m.d(),c&&K(c)}}}function wo(t,e,n){let o,s;return c(t,ot,(t=>n(0,o=t))),c(t,nt,(t=>n(1,s=t))),q((async()=>{nt.views={ViewTopicList:{component:De},ViewTopicInfo:{component:We},ViewTopicQuests:{component:dn},ViewTagInfo:{component:vn},ViewTagQuests:{component:Cn},ViewQuestAnswer:{component:On},ViewTranslate:{component:Nn},ViewHashes:{component:Dn},ViewAdmin:{component:ro},ViewSearch:{component:po},ViewQuestEdit:{component:go}},await he(),nt.setView("ViewTopicList",{id:""})})),[o,s]}return new class extends Z{constructor(t){super(),X(this,t,wo,$o,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
